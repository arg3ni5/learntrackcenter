const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Register-Bf4L78v0.js","assets/Register-Duh75M7k.css","assets/Courses-D82GeWOK.js","assets/courseService-BKmjs8rX.js","assets/Periods-CQwhUu4M.js","assets/periodService-COUu7smY.js","assets/Dashboard-DiO9mUqD.js","assets/Dashboard-BREJmAyz.css","assets/Students-Db6j1aZv.js","assets/PeriodsManager-Rlh27ig2.js","assets/useStudentCourses-D2S5OMls.js","assets/PeriodsManager-jNovB0yZ.css","assets/Students-WaJLWye5.css","assets/StudentsCourses-CXaF5WNZ.js","assets/CourseStudents-B27gEFke.js","assets/CourseStudents-ispZDE6Z.css"])))=>i.map(i=>d[i]);
function sI(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function oI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var em={exports:{}},eu={},tm={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w_;function lI(){if(w_)return ht;w_=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function v(te){return te===null||typeof te!="object"?null:(te=g&&te[g]||te["@@iterator"],typeof te=="function"?te:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,_={};function w(te,O,re){this.props=te,this.context=O,this.refs=_,this.updater=re||y}w.prototype.isReactComponent={},w.prototype.setState=function(te,O){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,O,"setState")},w.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function k(){}k.prototype=w.prototype;function F(te,O,re){this.props=te,this.context=O,this.refs=_,this.updater=re||y}var C=F.prototype=new k;C.constructor=F,E(C,w.prototype),C.isPureReactComponent=!0;var B=Array.isArray,V=Object.prototype.hasOwnProperty,z={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function R(te,O,re){var ee,Z={},ce=null,_e=null;if(O!=null)for(ee in O.ref!==void 0&&(_e=O.ref),O.key!==void 0&&(ce=""+O.key),O)V.call(O,ee)&&!A.hasOwnProperty(ee)&&(Z[ee]=O[ee]);var Se=arguments.length-2;if(Se===1)Z.children=re;else if(1<Se){for(var we=Array(Se),xe=0;xe<Se;xe++)we[xe]=arguments[xe+2];Z.children=we}if(te&&te.defaultProps)for(ee in Se=te.defaultProps,Se)Z[ee]===void 0&&(Z[ee]=Se[ee]);return{$$typeof:t,type:te,key:ce,ref:_e,props:Z,_owner:z.current}}function P(te,O){return{$$typeof:t,type:te.type,key:O,ref:te.ref,props:te.props,_owner:te._owner}}function L(te){return typeof te=="object"&&te!==null&&te.$$typeof===t}function M(te){var O={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(re){return O[re]})}var N=/\/+/g;function U(te,O){return typeof te=="object"&&te!==null&&te.key!=null?M(""+te.key):O.toString(36)}function be(te,O,re,ee,Z){var ce=typeof te;(ce==="undefined"||ce==="boolean")&&(te=null);var _e=!1;if(te===null)_e=!0;else switch(ce){case"string":case"number":_e=!0;break;case"object":switch(te.$$typeof){case t:case e:_e=!0}}if(_e)return _e=te,Z=Z(_e),te=ee===""?"."+U(_e,0):ee,B(Z)?(re="",te!=null&&(re=te.replace(N,"$&/")+"/"),be(Z,O,re,"",function(xe){return xe})):Z!=null&&(L(Z)&&(Z=P(Z,re+(!Z.key||_e&&_e.key===Z.key?"":(""+Z.key).replace(N,"$&/")+"/")+te)),O.push(Z)),1;if(_e=0,ee=ee===""?".":ee+":",B(te))for(var Se=0;Se<te.length;Se++){ce=te[Se];var we=ee+U(ce,Se);_e+=be(ce,O,re,we,Z)}else if(we=v(te),typeof we=="function")for(te=we.call(te),Se=0;!(ce=te.next()).done;)ce=ce.value,we=ee+U(ce,Se++),_e+=be(ce,O,re,we,Z);else if(ce==="object")throw O=String(te),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return _e}function Ee(te,O,re){if(te==null)return te;var ee=[],Z=0;return be(te,ee,"","",function(ce){return O.call(re,ce,Z++)}),ee}function Ce(te){if(te._status===-1){var O=te._result;O=O(),O.then(function(re){(te._status===0||te._status===-1)&&(te._status=1,te._result=re)},function(re){(te._status===0||te._status===-1)&&(te._status=2,te._result=re)}),te._status===-1&&(te._status=0,te._result=O)}if(te._status===1)return te._result.default;throw te._result}var Te={current:null},ye={transition:null},ie={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:ye,ReactCurrentOwner:z};function ve(){throw Error("act(...) is not supported in production builds of React.")}return ht.Children={map:Ee,forEach:function(te,O,re){Ee(te,function(){O.apply(this,arguments)},re)},count:function(te){var O=0;return Ee(te,function(){O++}),O},toArray:function(te){return Ee(te,function(O){return O})||[]},only:function(te){if(!L(te))throw Error("React.Children.only expected to receive a single React element child.");return te}},ht.Component=w,ht.Fragment=r,ht.Profiler=i,ht.PureComponent=F,ht.StrictMode=n,ht.Suspense=u,ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,ht.act=ve,ht.cloneElement=function(te,O,re){if(te==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+te+".");var ee=E({},te.props),Z=te.key,ce=te.ref,_e=te._owner;if(O!=null){if(O.ref!==void 0&&(ce=O.ref,_e=z.current),O.key!==void 0&&(Z=""+O.key),te.type&&te.type.defaultProps)var Se=te.type.defaultProps;for(we in O)V.call(O,we)&&!A.hasOwnProperty(we)&&(ee[we]=O[we]===void 0&&Se!==void 0?Se[we]:O[we])}var we=arguments.length-2;if(we===1)ee.children=re;else if(1<we){Se=Array(we);for(var xe=0;xe<we;xe++)Se[xe]=arguments[xe+2];ee.children=Se}return{$$typeof:t,type:te.type,key:Z,ref:ce,props:ee,_owner:_e}},ht.createContext=function(te){return te={$$typeof:o,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},te.Provider={$$typeof:a,_context:te},te.Consumer=te},ht.createElement=R,ht.createFactory=function(te){var O=R.bind(null,te);return O.type=te,O},ht.createRef=function(){return{current:null}},ht.forwardRef=function(te){return{$$typeof:c,render:te}},ht.isValidElement=L,ht.lazy=function(te){return{$$typeof:d,_payload:{_status:-1,_result:te},_init:Ce}},ht.memo=function(te,O){return{$$typeof:h,type:te,compare:O===void 0?null:O}},ht.startTransition=function(te){var O=ye.transition;ye.transition={};try{te()}finally{ye.transition=O}},ht.unstable_act=ve,ht.useCallback=function(te,O){return Te.current.useCallback(te,O)},ht.useContext=function(te){return Te.current.useContext(te)},ht.useDebugValue=function(){},ht.useDeferredValue=function(te){return Te.current.useDeferredValue(te)},ht.useEffect=function(te,O){return Te.current.useEffect(te,O)},ht.useId=function(){return Te.current.useId()},ht.useImperativeHandle=function(te,O,re){return Te.current.useImperativeHandle(te,O,re)},ht.useInsertionEffect=function(te,O){return Te.current.useInsertionEffect(te,O)},ht.useLayoutEffect=function(te,O){return Te.current.useLayoutEffect(te,O)},ht.useMemo=function(te,O){return Te.current.useMemo(te,O)},ht.useReducer=function(te,O,re){return Te.current.useReducer(te,O,re)},ht.useRef=function(te){return Te.current.useRef(te)},ht.useState=function(te){return Te.current.useState(te)},ht.useSyncExternalStore=function(te,O,re){return Te.current.useSyncExternalStore(te,O,re)},ht.useTransition=function(){return Te.current.useTransition()},ht.version="18.3.1",ht}var T_;function Pg(){return T_||(T_=1,tm.exports=lI()),tm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function cI(){if(S_)return eu;S_=1;var t=Pg(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,h){var d,g={},v=null,y=null;h!==void 0&&(v=""+h),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(y=u.ref);for(d in u)n.call(u,d)&&!a.hasOwnProperty(d)&&(g[d]=u[d]);if(c&&c.defaultProps)for(d in u=c.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:c,key:v,ref:y,props:g,_owner:i.current}}return eu.Fragment=r,eu.jsx=o,eu.jsxs=o,eu}var k_;function uI(){return k_||(k_=1,em.exports=cI()),em.exports}var Q=uI(),G=Pg();const Ms=oI(G),A_=sI({__proto__:null,default:Ms},[G]);var Ch={},rm={exports:{}},Mn={},nm={exports:{}},im={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C_;function fI(){return C_||(C_=1,function(t){function e(ye,ie){var ve=ye.length;ye.push(ie);e:for(;0<ve;){var te=ve-1>>>1,O=ye[te];if(0<i(O,ie))ye[te]=ie,ye[ve]=O,ve=te;else break e}}function r(ye){return ye.length===0?null:ye[0]}function n(ye){if(ye.length===0)return null;var ie=ye[0],ve=ye.pop();if(ve!==ie){ye[0]=ve;e:for(var te=0,O=ye.length,re=O>>>1;te<re;){var ee=2*(te+1)-1,Z=ye[ee],ce=ee+1,_e=ye[ce];if(0>i(Z,ve))ce<O&&0>i(_e,Z)?(ye[te]=_e,ye[ce]=ve,te=ce):(ye[te]=Z,ye[ee]=ve,te=ee);else if(ce<O&&0>i(_e,ve))ye[te]=_e,ye[ce]=ve,te=ce;else break e}}return ie}function i(ye,ie){var ve=ye.sortIndex-ie.sortIndex;return ve!==0?ve:ye.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,g=null,v=3,y=!1,E=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ye){for(var ie=r(h);ie!==null;){if(ie.callback===null)n(h);else if(ie.startTime<=ye)n(h),ie.sortIndex=ie.expirationTime,e(u,ie);else break;ie=r(h)}}function B(ye){if(_=!1,C(ye),!E)if(r(u)!==null)E=!0,Ce(V);else{var ie=r(h);ie!==null&&Te(B,ie.startTime-ye)}}function V(ye,ie){E=!1,_&&(_=!1,k(R),R=-1),y=!0;var ve=v;try{for(C(ie),g=r(u);g!==null&&(!(g.expirationTime>ie)||ye&&!M());){var te=g.callback;if(typeof te=="function"){g.callback=null,v=g.priorityLevel;var O=te(g.expirationTime<=ie);ie=t.unstable_now(),typeof O=="function"?g.callback=O:g===r(u)&&n(u),C(ie)}else n(u);g=r(u)}if(g!==null)var re=!0;else{var ee=r(h);ee!==null&&Te(B,ee.startTime-ie),re=!1}return re}finally{g=null,v=ve,y=!1}}var z=!1,A=null,R=-1,P=5,L=-1;function M(){return!(t.unstable_now()-L<P)}function N(){if(A!==null){var ye=t.unstable_now();L=ye;var ie=!0;try{ie=A(!0,ye)}finally{ie?U():(z=!1,A=null)}}else z=!1}var U;if(typeof F=="function")U=function(){F(N)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Ee=be.port2;be.port1.onmessage=N,U=function(){Ee.postMessage(null)}}else U=function(){w(N,0)};function Ce(ye){A=ye,z||(z=!0,U())}function Te(ye,ie){R=w(function(){ye(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ye){ye.callback=null},t.unstable_continueExecution=function(){E||y||(E=!0,Ce(V))},t.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<ye?Math.floor(1e3/ye):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(ye){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var ve=v;v=ie;try{return ye()}finally{v=ve}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ye,ie){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var ve=v;v=ye;try{return ie()}finally{v=ve}},t.unstable_scheduleCallback=function(ye,ie,ve){var te=t.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?te+ve:te):ve=te,ye){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ve+O,ye={id:d++,callback:ie,priorityLevel:ye,startTime:ve,expirationTime:O,sortIndex:-1},ve>te?(ye.sortIndex=ve,e(h,ye),r(u)===null&&ye===r(h)&&(_?(k(R),R=-1):_=!0,Te(B,ve-te))):(ye.sortIndex=O,e(u,ye),E||y||(E=!0,Ce(V))),ye},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(ye){var ie=v;return function(){var ve=v;v=ie;try{return ye.apply(this,arguments)}finally{v=ve}}}}(im)),im}var I_;function hI(){return I_||(I_=1,nm.exports=fI()),nm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function dI(){if(R_)return Mn;R_=1;var t=Pg(),e=hI();function r(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,l){o(s,l),o(s+"Capture",l)}function o(s,l){for(i[s]=l,s=0;s<l.length;s++)n.add(l[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function v(s){return u.call(g,s)?!0:u.call(d,s)?!1:h.test(s)?g[s]=!0:(d[s]=!0,!1)}function y(s,l,f,m){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:f!==null?!f.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function E(s,l,f,m){if(l===null||typeof l>"u"||y(s,l,f,m))return!0;if(m)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function _(s,l,f,m,x,S,b){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=f,this.propertyName=s,this.type=l,this.sanitizeURL=S,this.removeEmptyString=b}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){w[s]=new _(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];w[l]=new _(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){w[s]=new _(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){w[s]=new _(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){w[s]=new _(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){w[s]=new _(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){w[s]=new _(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){w[s]=new _(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){w[s]=new _(s,5,!1,s.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function F(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(k,F);w[l]=new _(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(k,F);w[l]=new _(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(k,F);w[l]=new _(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){w[s]=new _(s,1,!1,s.toLowerCase(),null,!1,!1)}),w.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){w[s]=new _(s,1,!1,s.toLowerCase(),null,!0,!0)});function C(s,l,f,m){var x=w.hasOwnProperty(l)?w[l]:null;(x!==null?x.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(E(l,f,x,m)&&(f=null),m||x===null?v(l)&&(f===null?s.removeAttribute(l):s.setAttribute(l,""+f)):x.mustUseProperty?s[x.propertyName]=f===null?x.type===3?!1:"":f:(l=x.attributeName,m=x.attributeNamespace,f===null?s.removeAttribute(l):(x=x.type,f=x===3||x===4&&f===!0?"":""+f,m?s.setAttributeNS(m,l,f):s.setAttribute(l,f))))}var B=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),z=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),M=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),Ee=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Te=Symbol.for("react.offscreen"),ye=Symbol.iterator;function ie(s){return s===null||typeof s!="object"?null:(s=ye&&s[ye]||s["@@iterator"],typeof s=="function"?s:null)}var ve=Object.assign,te;function O(s){if(te===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);te=l&&l[1]||""}return`
`+te+s}var re=!1;function ee(s,l){if(!s||re)return"";re=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(pe){var m=pe}Reflect.construct(s,[],l)}else{try{l.call()}catch(pe){m=pe}s.call(l.prototype)}else{try{throw Error()}catch(pe){m=pe}s()}}catch(pe){if(pe&&m&&typeof pe.stack=="string"){for(var x=pe.stack.split(`
`),S=m.stack.split(`
`),b=x.length-1,J=S.length-1;1<=b&&0<=J&&x[b]!==S[J];)J--;for(;1<=b&&0<=J;b--,J--)if(x[b]!==S[J]){if(b!==1||J!==1)do if(b--,J--,0>J||x[b]!==S[J]){var ne=`
`+x[b].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=b&&0<=J);break}}}finally{re=!1,Error.prepareStackTrace=f}return(s=s?s.displayName||s.name:"")?O(s):""}function Z(s){switch(s.tag){case 5:return O(s.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return s=ee(s.type,!1),s;case 11:return s=ee(s.type.render,!1),s;case 1:return s=ee(s.type,!0),s;default:return""}}function ce(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case z:return"Portal";case P:return"Profiler";case R:return"StrictMode";case U:return"Suspense";case be:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case M:return(s.displayName||"Context")+".Consumer";case L:return(s._context.displayName||"Context")+".Provider";case N:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Ee:return l=s.displayName||null,l!==null?l:ce(s.type)||"Memo";case Ce:l=s._payload,s=s._init;try{return ce(s(l))}catch{}}return null}function _e(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(l);case 8:return l===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Se(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function we(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function xe(s){var l=we(s)?"checked":"value",f=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),m=""+s[l];if(!s.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,S=f.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(b){m=""+b,S.call(this,b)}}),Object.defineProperty(s,l,{enumerable:f.enumerable}),{getValue:function(){return m},setValue:function(b){m=""+b},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Je(s){s._valueTracker||(s._valueTracker=xe(s))}function Y(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),m="";return s&&(m=we(s)?s.checked?"true":"false":s.value),s=m,s!==f?(l.setValue(s),!0):!1}function kt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ct(s,l){var f=l.checked;return ve({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??s._wrapperState.initialChecked})}function dt(s,l){var f=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;f=Se(l.value!=null?l.value:f),s._wrapperState={initialChecked:m,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ut(s,l){l=l.checked,l!=null&&C(s,"checked",l,!1)}function Ve(s,l){ut(s,l);var f=Se(l.value),m=l.type;if(f!=null)m==="number"?(f===0&&s.value===""||s.value!=f)&&(s.value=""+f):s.value!==""+f&&(s.value=""+f);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?wr(s,l.type,f):l.hasOwnProperty("defaultValue")&&wr(s,l.type,Se(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function Vt(s,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,f||l===s.value||(s.value=l),s.defaultValue=l}f=s.name,f!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,f!==""&&(s.name=f)}function wr(s,l,f){(l!=="number"||kt(s.ownerDocument)!==s)&&(f==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+f&&(s.defaultValue=""+f))}var ur=Array.isArray;function Tr(s,l,f,m){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&m&&(s[f].defaultSelected=!0)}else{for(f=""+Se(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,m&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function _i(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return ve({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function gn(s,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(r(92));if(ur(f)){if(1<f.length)throw Error(r(93));f=f[0]}l=f}l==null&&(l=""),f=l}s._wrapperState={initialValue:Se(f)}}function fr(s,l){var f=Se(l.value),m=Se(l.defaultValue);f!=null&&(f=""+f,f!==s.value&&(s.value=f),l.defaultValue==null&&s.defaultValue!==f&&(s.defaultValue=f)),m!=null&&(s.defaultValue=""+m)}function vn(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function Lt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jt(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?Lt(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var $t,Jr=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,m,x){MSApp.execUnsafeLocalFunction(function(){return s(l,f,m,x)})}:s}(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for($t=$t||document.createElement("div"),$t.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=$t.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function rt(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var Ot={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hr=["Webkit","ms","Moz","O"];Object.keys(Ot).forEach(function(s){hr.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),Ot[l]=Ot[s]})});function Ht(s,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||Ot.hasOwnProperty(s)&&Ot[s]?(""+l).trim():l+"px"}function $n(s,l){s=s.style;for(var f in l)if(l.hasOwnProperty(f)){var m=f.indexOf("--")===0,x=Ht(f,l[f],m);f==="float"&&(f="cssFloat"),m?s.setProperty(f,x):s[f]=x}}var rs=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ro(s,l){if(l){if(rs[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function no(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gi=null;function xa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var _a=null,Rn=null,ri=null;function yi(s){if(s=Bc(s)){if(typeof _a!="function")throw Error(r(280));var l=s.stateNode;l&&(l=$f(l),_a(s.stateNode,s.type,l))}}function ni(s){Rn?ri?ri.push(s):ri=[s]:Rn=s}function io(){if(Rn){var s=Rn,l=ri;if(ri=Rn=null,yi(s),l)for(s=0;s<l.length;s++)yi(l[s])}}function ya(s,l){return s(l)}function ao(){}var Ei=!1;function so(s,l,f){if(Ei)return s(l,f);Ei=!0;try{return ya(s,l,f)}finally{Ei=!1,(Rn!==null||ri!==null)&&(ao(),io())}}function Jt(s,l){var f=s.stateNode;if(f===null)return null;var m=$f(f);if(m===null)return null;f=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var ns=!1;if(c)try{var xn={};Object.defineProperty(xn,"passive",{get:function(){ns=!0}}),window.addEventListener("test",xn,xn),window.removeEventListener("test",xn,xn)}catch{ns=!1}function Ea(s,l,f,m,x,S,b,J,ne){var pe=Array.prototype.slice.call(arguments,3);try{l.apply(f,pe)}catch(Re){this.onError(Re)}}var wa=!1,is=null,D=!1,K=null,H={onError:function(s){wa=!0,is=s}};function W(s,l,f,m,x,S,b,J,ne){wa=!1,is=null,Ea.apply(H,arguments)}function q(s,l,f,m,x,S,b,J,ne){if(W.apply(this,arguments),wa){if(wa){var pe=is;wa=!1,is=null}else throw Error(r(198));D||(D=!0,K=pe)}}function X(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,l.flags&4098&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function le(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function ge(s){if(X(s)!==s)throw Error(r(188))}function ue(s){var l=s.alternate;if(!l){if(l=X(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,m=l;;){var x=f.return;if(x===null)break;var S=x.alternate;if(S===null){if(m=x.return,m!==null){f=m;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===f)return ge(x),s;if(S===m)return ge(x),l;S=S.sibling}throw Error(r(188))}if(f.return!==m.return)f=x,m=S;else{for(var b=!1,J=x.child;J;){if(J===f){b=!0,f=x,m=S;break}if(J===m){b=!0,m=x,f=S;break}J=J.sibling}if(!b){for(J=S.child;J;){if(J===f){b=!0,f=S,m=x;break}if(J===m){b=!0,m=S,f=x;break}J=J.sibling}if(!b)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function he(s){return s=ue(s),s!==null?de(s):null}function de(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=de(s);if(l!==null)return l;s=s.sibling}return null}var Pe=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,Be=e.unstable_shouldYield,De=e.unstable_requestPaint,Fe=e.unstable_now,et=e.unstable_getCurrentPriorityLevel,It=e.unstable_ImmediatePriority,At=e.unstable_UserBlockingPriority,Dt=e.unstable_NormalPriority,wi=e.unstable_LowPriority,Ki=e.unstable_IdlePriority,Hn=null,sr=null;function as(s){if(sr&&typeof sr.onCommitFiberRoot=="function")try{sr.onCommitFiberRoot(Hn,s,void 0,(s.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:yf,Tc=Math.log,_f=Math.LN2;function yf(s){return s>>>=0,s===0?32:31-(Tc(s)/_f|0)|0}var tl=64,rl=4194304;function ss(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function oo(s,l){var f=s.pendingLanes;if(f===0)return 0;var m=0,x=s.suspendedLanes,S=s.pingedLanes,b=f&268435455;if(b!==0){var J=b&~x;J!==0?m=ss(J):(S&=b,S!==0&&(m=ss(S)))}else b=f&~x,b!==0?m=ss(b):S!==0&&(m=ss(S));if(m===0)return 0;if(l!==0&&l!==m&&!(l&x)&&(x=m&-m,S=l&-l,x>=S||x===16&&(S&4194240)!==0))return l;if(m&4&&(m|=f&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=m;0<l;)f=31-zt(l),x=1<<f,m|=s[f],l&=~x;return m}function Pd(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ta(s,l){for(var f=s.suspendedLanes,m=s.pingedLanes,x=s.expirationTimes,S=s.pendingLanes;0<S;){var b=31-zt(S),J=1<<b,ne=x[b];ne===-1?(!(J&f)||J&m)&&(x[b]=Pd(J,l)):ne<=l&&(s.expiredLanes|=J),S&=~J}}function zn(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function lo(){var s=tl;return tl<<=1,!(tl&4194240)&&(tl=64),s}function os(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function ls(s,l,f){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-zt(l),s[l]=f}function Mt(s,l){var f=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<f;){var x=31-zt(f),S=1<<x;l[x]=0,m[x]=-1,s[x]=-1,f&=~S}}function cs(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var m=31-zt(f),x=1<<m;x&l|s[m]&l&&(s[m]|=l),f&=~x}}var gt=0;function us(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Ef,nl,wf,Tf,Sf,Sc=!1,qi=[],Ur=null,Ti=null,Si=null,fs=new Map,ii=new Map,Xi=[],Fd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kf(s,l){switch(s){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Si=null;break;case"pointerover":case"pointerout":fs.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ii.delete(l.pointerId)}}function Pn(s,l,f,m,x,S){return s===null||s.nativeEvent!==S?(s={blockedOn:l,domEventName:f,eventSystemFlags:m,nativeEvent:S,targetContainers:[x]},l!==null&&(l=Bc(l),l!==null&&nl(l)),s):(s.eventSystemFlags|=m,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function bd(s,l,f,m,x){switch(l){case"focusin":return Ur=Pn(Ur,s,l,f,m,x),!0;case"dragenter":return Ti=Pn(Ti,s,l,f,m,x),!0;case"mouseover":return Si=Pn(Si,s,l,f,m,x),!0;case"pointerover":var S=x.pointerId;return fs.set(S,Pn(fs.get(S)||null,s,l,f,m,x)),!0;case"gotpointercapture":return S=x.pointerId,ii.set(S,Pn(ii.get(S)||null,s,l,f,m,x)),!0}return!1}function Af(s){var l=po(s.target);if(l!==null){var f=X(l);if(f!==null){if(l=f.tag,l===13){if(l=le(f),l!==null){s.blockedOn=l,Sf(s.priority,function(){wf(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Sa(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=il(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(f===null){f=s.nativeEvent;var m=new f.constructor(f.type,f);Gi=m,f.target.dispatchEvent(m),Gi=null}else return l=Bc(f),l!==null&&nl(l),s.blockedOn=f,!1;l.shift()}return!0}function co(s,l,f){Sa(s)&&f.delete(l)}function Cf(){Sc=!1,Ur!==null&&Sa(Ur)&&(Ur=null),Ti!==null&&Sa(Ti)&&(Ti=null),Si!==null&&Sa(Si)&&(Si=null),fs.forEach(co),ii.forEach(co)}function ki(s,l){s.blockedOn===l&&(s.blockedOn=null,Sc||(Sc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Cf)))}function Ai(s){function l(x){return ki(x,s)}if(0<qi.length){ki(qi[0],s);for(var f=1;f<qi.length;f++){var m=qi[f];m.blockedOn===s&&(m.blockedOn=null)}}for(Ur!==null&&ki(Ur,s),Ti!==null&&ki(Ti,s),Si!==null&&ki(Si,s),fs.forEach(l),ii.forEach(l),f=0;f<Xi.length;f++)m=Xi[f],m.blockedOn===s&&(m.blockedOn=null);for(;0<Xi.length&&(f=Xi[0],f.blockedOn===null);)Af(f),f.blockedOn===null&&Xi.shift()}var ka=B.ReactCurrentBatchConfig,hs=!0;function qt(s,l,f,m){var x=gt,S=ka.transition;ka.transition=null;try{gt=1,kc(s,l,f,m)}finally{gt=x,ka.transition=S}}function Od(s,l,f,m){var x=gt,S=ka.transition;ka.transition=null;try{gt=4,kc(s,l,f,m)}finally{gt=x,ka.transition=S}}function kc(s,l,f,m){if(hs){var x=il(s,l,f,m);if(x===null)zd(s,l,m,uo,f),kf(s,m);else if(bd(x,s,l,f,m))m.stopPropagation();else if(kf(s,m),l&4&&-1<Fd.indexOf(s)){for(;x!==null;){var S=Bc(x);if(S!==null&&Ef(S),S=il(s,l,f,m),S===null&&zd(s,l,m,uo,f),S===x)break;x=S}x!==null&&m.stopPropagation()}else zd(s,l,m,null,f)}}var uo=null;function il(s,l,f,m){if(uo=null,s=xa(m),s=po(s),s!==null)if(l=X(s),l===null)s=null;else if(f=l.tag,f===13){if(s=le(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return uo=s,null}function Ac(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(et()){case It:return 1;case At:return 4;case Dt:case wi:return 16;case Ki:return 536870912;default:return 16}default:return 16}}var Wn=null,al=null,Fn=null;function Cc(){if(Fn)return Fn;var s,l=al,f=l.length,m,x="value"in Wn?Wn.value:Wn.textContent,S=x.length;for(s=0;s<f&&l[s]===x[s];s++);var b=f-s;for(m=1;m<=b&&l[f-m]===x[S-m];m++);return Fn=x.slice(s,1<m?1-m:void 0)}function sl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Yi(){return!0}function Ic(){return!1}function jr(s){function l(f,m,x,S,b){this._reactName=f,this._targetInst=x,this.type=m,this.nativeEvent=S,this.target=b,this.currentTarget=null;for(var J in s)s.hasOwnProperty(J)&&(f=s[J],this[J]=f?f(S):S[J]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Yi:Ic,this.isPropagationStopped=Ic,this}return ve(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Yi)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Yi)},persist:function(){},isPersistent:Yi}),l}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=jr(Ci),Qi=ve({},Ci,{view:0,detail:0}),Dd=jr(Qi),ll,Aa,ds,fo=ve({},Qi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ji,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ds&&(ds&&s.type==="mousemove"?(ll=s.screenX-ds.screenX,Aa=s.screenY-ds.screenY):Aa=ll=0,ds=s),ll)},movementY:function(s){return"movementY"in s?s.movementY:Aa}}),cl=jr(fo),Rc=ve({},fo,{dataTransfer:0}),If=jr(Rc),ul=ve({},Qi,{relatedTarget:0}),fl=jr(ul),Rf=ve({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),Ca=jr(Rf),Pf=ve({},Ci,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ff=jr(Pf),bf=ve({},Ci,{data:0}),Pc=jr(bf),hl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Of={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Df(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Of[s])?!!l[s]:!1}function Ji(){return Df}var p=ve({},Qi,{key:function(s){if(s.key){var l=hl[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=sl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?_n[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ji,charCode:function(s){return s.type==="keypress"?sl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?sl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),T=jr(p),I=ve({},fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j=jr(I),se=ve({},Qi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ji}),me=jr(se),Me=ve({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nt=jr(Me),Sr=ve({},fo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),_t=jr(Sr),Or=[9,13,27,32],dr=c&&"CompositionEvent"in window,ai=null;c&&"documentMode"in document&&(ai=document.documentMode);var Gn=c&&"TextEvent"in window&&!ai,ho=c&&(!dr||ai&&8<ai&&11>=ai),dl=" ",gv=!1;function vv(s,l){switch(s){case"keyup":return Or.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xv(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var pl=!1;function iC(s,l){switch(s){case"compositionend":return xv(l);case"keypress":return l.which!==32?null:(gv=!0,dl);case"textInput":return s=l.data,s===dl&&gv?null:s;default:return null}}function aC(s,l){if(pl)return s==="compositionend"||!dr&&vv(s,l)?(s=Cc(),Fn=al=Wn=null,pl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return ho&&l.locale!=="ko"?null:l.data;default:return null}}var sC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _v(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!sC[s.type]:l==="textarea"}function yv(s,l,f,m){ni(m),l=Bf(l,"onChange"),0<l.length&&(f=new ol("onChange","change",null,f,m),s.push({event:f,listeners:l}))}var Fc=null,bc=null;function oC(s){Vv(s,0)}function Nf(s){var l=_l(s);if(Y(l))return s}function lC(s,l){if(s==="change")return l}var Ev=!1;if(c){var Nd;if(c){var Ld="oninput"in document;if(!Ld){var wv=document.createElement("div");wv.setAttribute("oninput","return;"),Ld=typeof wv.oninput=="function"}Nd=Ld}else Nd=!1;Ev=Nd&&(!document.documentMode||9<document.documentMode)}function Tv(){Fc&&(Fc.detachEvent("onpropertychange",Sv),bc=Fc=null)}function Sv(s){if(s.propertyName==="value"&&Nf(bc)){var l=[];yv(l,bc,s,xa(s)),so(oC,l)}}function cC(s,l,f){s==="focusin"?(Tv(),Fc=l,bc=f,Fc.attachEvent("onpropertychange",Sv)):s==="focusout"&&Tv()}function uC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Nf(bc)}function fC(s,l){if(s==="click")return Nf(l)}function hC(s,l){if(s==="input"||s==="change")return Nf(l)}function dC(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Ii=typeof Object.is=="function"?Object.is:dC;function Oc(s,l){if(Ii(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),m=Object.keys(l);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var x=f[m];if(!u.call(l,x)||!Ii(s[x],l[x]))return!1}return!0}function kv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Av(s,l){var f=kv(s);s=0;for(var m;f;){if(f.nodeType===3){if(m=s+f.textContent.length,s<=l&&m>=l)return{node:f,offset:l-s};s=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=kv(f)}}function Cv(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Cv(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Iv(){for(var s=window,l=kt();l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=kt(s.document)}return l}function Md(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function pC(s){var l=Iv(),f=s.focusedElem,m=s.selectionRange;if(l!==f&&f&&f.ownerDocument&&Cv(f.ownerDocument.documentElement,f)){if(m!==null&&Md(f)){if(l=m.start,s=m.end,s===void 0&&(s=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(s,f.value.length);else if(s=(l=f.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var x=f.textContent.length,S=Math.min(m.start,x);m=m.end===void 0?S:Math.min(m.end,x),!s.extend&&S>m&&(x=m,m=S,S=x),x=Av(f,S);var b=Av(f,m);x&&b&&(s.rangeCount!==1||s.anchorNode!==x.node||s.anchorOffset!==x.offset||s.focusNode!==b.node||s.focusOffset!==b.offset)&&(l=l.createRange(),l.setStart(x.node,x.offset),s.removeAllRanges(),S>m?(s.addRange(l),s.extend(b.node,b.offset)):(l.setEnd(b.node,b.offset),s.addRange(l)))}}for(l=[],s=f;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)s=l[f],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var mC=c&&"documentMode"in document&&11>=document.documentMode,ml=null,Vd=null,Dc=null,Bd=!1;function Rv(s,l,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Bd||ml==null||ml!==kt(m)||(m=ml,"selectionStart"in m&&Md(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Dc&&Oc(Dc,m)||(Dc=m,m=Bf(Vd,"onSelect"),0<m.length&&(l=new ol("onSelect","select",null,l,f),s.push({event:l,listeners:m}),l.target=ml)))}function Lf(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var gl={animationend:Lf("Animation","AnimationEnd"),animationiteration:Lf("Animation","AnimationIteration"),animationstart:Lf("Animation","AnimationStart"),transitionend:Lf("Transition","TransitionEnd")},Ud={},Pv={};c&&(Pv=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Mf(s){if(Ud[s])return Ud[s];if(!gl[s])return s;var l=gl[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in Pv)return Ud[s]=l[f];return s}var Fv=Mf("animationend"),bv=Mf("animationiteration"),Ov=Mf("animationstart"),Dv=Mf("transitionend"),Nv=new Map,Lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ps(s,l){Nv.set(s,l),a(l,[s])}for(var jd=0;jd<Lv.length;jd++){var $d=Lv[jd],gC=$d.toLowerCase(),vC=$d[0].toUpperCase()+$d.slice(1);ps(gC,"on"+vC)}ps(Fv,"onAnimationEnd"),ps(bv,"onAnimationIteration"),ps(Ov,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(Dv,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nc));function Mv(s,l,f){var m=s.type||"unknown-event";s.currentTarget=f,q(m,l,void 0,s),s.currentTarget=null}function Vv(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var m=s[f],x=m.event;m=m.listeners;e:{var S=void 0;if(l)for(var b=m.length-1;0<=b;b--){var J=m[b],ne=J.instance,pe=J.currentTarget;if(J=J.listener,ne!==S&&x.isPropagationStopped())break e;Mv(x,J,pe),S=ne}else for(b=0;b<m.length;b++){if(J=m[b],ne=J.instance,pe=J.currentTarget,J=J.listener,ne!==S&&x.isPropagationStopped())break e;Mv(x,J,pe),S=ne}}}if(D)throw s=K,D=!1,K=null,s}function Wt(s,l){var f=l[Yd];f===void 0&&(f=l[Yd]=new Set);var m=s+"__bubble";f.has(m)||(Bv(l,s,2,!1),f.add(m))}function Hd(s,l,f){var m=0;l&&(m|=4),Bv(f,s,m,l)}var Vf="_reactListening"+Math.random().toString(36).slice(2);function Lc(s){if(!s[Vf]){s[Vf]=!0,n.forEach(function(f){f!=="selectionchange"&&(xC.has(f)||Hd(f,!1,s),Hd(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Vf]||(l[Vf]=!0,Hd("selectionchange",!1,l))}}function Bv(s,l,f,m){switch(Ac(l)){case 1:var x=qt;break;case 4:x=Od;break;default:x=kc}f=x.bind(null,l,f,s),x=void 0,!ns||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),m?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function zd(s,l,f,m,x){var S=m;if(!(l&1)&&!(l&2)&&m!==null)e:for(;;){if(m===null)return;var b=m.tag;if(b===3||b===4){var J=m.stateNode.containerInfo;if(J===x||J.nodeType===8&&J.parentNode===x)break;if(b===4)for(b=m.return;b!==null;){var ne=b.tag;if((ne===3||ne===4)&&(ne=b.stateNode.containerInfo,ne===x||ne.nodeType===8&&ne.parentNode===x))return;b=b.return}for(;J!==null;){if(b=po(J),b===null)return;if(ne=b.tag,ne===5||ne===6){m=S=b;continue e}J=J.parentNode}}m=m.return}so(function(){var pe=S,Re=xa(f),Oe=[];e:{var Ie=Nv.get(s);if(Ie!==void 0){var Ue=ol,ze=s;switch(s){case"keypress":if(sl(f)===0)break e;case"keydown":case"keyup":Ue=T;break;case"focusin":ze="focus",Ue=fl;break;case"focusout":ze="blur",Ue=fl;break;case"beforeblur":case"afterblur":Ue=fl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=If;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=me;break;case Fv:case bv:case Ov:Ue=Ca;break;case Dv:Ue=Nt;break;case"scroll":Ue=Dd;break;case"wheel":Ue=_t;break;case"copy":case"cut":case"paste":Ue=Ff;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=j}var We=(l&4)!==0,or=!We&&s==="scroll",oe=We?Ie!==null?Ie+"Capture":null:Ie;We=[];for(var ae=pe,fe;ae!==null;){fe=ae;var Ne=fe.stateNode;if(fe.tag===5&&Ne!==null&&(fe=Ne,oe!==null&&(Ne=Jt(ae,oe),Ne!=null&&We.push(Mc(ae,Ne,fe)))),or)break;ae=ae.return}0<We.length&&(Ie=new Ue(Ie,ze,null,f,Re),Oe.push({event:Ie,listeners:We}))}}if(!(l&7)){e:{if(Ie=s==="mouseover"||s==="pointerover",Ue=s==="mouseout"||s==="pointerout",Ie&&f!==Gi&&(ze=f.relatedTarget||f.fromElement)&&(po(ze)||ze[Ia]))break e;if((Ue||Ie)&&(Ie=Re.window===Re?Re:(Ie=Re.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Ue?(ze=f.relatedTarget||f.toElement,Ue=pe,ze=ze?po(ze):null,ze!==null&&(or=X(ze),ze!==or||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Ue=null,ze=pe),Ue!==ze)){if(We=cl,Ne="onMouseLeave",oe="onMouseEnter",ae="mouse",(s==="pointerout"||s==="pointerover")&&(We=j,Ne="onPointerLeave",oe="onPointerEnter",ae="pointer"),or=Ue==null?Ie:_l(Ue),fe=ze==null?Ie:_l(ze),Ie=new We(Ne,ae+"leave",Ue,f,Re),Ie.target=or,Ie.relatedTarget=fe,Ne=null,po(Re)===pe&&(We=new We(oe,ae+"enter",ze,f,Re),We.target=fe,We.relatedTarget=or,Ne=We),or=Ne,Ue&&ze)t:{for(We=Ue,oe=ze,ae=0,fe=We;fe;fe=vl(fe))ae++;for(fe=0,Ne=oe;Ne;Ne=vl(Ne))fe++;for(;0<ae-fe;)We=vl(We),ae--;for(;0<fe-ae;)oe=vl(oe),fe--;for(;ae--;){if(We===oe||oe!==null&&We===oe.alternate)break t;We=vl(We),oe=vl(oe)}We=null}else We=null;Ue!==null&&Uv(Oe,Ie,Ue,We,!1),ze!==null&&or!==null&&Uv(Oe,or,ze,We,!0)}}e:{if(Ie=pe?_l(pe):window,Ue=Ie.nodeName&&Ie.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Ie.type==="file")var Ge=lC;else if(_v(Ie))if(Ev)Ge=hC;else{Ge=uC;var Xe=cC}else(Ue=Ie.nodeName)&&Ue.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(Ge=fC);if(Ge&&(Ge=Ge(s,pe))){yv(Oe,Ge,f,Re);break e}Xe&&Xe(s,Ie,pe),s==="focusout"&&(Xe=Ie._wrapperState)&&Xe.controlled&&Ie.type==="number"&&wr(Ie,"number",Ie.value)}switch(Xe=pe?_l(pe):window,s){case"focusin":(_v(Xe)||Xe.contentEditable==="true")&&(ml=Xe,Vd=pe,Dc=null);break;case"focusout":Dc=Vd=ml=null;break;case"mousedown":Bd=!0;break;case"contextmenu":case"mouseup":case"dragend":Bd=!1,Rv(Oe,f,Re);break;case"selectionchange":if(mC)break;case"keydown":case"keyup":Rv(Oe,f,Re)}var Ye;if(dr)e:{switch(s){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else pl?vv(s,f)&&(nt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(nt="onCompositionStart");nt&&(ho&&f.locale!=="ko"&&(pl||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&pl&&(Ye=Cc()):(Wn=Re,al="value"in Wn?Wn.value:Wn.textContent,pl=!0)),Xe=Bf(pe,nt),0<Xe.length&&(nt=new Pc(nt,s,null,f,Re),Oe.push({event:nt,listeners:Xe}),Ye?nt.data=Ye:(Ye=xv(f),Ye!==null&&(nt.data=Ye)))),(Ye=Gn?iC(s,f):aC(s,f))&&(pe=Bf(pe,"onBeforeInput"),0<pe.length&&(Re=new Pc("onBeforeInput","beforeinput",null,f,Re),Oe.push({event:Re,listeners:pe}),Re.data=Ye))}Vv(Oe,l)})}function Mc(s,l,f){return{instance:s,listener:l,currentTarget:f}}function Bf(s,l){for(var f=l+"Capture",m=[];s!==null;){var x=s,S=x.stateNode;x.tag===5&&S!==null&&(x=S,S=Jt(s,f),S!=null&&m.unshift(Mc(s,S,x)),S=Jt(s,l),S!=null&&m.push(Mc(s,S,x))),s=s.return}return m}function vl(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Uv(s,l,f,m,x){for(var S=l._reactName,b=[];f!==null&&f!==m;){var J=f,ne=J.alternate,pe=J.stateNode;if(ne!==null&&ne===m)break;J.tag===5&&pe!==null&&(J=pe,x?(ne=Jt(f,S),ne!=null&&b.unshift(Mc(f,ne,J))):x||(ne=Jt(f,S),ne!=null&&b.push(Mc(f,ne,J)))),f=f.return}b.length!==0&&s.push({event:l,listeners:b})}var _C=/\r\n?/g,yC=/\u0000|\uFFFD/g;function jv(s){return(typeof s=="string"?s:""+s).replace(_C,`
`).replace(yC,"")}function Uf(s,l,f){if(l=jv(l),jv(s)!==l&&f)throw Error(r(425))}function jf(){}var Wd=null,Gd=null;function Kd(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var qd=typeof setTimeout=="function"?setTimeout:void 0,EC=typeof clearTimeout=="function"?clearTimeout:void 0,$v=typeof Promise=="function"?Promise:void 0,wC=typeof queueMicrotask=="function"?queueMicrotask:typeof $v<"u"?function(s){return $v.resolve(null).then(s).catch(TC)}:qd;function TC(s){setTimeout(function(){throw s})}function Xd(s,l){var f=l,m=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"){if(m===0){s.removeChild(x),Ai(l);return}m--}else f!=="$"&&f!=="$?"&&f!=="$!"||m++;f=x}while(f);Ai(l)}function ms(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function Hv(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return s;l--}else f==="/$"&&l++}s=s.previousSibling}return null}var xl=Math.random().toString(36).slice(2),Zi="__reactFiber$"+xl,Vc="__reactProps$"+xl,Ia="__reactContainer$"+xl,Yd="__reactEvents$"+xl,SC="__reactListeners$"+xl,kC="__reactHandles$"+xl;function po(s){var l=s[Zi];if(l)return l;for(var f=s.parentNode;f;){if(l=f[Ia]||f[Zi]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=Hv(s);s!==null;){if(f=s[Zi])return f;s=Hv(s)}return l}s=f,f=s.parentNode}return null}function Bc(s){return s=s[Zi]||s[Ia],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function _l(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(r(33))}function $f(s){return s[Vc]||null}var Qd=[],yl=-1;function gs(s){return{current:s}}function Gt(s){0>yl||(s.current=Qd[yl],Qd[yl]=null,yl--)}function Bt(s,l){yl++,Qd[yl]=s.current,s.current=l}var vs={},Zr=gs(vs),bn=gs(!1),mo=vs;function El(s,l){var f=s.type.contextTypes;if(!f)return vs;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var x={},S;for(S in f)x[S]=l[S];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=x),x}function On(s){return s=s.childContextTypes,s!=null}function Hf(){Gt(bn),Gt(Zr)}function zv(s,l,f){if(Zr.current!==vs)throw Error(r(168));Bt(Zr,l),Bt(bn,f)}function Wv(s,l,f){var m=s.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return f;m=m.getChildContext();for(var x in m)if(!(x in l))throw Error(r(108,_e(s)||"Unknown",x));return ve({},f,m)}function zf(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||vs,mo=Zr.current,Bt(Zr,s),Bt(bn,bn.current),!0}function Gv(s,l,f){var m=s.stateNode;if(!m)throw Error(r(169));f?(s=Wv(s,l,mo),m.__reactInternalMemoizedMergedChildContext=s,Gt(bn),Gt(Zr),Bt(Zr,s)):Gt(bn),Bt(bn,f)}var Ra=null,Wf=!1,Jd=!1;function Kv(s){Ra===null?Ra=[s]:Ra.push(s)}function AC(s){Wf=!0,Kv(s)}function xs(){if(!Jd&&Ra!==null){Jd=!0;var s=0,l=gt;try{var f=Ra;for(gt=1;s<f.length;s++){var m=f[s];do m=m(!0);while(m!==null)}Ra=null,Wf=!1}catch(x){throw Ra!==null&&(Ra=Ra.slice(s+1)),Pe(It,xs),x}finally{gt=l,Jd=!1}}return null}var wl=[],Tl=0,Gf=null,Kf=0,si=[],oi=0,go=null,Pa=1,Fa="";function vo(s,l){wl[Tl++]=Kf,wl[Tl++]=Gf,Gf=s,Kf=l}function qv(s,l,f){si[oi++]=Pa,si[oi++]=Fa,si[oi++]=go,go=s;var m=Pa;s=Fa;var x=32-zt(m)-1;m&=~(1<<x),f+=1;var S=32-zt(l)+x;if(30<S){var b=x-x%5;S=(m&(1<<b)-1).toString(32),m>>=b,x-=b,Pa=1<<32-zt(l)+x|f<<x|m,Fa=S+s}else Pa=1<<S|f<<x|m,Fa=s}function Zd(s){s.return!==null&&(vo(s,1),qv(s,1,0))}function ep(s){for(;s===Gf;)Gf=wl[--Tl],wl[Tl]=null,Kf=wl[--Tl],wl[Tl]=null;for(;s===go;)go=si[--oi],si[oi]=null,Fa=si[--oi],si[oi]=null,Pa=si[--oi],si[oi]=null}var Kn=null,qn=null,Xt=!1,Ri=null;function Xv(s,l){var f=fi(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=s,l=s.deletions,l===null?(s.deletions=[f],s.flags|=16):l.push(f)}function Yv(s,l){switch(s.tag){case 5:var f=s.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,Kn=s,qn=ms(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,Kn=s,qn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=go!==null?{id:Pa,overflow:Fa}:null,s.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=fi(18,null,null,0),f.stateNode=l,f.return=s,s.child=f,Kn=s,qn=null,!0):!1;default:return!1}}function tp(s){return(s.mode&1)!==0&&(s.flags&128)===0}function rp(s){if(Xt){var l=qn;if(l){var f=l;if(!Yv(s,l)){if(tp(s))throw Error(r(418));l=ms(f.nextSibling);var m=Kn;l&&Yv(s,l)?Xv(m,f):(s.flags=s.flags&-4097|2,Xt=!1,Kn=s)}}else{if(tp(s))throw Error(r(418));s.flags=s.flags&-4097|2,Xt=!1,Kn=s}}}function Qv(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Kn=s}function qf(s){if(s!==Kn)return!1;if(!Xt)return Qv(s),Xt=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!Kd(s.type,s.memoizedProps)),l&&(l=qn)){if(tp(s))throw Jv(),Error(r(418));for(;l;)Xv(s,l),l=ms(l.nextSibling)}if(Qv(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"){if(l===0){qn=ms(s.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}s=s.nextSibling}qn=null}}else qn=Kn?ms(s.stateNode.nextSibling):null;return!0}function Jv(){for(var s=qn;s;)s=ms(s.nextSibling)}function Sl(){qn=Kn=null,Xt=!1}function np(s){Ri===null?Ri=[s]:Ri.push(s)}var CC=B.ReactCurrentBatchConfig;function Uc(s,l,f){if(s=f.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var m=f.stateNode}if(!m)throw Error(r(147,s));var x=m,S=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===S?l.ref:(l=function(b){var J=x.refs;b===null?delete J[S]:J[S]=b},l._stringRef=S,l)}if(typeof s!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,s))}return s}function Xf(s,l){throw s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function Zv(s){var l=s._init;return l(s._payload)}function ex(s){function l(oe,ae){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[ae],oe.flags|=16):fe.push(ae)}}function f(oe,ae){if(!s)return null;for(;ae!==null;)l(oe,ae),ae=ae.sibling;return null}function m(oe,ae){for(oe=new Map;ae!==null;)ae.key!==null?oe.set(ae.key,ae):oe.set(ae.index,ae),ae=ae.sibling;return oe}function x(oe,ae){return oe=As(oe,ae),oe.index=0,oe.sibling=null,oe}function S(oe,ae,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<ae?(oe.flags|=2,ae):fe):(oe.flags|=2,ae)):(oe.flags|=1048576,ae)}function b(oe){return s&&oe.alternate===null&&(oe.flags|=2),oe}function J(oe,ae,fe,Ne){return ae===null||ae.tag!==6?(ae=qp(fe,oe.mode,Ne),ae.return=oe,ae):(ae=x(ae,fe),ae.return=oe,ae)}function ne(oe,ae,fe,Ne){var Ge=fe.type;return Ge===A?Re(oe,ae,fe.props.children,Ne,fe.key):ae!==null&&(ae.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ce&&Zv(Ge)===ae.type)?(Ne=x(ae,fe.props),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,Ne):(Ne=_h(fe.type,fe.key,fe.props,null,oe.mode,Ne),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,Ne)}function pe(oe,ae,fe,Ne){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==fe.containerInfo||ae.stateNode.implementation!==fe.implementation?(ae=Xp(fe,oe.mode,Ne),ae.return=oe,ae):(ae=x(ae,fe.children||[]),ae.return=oe,ae)}function Re(oe,ae,fe,Ne,Ge){return ae===null||ae.tag!==7?(ae=ko(fe,oe.mode,Ne,Ge),ae.return=oe,ae):(ae=x(ae,fe),ae.return=oe,ae)}function Oe(oe,ae,fe){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return ae=qp(""+ae,oe.mode,fe),ae.return=oe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:return fe=_h(ae.type,ae.key,ae.props,null,oe.mode,fe),fe.ref=Uc(oe,null,ae),fe.return=oe,fe;case z:return ae=Xp(ae,oe.mode,fe),ae.return=oe,ae;case Ce:var Ne=ae._init;return Oe(oe,Ne(ae._payload),fe)}if(ur(ae)||ie(ae))return ae=ko(ae,oe.mode,fe,null),ae.return=oe,ae;Xf(oe,ae)}return null}function Ie(oe,ae,fe,Ne){var Ge=ae!==null?ae.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number")return Ge!==null?null:J(oe,ae,""+fe,Ne);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case V:return fe.key===Ge?ne(oe,ae,fe,Ne):null;case z:return fe.key===Ge?pe(oe,ae,fe,Ne):null;case Ce:return Ge=fe._init,Ie(oe,ae,Ge(fe._payload),Ne)}if(ur(fe)||ie(fe))return Ge!==null?null:Re(oe,ae,fe,Ne,null);Xf(oe,fe)}return null}function Ue(oe,ae,fe,Ne,Ge){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return oe=oe.get(fe)||null,J(ae,oe,""+Ne,Ge);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case V:return oe=oe.get(Ne.key===null?fe:Ne.key)||null,ne(ae,oe,Ne,Ge);case z:return oe=oe.get(Ne.key===null?fe:Ne.key)||null,pe(ae,oe,Ne,Ge);case Ce:var Xe=Ne._init;return Ue(oe,ae,fe,Xe(Ne._payload),Ge)}if(ur(Ne)||ie(Ne))return oe=oe.get(fe)||null,Re(ae,oe,Ne,Ge,null);Xf(ae,Ne)}return null}function ze(oe,ae,fe,Ne){for(var Ge=null,Xe=null,Ye=ae,nt=ae=0,Lr=null;Ye!==null&&nt<fe.length;nt++){Ye.index>nt?(Lr=Ye,Ye=null):Lr=Ye.sibling;var Ct=Ie(oe,Ye,fe[nt],Ne);if(Ct===null){Ye===null&&(Ye=Lr);break}s&&Ye&&Ct.alternate===null&&l(oe,Ye),ae=S(Ct,ae,nt),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct,Ye=Lr}if(nt===fe.length)return f(oe,Ye),Xt&&vo(oe,nt),Ge;if(Ye===null){for(;nt<fe.length;nt++)Ye=Oe(oe,fe[nt],Ne),Ye!==null&&(ae=S(Ye,ae,nt),Xe===null?Ge=Ye:Xe.sibling=Ye,Xe=Ye);return Xt&&vo(oe,nt),Ge}for(Ye=m(oe,Ye);nt<fe.length;nt++)Lr=Ue(Ye,oe,nt,fe[nt],Ne),Lr!==null&&(s&&Lr.alternate!==null&&Ye.delete(Lr.key===null?nt:Lr.key),ae=S(Lr,ae,nt),Xe===null?Ge=Lr:Xe.sibling=Lr,Xe=Lr);return s&&Ye.forEach(function(Cs){return l(oe,Cs)}),Xt&&vo(oe,nt),Ge}function We(oe,ae,fe,Ne){var Ge=ie(fe);if(typeof Ge!="function")throw Error(r(150));if(fe=Ge.call(fe),fe==null)throw Error(r(151));for(var Xe=Ge=null,Ye=ae,nt=ae=0,Lr=null,Ct=fe.next();Ye!==null&&!Ct.done;nt++,Ct=fe.next()){Ye.index>nt?(Lr=Ye,Ye=null):Lr=Ye.sibling;var Cs=Ie(oe,Ye,Ct.value,Ne);if(Cs===null){Ye===null&&(Ye=Lr);break}s&&Ye&&Cs.alternate===null&&l(oe,Ye),ae=S(Cs,ae,nt),Xe===null?Ge=Cs:Xe.sibling=Cs,Xe=Cs,Ye=Lr}if(Ct.done)return f(oe,Ye),Xt&&vo(oe,nt),Ge;if(Ye===null){for(;!Ct.done;nt++,Ct=fe.next())Ct=Oe(oe,Ct.value,Ne),Ct!==null&&(ae=S(Ct,ae,nt),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct);return Xt&&vo(oe,nt),Ge}for(Ye=m(oe,Ye);!Ct.done;nt++,Ct=fe.next())Ct=Ue(Ye,oe,nt,Ct.value,Ne),Ct!==null&&(s&&Ct.alternate!==null&&Ye.delete(Ct.key===null?nt:Ct.key),ae=S(Ct,ae,nt),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct);return s&&Ye.forEach(function(aI){return l(oe,aI)}),Xt&&vo(oe,nt),Ge}function or(oe,ae,fe,Ne){if(typeof fe=="object"&&fe!==null&&fe.type===A&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case V:e:{for(var Ge=fe.key,Xe=ae;Xe!==null;){if(Xe.key===Ge){if(Ge=fe.type,Ge===A){if(Xe.tag===7){f(oe,Xe.sibling),ae=x(Xe,fe.props.children),ae.return=oe,oe=ae;break e}}else if(Xe.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ce&&Zv(Ge)===Xe.type){f(oe,Xe.sibling),ae=x(Xe,fe.props),ae.ref=Uc(oe,Xe,fe),ae.return=oe,oe=ae;break e}f(oe,Xe);break}else l(oe,Xe);Xe=Xe.sibling}fe.type===A?(ae=ko(fe.props.children,oe.mode,Ne,fe.key),ae.return=oe,oe=ae):(Ne=_h(fe.type,fe.key,fe.props,null,oe.mode,Ne),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,oe=Ne)}return b(oe);case z:e:{for(Xe=fe.key;ae!==null;){if(ae.key===Xe)if(ae.tag===4&&ae.stateNode.containerInfo===fe.containerInfo&&ae.stateNode.implementation===fe.implementation){f(oe,ae.sibling),ae=x(ae,fe.children||[]),ae.return=oe,oe=ae;break e}else{f(oe,ae);break}else l(oe,ae);ae=ae.sibling}ae=Xp(fe,oe.mode,Ne),ae.return=oe,oe=ae}return b(oe);case Ce:return Xe=fe._init,or(oe,ae,Xe(fe._payload),Ne)}if(ur(fe))return ze(oe,ae,fe,Ne);if(ie(fe))return We(oe,ae,fe,Ne);Xf(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"?(fe=""+fe,ae!==null&&ae.tag===6?(f(oe,ae.sibling),ae=x(ae,fe),ae.return=oe,oe=ae):(f(oe,ae),ae=qp(fe,oe.mode,Ne),ae.return=oe,oe=ae),b(oe)):f(oe,ae)}return or}var kl=ex(!0),tx=ex(!1),Yf=gs(null),Qf=null,Al=null,ip=null;function ap(){ip=Al=Qf=null}function sp(s){var l=Yf.current;Gt(Yf),s._currentValue=l}function op(s,l,f){for(;s!==null;){var m=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),s===f)break;s=s.return}}function Cl(s,l){Qf=s,ip=Al=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&l&&(Dn=!0),s.firstContext=null)}function li(s){var l=s._currentValue;if(ip!==s)if(s={context:s,memoizedValue:l,next:null},Al===null){if(Qf===null)throw Error(r(308));Al=s,Qf.dependencies={lanes:0,firstContext:s}}else Al=Al.next=s;return l}var xo=null;function lp(s){xo===null?xo=[s]:xo.push(s)}function rx(s,l,f,m){var x=l.interleaved;return x===null?(f.next=f,lp(l)):(f.next=x.next,x.next=f),l.interleaved=f,ba(s,m)}function ba(s,l){s.lanes|=l;var f=s.alternate;for(f!==null&&(f.lanes|=l),f=s,s=s.return;s!==null;)s.childLanes|=l,f=s.alternate,f!==null&&(f.childLanes|=l),f=s,s=s.return;return f.tag===3?f.stateNode:null}var _s=!1;function cp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nx(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Oa(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function ys(s,l,f){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,Tt&2){var x=m.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),m.pending=l,ba(s,f)}return x=m.interleaved,x===null?(l.next=l,lp(m)):(l.next=x.next,x.next=l),m.interleaved=l,ba(s,f)}function Jf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,cs(s,f)}}function ix(s,l){var f=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var x=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};S===null?x=S=b:S=S.next=b,f=f.next}while(f!==null);S===null?x=S=l:S=S.next=l}else x=S=l;f={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:m.shared,effects:m.effects},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}function Zf(s,l,f,m){var x=s.updateQueue;_s=!1;var S=x.firstBaseUpdate,b=x.lastBaseUpdate,J=x.shared.pending;if(J!==null){x.shared.pending=null;var ne=J,pe=ne.next;ne.next=null,b===null?S=pe:b.next=pe,b=ne;var Re=s.alternate;Re!==null&&(Re=Re.updateQueue,J=Re.lastBaseUpdate,J!==b&&(J===null?Re.firstBaseUpdate=pe:J.next=pe,Re.lastBaseUpdate=ne))}if(S!==null){var Oe=x.baseState;b=0,Re=pe=ne=null,J=S;do{var Ie=J.lane,Ue=J.eventTime;if((m&Ie)===Ie){Re!==null&&(Re=Re.next={eventTime:Ue,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var ze=s,We=J;switch(Ie=l,Ue=f,We.tag){case 1:if(ze=We.payload,typeof ze=="function"){Oe=ze.call(Ue,Oe,Ie);break e}Oe=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=We.payload,Ie=typeof ze=="function"?ze.call(Ue,Oe,Ie):ze,Ie==null)break e;Oe=ve({},Oe,Ie);break e;case 2:_s=!0}}J.callback!==null&&J.lane!==0&&(s.flags|=64,Ie=x.effects,Ie===null?x.effects=[J]:Ie.push(J))}else Ue={eventTime:Ue,lane:Ie,tag:J.tag,payload:J.payload,callback:J.callback,next:null},Re===null?(pe=Re=Ue,ne=Oe):Re=Re.next=Ue,b|=Ie;if(J=J.next,J===null){if(J=x.shared.pending,J===null)break;Ie=J,J=Ie.next,Ie.next=null,x.lastBaseUpdate=Ie,x.shared.pending=null}}while(!0);if(Re===null&&(ne=Oe),x.baseState=ne,x.firstBaseUpdate=pe,x.lastBaseUpdate=Re,l=x.shared.interleaved,l!==null){x=l;do b|=x.lane,x=x.next;while(x!==l)}else S===null&&(x.shared.lanes=0);Eo|=b,s.lanes=b,s.memoizedState=Oe}}function ax(s,l,f){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var m=s[l],x=m.callback;if(x!==null){if(m.callback=null,m=f,typeof x!="function")throw Error(r(191,x));x.call(m)}}}var jc={},ea=gs(jc),$c=gs(jc),Hc=gs(jc);function _o(s){if(s===jc)throw Error(r(174));return s}function up(s,l){switch(Bt(Hc,l),Bt($c,s),Bt(ea,jc),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:jt(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=jt(l,s)}Gt(ea),Bt(ea,l)}function Il(){Gt(ea),Gt($c),Gt(Hc)}function sx(s){_o(Hc.current);var l=_o(ea.current),f=jt(l,s.type);l!==f&&(Bt($c,s),Bt(ea,f))}function fp(s){$c.current===s&&(Gt(ea),Gt($c))}var Zt=gs(0);function eh(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var hp=[];function dp(){for(var s=0;s<hp.length;s++)hp[s]._workInProgressVersionPrimary=null;hp.length=0}var th=B.ReactCurrentDispatcher,pp=B.ReactCurrentBatchConfig,yo=0,er=null,kr=null,Dr=null,rh=!1,zc=!1,Wc=0,IC=0;function en(){throw Error(r(321))}function mp(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Ii(s[f],l[f]))return!1;return!0}function gp(s,l,f,m,x,S){if(yo=S,er=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,th.current=s===null||s.memoizedState===null?bC:OC,s=f(m,x),zc){S=0;do{if(zc=!1,Wc=0,25<=S)throw Error(r(301));S+=1,Dr=kr=null,l.updateQueue=null,th.current=DC,s=f(m,x)}while(zc)}if(th.current=ah,l=kr!==null&&kr.next!==null,yo=0,Dr=kr=er=null,rh=!1,l)throw Error(r(300));return s}function vp(){var s=Wc!==0;return Wc=0,s}function ta(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?er.memoizedState=Dr=s:Dr=Dr.next=s,Dr}function ci(){if(kr===null){var s=er.alternate;s=s!==null?s.memoizedState:null}else s=kr.next;var l=Dr===null?er.memoizedState:Dr.next;if(l!==null)Dr=l,kr=s;else{if(s===null)throw Error(r(310));kr=s,s={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Dr===null?er.memoizedState=Dr=s:Dr=Dr.next=s}return Dr}function Gc(s,l){return typeof l=="function"?l(s):l}function xp(s){var l=ci(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var m=kr,x=m.baseQueue,S=f.pending;if(S!==null){if(x!==null){var b=x.next;x.next=S.next,S.next=b}m.baseQueue=x=S,f.pending=null}if(x!==null){S=x.next,m=m.baseState;var J=b=null,ne=null,pe=S;do{var Re=pe.lane;if((yo&Re)===Re)ne!==null&&(ne=ne.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),m=pe.hasEagerState?pe.eagerState:s(m,pe.action);else{var Oe={lane:Re,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};ne===null?(J=ne=Oe,b=m):ne=ne.next=Oe,er.lanes|=Re,Eo|=Re}pe=pe.next}while(pe!==null&&pe!==S);ne===null?b=m:ne.next=J,Ii(m,l.memoizedState)||(Dn=!0),l.memoizedState=m,l.baseState=b,l.baseQueue=ne,f.lastRenderedState=m}if(s=f.interleaved,s!==null){x=s;do S=x.lane,er.lanes|=S,Eo|=S,x=x.next;while(x!==s)}else x===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function _p(s){var l=ci(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var m=f.dispatch,x=f.pending,S=l.memoizedState;if(x!==null){f.pending=null;var b=x=x.next;do S=s(S,b.action),b=b.next;while(b!==x);Ii(S,l.memoizedState)||(Dn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),f.lastRenderedState=S}return[S,m]}function ox(){}function lx(s,l){var f=er,m=ci(),x=l(),S=!Ii(m.memoizedState,x);if(S&&(m.memoizedState=x,Dn=!0),m=m.queue,yp(fx.bind(null,f,m,s),[s]),m.getSnapshot!==l||S||Dr!==null&&Dr.memoizedState.tag&1){if(f.flags|=2048,Kc(9,ux.bind(null,f,m,x,l),void 0,null),Nr===null)throw Error(r(349));yo&30||cx(f,l,x)}return x}function cx(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=er.updateQueue,l===null?(l={lastEffect:null,stores:null},er.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function ux(s,l,f,m){l.value=f,l.getSnapshot=m,hx(l)&&dx(s)}function fx(s,l,f){return f(function(){hx(l)&&dx(s)})}function hx(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Ii(s,f)}catch{return!0}}function dx(s){var l=ba(s,1);l!==null&&Oi(l,s,1,-1)}function px(s){var l=ta();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gc,lastRenderedState:s},l.queue=s,s=s.dispatch=FC.bind(null,er,s),[l.memoizedState,s]}function Kc(s,l,f,m){return s={tag:s,create:l,destroy:f,deps:m,next:null},l=er.updateQueue,l===null?(l={lastEffect:null,stores:null},er.updateQueue=l,l.lastEffect=s.next=s):(f=l.lastEffect,f===null?l.lastEffect=s.next=s:(m=f.next,f.next=s,s.next=m,l.lastEffect=s)),s}function mx(){return ci().memoizedState}function nh(s,l,f,m){var x=ta();er.flags|=s,x.memoizedState=Kc(1|l,f,void 0,m===void 0?null:m)}function ih(s,l,f,m){var x=ci();m=m===void 0?null:m;var S=void 0;if(kr!==null){var b=kr.memoizedState;if(S=b.destroy,m!==null&&mp(m,b.deps)){x.memoizedState=Kc(l,f,S,m);return}}er.flags|=s,x.memoizedState=Kc(1|l,f,S,m)}function gx(s,l){return nh(8390656,8,s,l)}function yp(s,l){return ih(2048,8,s,l)}function vx(s,l){return ih(4,2,s,l)}function xx(s,l){return ih(4,4,s,l)}function _x(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function yx(s,l,f){return f=f!=null?f.concat([s]):null,ih(4,4,_x.bind(null,l,s),f)}function Ep(){}function Ex(s,l){var f=ci();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&mp(l,m[1])?m[0]:(f.memoizedState=[s,l],s)}function wx(s,l){var f=ci();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&mp(l,m[1])?m[0]:(s=s(),f.memoizedState=[s,l],s)}function Tx(s,l,f){return yo&21?(Ii(f,l)||(f=lo(),er.lanes|=f,Eo|=f,s.baseState=!0),l):(s.baseState&&(s.baseState=!1,Dn=!0),s.memoizedState=f)}function RC(s,l){var f=gt;gt=f!==0&&4>f?f:4,s(!0);var m=pp.transition;pp.transition={};try{s(!1),l()}finally{gt=f,pp.transition=m}}function Sx(){return ci().memoizedState}function PC(s,l,f){var m=Ss(s);if(f={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null},kx(s))Ax(l,f);else if(f=rx(s,l,f,m),f!==null){var x=En();Oi(f,s,m,x),Cx(f,l,m)}}function FC(s,l,f){var m=Ss(s),x={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null};if(kx(s))Ax(l,x);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var b=l.lastRenderedState,J=S(b,f);if(x.hasEagerState=!0,x.eagerState=J,Ii(J,b)){var ne=l.interleaved;ne===null?(x.next=x,lp(l)):(x.next=ne.next,ne.next=x),l.interleaved=x;return}}catch{}finally{}f=rx(s,l,x,m),f!==null&&(x=En(),Oi(f,s,m,x),Cx(f,l,m))}}function kx(s){var l=s.alternate;return s===er||l!==null&&l===er}function Ax(s,l){zc=rh=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function Cx(s,l,f){if(f&4194240){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,cs(s,f)}}var ah={readContext:li,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},bC={readContext:li,useCallback:function(s,l){return ta().memoizedState=[s,l===void 0?null:l],s},useContext:li,useEffect:gx,useImperativeHandle:function(s,l,f){return f=f!=null?f.concat([s]):null,nh(4194308,4,_x.bind(null,l,s),f)},useLayoutEffect:function(s,l){return nh(4194308,4,s,l)},useInsertionEffect:function(s,l){return nh(4,2,s,l)},useMemo:function(s,l){var f=ta();return l=l===void 0?null:l,s=s(),f.memoizedState=[s,l],s},useReducer:function(s,l,f){var m=ta();return l=f!==void 0?f(l):l,m.memoizedState=m.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},m.queue=s,s=s.dispatch=PC.bind(null,er,s),[m.memoizedState,s]},useRef:function(s){var l=ta();return s={current:s},l.memoizedState=s},useState:px,useDebugValue:Ep,useDeferredValue:function(s){return ta().memoizedState=s},useTransition:function(){var s=px(!1),l=s[0];return s=RC.bind(null,s[1]),ta().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,f){var m=er,x=ta();if(Xt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Nr===null)throw Error(r(349));yo&30||cx(m,l,f)}x.memoizedState=f;var S={value:f,getSnapshot:l};return x.queue=S,gx(fx.bind(null,m,S,s),[s]),m.flags|=2048,Kc(9,ux.bind(null,m,S,f,l),void 0,null),f},useId:function(){var s=ta(),l=Nr.identifierPrefix;if(Xt){var f=Fa,m=Pa;f=(m&~(1<<32-zt(m)-1)).toString(32)+f,l=":"+l+"R"+f,f=Wc++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=IC++,l=":"+l+"r"+f.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},OC={readContext:li,useCallback:Ex,useContext:li,useEffect:yp,useImperativeHandle:yx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:wx,useReducer:xp,useRef:mx,useState:function(){return xp(Gc)},useDebugValue:Ep,useDeferredValue:function(s){var l=ci();return Tx(l,kr.memoizedState,s)},useTransition:function(){var s=xp(Gc)[0],l=ci().memoizedState;return[s,l]},useMutableSource:ox,useSyncExternalStore:lx,useId:Sx,unstable_isNewReconciler:!1},DC={readContext:li,useCallback:Ex,useContext:li,useEffect:yp,useImperativeHandle:yx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:wx,useReducer:_p,useRef:mx,useState:function(){return _p(Gc)},useDebugValue:Ep,useDeferredValue:function(s){var l=ci();return kr===null?l.memoizedState=s:Tx(l,kr.memoizedState,s)},useTransition:function(){var s=_p(Gc)[0],l=ci().memoizedState;return[s,l]},useMutableSource:ox,useSyncExternalStore:lx,useId:Sx,unstable_isNewReconciler:!1};function Pi(s,l){if(s&&s.defaultProps){l=ve({},l),s=s.defaultProps;for(var f in s)l[f]===void 0&&(l[f]=s[f]);return l}return l}function wp(s,l,f,m){l=s.memoizedState,f=f(m,l),f=f==null?l:ve({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var sh={isMounted:function(s){return(s=s._reactInternals)?X(s)===s:!1},enqueueSetState:function(s,l,f){s=s._reactInternals;var m=En(),x=Ss(s),S=Oa(m,x);S.payload=l,f!=null&&(S.callback=f),l=ys(s,S,x),l!==null&&(Oi(l,s,x,m),Jf(l,s,x))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var m=En(),x=Ss(s),S=Oa(m,x);S.tag=1,S.payload=l,f!=null&&(S.callback=f),l=ys(s,S,x),l!==null&&(Oi(l,s,x,m),Jf(l,s,x))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=En(),m=Ss(s),x=Oa(f,m);x.tag=2,l!=null&&(x.callback=l),l=ys(s,x,m),l!==null&&(Oi(l,s,m,f),Jf(l,s,m))}};function Ix(s,l,f,m,x,S,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,S,b):l.prototype&&l.prototype.isPureReactComponent?!Oc(f,m)||!Oc(x,S):!0}function Rx(s,l,f){var m=!1,x=vs,S=l.contextType;return typeof S=="object"&&S!==null?S=li(S):(x=On(l)?mo:Zr.current,m=l.contextTypes,S=(m=m!=null)?El(s,x):vs),l=new l(f,S),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=sh,s.stateNode=l,l._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=x,s.__reactInternalMemoizedMaskedChildContext=S),l}function Px(s,l,f,m){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,m),l.state!==s&&sh.enqueueReplaceState(l,l.state,null)}function Tp(s,l,f,m){var x=s.stateNode;x.props=f,x.state=s.memoizedState,x.refs={},cp(s);var S=l.contextType;typeof S=="object"&&S!==null?x.context=li(S):(S=On(l)?mo:Zr.current,x.context=El(s,S)),x.state=s.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(wp(s,l,S,f),x.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(l=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),l!==x.state&&sh.enqueueReplaceState(x,x.state,null),Zf(s,f,x,m),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308)}function Rl(s,l){try{var f="",m=l;do f+=Z(m),m=m.return;while(m);var x=f}catch(S){x=`
Error generating stack: `+S.message+`
`+S.stack}return{value:s,source:l,stack:x,digest:null}}function Sp(s,l,f){return{value:s,source:null,stack:f??null,digest:l??null}}function kp(s,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var NC=typeof WeakMap=="function"?WeakMap:Map;function Fx(s,l,f){f=Oa(-1,f),f.tag=3,f.payload={element:null};var m=l.value;return f.callback=function(){dh||(dh=!0,Up=m),kp(s,l)},f}function bx(s,l,f){f=Oa(-1,f),f.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var x=l.value;f.payload=function(){return m(x)},f.callback=function(){kp(s,l)}}var S=s.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(f.callback=function(){kp(s,l),typeof m!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})}),f}function Ox(s,l,f){var m=s.pingCache;if(m===null){m=s.pingCache=new NC;var x=new Set;m.set(l,x)}else x=m.get(l),x===void 0&&(x=new Set,m.set(l,x));x.has(f)||(x.add(f),s=XC.bind(null,s,l,f),l.then(s,s))}function Dx(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function Nx(s,l,f,m,x){return s.mode&1?(s.flags|=65536,s.lanes=x,s):(s===l?s.flags|=65536:(s.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=Oa(-1,1),l.tag=2,ys(f,l,1))),f.lanes|=1),s)}var LC=B.ReactCurrentOwner,Dn=!1;function yn(s,l,f,m){l.child=s===null?tx(l,null,f,m):kl(l,s.child,f,m)}function Lx(s,l,f,m,x){f=f.render;var S=l.ref;return Cl(l,x),m=gp(s,l,f,m,S,x),f=vp(),s!==null&&!Dn?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Da(s,l,x)):(Xt&&f&&Zd(l),l.flags|=1,yn(s,l,m,x),l.child)}function Mx(s,l,f,m,x){if(s===null){var S=f.type;return typeof S=="function"&&!Kp(S)&&S.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=S,Vx(s,l,S,m,x)):(s=_h(f.type,null,m,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(S=s.child,!(s.lanes&x)){var b=S.memoizedProps;if(f=f.compare,f=f!==null?f:Oc,f(b,m)&&s.ref===l.ref)return Da(s,l,x)}return l.flags|=1,s=As(S,m),s.ref=l.ref,s.return=l,l.child=s}function Vx(s,l,f,m,x){if(s!==null){var S=s.memoizedProps;if(Oc(S,m)&&s.ref===l.ref)if(Dn=!1,l.pendingProps=m=S,(s.lanes&x)!==0)s.flags&131072&&(Dn=!0);else return l.lanes=s.lanes,Da(s,l,x)}return Ap(s,l,f,m,x)}function Bx(s,l,f){var m=l.pendingProps,x=m.children,S=s!==null?s.memoizedState:null;if(m.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(Fl,Xn),Xn|=f;else{if(!(f&1073741824))return s=S!==null?S.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Bt(Fl,Xn),Xn|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=S!==null?S.baseLanes:f,Bt(Fl,Xn),Xn|=m}else S!==null?(m=S.baseLanes|f,l.memoizedState=null):m=f,Bt(Fl,Xn),Xn|=m;return yn(s,l,x,f),l.child}function Ux(s,l){var f=l.ref;(s===null&&f!==null||s!==null&&s.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function Ap(s,l,f,m,x){var S=On(f)?mo:Zr.current;return S=El(l,S),Cl(l,x),f=gp(s,l,f,m,S,x),m=vp(),s!==null&&!Dn?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Da(s,l,x)):(Xt&&m&&Zd(l),l.flags|=1,yn(s,l,f,x),l.child)}function jx(s,l,f,m,x){if(On(f)){var S=!0;zf(l)}else S=!1;if(Cl(l,x),l.stateNode===null)lh(s,l),Rx(l,f,m),Tp(l,f,m,x),m=!0;else if(s===null){var b=l.stateNode,J=l.memoizedProps;b.props=J;var ne=b.context,pe=f.contextType;typeof pe=="object"&&pe!==null?pe=li(pe):(pe=On(f)?mo:Zr.current,pe=El(l,pe));var Re=f.getDerivedStateFromProps,Oe=typeof Re=="function"||typeof b.getSnapshotBeforeUpdate=="function";Oe||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(J!==m||ne!==pe)&&Px(l,b,m,pe),_s=!1;var Ie=l.memoizedState;b.state=Ie,Zf(l,m,b,x),ne=l.memoizedState,J!==m||Ie!==ne||bn.current||_s?(typeof Re=="function"&&(wp(l,f,Re,m),ne=l.memoizedState),(J=_s||Ix(l,f,J,m,Ie,ne,pe))?(Oe||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=ne),b.props=m,b.state=ne,b.context=pe,m=J):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{b=l.stateNode,nx(s,l),J=l.memoizedProps,pe=l.type===l.elementType?J:Pi(l.type,J),b.props=pe,Oe=l.pendingProps,Ie=b.context,ne=f.contextType,typeof ne=="object"&&ne!==null?ne=li(ne):(ne=On(f)?mo:Zr.current,ne=El(l,ne));var Ue=f.getDerivedStateFromProps;(Re=typeof Ue=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(J!==Oe||Ie!==ne)&&Px(l,b,m,ne),_s=!1,Ie=l.memoizedState,b.state=Ie,Zf(l,m,b,x);var ze=l.memoizedState;J!==Oe||Ie!==ze||bn.current||_s?(typeof Ue=="function"&&(wp(l,f,Ue,m),ze=l.memoizedState),(pe=_s||Ix(l,f,pe,m,Ie,ze,ne)||!1)?(Re||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,ze,ne),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,ze,ne)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||J===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||J===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=ze),b.props=m,b.state=ze,b.context=ne,m=pe):(typeof b.componentDidUpdate!="function"||J===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||J===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=1024),m=!1)}return Cp(s,l,f,m,S,x)}function Cp(s,l,f,m,x,S){Ux(s,l);var b=(l.flags&128)!==0;if(!m&&!b)return x&&Gv(l,f,!1),Da(s,l,S);m=l.stateNode,LC.current=l;var J=b&&typeof f.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,s!==null&&b?(l.child=kl(l,s.child,null,S),l.child=kl(l,null,J,S)):yn(s,l,J,S),l.memoizedState=m.state,x&&Gv(l,f,!0),l.child}function $x(s){var l=s.stateNode;l.pendingContext?zv(s,l.pendingContext,l.pendingContext!==l.context):l.context&&zv(s,l.context,!1),up(s,l.containerInfo)}function Hx(s,l,f,m,x){return Sl(),np(x),l.flags|=256,yn(s,l,f,m),l.child}var Ip={dehydrated:null,treeContext:null,retryLane:0};function Rp(s){return{baseLanes:s,cachePool:null,transitions:null}}function zx(s,l,f){var m=l.pendingProps,x=Zt.current,S=!1,b=(l.flags&128)!==0,J;if((J=b)||(J=s!==null&&s.memoizedState===null?!1:(x&2)!==0),J?(S=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(x|=1),Bt(Zt,x&1),s===null)return rp(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(l.mode&1?s.data==="$!"?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(b=m.children,s=m.fallback,S?(m=l.mode,S=l.child,b={mode:"hidden",children:b},!(m&1)&&S!==null?(S.childLanes=0,S.pendingProps=b):S=yh(b,m,0,null),s=ko(s,m,f,null),S.return=l,s.return=l,S.sibling=s,l.child=S,l.child.memoizedState=Rp(f),l.memoizedState=Ip,s):Pp(l,b));if(x=s.memoizedState,x!==null&&(J=x.dehydrated,J!==null))return MC(s,l,b,m,J,x,f);if(S){S=m.fallback,b=l.mode,x=s.child,J=x.sibling;var ne={mode:"hidden",children:m.children};return!(b&1)&&l.child!==x?(m=l.child,m.childLanes=0,m.pendingProps=ne,l.deletions=null):(m=As(x,ne),m.subtreeFlags=x.subtreeFlags&14680064),J!==null?S=As(J,S):(S=ko(S,b,f,null),S.flags|=2),S.return=l,m.return=l,m.sibling=S,l.child=m,m=S,S=l.child,b=s.child.memoizedState,b=b===null?Rp(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},S.memoizedState=b,S.childLanes=s.childLanes&~f,l.memoizedState=Ip,m}return S=s.child,s=S.sibling,m=As(S,{mode:"visible",children:m.children}),!(l.mode&1)&&(m.lanes=f),m.return=l,m.sibling=null,s!==null&&(f=l.deletions,f===null?(l.deletions=[s],l.flags|=16):f.push(s)),l.child=m,l.memoizedState=null,m}function Pp(s,l){return l=yh({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function oh(s,l,f,m){return m!==null&&np(m),kl(l,s.child,null,f),s=Pp(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function MC(s,l,f,m,x,S,b){if(f)return l.flags&256?(l.flags&=-257,m=Sp(Error(r(422))),oh(s,l,b,m)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(S=m.fallback,x=l.mode,m=yh({mode:"visible",children:m.children},x,0,null),S=ko(S,x,b,null),S.flags|=2,m.return=l,S.return=l,m.sibling=S,l.child=m,l.mode&1&&kl(l,s.child,null,b),l.child.memoizedState=Rp(b),l.memoizedState=Ip,S);if(!(l.mode&1))return oh(s,l,b,null);if(x.data==="$!"){if(m=x.nextSibling&&x.nextSibling.dataset,m)var J=m.dgst;return m=J,S=Error(r(419)),m=Sp(S,m,void 0),oh(s,l,b,m)}if(J=(b&s.childLanes)!==0,Dn||J){if(m=Nr,m!==null){switch(b&-b){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(m.suspendedLanes|b)?0:x,x!==0&&x!==S.retryLane&&(S.retryLane=x,ba(s,x),Oi(m,s,x,-1))}return Gp(),m=Sp(Error(r(421))),oh(s,l,b,m)}return x.data==="$?"?(l.flags|=128,l.child=s.child,l=YC.bind(null,s),x._reactRetry=l,null):(s=S.treeContext,qn=ms(x.nextSibling),Kn=l,Xt=!0,Ri=null,s!==null&&(si[oi++]=Pa,si[oi++]=Fa,si[oi++]=go,Pa=s.id,Fa=s.overflow,go=l),l=Pp(l,m.children),l.flags|=4096,l)}function Wx(s,l,f){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l),op(s.return,l,f)}function Fp(s,l,f,m,x){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:x}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=f,S.tailMode=x)}function Gx(s,l,f){var m=l.pendingProps,x=m.revealOrder,S=m.tail;if(yn(s,l,m.children,f),m=Zt.current,m&2)m=m&1|2,l.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wx(s,f,l);else if(s.tag===19)Wx(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Bt(Zt,m),!(l.mode&1))l.memoizedState=null;else switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&eh(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),Fp(l,!1,x,f,S);break;case"backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&eh(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}Fp(l,!0,f,null,S);break;case"together":Fp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function lh(s,l){!(l.mode&1)&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function Da(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),Eo|=l.lanes,!(f&l.childLanes))return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=As(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=As(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function VC(s,l,f){switch(l.tag){case 3:$x(l),Sl();break;case 5:sx(l);break;case 1:On(l.type)&&zf(l);break;case 4:up(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,x=l.memoizedProps.value;Bt(Yf,m._currentValue),m._currentValue=x;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(Bt(Zt,Zt.current&1),l.flags|=128,null):f&l.child.childLanes?zx(s,l,f):(Bt(Zt,Zt.current&1),s=Da(s,l,f),s!==null?s.sibling:null);Bt(Zt,Zt.current&1);break;case 19:if(m=(f&l.childLanes)!==0,s.flags&128){if(m)return Gx(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Bt(Zt,Zt.current),m)break;return null;case 22:case 23:return l.lanes=0,Bx(s,l,f)}return Da(s,l,f)}var Kx,bp,qx,Xx;Kx=function(s,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)s.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},bp=function(){},qx=function(s,l,f,m){var x=s.memoizedProps;if(x!==m){s=l.stateNode,_o(ea.current);var S=null;switch(f){case"input":x=ct(s,x),m=ct(s,m),S=[];break;case"select":x=ve({},x,{value:void 0}),m=ve({},m,{value:void 0}),S=[];break;case"textarea":x=_i(s,x),m=_i(s,m),S=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=jf)}ro(f,m);var b;f=null;for(pe in x)if(!m.hasOwnProperty(pe)&&x.hasOwnProperty(pe)&&x[pe]!=null)if(pe==="style"){var J=x[pe];for(b in J)J.hasOwnProperty(b)&&(f||(f={}),f[b]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(i.hasOwnProperty(pe)?S||(S=[]):(S=S||[]).push(pe,null));for(pe in m){var ne=m[pe];if(J=x!=null?x[pe]:void 0,m.hasOwnProperty(pe)&&ne!==J&&(ne!=null||J!=null))if(pe==="style")if(J){for(b in J)!J.hasOwnProperty(b)||ne&&ne.hasOwnProperty(b)||(f||(f={}),f[b]="");for(b in ne)ne.hasOwnProperty(b)&&J[b]!==ne[b]&&(f||(f={}),f[b]=ne[b])}else f||(S||(S=[]),S.push(pe,f)),f=ne;else pe==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,J=J?J.__html:void 0,ne!=null&&J!==ne&&(S=S||[]).push(pe,ne)):pe==="children"?typeof ne!="string"&&typeof ne!="number"||(S=S||[]).push(pe,""+ne):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(i.hasOwnProperty(pe)?(ne!=null&&pe==="onScroll"&&Wt("scroll",s),S||J===ne||(S=[])):(S=S||[]).push(pe,ne))}f&&(S=S||[]).push("style",f);var pe=S;(l.updateQueue=pe)&&(l.flags|=4)}},Xx=function(s,l,f,m){f!==m&&(l.flags|=4)};function qc(s,l){if(!Xt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function tn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,m=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags&14680064,m|=x.flags&14680064,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=m,s.childLanes=f,l}function BC(s,l,f){var m=l.pendingProps;switch(ep(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(l),null;case 1:return On(l.type)&&Hf(),tn(l),null;case 3:return m=l.stateNode,Il(),Gt(bn),Gt(Zr),dp(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(qf(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,Ri!==null&&(Hp(Ri),Ri=null))),bp(s,l),tn(l),null;case 5:fp(l);var x=_o(Hc.current);if(f=l.type,s!==null&&l.stateNode!=null)qx(s,l,f,m,x),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(r(166));return tn(l),null}if(s=_o(ea.current),qf(l)){m=l.stateNode,f=l.type;var S=l.memoizedProps;switch(m[Zi]=l,m[Vc]=S,s=(l.mode&1)!==0,f){case"dialog":Wt("cancel",m),Wt("close",m);break;case"iframe":case"object":case"embed":Wt("load",m);break;case"video":case"audio":for(x=0;x<Nc.length;x++)Wt(Nc[x],m);break;case"source":Wt("error",m);break;case"img":case"image":case"link":Wt("error",m),Wt("load",m);break;case"details":Wt("toggle",m);break;case"input":dt(m,S),Wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!S.multiple},Wt("invalid",m);break;case"textarea":gn(m,S),Wt("invalid",m)}ro(f,S),x=null;for(var b in S)if(S.hasOwnProperty(b)){var J=S[b];b==="children"?typeof J=="string"?m.textContent!==J&&(S.suppressHydrationWarning!==!0&&Uf(m.textContent,J,s),x=["children",J]):typeof J=="number"&&m.textContent!==""+J&&(S.suppressHydrationWarning!==!0&&Uf(m.textContent,J,s),x=["children",""+J]):i.hasOwnProperty(b)&&J!=null&&b==="onScroll"&&Wt("scroll",m)}switch(f){case"input":Je(m),Vt(m,S,!0);break;case"textarea":Je(m),vn(m);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(m.onclick=jf)}m=x,l.updateQueue=m,m!==null&&(l.flags|=4)}else{b=x.nodeType===9?x:x.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Lt(f)),s==="http://www.w3.org/1999/xhtml"?f==="script"?(s=b.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=b.createElement(f,{is:m.is}):(s=b.createElement(f),f==="select"&&(b=s,m.multiple?b.multiple=!0:m.size&&(b.size=m.size))):s=b.createElementNS(s,f),s[Zi]=l,s[Vc]=m,Kx(s,l,!1,!1),l.stateNode=s;e:{switch(b=no(f,m),f){case"dialog":Wt("cancel",s),Wt("close",s),x=m;break;case"iframe":case"object":case"embed":Wt("load",s),x=m;break;case"video":case"audio":for(x=0;x<Nc.length;x++)Wt(Nc[x],s);x=m;break;case"source":Wt("error",s),x=m;break;case"img":case"image":case"link":Wt("error",s),Wt("load",s),x=m;break;case"details":Wt("toggle",s),x=m;break;case"input":dt(s,m),x=ct(s,m),Wt("invalid",s);break;case"option":x=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},x=ve({},m,{value:void 0}),Wt("invalid",s);break;case"textarea":gn(s,m),x=_i(s,m),Wt("invalid",s);break;default:x=m}ro(f,x),J=x;for(S in J)if(J.hasOwnProperty(S)){var ne=J[S];S==="style"?$n(s,ne):S==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&Jr(s,ne)):S==="children"?typeof ne=="string"?(f!=="textarea"||ne!=="")&&rt(s,ne):typeof ne=="number"&&rt(s,""+ne):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(i.hasOwnProperty(S)?ne!=null&&S==="onScroll"&&Wt("scroll",s):ne!=null&&C(s,S,ne,b))}switch(f){case"input":Je(s),Vt(s,m,!1);break;case"textarea":Je(s),vn(s);break;case"option":m.value!=null&&s.setAttribute("value",""+Se(m.value));break;case"select":s.multiple=!!m.multiple,S=m.value,S!=null?Tr(s,!!m.multiple,S,!1):m.defaultValue!=null&&Tr(s,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(s.onclick=jf)}switch(f){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return tn(l),null;case 6:if(s&&l.stateNode!=null)Xx(s,l,s.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(f=_o(Hc.current),_o(ea.current),qf(l)){if(m=l.stateNode,f=l.memoizedProps,m[Zi]=l,(S=m.nodeValue!==f)&&(s=Kn,s!==null))switch(s.tag){case 3:Uf(m.nodeValue,f,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Uf(m.nodeValue,f,(s.mode&1)!==0)}S&&(l.flags|=4)}else m=(f.nodeType===9?f:f.ownerDocument).createTextNode(m),m[Zi]=l,l.stateNode=m}return tn(l),null;case 13:if(Gt(Zt),m=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Xt&&qn!==null&&l.mode&1&&!(l.flags&128))Jv(),Sl(),l.flags|=98560,S=!1;else if(S=qf(l),m!==null&&m.dehydrated!==null){if(s===null){if(!S)throw Error(r(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[Zi]=l}else Sl(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;tn(l),S=!1}else Ri!==null&&(Hp(Ri),Ri=null),S=!0;if(!S)return l.flags&65536?l:null}return l.flags&128?(l.lanes=f,l):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(l.child.flags|=8192,l.mode&1&&(s===null||Zt.current&1?Ar===0&&(Ar=3):Gp())),l.updateQueue!==null&&(l.flags|=4),tn(l),null);case 4:return Il(),bp(s,l),s===null&&Lc(l.stateNode.containerInfo),tn(l),null;case 10:return sp(l.type._context),tn(l),null;case 17:return On(l.type)&&Hf(),tn(l),null;case 19:if(Gt(Zt),S=l.memoizedState,S===null)return tn(l),null;if(m=(l.flags&128)!==0,b=S.rendering,b===null)if(m)qc(S,!1);else{if(Ar!==0||s!==null&&s.flags&128)for(s=l.child;s!==null;){if(b=eh(s),b!==null){for(l.flags|=128,qc(S,!1),m=b.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=f,f=l.child;f!==null;)S=f,s=m,S.flags&=14680066,b=S.alternate,b===null?(S.childLanes=0,S.lanes=s,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=b.childLanes,S.lanes=b.lanes,S.child=b.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=b.memoizedProps,S.memoizedState=b.memoizedState,S.updateQueue=b.updateQueue,S.type=b.type,s=b.dependencies,S.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),f=f.sibling;return Bt(Zt,Zt.current&1|2),l.child}s=s.sibling}S.tail!==null&&Fe()>bl&&(l.flags|=128,m=!0,qc(S,!1),l.lanes=4194304)}else{if(!m)if(s=eh(b),s!==null){if(l.flags|=128,m=!0,f=s.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),qc(S,!0),S.tail===null&&S.tailMode==="hidden"&&!b.alternate&&!Xt)return tn(l),null}else 2*Fe()-S.renderingStartTime>bl&&f!==1073741824&&(l.flags|=128,m=!0,qc(S,!1),l.lanes=4194304);S.isBackwards?(b.sibling=l.child,l.child=b):(f=S.last,f!==null?f.sibling=b:l.child=b,S.last=b)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=Fe(),l.sibling=null,f=Zt.current,Bt(Zt,m?f&1|2:f&1),l):(tn(l),null);case 22:case 23:return Wp(),m=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(l.flags|=8192),m&&l.mode&1?Xn&1073741824&&(tn(l),l.subtreeFlags&6&&(l.flags|=8192)):tn(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function UC(s,l){switch(ep(l),l.tag){case 1:return On(l.type)&&Hf(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Il(),Gt(bn),Gt(Zr),dp(),s=l.flags,s&65536&&!(s&128)?(l.flags=s&-65537|128,l):null;case 5:return fp(l),null;case 13:if(Gt(Zt),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Sl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Gt(Zt),null;case 4:return Il(),null;case 10:return sp(l.type._context),null;case 22:case 23:return Wp(),null;case 24:return null;default:return null}}var ch=!1,rn=!1,jC=typeof WeakSet=="function"?WeakSet:Set,He=null;function Pl(s,l){var f=s.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(m){rr(s,l,m)}else f.current=null}function Op(s,l,f){try{f()}catch(m){rr(s,l,m)}}var Yx=!1;function $C(s,l){if(Wd=hs,s=Iv(),Md(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var x=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var b=0,J=-1,ne=-1,pe=0,Re=0,Oe=s,Ie=null;t:for(;;){for(var Ue;Oe!==f||x!==0&&Oe.nodeType!==3||(J=b+x),Oe!==S||m!==0&&Oe.nodeType!==3||(ne=b+m),Oe.nodeType===3&&(b+=Oe.nodeValue.length),(Ue=Oe.firstChild)!==null;)Ie=Oe,Oe=Ue;for(;;){if(Oe===s)break t;if(Ie===f&&++pe===x&&(J=b),Ie===S&&++Re===m&&(ne=b),(Ue=Oe.nextSibling)!==null)break;Oe=Ie,Ie=Oe.parentNode}Oe=Ue}f=J===-1||ne===-1?null:{start:J,end:ne}}else f=null}f=f||{start:0,end:0}}else f=null;for(Gd={focusedElem:s,selectionRange:f},hs=!1,He=l;He!==null;)if(l=He,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,He=s;else for(;He!==null;){l=He;try{var ze=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var We=ze.memoizedProps,or=ze.memoizedState,oe=l.stateNode,ae=oe.getSnapshotBeforeUpdate(l.elementType===l.type?We:Pi(l.type,We),or);oe.__reactInternalSnapshotBeforeUpdate=ae}break;case 3:var fe=l.stateNode.containerInfo;fe.nodeType===1?fe.textContent="":fe.nodeType===9&&fe.documentElement&&fe.removeChild(fe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ne){rr(l,l.return,Ne)}if(s=l.sibling,s!==null){s.return=l.return,He=s;break}He=l.return}return ze=Yx,Yx=!1,ze}function Xc(s,l,f){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var x=m=m.next;do{if((x.tag&s)===s){var S=x.destroy;x.destroy=void 0,S!==void 0&&Op(l,f,S)}x=x.next}while(x!==m)}}function uh(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&s)===s){var m=f.create;f.destroy=m()}f=f.next}while(f!==l)}}function Dp(s){var l=s.ref;if(l!==null){var f=s.stateNode;switch(s.tag){case 5:s=f;break;default:s=f}typeof l=="function"?l(s):l.current=s}}function Qx(s){var l=s.alternate;l!==null&&(s.alternate=null,Qx(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[Zi],delete l[Vc],delete l[Yd],delete l[SC],delete l[kC])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Jx(s){return s.tag===5||s.tag===3||s.tag===4}function Zx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Jx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Np(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(s,l):f.insertBefore(s,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(s,f)):(l=f,l.appendChild(s)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=jf));else if(m!==4&&(s=s.child,s!==null))for(Np(s,l,f),s=s.sibling;s!==null;)Np(s,l,f),s=s.sibling}function Lp(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(Lp(s,l,f),s=s.sibling;s!==null;)Lp(s,l,f),s=s.sibling}var $r=null,Fi=!1;function Es(s,l,f){for(f=f.child;f!==null;)e_(s,l,f),f=f.sibling}function e_(s,l,f){if(sr&&typeof sr.onCommitFiberUnmount=="function")try{sr.onCommitFiberUnmount(Hn,f)}catch{}switch(f.tag){case 5:rn||Pl(f,l);case 6:var m=$r,x=Fi;$r=null,Es(s,l,f),$r=m,Fi=x,$r!==null&&(Fi?(s=$r,f=f.stateNode,s.nodeType===8?s.parentNode.removeChild(f):s.removeChild(f)):$r.removeChild(f.stateNode));break;case 18:$r!==null&&(Fi?(s=$r,f=f.stateNode,s.nodeType===8?Xd(s.parentNode,f):s.nodeType===1&&Xd(s,f),Ai(s)):Xd($r,f.stateNode));break;case 4:m=$r,x=Fi,$r=f.stateNode.containerInfo,Fi=!0,Es(s,l,f),$r=m,Fi=x;break;case 0:case 11:case 14:case 15:if(!rn&&(m=f.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){x=m=m.next;do{var S=x,b=S.destroy;S=S.tag,b!==void 0&&(S&2||S&4)&&Op(f,l,b),x=x.next}while(x!==m)}Es(s,l,f);break;case 1:if(!rn&&(Pl(f,l),m=f.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=f.memoizedProps,m.state=f.memoizedState,m.componentWillUnmount()}catch(J){rr(f,l,J)}Es(s,l,f);break;case 21:Es(s,l,f);break;case 22:f.mode&1?(rn=(m=rn)||f.memoizedState!==null,Es(s,l,f),rn=m):Es(s,l,f);break;default:Es(s,l,f)}}function t_(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var f=s.stateNode;f===null&&(f=s.stateNode=new jC),l.forEach(function(m){var x=QC.bind(null,s,m);f.has(m)||(f.add(m),m.then(x,x))})}}function bi(s,l){var f=l.deletions;if(f!==null)for(var m=0;m<f.length;m++){var x=f[m];try{var S=s,b=l,J=b;e:for(;J!==null;){switch(J.tag){case 5:$r=J.stateNode,Fi=!1;break e;case 3:$r=J.stateNode.containerInfo,Fi=!0;break e;case 4:$r=J.stateNode.containerInfo,Fi=!0;break e}J=J.return}if($r===null)throw Error(r(160));e_(S,b,x),$r=null,Fi=!1;var ne=x.alternate;ne!==null&&(ne.return=null),x.return=null}catch(pe){rr(x,l,pe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)r_(l,s),l=l.sibling}function r_(s,l){var f=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(bi(l,s),ra(s),m&4){try{Xc(3,s,s.return),uh(3,s)}catch(We){rr(s,s.return,We)}try{Xc(5,s,s.return)}catch(We){rr(s,s.return,We)}}break;case 1:bi(l,s),ra(s),m&512&&f!==null&&Pl(f,f.return);break;case 5:if(bi(l,s),ra(s),m&512&&f!==null&&Pl(f,f.return),s.flags&32){var x=s.stateNode;try{rt(x,"")}catch(We){rr(s,s.return,We)}}if(m&4&&(x=s.stateNode,x!=null)){var S=s.memoizedProps,b=f!==null?f.memoizedProps:S,J=s.type,ne=s.updateQueue;if(s.updateQueue=null,ne!==null)try{J==="input"&&S.type==="radio"&&S.name!=null&&ut(x,S),no(J,b);var pe=no(J,S);for(b=0;b<ne.length;b+=2){var Re=ne[b],Oe=ne[b+1];Re==="style"?$n(x,Oe):Re==="dangerouslySetInnerHTML"?Jr(x,Oe):Re==="children"?rt(x,Oe):C(x,Re,Oe,pe)}switch(J){case"input":Ve(x,S);break;case"textarea":fr(x,S);break;case"select":var Ie=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!S.multiple;var Ue=S.value;Ue!=null?Tr(x,!!S.multiple,Ue,!1):Ie!==!!S.multiple&&(S.defaultValue!=null?Tr(x,!!S.multiple,S.defaultValue,!0):Tr(x,!!S.multiple,S.multiple?[]:"",!1))}x[Vc]=S}catch(We){rr(s,s.return,We)}}break;case 6:if(bi(l,s),ra(s),m&4){if(s.stateNode===null)throw Error(r(162));x=s.stateNode,S=s.memoizedProps;try{x.nodeValue=S}catch(We){rr(s,s.return,We)}}break;case 3:if(bi(l,s),ra(s),m&4&&f!==null&&f.memoizedState.isDehydrated)try{Ai(l.containerInfo)}catch(We){rr(s,s.return,We)}break;case 4:bi(l,s),ra(s);break;case 13:bi(l,s),ra(s),x=s.child,x.flags&8192&&(S=x.memoizedState!==null,x.stateNode.isHidden=S,!S||x.alternate!==null&&x.alternate.memoizedState!==null||(Bp=Fe())),m&4&&t_(s);break;case 22:if(Re=f!==null&&f.memoizedState!==null,s.mode&1?(rn=(pe=rn)||Re,bi(l,s),rn=pe):bi(l,s),ra(s),m&8192){if(pe=s.memoizedState!==null,(s.stateNode.isHidden=pe)&&!Re&&s.mode&1)for(He=s,Re=s.child;Re!==null;){for(Oe=He=Re;He!==null;){switch(Ie=He,Ue=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Xc(4,Ie,Ie.return);break;case 1:Pl(Ie,Ie.return);var ze=Ie.stateNode;if(typeof ze.componentWillUnmount=="function"){m=Ie,f=Ie.return;try{l=m,ze.props=l.memoizedProps,ze.state=l.memoizedState,ze.componentWillUnmount()}catch(We){rr(m,f,We)}}break;case 5:Pl(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){a_(Oe);continue}}Ue!==null?(Ue.return=Ie,He=Ue):a_(Oe)}Re=Re.sibling}e:for(Re=null,Oe=s;;){if(Oe.tag===5){if(Re===null){Re=Oe;try{x=Oe.stateNode,pe?(S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(J=Oe.stateNode,ne=Oe.memoizedProps.style,b=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,J.style.display=Ht("display",b))}catch(We){rr(s,s.return,We)}}}else if(Oe.tag===6){if(Re===null)try{Oe.stateNode.nodeValue=pe?"":Oe.memoizedProps}catch(We){rr(s,s.return,We)}}else if((Oe.tag!==22&&Oe.tag!==23||Oe.memoizedState===null||Oe===s)&&Oe.child!==null){Oe.child.return=Oe,Oe=Oe.child;continue}if(Oe===s)break e;for(;Oe.sibling===null;){if(Oe.return===null||Oe.return===s)break e;Re===Oe&&(Re=null),Oe=Oe.return}Re===Oe&&(Re=null),Oe.sibling.return=Oe.return,Oe=Oe.sibling}}break;case 19:bi(l,s),ra(s),m&4&&t_(s);break;case 21:break;default:bi(l,s),ra(s)}}function ra(s){var l=s.flags;if(l&2){try{e:{for(var f=s.return;f!==null;){if(Jx(f)){var m=f;break e}f=f.return}throw Error(r(160))}switch(m.tag){case 5:var x=m.stateNode;m.flags&32&&(rt(x,""),m.flags&=-33);var S=Zx(s);Lp(s,S,x);break;case 3:case 4:var b=m.stateNode.containerInfo,J=Zx(s);Np(s,J,b);break;default:throw Error(r(161))}}catch(ne){rr(s,s.return,ne)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function HC(s,l,f){He=s,n_(s)}function n_(s,l,f){for(var m=(s.mode&1)!==0;He!==null;){var x=He,S=x.child;if(x.tag===22&&m){var b=x.memoizedState!==null||ch;if(!b){var J=x.alternate,ne=J!==null&&J.memoizedState!==null||rn;J=ch;var pe=rn;if(ch=b,(rn=ne)&&!pe)for(He=x;He!==null;)b=He,ne=b.child,b.tag===22&&b.memoizedState!==null?s_(x):ne!==null?(ne.return=b,He=ne):s_(x);for(;S!==null;)He=S,n_(S),S=S.sibling;He=x,ch=J,rn=pe}i_(s)}else x.subtreeFlags&8772&&S!==null?(S.return=x,He=S):i_(s)}}function i_(s){for(;He!==null;){var l=He;if(l.flags&8772){var f=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:rn||uh(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!rn)if(f===null)m.componentDidMount();else{var x=l.elementType===l.type?f.memoizedProps:Pi(l.type,f.memoizedProps);m.componentDidUpdate(x,f.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var S=l.updateQueue;S!==null&&ax(l,S,m);break;case 3:var b=l.updateQueue;if(b!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}ax(l,b,f)}break;case 5:var J=l.stateNode;if(f===null&&l.flags&4){f=J;var ne=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&f.focus();break;case"img":ne.src&&(f.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var pe=l.alternate;if(pe!==null){var Re=pe.memoizedState;if(Re!==null){var Oe=Re.dehydrated;Oe!==null&&Ai(Oe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}rn||l.flags&512&&Dp(l)}catch(Ie){rr(l,l.return,Ie)}}if(l===s){He=null;break}if(f=l.sibling,f!==null){f.return=l.return,He=f;break}He=l.return}}function a_(s){for(;He!==null;){var l=He;if(l===s){He=null;break}var f=l.sibling;if(f!==null){f.return=l.return,He=f;break}He=l.return}}function s_(s){for(;He!==null;){var l=He;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{uh(4,l)}catch(ne){rr(l,f,ne)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var x=l.return;try{m.componentDidMount()}catch(ne){rr(l,x,ne)}}var S=l.return;try{Dp(l)}catch(ne){rr(l,S,ne)}break;case 5:var b=l.return;try{Dp(l)}catch(ne){rr(l,b,ne)}}}catch(ne){rr(l,l.return,ne)}if(l===s){He=null;break}var J=l.sibling;if(J!==null){J.return=l.return,He=J;break}He=l.return}}var zC=Math.ceil,fh=B.ReactCurrentDispatcher,Mp=B.ReactCurrentOwner,ui=B.ReactCurrentBatchConfig,Tt=0,Nr=null,pr=null,Hr=0,Xn=0,Fl=gs(0),Ar=0,Yc=null,Eo=0,hh=0,Vp=0,Qc=null,Nn=null,Bp=0,bl=1/0,Na=null,dh=!1,Up=null,ws=null,ph=!1,Ts=null,mh=0,Jc=0,jp=null,gh=-1,vh=0;function En(){return Tt&6?Fe():gh!==-1?gh:gh=Fe()}function Ss(s){return s.mode&1?Tt&2&&Hr!==0?Hr&-Hr:CC.transition!==null?(vh===0&&(vh=lo()),vh):(s=gt,s!==0||(s=window.event,s=s===void 0?16:Ac(s.type)),s):1}function Oi(s,l,f,m){if(50<Jc)throw Jc=0,jp=null,Error(r(185));ls(s,f,m),(!(Tt&2)||s!==Nr)&&(s===Nr&&(!(Tt&2)&&(hh|=f),Ar===4&&ks(s,Hr)),Ln(s,m),f===1&&Tt===0&&!(l.mode&1)&&(bl=Fe()+500,Wf&&xs()))}function Ln(s,l){var f=s.callbackNode;Ta(s,l);var m=oo(s,s===Nr?Hr:0);if(m===0)f!==null&&Le(f),s.callbackNode=null,s.callbackPriority=0;else if(l=m&-m,s.callbackPriority!==l){if(f!=null&&Le(f),l===1)s.tag===0?AC(l_.bind(null,s)):Kv(l_.bind(null,s)),wC(function(){!(Tt&6)&&xs()}),f=null;else{switch(us(m)){case 1:f=It;break;case 4:f=At;break;case 16:f=Dt;break;case 536870912:f=Ki;break;default:f=Dt}f=g_(f,o_.bind(null,s))}s.callbackPriority=l,s.callbackNode=f}}function o_(s,l){if(gh=-1,vh=0,Tt&6)throw Error(r(327));var f=s.callbackNode;if(Ol()&&s.callbackNode!==f)return null;var m=oo(s,s===Nr?Hr:0);if(m===0)return null;if(m&30||m&s.expiredLanes||l)l=xh(s,m);else{l=m;var x=Tt;Tt|=2;var S=u_();(Nr!==s||Hr!==l)&&(Na=null,bl=Fe()+500,To(s,l));do try{KC();break}catch(J){c_(s,J)}while(!0);ap(),fh.current=S,Tt=x,pr!==null?l=0:(Nr=null,Hr=0,l=Ar)}if(l!==0){if(l===2&&(x=zn(s),x!==0&&(m=x,l=$p(s,x))),l===1)throw f=Yc,To(s,0),ks(s,m),Ln(s,Fe()),f;if(l===6)ks(s,m);else{if(x=s.current.alternate,!(m&30)&&!WC(x)&&(l=xh(s,m),l===2&&(S=zn(s),S!==0&&(m=S,l=$p(s,S))),l===1))throw f=Yc,To(s,0),ks(s,m),Ln(s,Fe()),f;switch(s.finishedWork=x,s.finishedLanes=m,l){case 0:case 1:throw Error(r(345));case 2:So(s,Nn,Na);break;case 3:if(ks(s,m),(m&130023424)===m&&(l=Bp+500-Fe(),10<l)){if(oo(s,0)!==0)break;if(x=s.suspendedLanes,(x&m)!==m){En(),s.pingedLanes|=s.suspendedLanes&x;break}s.timeoutHandle=qd(So.bind(null,s,Nn,Na),l);break}So(s,Nn,Na);break;case 4:if(ks(s,m),(m&4194240)===m)break;for(l=s.eventTimes,x=-1;0<m;){var b=31-zt(m);S=1<<b,b=l[b],b>x&&(x=b),m&=~S}if(m=x,m=Fe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*zC(m/1960))-m,10<m){s.timeoutHandle=qd(So.bind(null,s,Nn,Na),m);break}So(s,Nn,Na);break;case 5:So(s,Nn,Na);break;default:throw Error(r(329))}}}return Ln(s,Fe()),s.callbackNode===f?o_.bind(null,s):null}function $p(s,l){var f=Qc;return s.current.memoizedState.isDehydrated&&(To(s,l).flags|=256),s=xh(s,l),s!==2&&(l=Nn,Nn=f,l!==null&&Hp(l)),s}function Hp(s){Nn===null?Nn=s:Nn.push.apply(Nn,s)}function WC(s){for(var l=s;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var m=0;m<f.length;m++){var x=f[m],S=x.getSnapshot;x=x.value;try{if(!Ii(S(),x))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ks(s,l){for(l&=~Vp,l&=~hh,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var f=31-zt(l),m=1<<f;s[f]=-1,l&=~m}}function l_(s){if(Tt&6)throw Error(r(327));Ol();var l=oo(s,0);if(!(l&1))return Ln(s,Fe()),null;var f=xh(s,l);if(s.tag!==0&&f===2){var m=zn(s);m!==0&&(l=m,f=$p(s,m))}if(f===1)throw f=Yc,To(s,0),ks(s,l),Ln(s,Fe()),f;if(f===6)throw Error(r(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,So(s,Nn,Na),Ln(s,Fe()),null}function zp(s,l){var f=Tt;Tt|=1;try{return s(l)}finally{Tt=f,Tt===0&&(bl=Fe()+500,Wf&&xs())}}function wo(s){Ts!==null&&Ts.tag===0&&!(Tt&6)&&Ol();var l=Tt;Tt|=1;var f=ui.transition,m=gt;try{if(ui.transition=null,gt=1,s)return s()}finally{gt=m,ui.transition=f,Tt=l,!(Tt&6)&&xs()}}function Wp(){Xn=Fl.current,Gt(Fl)}function To(s,l){s.finishedWork=null,s.finishedLanes=0;var f=s.timeoutHandle;if(f!==-1&&(s.timeoutHandle=-1,EC(f)),pr!==null)for(f=pr.return;f!==null;){var m=f;switch(ep(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Hf();break;case 3:Il(),Gt(bn),Gt(Zr),dp();break;case 5:fp(m);break;case 4:Il();break;case 13:Gt(Zt);break;case 19:Gt(Zt);break;case 10:sp(m.type._context);break;case 22:case 23:Wp()}f=f.return}if(Nr=s,pr=s=As(s.current,null),Hr=Xn=l,Ar=0,Yc=null,Vp=hh=Eo=0,Nn=Qc=null,xo!==null){for(l=0;l<xo.length;l++)if(f=xo[l],m=f.interleaved,m!==null){f.interleaved=null;var x=m.next,S=f.pending;if(S!==null){var b=S.next;S.next=x,m.next=b}f.pending=m}xo=null}return s}function c_(s,l){do{var f=pr;try{if(ap(),th.current=ah,rh){for(var m=er.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}rh=!1}if(yo=0,Dr=kr=er=null,zc=!1,Wc=0,Mp.current=null,f===null||f.return===null){Ar=1,Yc=l,pr=null;break}e:{var S=s,b=f.return,J=f,ne=l;if(l=Hr,J.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var pe=ne,Re=J,Oe=Re.tag;if(!(Re.mode&1)&&(Oe===0||Oe===11||Oe===15)){var Ie=Re.alternate;Ie?(Re.updateQueue=Ie.updateQueue,Re.memoizedState=Ie.memoizedState,Re.lanes=Ie.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var Ue=Dx(b);if(Ue!==null){Ue.flags&=-257,Nx(Ue,b,J,S,l),Ue.mode&1&&Ox(S,pe,l),l=Ue,ne=pe;var ze=l.updateQueue;if(ze===null){var We=new Set;We.add(ne),l.updateQueue=We}else ze.add(ne);break e}else{if(!(l&1)){Ox(S,pe,l),Gp();break e}ne=Error(r(426))}}else if(Xt&&J.mode&1){var or=Dx(b);if(or!==null){!(or.flags&65536)&&(or.flags|=256),Nx(or,b,J,S,l),np(Rl(ne,J));break e}}S=ne=Rl(ne,J),Ar!==4&&(Ar=2),Qc===null?Qc=[S]:Qc.push(S),S=b;do{switch(S.tag){case 3:S.flags|=65536,l&=-l,S.lanes|=l;var oe=Fx(S,ne,l);ix(S,oe);break e;case 1:J=ne;var ae=S.type,fe=S.stateNode;if(!(S.flags&128)&&(typeof ae.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(ws===null||!ws.has(fe)))){S.flags|=65536,l&=-l,S.lanes|=l;var Ne=bx(S,J,l);ix(S,Ne);break e}}S=S.return}while(S!==null)}h_(f)}catch(Ge){l=Ge,pr===f&&f!==null&&(pr=f=f.return);continue}break}while(!0)}function u_(){var s=fh.current;return fh.current=ah,s===null?ah:s}function Gp(){(Ar===0||Ar===3||Ar===2)&&(Ar=4),Nr===null||!(Eo&268435455)&&!(hh&268435455)||ks(Nr,Hr)}function xh(s,l){var f=Tt;Tt|=2;var m=u_();(Nr!==s||Hr!==l)&&(Na=null,To(s,l));do try{GC();break}catch(x){c_(s,x)}while(!0);if(ap(),Tt=f,fh.current=m,pr!==null)throw Error(r(261));return Nr=null,Hr=0,Ar}function GC(){for(;pr!==null;)f_(pr)}function KC(){for(;pr!==null&&!Be();)f_(pr)}function f_(s){var l=m_(s.alternate,s,Xn);s.memoizedProps=s.pendingProps,l===null?h_(s):pr=l,Mp.current=null}function h_(s){var l=s;do{var f=l.alternate;if(s=l.return,l.flags&32768){if(f=UC(f,l),f!==null){f.flags&=32767,pr=f;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Ar=6,pr=null;return}}else if(f=BC(f,l,Xn),f!==null){pr=f;return}if(l=l.sibling,l!==null){pr=l;return}pr=l=s}while(l!==null);Ar===0&&(Ar=5)}function So(s,l,f){var m=gt,x=ui.transition;try{ui.transition=null,gt=1,qC(s,l,f,m)}finally{ui.transition=x,gt=m}return null}function qC(s,l,f,m){do Ol();while(Ts!==null);if(Tt&6)throw Error(r(327));f=s.finishedWork;var x=s.finishedLanes;if(f===null)return null;if(s.finishedWork=null,s.finishedLanes=0,f===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0;var S=f.lanes|f.childLanes;if(Mt(s,S),s===Nr&&(pr=Nr=null,Hr=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||ph||(ph=!0,g_(Dt,function(){return Ol(),null})),S=(f.flags&15990)!==0,f.subtreeFlags&15990||S){S=ui.transition,ui.transition=null;var b=gt;gt=1;var J=Tt;Tt|=4,Mp.current=null,$C(s,f),r_(f,s),pC(Gd),hs=!!Wd,Gd=Wd=null,s.current=f,HC(f),De(),Tt=J,gt=b,ui.transition=S}else s.current=f;if(ph&&(ph=!1,Ts=s,mh=x),S=s.pendingLanes,S===0&&(ws=null),as(f.stateNode),Ln(s,Fe()),l!==null)for(m=s.onRecoverableError,f=0;f<l.length;f++)x=l[f],m(x.value,{componentStack:x.stack,digest:x.digest});if(dh)throw dh=!1,s=Up,Up=null,s;return mh&1&&s.tag!==0&&Ol(),S=s.pendingLanes,S&1?s===jp?Jc++:(Jc=0,jp=s):Jc=0,xs(),null}function Ol(){if(Ts!==null){var s=us(mh),l=ui.transition,f=gt;try{if(ui.transition=null,gt=16>s?16:s,Ts===null)var m=!1;else{if(s=Ts,Ts=null,mh=0,Tt&6)throw Error(r(331));var x=Tt;for(Tt|=4,He=s.current;He!==null;){var S=He,b=S.child;if(He.flags&16){var J=S.deletions;if(J!==null){for(var ne=0;ne<J.length;ne++){var pe=J[ne];for(He=pe;He!==null;){var Re=He;switch(Re.tag){case 0:case 11:case 15:Xc(8,Re,S)}var Oe=Re.child;if(Oe!==null)Oe.return=Re,He=Oe;else for(;He!==null;){Re=He;var Ie=Re.sibling,Ue=Re.return;if(Qx(Re),Re===pe){He=null;break}if(Ie!==null){Ie.return=Ue,He=Ie;break}He=Ue}}}var ze=S.alternate;if(ze!==null){var We=ze.child;if(We!==null){ze.child=null;do{var or=We.sibling;We.sibling=null,We=or}while(We!==null)}}He=S}}if(S.subtreeFlags&2064&&b!==null)b.return=S,He=b;else e:for(;He!==null;){if(S=He,S.flags&2048)switch(S.tag){case 0:case 11:case 15:Xc(9,S,S.return)}var oe=S.sibling;if(oe!==null){oe.return=S.return,He=oe;break e}He=S.return}}var ae=s.current;for(He=ae;He!==null;){b=He;var fe=b.child;if(b.subtreeFlags&2064&&fe!==null)fe.return=b,He=fe;else e:for(b=ae;He!==null;){if(J=He,J.flags&2048)try{switch(J.tag){case 0:case 11:case 15:uh(9,J)}}catch(Ge){rr(J,J.return,Ge)}if(J===b){He=null;break e}var Ne=J.sibling;if(Ne!==null){Ne.return=J.return,He=Ne;break e}He=J.return}}if(Tt=x,xs(),sr&&typeof sr.onPostCommitFiberRoot=="function")try{sr.onPostCommitFiberRoot(Hn,s)}catch{}m=!0}return m}finally{gt=f,ui.transition=l}}return!1}function d_(s,l,f){l=Rl(f,l),l=Fx(s,l,1),s=ys(s,l,1),l=En(),s!==null&&(ls(s,1,l),Ln(s,l))}function rr(s,l,f){if(s.tag===3)d_(s,s,f);else for(;l!==null;){if(l.tag===3){d_(l,s,f);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ws===null||!ws.has(m))){s=Rl(f,s),s=bx(l,s,1),l=ys(l,s,1),s=En(),l!==null&&(ls(l,1,s),Ln(l,s));break}}l=l.return}}function XC(s,l,f){var m=s.pingCache;m!==null&&m.delete(l),l=En(),s.pingedLanes|=s.suspendedLanes&f,Nr===s&&(Hr&f)===f&&(Ar===4||Ar===3&&(Hr&130023424)===Hr&&500>Fe()-Bp?To(s,0):Vp|=f),Ln(s,l)}function p_(s,l){l===0&&(s.mode&1?(l=rl,rl<<=1,!(rl&130023424)&&(rl=4194304)):l=1);var f=En();s=ba(s,l),s!==null&&(ls(s,l,f),Ln(s,f))}function YC(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),p_(s,f)}function QC(s,l){var f=0;switch(s.tag){case 13:var m=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(l),p_(s,f)}var m_;m_=function(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps||bn.current)Dn=!0;else{if(!(s.lanes&f)&&!(l.flags&128))return Dn=!1,VC(s,l,f);Dn=!!(s.flags&131072)}else Dn=!1,Xt&&l.flags&1048576&&qv(l,Kf,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;lh(s,l),s=l.pendingProps;var x=El(l,Zr.current);Cl(l,f),x=gp(null,l,m,s,x,f);var S=vp();return l.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,On(m)?(S=!0,zf(l)):S=!1,l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,cp(l),x.updater=sh,l.stateNode=x,x._reactInternals=l,Tp(l,m,s,f),l=Cp(null,l,m,!0,S,f)):(l.tag=0,Xt&&S&&Zd(l),yn(null,l,x,f),l=l.child),l;case 16:m=l.elementType;e:{switch(lh(s,l),s=l.pendingProps,x=m._init,m=x(m._payload),l.type=m,x=l.tag=ZC(m),s=Pi(m,s),x){case 0:l=Ap(null,l,m,s,f);break e;case 1:l=jx(null,l,m,s,f);break e;case 11:l=Lx(null,l,m,s,f);break e;case 14:l=Mx(null,l,m,Pi(m.type,s),f);break e}throw Error(r(306,m,""))}return l;case 0:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),Ap(s,l,m,x,f);case 1:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),jx(s,l,m,x,f);case 3:e:{if($x(l),s===null)throw Error(r(387));m=l.pendingProps,S=l.memoizedState,x=S.element,nx(s,l),Zf(l,m,null,f);var b=l.memoizedState;if(m=b.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){x=Rl(Error(r(423)),l),l=Hx(s,l,m,f,x);break e}else if(m!==x){x=Rl(Error(r(424)),l),l=Hx(s,l,m,f,x);break e}else for(qn=ms(l.stateNode.containerInfo.firstChild),Kn=l,Xt=!0,Ri=null,f=tx(l,null,m,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Sl(),m===x){l=Da(s,l,f);break e}yn(s,l,m,f)}l=l.child}return l;case 5:return sx(l),s===null&&rp(l),m=l.type,x=l.pendingProps,S=s!==null?s.memoizedProps:null,b=x.children,Kd(m,x)?b=null:S!==null&&Kd(m,S)&&(l.flags|=32),Ux(s,l),yn(s,l,b,f),l.child;case 6:return s===null&&rp(l),null;case 13:return zx(s,l,f);case 4:return up(l,l.stateNode.containerInfo),m=l.pendingProps,s===null?l.child=kl(l,null,m,f):yn(s,l,m,f),l.child;case 11:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),Lx(s,l,m,x,f);case 7:return yn(s,l,l.pendingProps,f),l.child;case 8:return yn(s,l,l.pendingProps.children,f),l.child;case 12:return yn(s,l,l.pendingProps.children,f),l.child;case 10:e:{if(m=l.type._context,x=l.pendingProps,S=l.memoizedProps,b=x.value,Bt(Yf,m._currentValue),m._currentValue=b,S!==null)if(Ii(S.value,b)){if(S.children===x.children&&!bn.current){l=Da(s,l,f);break e}}else for(S=l.child,S!==null&&(S.return=l);S!==null;){var J=S.dependencies;if(J!==null){b=S.child;for(var ne=J.firstContext;ne!==null;){if(ne.context===m){if(S.tag===1){ne=Oa(-1,f&-f),ne.tag=2;var pe=S.updateQueue;if(pe!==null){pe=pe.shared;var Re=pe.pending;Re===null?ne.next=ne:(ne.next=Re.next,Re.next=ne),pe.pending=ne}}S.lanes|=f,ne=S.alternate,ne!==null&&(ne.lanes|=f),op(S.return,f,l),J.lanes|=f;break}ne=ne.next}}else if(S.tag===10)b=S.type===l.type?null:S.child;else if(S.tag===18){if(b=S.return,b===null)throw Error(r(341));b.lanes|=f,J=b.alternate,J!==null&&(J.lanes|=f),op(b,f,l),b=S.sibling}else b=S.child;if(b!==null)b.return=S;else for(b=S;b!==null;){if(b===l){b=null;break}if(S=b.sibling,S!==null){S.return=b.return,b=S;break}b=b.return}S=b}yn(s,l,x.children,f),l=l.child}return l;case 9:return x=l.type,m=l.pendingProps.children,Cl(l,f),x=li(x),m=m(x),l.flags|=1,yn(s,l,m,f),l.child;case 14:return m=l.type,x=Pi(m,l.pendingProps),x=Pi(m.type,x),Mx(s,l,m,x,f);case 15:return Vx(s,l,l.type,l.pendingProps,f);case 17:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),lh(s,l),l.tag=1,On(m)?(s=!0,zf(l)):s=!1,Cl(l,f),Rx(l,m,x),Tp(l,m,x,f),Cp(null,l,m,!0,s,f);case 19:return Gx(s,l,f);case 22:return Bx(s,l,f)}throw Error(r(156,l.tag))};function g_(s,l){return Pe(s,l)}function JC(s,l,f,m){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(s,l,f,m){return new JC(s,l,f,m)}function Kp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ZC(s){if(typeof s=="function")return Kp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===N)return 11;if(s===Ee)return 14}return 2}function As(s,l){var f=s.alternate;return f===null?(f=fi(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&14680064,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f}function _h(s,l,f,m,x,S){var b=2;if(m=s,typeof s=="function")Kp(s)&&(b=1);else if(typeof s=="string")b=5;else e:switch(s){case A:return ko(f.children,x,S,l);case R:b=8,x|=8;break;case P:return s=fi(12,f,l,x|2),s.elementType=P,s.lanes=S,s;case U:return s=fi(13,f,l,x),s.elementType=U,s.lanes=S,s;case be:return s=fi(19,f,l,x),s.elementType=be,s.lanes=S,s;case Te:return yh(f,x,S,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case L:b=10;break e;case M:b=9;break e;case N:b=11;break e;case Ee:b=14;break e;case Ce:b=16,m=null;break e}throw Error(r(130,s==null?s:typeof s,""))}return l=fi(b,f,l,x),l.elementType=s,l.type=m,l.lanes=S,l}function ko(s,l,f,m){return s=fi(7,s,m,l),s.lanes=f,s}function yh(s,l,f,m){return s=fi(22,s,m,l),s.elementType=Te,s.lanes=f,s.stateNode={isHidden:!1},s}function qp(s,l,f){return s=fi(6,s,null,l),s.lanes=f,s}function Xp(s,l,f){return l=fi(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function eI(s,l,f,m,x){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=os(0),this.expirationTimes=os(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=os(0),this.identifierPrefix=m,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function Yp(s,l,f,m,x,S,b,J,ne){return s=new eI(s,l,f,J,ne),l===1?(l=1,S===!0&&(l|=8)):l=0,S=fi(3,null,null,l),s.current=S,S.stateNode=s,S.memoizedState={element:m,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},cp(S),s}function tI(s,l,f){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:m==null?null:""+m,children:s,containerInfo:l,implementation:f}}function v_(s){if(!s)return vs;s=s._reactInternals;e:{if(X(s)!==s||s.tag!==1)throw Error(r(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(On(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(s.tag===1){var f=s.type;if(On(f))return Wv(s,f,l)}return l}function x_(s,l,f,m,x,S,b,J,ne){return s=Yp(f,m,!0,s,x,S,b,J,ne),s.context=v_(null),f=s.current,m=En(),x=Ss(f),S=Oa(m,x),S.callback=l??null,ys(f,S,x),s.current.lanes=x,ls(s,x,m),Ln(s,m),s}function Eh(s,l,f,m){var x=l.current,S=En(),b=Ss(x);return f=v_(f),l.context===null?l.context=f:l.pendingContext=f,l=Oa(S,b),l.payload={element:s},m=m===void 0?null:m,m!==null&&(l.callback=m),s=ys(x,l,b),s!==null&&(Oi(s,x,b,S),Jf(s,x,b)),b}function wh(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function __(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function Qp(s,l){__(s,l),(s=s.alternate)&&__(s,l)}var y_=typeof reportError=="function"?reportError:function(s){console.error(s)};function Jp(s){this._internalRoot=s}Th.prototype.render=Jp.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));Eh(s,l,null,null)},Th.prototype.unmount=Jp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;wo(function(){Eh(null,s,null,null)}),l[Ia]=null}};function Th(s){this._internalRoot=s}Th.prototype.unstable_scheduleHydration=function(s){if(s){var l=Tf();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Xi.length&&l!==0&&l<Xi[f].priority;f++);Xi.splice(f,0,s),f===0&&Af(s)}};function Zp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Sh(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function E_(){}function rI(s,l,f,m,x){if(x){if(typeof m=="function"){var S=m;m=function(){var pe=wh(b);S.call(pe)}}var b=x_(l,m,s,0,null,!1,!1,"",E_);return s._reactRootContainer=b,s[Ia]=b.current,Lc(s.nodeType===8?s.parentNode:s),wo(),b}for(;x=s.lastChild;)s.removeChild(x);if(typeof m=="function"){var J=m;m=function(){var pe=wh(ne);J.call(pe)}}var ne=Yp(s,0,!1,null,null,!1,!1,"",E_);return s._reactRootContainer=ne,s[Ia]=ne.current,Lc(s.nodeType===8?s.parentNode:s),wo(function(){Eh(l,ne,f,m)}),ne}function kh(s,l,f,m,x){var S=f._reactRootContainer;if(S){var b=S;if(typeof x=="function"){var J=x;x=function(){var ne=wh(b);J.call(ne)}}Eh(l,b,s,x)}else b=rI(f,l,s,x,m);return wh(b)}Ef=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var f=ss(l.pendingLanes);f!==0&&(cs(l,f|1),Ln(l,Fe()),!(Tt&6)&&(bl=Fe()+500,xs()))}break;case 13:wo(function(){var m=ba(s,1);if(m!==null){var x=En();Oi(m,s,1,x)}}),Qp(s,1)}},nl=function(s){if(s.tag===13){var l=ba(s,134217728);if(l!==null){var f=En();Oi(l,s,134217728,f)}Qp(s,134217728)}},wf=function(s){if(s.tag===13){var l=Ss(s),f=ba(s,l);if(f!==null){var m=En();Oi(f,s,l,m)}Qp(s,l)}},Tf=function(){return gt},Sf=function(s,l){var f=gt;try{return gt=s,l()}finally{gt=f}},_a=function(s,l,f){switch(l){case"input":if(Ve(s,f),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var m=f[l];if(m!==s&&m.form===s.form){var x=$f(m);if(!x)throw Error(r(90));Y(m),Ve(m,x)}}}break;case"textarea":fr(s,f);break;case"select":l=f.value,l!=null&&Tr(s,!!f.multiple,l,!1)}},ya=zp,ao=wo;var nI={usingClientEntryPoint:!1,Events:[Bc,_l,$f,ni,io,zp]},Zc={findFiberByHostInstance:po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iI={bundleType:Zc.bundleType,version:Zc.version,rendererPackageName:Zc.rendererPackageName,rendererConfig:Zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=he(s),s===null?null:s.stateNode},findFiberByHostInstance:Zc.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ah.isDisabled&&Ah.supportsFiber)try{Hn=Ah.inject(iI),sr=Ah}catch{}}return Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nI,Mn.createPortal=function(s,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zp(l))throw Error(r(200));return tI(s,l,null,f)},Mn.createRoot=function(s,l){if(!Zp(s))throw Error(r(299));var f=!1,m="",x=y_;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(x=l.onRecoverableError)),l=Yp(s,1,!1,null,null,f,!1,m,x),s[Ia]=l.current,Lc(s.nodeType===8?s.parentNode:s),new Jp(l)},Mn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=he(l),s=s===null?null:s.stateNode,s},Mn.flushSync=function(s){return wo(s)},Mn.hydrate=function(s,l,f){if(!Sh(l))throw Error(r(200));return kh(null,s,l,!0,f)},Mn.hydrateRoot=function(s,l,f){if(!Zp(s))throw Error(r(405));var m=f!=null&&f.hydratedSources||null,x=!1,S="",b=y_;if(f!=null&&(f.unstable_strictMode===!0&&(x=!0),f.identifierPrefix!==void 0&&(S=f.identifierPrefix),f.onRecoverableError!==void 0&&(b=f.onRecoverableError)),l=x_(l,null,s,1,f??null,x,!1,S,b),s[Ia]=l.current,Lc(s),m)for(s=0;s<m.length;s++)f=m[s],x=f._getVersion,x=x(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,x]:l.mutableSourceEagerHydrationData.push(f,x);return new Th(l)},Mn.render=function(s,l,f){if(!Sh(l))throw Error(r(200));return kh(null,s,l,!1,f)},Mn.unmountComponentAtNode=function(s){if(!Sh(s))throw Error(r(40));return s._reactRootContainer?(wo(function(){kh(null,null,s,!1,function(){s._reactRootContainer=null,s[Ia]=null})}),!0):!1},Mn.unstable_batchedUpdates=zp,Mn.unstable_renderSubtreeIntoContainer=function(s,l,f,m){if(!Sh(f))throw Error(r(200));if(s==null||s._reactInternals===void 0)throw Error(r(38));return kh(s,l,f,!1,m)},Mn.version="18.3.1-next-f1338f8080-20240426",Mn}var P_;function zw(){if(P_)return rm.exports;P_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),rm.exports=dI(),rm.exports}var F_;function pI(){if(F_)return Ch;F_=1;var t=zw();return Ch.createRoot=t.createRoot,Ch.hydrateRoot=t.hydrateRoot,Ch}var mI=pI(),tu={},b_;function gI(){if(b_)return tu;b_=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.parse=o,tu.serialize=h;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,a=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,y){const E=new a,_=v.length;if(_<2)return E;const w=(y==null?void 0:y.decode)||d;let k=0;do{const F=v.indexOf("=",k);if(F===-1)break;const C=v.indexOf(";",k),B=C===-1?_:C;if(F>B){k=v.lastIndexOf(";",F-1)+1;continue}const V=c(v,k,F),z=u(v,F,V),A=v.slice(V,z);if(E[A]===void 0){let R=c(v,F+1,B),P=u(v,B,R);const L=w(v.slice(R,P));E[A]=L}k=B+1}while(k<_);return E}function c(v,y,E){do{const _=v.charCodeAt(y);if(_!==32&&_!==9)return y}while(++y<E);return E}function u(v,y,E){for(;y>E;){const _=v.charCodeAt(--y);if(_!==32&&_!==9)return y+1}return E}function h(v,y,E){const _=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(v))throw new TypeError(`argument name is invalid: ${v}`);const w=_(y);if(!e.test(w))throw new TypeError(`argument val is invalid: ${y}`);let k=v+"="+w;if(!E)return k;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);k+="; Max-Age="+E.maxAge}if(E.domain){if(!r.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);k+="; Domain="+E.domain}if(E.path){if(!n.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);k+="; Path="+E.path}if(E.expires){if(!g(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);k+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(k+="; HttpOnly"),E.secure&&(k+="; Secure"),E.partitioned&&(k+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return k}function d(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function g(v){return i.call(v)==="[object Date]"}return tu}gI();/**
 * react-router v7.1.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var O_="popstate";function vI(t={}){function e(n,i){let{pathname:a,search:o,hash:c}=n.location;return Vm("",{pathname:a,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Iu(i)}return _I(e,r,null,t)}function Qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ji(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xI(){return Math.random().toString(36).substring(2,10)}function D_(t,e){return{usr:t.state,key:t.key,idx:e}}function Vm(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?uc(e):e,state:r,key:e&&e.key||n||xI()}}function Iu({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function uc(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function _I(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,c="POP",u=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function g(){c="POP";let w=d(),k=w==null?null:w-h;h=w,u&&u({action:c,location:_.location,delta:k})}function v(w,k){c="PUSH";let F=Vm(_.location,w,k);h=d()+1;let C=D_(F,h),B=_.createHref(F);try{o.pushState(C,"",B)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;i.location.assign(B)}a&&u&&u({action:c,location:_.location,delta:1})}function y(w,k){c="REPLACE";let F=Vm(_.location,w,k);h=d();let C=D_(F,h),B=_.createHref(F);o.replaceState(C,"",B),a&&u&&u({action:c,location:_.location,delta:0})}function E(w){let k=i.location.origin!=="null"?i.location.origin:i.location.href,F=typeof w=="string"?w:Iu(w);return F=F.replace(/ $/,"%20"),Qt(k,`No window.location.(origin|href) available to create URL for href: ${F}`),new URL(F,k)}let _={get action(){return c},get location(){return t(i,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(O_,g),u=w,()=>{i.removeEventListener(O_,g),u=null}},createHref(w){return e(i,w)},createURL:E,encodeLocation(w){let k=E(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:v,replace:y,go(w){return o.go(w)}};return _}function Ww(t,e,r="/"){return yI(t,e,r,!1)}function yI(t,e,r,n){let i=typeof e=="string"?uc(e):e,a=zs(i.pathname||"/",r);if(a==null)return null;let o=Gw(t);EI(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let h=bI(a);c=PI(o[u],h,n)}return c}function Gw(t,e=[],r=[],n=""){let i=(a,o,c)=>{let u={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(Qt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let h=ja([n,u.relativePath]),d=r.concat(u);a.children&&a.children.length>0&&(Qt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Gw(a.children,e,d,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:II(h,a.index),routesMeta:d})};return t.forEach((a,o)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,o);else for(let u of Kw(a.path))i(a,o,u)}),e}function Kw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=Kw(n.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function EI(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:RI(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var wI=/^:[\w-]+$/,TI=3,SI=2,kI=1,AI=10,CI=-2,N_=t=>t==="*";function II(t,e){let r=t.split("/"),n=r.length;return r.some(N_)&&(n+=CI),e&&(n+=SI),r.filter(i=>!N_(i)).reduce((i,a)=>i+(wI.test(a)?TI:a===""?kI:AI),n)}function RI(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function PI(t,e,r=!1){let{routesMeta:n}=t,i={},a="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],h=c===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",g=f0({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),v=u.route;if(!g&&h&&r&&!n[n.length-1].route.index&&(g=f0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!g)return null;Object.assign(i,g.params),o.push({params:i,pathname:ja([a,g.pathname]),pathnameBase:LI(ja([a,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(a=ja([a,g.pathnameBase]))}return o}function f0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=FI(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((h,{paramName:d,isOptional:g},v)=>{if(d==="*"){let E=c[v]||"";o=a.slice(0,a.length-E.length).replace(/(.)\/+$/,"$1")}const y=c[v];return g&&!y?h[d]=void 0:h[d]=(y||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:o,pattern:t}}function FI(t,e=!1,r=!0){ji(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function bI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ji(!1,`The URL path "${t}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function zs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function OI(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?uc(t):t;return{pathname:r?r.startsWith("/")?r:DI(r,e):e,search:MI(n),hash:VI(i)}}function DI(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function am(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function NI(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Fg(t){let e=NI(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function bg(t,e,r,n=!1){let i;typeof t=="string"?i=uc(t):(i={...t},Qt(!i.pathname||!i.pathname.includes("?"),am("?","pathname","search",i)),Qt(!i.pathname||!i.pathname.includes("#"),am("#","pathname","hash",i)),Qt(!i.search||!i.search.includes("#"),am("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=r;else{let g=e.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),g-=1;i.pathname=v.join("/")}c=g>=0?e[g]:"/"}let u=OI(i,c),h=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||d)&&(u.pathname+="/"),u}var ja=t=>t.join("/").replace(/\/\/+/g,"/"),LI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),MI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,VI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function BI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var qw=["POST","PUT","PATCH","DELETE"];new Set(qw);var UI=["GET",...qw];new Set(UI);var fc=G.createContext(null);fc.displayName="DataRouter";var Y0=G.createContext(null);Y0.displayName="DataRouterState";var Xw=G.createContext({isTransitioning:!1});Xw.displayName="ViewTransition";var jI=G.createContext(new Map);jI.displayName="Fetchers";var $I=G.createContext(null);$I.displayName="Await";var Hi=G.createContext(null);Hi.displayName="Navigation";var Ku=G.createContext(null);Ku.displayName="Location";var zi=G.createContext({outlet:null,matches:[],isDataRoute:!1});zi.displayName="Route";var Og=G.createContext(null);Og.displayName="RouteError";function HI(t,{relative:e}={}){Qt(hc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=G.useContext(Hi),{hash:i,pathname:a,search:o}=qu(t,{relative:e}),c=a;return r!=="/"&&(c=a==="/"?r:ja([r,a])),n.createHref({pathname:c,search:o,hash:i})}function hc(){return G.useContext(Ku)!=null}function ma(){return Qt(hc(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(Ku).location}var Yw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Qw(t){G.useContext(Hi).static||G.useLayoutEffect(t)}function Dg(){let{isDataRoute:t}=G.useContext(zi);return t?nR():zI()}function zI(){Qt(hc(),"useNavigate() may be used only in the context of a <Router> component.");let t=G.useContext(fc),{basename:e,navigator:r}=G.useContext(Hi),{matches:n}=G.useContext(zi),{pathname:i}=ma(),a=JSON.stringify(Fg(n)),o=G.useRef(!1);return Qw(()=>{o.current=!0}),G.useCallback((u,h={})=>{if(ji(o.current,Yw),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=bg(u,JSON.parse(a),i,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ja([e,d.pathname])),(h.replace?r.replace:r.push)(d,h.state,h)},[e,r,a,i,t])}G.createContext(null);function WI(){let{matches:t}=G.useContext(zi),e=t[t.length-1];return e?e.params:{}}function qu(t,{relative:e}={}){let{matches:r}=G.useContext(zi),{pathname:n}=ma(),i=JSON.stringify(Fg(r));return G.useMemo(()=>bg(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function GI(t,e){return Jw(t,e)}function Jw(t,e,r,n){var k;Qt(hc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=G.useContext(Hi),{matches:a}=G.useContext(zi),o=a[a.length-1],c=o?o.params:{},u=o?o.pathname:"/",h=o?o.pathnameBase:"/",d=o&&o.route;{let F=d&&d.path||"";Zw(u,!d||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let g=ma(),v;if(e){let F=typeof e=="string"?uc(e):e;Qt(h==="/"||((k=F.pathname)==null?void 0:k.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${F.pathname}" was given in the \`location\` prop.`),v=F}else v=g;let y=v.pathname||"/",E=y;if(h!=="/"){let F=h.replace(/^\//,"").split("/");E="/"+y.replace(/^\//,"").split("/").slice(F.length).join("/")}let _=Ww(t,{pathname:E});ji(d||_!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ji(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=QI(_&&_.map(F=>Object.assign({},F,{params:Object.assign({},c,F.params),pathname:ja([h,i.encodeLocation?i.encodeLocation(F.pathname).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?h:ja([h,i.encodeLocation?i.encodeLocation(F.pathnameBase).pathname:F.pathnameBase])})),a,r,n);return e&&w?G.createElement(Ku.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},w):w}function KI(){let t=rR(),e=BI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=G.createElement(G.Fragment,null,G.createElement("p",null," Hey developer "),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:a},"ErrorBoundary")," or"," ",G.createElement("code",{style:a},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),r?G.createElement("pre",{style:i},r):null,o)}var qI=G.createElement(KI,null),XI=class extends G.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?G.createElement(zi.Provider,{value:this.props.routeContext},G.createElement(Og.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function YI({routeContext:t,match:e,children:r}){let n=G.useContext(fc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),G.createElement(zi.Provider,{value:t},r)}function QI(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,a=r==null?void 0:r.errors;if(a!=null){let u=i.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);Qt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let o=!1,c=-1;if(r)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:g}=r,v=h.route.loader&&!d.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||v){o=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,h,d)=>{let g,v=!1,y=null,E=null;r&&(g=a&&h.route.id?a[h.route.id]:void 0,y=h.route.errorElement||qI,o&&(c<0&&d===0?(Zw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,E=null):c===d&&(v=!0,E=h.route.hydrateFallbackElement||null)));let _=e.concat(i.slice(0,d+1)),w=()=>{let k;return g?k=y:v?k=E:h.route.Component?k=G.createElement(h.route.Component,null):h.route.element?k=h.route.element:k=u,G.createElement(YI,{match:h,routeContext:{outlet:u,matches:_,isDataRoute:r!=null},children:k})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?G.createElement(XI,{location:r.location,revalidation:r.revalidation,component:y,error:g,children:w(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):w()},null)}function Ng(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function JI(t){let e=G.useContext(fc);return Qt(e,Ng(t)),e}function ZI(t){let e=G.useContext(Y0);return Qt(e,Ng(t)),e}function eR(t){let e=G.useContext(zi);return Qt(e,Ng(t)),e}function Lg(t){let e=eR(t),r=e.matches[e.matches.length-1];return Qt(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function tR(){return Lg("useRouteId")}function rR(){var n;let t=G.useContext(Og),e=ZI("useRouteError"),r=Lg("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function nR(){let{router:t}=JI("useNavigate"),e=Lg("useNavigate"),r=G.useRef(!1);return Qw(()=>{r.current=!0}),G.useCallback(async(i,a={})=>{ji(r.current,Yw),r.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var L_={};function Zw(t,e,r){!e&&!L_[t]&&(L_[t]=!0,ji(!1,r))}G.memo(iR);function iR({routes:t,future:e,state:r}){return Jw(t,void 0,r,e)}function eT({to:t,replace:e,state:r,relative:n}){Qt(hc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=G.useContext(Hi);ji(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=G.useContext(zi),{pathname:o}=ma(),c=Dg(),u=bg(t,Fg(a),o,n==="path"),h=JSON.stringify(u);return G.useEffect(()=>{c(JSON.parse(h),{replace:e,state:r,relative:n})},[c,h,n,e,r]),null}function zr(t){Qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:a=!1}){Qt(!hc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof r=="string"&&(r=uc(r));let{pathname:u="/",search:h="",hash:d="",state:g=null,key:v="default"}=r,y=G.useMemo(()=>{let E=zs(u,o);return E==null?null:{location:{pathname:E,search:h,hash:d,state:g,key:v},navigationType:n}},[o,u,h,d,g,v,n]);return ji(y!=null,`<Router basename="${o}"> is not able to match the URL "${u}${h}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:G.createElement(Hi.Provider,{value:c},G.createElement(Ku.Provider,{children:e,value:y}))}function sR({children:t,location:e}){return GI(Bm(t),e)}function Bm(t,e=[]){let r=[];return G.Children.forEach(t,(n,i)=>{if(!G.isValidElement(n))return;let a=[...e,i];if(n.type===G.Fragment){r.push.apply(r,Bm(n.props.children,a));return}Qt(n.type===zr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Bm(n.props.children,a)),r.push(o)}),r}var Xh="get",Yh="application/x-www-form-urlencoded";function Q0(t){return t!=null&&typeof t.tagName=="string"}function oR(t){return Q0(t)&&t.tagName.toLowerCase()==="button"}function lR(t){return Q0(t)&&t.tagName.toLowerCase()==="form"}function cR(t){return Q0(t)&&t.tagName.toLowerCase()==="input"}function uR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function fR(t,e){return t.button===0&&(!e||e==="_self")&&!uR(t)}var Ih=null;function hR(){if(Ih===null)try{new FormData(document.createElement("form"),0),Ih=!1}catch{Ih=!0}return Ih}var dR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sm(t){return t!=null&&!dR.has(t)?(ji(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yh}"`),null):t}function pR(t,e){let r,n,i,a,o;if(lR(t)){let c=t.getAttribute("action");n=c?zs(c,e):null,r=t.getAttribute("method")||Xh,i=sm(t.getAttribute("enctype"))||Yh,a=new FormData(t)}else if(oR(t)||cR(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(n=u?zs(u,e):null,r=t.getAttribute("formmethod")||c.getAttribute("method")||Xh,i=sm(t.getAttribute("formenctype"))||sm(c.getAttribute("enctype"))||Yh,a=new FormData(c,t),!hR()){let{name:h,type:d,value:g}=t;if(d==="image"){let v=h?`${h}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else h&&a.append(h,g)}}else{if(Q0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Xh,n=null,i=Yh,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:o}}function Mg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function mR(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function vR(t,e,r){let n=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await mR(a,r);return o.links?o.links():[]}return[]}));return ER(n.flat(1).filter(gR).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function M_(t,e,r,n,i,a){let o=(u,h)=>r[h]?u.route.id!==r[h].route.id:!0,c=(u,h)=>{var d;return r[h].pathname!==u.pathname||((d=r[h].route.path)==null?void 0:d.endsWith("*"))&&r[h].params["*"]!==u.params["*"]};return a==="assets"?e.filter((u,h)=>o(u,h)||c(u,h)):a==="data"?e.filter((u,h)=>{var g;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,h)||c(u,h))return!0;if(u.route.shouldRevalidate){let v=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function xR(t,e){return _R(t.map(r=>{let n=e.routes[r.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function _R(t){return[...new Set(t)]}function yR(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function ER(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let a=JSON.stringify(yR(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}function wR(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function TR(){let t=G.useContext(fc);return Mg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function SR(){let t=G.useContext(Y0);return Mg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Vg=G.createContext(void 0);Vg.displayName="FrameworkContext";function tT(){let t=G.useContext(Vg);return Mg(t,"You must render this element inside a <HydratedRouter> element"),t}function kR(t,e){let r=G.useContext(Vg),[n,i]=G.useState(!1),[a,o]=G.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:h,onMouseLeave:d,onTouchStart:g}=e,v=G.useRef(null);G.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let _=k=>{k.forEach(F=>{o(F.isIntersecting)})},w=new IntersectionObserver(_,{threshold:.5});return v.current&&w.observe(v.current),()=>{w.disconnect()}}},[t]),G.useEffect(()=>{if(n){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[n]);let y=()=>{i(!0)},E=()=>{i(!1),o(!1)};return r?t!=="intent"?[a,v,{}]:[a,v,{onFocus:ru(c,y),onBlur:ru(u,E),onMouseEnter:ru(h,y),onMouseLeave:ru(d,E),onTouchStart:ru(g,y)}]:[!1,v,{}]}function ru(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function AR({page:t,...e}){let{router:r}=TR(),n=G.useMemo(()=>Ww(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?G.createElement(IR,{page:t,matches:n,...e}):null}function CR(t){let{manifest:e,routeModules:r}=tT(),[n,i]=G.useState([]);return G.useEffect(()=>{let a=!1;return vR(t,e,r).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,r]),n}function IR({page:t,matches:e,...r}){let n=ma(),{manifest:i,routeModules:a}=tT(),{loaderData:o,matches:c}=SR(),u=G.useMemo(()=>M_(t,e,c,i,n,"data"),[t,e,c,i,n]),h=G.useMemo(()=>M_(t,e,c,i,n,"assets"),[t,e,c,i,n]),d=G.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let y=new Set,E=!1;if(e.forEach(w=>{var F;let k=i.routes[w.route.id];!k||!k.hasLoader||(!u.some(C=>C.route.id===w.route.id)&&w.route.id in o&&((F=a[w.route.id])!=null&&F.shouldRevalidate)||k.hasClientLoader?E=!0:y.add(w.route.id))}),y.size===0)return[];let _=wR(t);return E&&y.size>0&&_.searchParams.set("_routes",e.filter(w=>y.has(w.route.id)).map(w=>w.route.id).join(",")),[_.pathname+_.search]},[o,n,i,u,e,t,a]),g=G.useMemo(()=>xR(h,i),[h,i]),v=CR(h);return G.createElement(G.Fragment,null,d.map(y=>G.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...r})),g.map(y=>G.createElement("link",{key:y,rel:"modulepreload",href:y,...r})),v.map(({key:y,link:E})=>G.createElement("link",{key:y,...E})))}function RR(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var rT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rT&&(window.__reactRouterVersion="7.1.1")}catch{}function PR({basename:t,children:e,window:r}){let n=G.useRef();n.current==null&&(n.current=vI({window:r,v5Compat:!0}));let i=n.current,[a,o]=G.useState({action:i.action,location:i.location}),c=G.useCallback(u=>{G.startTransition(()=>o(u))},[o]);return G.useLayoutEffect(()=>i.listen(c),[i,c]),G.createElement(aR,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var nT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$o=G.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:h,preventScrollReset:d,viewTransition:g,...v},y){let{basename:E}=G.useContext(Hi),_=typeof h=="string"&&nT.test(h),w,k=!1;if(typeof h=="string"&&_&&(w=h,rT))try{let P=new URL(window.location.href),L=h.startsWith("//")?new URL(P.protocol+h):new URL(h),M=zs(L.pathname,E);L.origin===P.origin&&M!=null?h=M+L.search+L.hash:k=!0}catch{ji(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let F=HI(h,{relative:i}),[C,B,V]=kR(n,v),z=DR(h,{replace:o,state:c,target:u,preventScrollReset:d,relative:i,viewTransition:g});function A(P){e&&e(P),P.defaultPrevented||z(P)}let R=G.createElement("a",{...v,...V,href:w||F,onClick:k||a?e:A,ref:RR(y,B),target:u,"data-discover":!_&&r==="render"?"true":void 0});return C&&!_?G.createElement(G.Fragment,null,R,G.createElement(AR,{page:F})):R});$o.displayName="Link";var FR=G.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...h},d){let g=qu(o,{relative:h.relative}),v=ma(),y=G.useContext(Y0),{navigator:E,basename:_}=G.useContext(Hi),w=y!=null&&BR(g)&&c===!0,k=E.encodeLocation?E.encodeLocation(g).pathname:g.pathname,F=v.pathname,C=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(F=F.toLowerCase(),C=C?C.toLowerCase():null,k=k.toLowerCase()),C&&_&&(C=zs(C,_)||C);const B=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let V=F===k||!i&&F.startsWith(k)&&F.charAt(B)==="/",z=C!=null&&(C===k||!i&&C.startsWith(k)&&C.charAt(k.length)==="/"),A={isActive:V,isPending:z,isTransitioning:w},R=V?e:void 0,P;typeof n=="function"?P=n(A):P=[n,V?"active":null,z?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let L=typeof a=="function"?a(A):a;return G.createElement($o,{...h,"aria-current":R,className:P,ref:d,style:L,to:o,viewTransition:c},typeof u=="function"?u(A):u)});FR.displayName="NavLink";var bR=G.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:a,method:o=Xh,action:c,onSubmit:u,relative:h,preventScrollReset:d,viewTransition:g,...v},y)=>{let E=MR(),_=VR(c,{relative:h}),w=o.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&nT.test(c),F=C=>{if(u&&u(C),C.defaultPrevented)return;C.preventDefault();let B=C.nativeEvent.submitter,V=(B==null?void 0:B.getAttribute("formmethod"))||o;E(B||C.currentTarget,{fetcherKey:e,method:V,navigate:r,replace:i,state:a,relative:h,preventScrollReset:d,viewTransition:g})};return G.createElement("form",{ref:y,method:w,action:_,onSubmit:n?u:F,...v,"data-discover":!k&&t==="render"?"true":void 0})});bR.displayName="Form";function OR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iT(t){let e=G.useContext(fc);return Qt(e,OR(t)),e}function DR(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:o}={}){let c=Dg(),u=ma(),h=qu(t,{relative:a});return G.useCallback(d=>{if(fR(d,e)){d.preventDefault();let g=r!==void 0?r:Iu(u)===Iu(h);c(t,{replace:g,state:n,preventScrollReset:i,relative:a,viewTransition:o})}},[u,c,h,r,n,e,t,i,a,o])}var NR=0,LR=()=>`__${String(++NR)}__`;function MR(){let{router:t}=iT("useSubmit"),{basename:e}=G.useContext(Hi),r=tR();return G.useCallback(async(n,i={})=>{let{action:a,method:o,encType:c,formData:u,body:h}=pR(n,e);if(i.navigate===!1){let d=i.fetcherKey||LR();await t.fetch(d,r,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:h,formMethod:i.method||o,formEncType:i.encType||c,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:h,formMethod:i.method||o,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,r])}function VR(t,{relative:e}={}){let{basename:r}=G.useContext(Hi),n=G.useContext(zi);Qt(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...qu(t||".",{relative:e})},o=ma();if(t==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(d=>d==="")){c.delete("index"),u.filter(g=>g).forEach(g=>c.append("index",g));let d=c.toString();a.search=d?`?${d}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:ja([r,a.pathname])),Iu(a)}function BR(t,e={}){let r=G.useContext(Xw);Qt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=iT("useViewTransitionState"),i=qu(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=zs(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=zs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return f0(i.pathname,o)!=null||f0(i.pathname,a)!=null}new TextEncoder;var UR=zw();const jR="modulepreload",$R=function(t){return"/learntrackcenter/"+t},V_={},Wi=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(u=>{if(u=$R(u),u in V_)return;V_[u]=!0;const h=u.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":jR,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((v,y)=>{g.addEventListener("load",v),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var B_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},HR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],c=t[r++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},sT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,d=a>>2,g=(a&3)<<4|c>>4;let v=(c&15)<<2|h>>6,y=h&63;u||(y=64,o||(v=64)),n.push(r[d],r[g],r[v],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const g=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||c==null||h==null||g==null)throw new zR;const v=a<<2|c>>4;if(n.push(v),h!==64){const y=c<<4&240|h>>2;if(n.push(y),g!==64){const E=h<<6&192|g;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class zR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const WR=function(t){const e=aT(t);return sT.encodeByteArray(e,!0)},h0=function(t){return WR(t).replace(/\./g,"")},oT=function(t){try{return sT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR=()=>GR().__FIREBASE_DEFAULTS__,qR=()=>{if(typeof process>"u"||typeof B_>"u")return;const t=B_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},XR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&oT(t[1]);return e&&JSON.parse(e)},J0=()=>{try{return KR()||qR()||XR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},lT=t=>{var e,r;return(r=(e=J0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},YR=t=>{const e=lT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},cT=()=>{var t;return(t=J0())===null||t===void 0?void 0:t.config},uT=t=>{var e;return(e=J0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[h0(JSON.stringify(r)),h0(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dn())}function e4(){var t;const e=(t=J0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function t4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function r4(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function n4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function i4(){const t=dn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function a4(){return!e4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function s4(){try{return typeof indexedDB=="object"}catch{return!1}}function o4(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4="FirebaseError";class Ja extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=l4,Object.setPrototypeOf(this,Ja.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xu.prototype.create)}}class Xu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?c4(a,n):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ja(i,c,n)}}function c4(t,e){return t.replace(u4,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const u4=/\{\$([^}]+)}/g;function f4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(U_(a)&&U_(o)){if(!Yl(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function U_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function h4(t,e){const r=new d4(t,e);return r.subscribe.bind(r)}class d4{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");p4(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=om),i.error===void 0&&(i.error=om),i.complete===void 0&&(i.complete=om);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function p4(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function om(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t){return t&&t._delegate?t._delegate:t}class Do{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new QR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(v4(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&o.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:g4(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function g4(t){return t===Ao?void 0:t}function v4(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new m4(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pt||(pt={}));const _4={debug:pt.DEBUG,verbose:pt.VERBOSE,info:pt.INFO,warn:pt.WARN,error:pt.ERROR,silent:pt.SILENT},y4=pt.INFO,E4={[pt.DEBUG]:"log",[pt.VERBOSE]:"log",[pt.INFO]:"info",[pt.WARN]:"warn",[pt.ERROR]:"error"},w4=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=E4[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bg{constructor(e){this.name=e,this._logLevel=y4,this._logHandler=w4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pt.DEBUG,...e),this._logHandler(this,pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pt.VERBOSE,...e),this._logHandler(this,pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pt.INFO,...e),this._logHandler(this,pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pt.WARN,...e),this._logHandler(this,pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pt.ERROR,...e),this._logHandler(this,pt.ERROR,...e)}}const T4=(t,e)=>e.some(r=>t instanceof r);let j_,$_;function S4(){return j_||(j_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k4(){return $_||($_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fT=new WeakMap,Um=new WeakMap,hT=new WeakMap,lm=new WeakMap,Ug=new WeakMap;function A4(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Vs(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&fT.set(r,t)}).catch(()=>{}),Ug.set(e,t),e}function C4(t){if(Um.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});Um.set(t,e)}let jm={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Um.get(t);if(e==="objectStoreNames")return t.objectStoreNames||hT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Vs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function I4(t){jm=t(jm)}function R4(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(cm(this),e,...r);return hT.set(n,e.sort?e.sort():[e]),Vs(n)}:k4().includes(t)?function(...e){return t.apply(cm(this),e),Vs(fT.get(this))}:function(...e){return Vs(t.apply(cm(this),e))}}function P4(t){return typeof t=="function"?R4(t):(t instanceof IDBTransaction&&C4(t),T4(t,S4())?new Proxy(t,jm):t)}function Vs(t){if(t instanceof IDBRequest)return A4(t);if(lm.has(t))return lm.get(t);const e=P4(t);return e!==t&&(lm.set(t,e),Ug.set(e,t)),e}const cm=t=>Ug.get(t);function F4(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=Vs(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Vs(o.result),u.oldVersion,u.newVersion,Vs(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const b4=["get","getKey","getAll","getAllKeys","count"],O4=["put","add","delete","clear"],um=new Map;function H_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(um.get(e))return um.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=O4.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||b4.includes(r)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return um.set(e,a),a}I4(t=>({...t,get:(e,r,n)=>H_(e,r)||t.get(e,r,n),has:(e,r)=>!!H_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(N4(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function N4(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $m="@firebase/app",z_="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new Bg("@firebase/app"),L4="@firebase/app-compat",M4="@firebase/analytics-compat",V4="@firebase/analytics",B4="@firebase/app-check-compat",U4="@firebase/app-check",j4="@firebase/auth",$4="@firebase/auth-compat",H4="@firebase/database",z4="@firebase/data-connect",W4="@firebase/database-compat",G4="@firebase/functions",K4="@firebase/functions-compat",q4="@firebase/installations",X4="@firebase/installations-compat",Y4="@firebase/messaging",Q4="@firebase/messaging-compat",J4="@firebase/performance",Z4="@firebase/performance-compat",eP="@firebase/remote-config",tP="@firebase/remote-config-compat",rP="@firebase/storage",nP="@firebase/storage-compat",iP="@firebase/firestore",aP="@firebase/vertexai",sP="@firebase/firestore-compat",oP="firebase",lP="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="[DEFAULT]",cP={[$m]:"fire-core",[L4]:"fire-core-compat",[V4]:"fire-analytics",[M4]:"fire-analytics-compat",[U4]:"fire-app-check",[B4]:"fire-app-check-compat",[j4]:"fire-auth",[$4]:"fire-auth-compat",[H4]:"fire-rtdb",[z4]:"fire-data-connect",[W4]:"fire-rtdb-compat",[G4]:"fire-fn",[K4]:"fire-fn-compat",[q4]:"fire-iid",[X4]:"fire-iid-compat",[Y4]:"fire-fcm",[Q4]:"fire-fcm-compat",[J4]:"fire-perf",[Z4]:"fire-perf-compat",[eP]:"fire-rc",[tP]:"fire-rc-compat",[rP]:"fire-gcs",[nP]:"fire-gcs-compat",[iP]:"fire-fst",[sP]:"fire-fst-compat",[aP]:"fire-vertex","fire-js":"fire-js",[oP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0=new Map,uP=new Map,zm=new Map;function W_(t,e){try{t.container.addComponent(e)}catch(r){Ga.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ql(t){const e=t.name;if(zm.has(e))return Ga.debug(`There were multiple attempts to register component ${e}.`),!1;zm.set(e,t);for(const r of d0.values())W_(r,t);for(const r of uP.values())W_(r,t);return!0}function jg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bs=new Xu("app","Firebase",fP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Do("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=lP;function dT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Hm,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Bs.create("bad-app-name",{appName:String(i)});if(r||(r=cT()),!r)throw Bs.create("no-options");const a=d0.get(i);if(a){if(Yl(r,a.options)&&Yl(n,a.config))return a;throw Bs.create("duplicate-app",{appName:i})}const o=new x4(i);for(const u of zm.values())o.addComponent(u);const c=new hP(r,n,o);return d0.set(i,c),c}function pT(t=Hm){const e=d0.get(t);if(!e&&t===Hm&&cT())return dT();if(!e)throw Bs.create("no-app",{appName:t});return e}function Us(t,e,r){var n;let i=(n=cP[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ga.warn(c.join(" "));return}Ql(new Do(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dP="firebase-heartbeat-database",pP=1,Ru="firebase-heartbeat-store";let fm=null;function mT(){return fm||(fm=F4(dP,pP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ru)}catch(r){console.warn(r)}}}}).catch(t=>{throw Bs.create("idb-open",{originalErrorMessage:t.message})})),fm}async function mP(t){try{const r=(await mT()).transaction(Ru),n=await r.objectStore(Ru).get(gT(t));return await r.done,n}catch(e){if(e instanceof Ja)Ga.warn(e.message);else{const r=Bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ga.warn(r.message)}}}async function G_(t,e){try{const n=(await mT()).transaction(Ru,"readwrite");await n.objectStore(Ru).put(e,gT(t)),await n.done}catch(r){if(r instanceof Ja)Ga.warn(r.message);else{const n=Bs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ga.warn(n.message)}}}function gT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=1024,vP=30*24*60*60*1e3;class xP{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new yP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=K_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=vP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Ga.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=K_(),{heartbeatsToSend:n,unsentEntries:i}=_P(this._heartbeatsCache.heartbeats),a=h0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Ga.warn(r),""}}}function K_(){return new Date().toISOString().substring(0,10)}function _P(t,e=gP){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),q_(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),q_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class yP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return s4()?o4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await mP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function q_(t){return h0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(t){Ql(new Do("platform-logger",e=>new D4(e),"PRIVATE")),Ql(new Do("heartbeat",e=>new xP(e),"PRIVATE")),Us($m,z_,t),Us($m,z_,"esm2017"),Us("fire-js","")}EP("");function $g(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function vT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wP=vT,xT=new Xu("auth","Firebase",vT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=new Bg("@firebase/auth");function TP(t,...e){p0.logLevel<=pt.WARN&&p0.warn(`Auth (${dc}): ${t}`,...e)}function Qh(t,...e){p0.logLevel<=pt.ERROR&&p0.error(`Auth (${dc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t,...e){throw zg(t,...e)}function Bi(t,...e){return zg(t,...e)}function Hg(t,e,r){const n=Object.assign(Object.assign({},wP()),{[e]:r});return new Xu("auth","Firebase",n).create(e,{appName:t.name})}function js(t){return Hg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function SP(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ha(t,"argument-error"),Hg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function zg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return xT.create(t,...e)}function at(t,e,...r){if(!t)throw zg(e,...r)}function Ma(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Qh(e),new Error(e)}function Ka(t,e){t||Ma(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function kP(){return X_()==="http:"||X_()==="https:"}function X_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kP()||r4()||"connection"in navigator)?navigator.onLine:!0}function CP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ka(r>e,"Short delay should be less than long delay!"),this.isMobile=ZR()||n4()}get(){return AP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t,e){Ka(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ma("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ma("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ma("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP=new Qu(3e4,6e4);function Ju(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ho(t,e,r,n,i={}){return yT(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const c=Yu(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},a);return t4()||(h.referrerPolicy="no-referrer"),_T.fetch()(wT(t,t.config.apiHost,r,c),h)})}async function yT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},IP),e);try{const i=new FP(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Rh(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rh(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Rh(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Rh(t,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Hg(t,d,h);ha(t,d)}}catch(i){if(i instanceof Ja)throw i;ha(t,"network-request-failed",{message:String(i)})}}async function ET(t,e,r,n,i={}){const a=await Ho(t,e,r,n,i);return"mfaPendingCredential"in a&&ha(t,"multi-factor-auth-required",{_serverResponse:a}),a}function wT(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Wg(t.config,i):`${t.config.apiScheme}://${i}`}function PP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class FP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Bi(this.auth,"network-request-failed")),RP.get())})}}function Rh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Bi(t,e,n);return i.customData._tokenResponse=r,i}function Y_(t){return t!==void 0&&t.enterprise!==void 0}class bP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return PP(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function OP(t,e){return Ho(t,"GET","/v2/recaptchaConfig",Ju(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DP(t,e){return Ho(t,"POST","/v1/accounts:delete",e)}async function TT(t,e){return Ho(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function NP(t,e=!1){const r=br(t),n=await r.getIdToken(e),i=Gg(n);at(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:i,token:n,authTime:pu(hm(i.auth_time)),issuedAtTime:pu(hm(i.iat)),expirationTime:pu(hm(i.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function hm(t){return Number(t)*1e3}function Gg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Qh("JWT malformed, contained fewer than 3 sections"),null;try{const i=oT(r);return i?JSON.parse(i):(Qh("Failed to decode base64 JWT payload"),null)}catch(i){return Qh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Q_(t){const e=Gg(t);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ja&&LP(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function LP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Pu(t,TT(r,{idToken:n}));at(i==null?void 0:i.users.length,r,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?ST(a.providerUserInfo):[],c=BP(t.providerData,o),u=t.isAnonymous,h=!(t.email&&a.passwordHash)&&!(c!=null&&c.length),d=u?h:!1,g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Gm(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,g)}async function VP(t){const e=br(t);await m0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function BP(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function ST(t){return t.map(e=>{var{providerId:r}=e,n=$g(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UP(t,e){const r=await yT(t,{},async()=>{const n=Yu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=wT(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",_T.fetch()(o,{method:"POST",headers:c,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function jP(t,e){return Ho(t,"POST","/v2/accounts:revokeToken",Ju(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){at(e.length!==0,"internal-error");const r=Q_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await UP(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new $l;return n&&(at(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(at(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(at(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(t,e){at(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Va{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,a=$g(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new MP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Gm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Pu(this,this.stsTokenManager.getToken(this.auth,e));return at(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return NP(this,e)}reload(){return VP(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Va(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await m0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oa(this.auth.app))return Promise.reject(js(this.auth));const e=await this.getIdToken();return await Pu(this,DP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,a,o,c,u,h,d;const g=(n=r.displayName)!==null&&n!==void 0?n:void 0,v=(i=r.email)!==null&&i!==void 0?i:void 0,y=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,E=(o=r.photoURL)!==null&&o!==void 0?o:void 0,_=(c=r.tenantId)!==null&&c!==void 0?c:void 0,w=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,k=(h=r.createdAt)!==null&&h!==void 0?h:void 0,F=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:B,isAnonymous:V,providerData:z,stsTokenManager:A}=r;at(C&&A,e,"internal-error");const R=$l.fromJSON(this.name,A);at(typeof C=="string",e,"internal-error"),Is(g,e.name),Is(v,e.name),at(typeof B=="boolean",e,"internal-error"),at(typeof V=="boolean",e,"internal-error"),Is(y,e.name),Is(E,e.name),Is(_,e.name),Is(w,e.name),Is(k,e.name),Is(F,e.name);const P=new Va({uid:C,auth:e,email:v,emailVerified:B,displayName:g,isAnonymous:V,photoURL:E,phoneNumber:y,tenantId:_,stsTokenManager:R,createdAt:k,lastLoginAt:F});return z&&Array.isArray(z)&&(P.providerData=z.map(L=>Object.assign({},L))),w&&(P._redirectEventId=w),P}static async _fromIdTokenResponse(e,r,n=!1){const i=new $l;i.updateFromServerResponse(r);const a=new Va({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await m0(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];at(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?ST(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),c=new $l;c.updateFromIdToken(n);const u=new Va({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Gm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_=new Map;function Ba(t){Ka(t instanceof Function,"Expected a class definition");let e=J_.get(t);return e?(Ka(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,J_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}kT.type="NONE";const Z_=kT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jh(t,e,r){return`firebase:${t}:${e}:${r}`}class Hl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Jh(this.userKey,i.apiKey,a),this.fullPersistenceKey=Jh("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Va._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Hl(Ba(Z_),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||Ba(Z_);const o=Jh(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){const g=Va._fromJSON(e,d);h!==a&&(c=g),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Hl(a,e,n):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==a)try{await h._remove(o)}catch{}})),new Hl(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(AT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(FT(e))return"Blackberry";if(bT(e))return"Webos";if(CT(e))return"Safari";if((e.includes("chrome/")||IT(e))&&!e.includes("edge/"))return"Chrome";if(PT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function AT(t=dn()){return/firefox\//i.test(t)}function CT(t=dn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function IT(t=dn()){return/crios\//i.test(t)}function RT(t=dn()){return/iemobile/i.test(t)}function PT(t=dn()){return/android/i.test(t)}function FT(t=dn()){return/blackberry/i.test(t)}function bT(t=dn()){return/webos/i.test(t)}function Kg(t=dn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $P(t=dn()){var e;return Kg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function HP(){return i4()&&document.documentMode===10}function OT(t=dn()){return Kg(t)||PT(t)||bT(t)||FT(t)||/windows phone/i.test(t)||RT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t,e=[]){let r;switch(t){case"Browser":r=ey(dn());break;case"Worker":r=`${ey(dn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${dc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WP(t,e={}){return Ho(t,"GET","/v2/passwordPolicy",Ju(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=6;class KP{constructor(e){var r,n,i,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:GP,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,a,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsUppercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ty(this),this.idTokenSubscription=new ty(this),this.beforeStateQueue=new zP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ba(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Hl.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await TT(this,{idToken:e}),n=await Va._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(oa(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,c=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(i=u.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await m0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oa(this.app))return Promise.reject(js(this));const r=e?br(e):null;return r&&at(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oa(this.app)?Promise.reject(js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oa(this.app)?Promise.reject(js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ba(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WP(this),r=new KP(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Xu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await jP(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ba(e)||this._popupRedirectResolver;at(r,this,"argument-error"),this.redirectPersistenceManager=await Hl.create(this,[Ba(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=DT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&TP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function zo(t){return br(t)}class ty{constructor(e){this.auth=e,this.observer=null,this.addObserver=h4(r=>this.observer=r)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XP(t){Z0=t}function NT(t){return Z0.loadJS(t)}function YP(){return Z0.recaptchaEnterpriseScript}function QP(){return Z0.gapiScript}function JP(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class ZP{constructor(){this.enterprise=new eF}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class eF{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const tF="recaptcha-enterprise",LT="NO_RECAPTCHA";class rF{constructor(e){this.type=tF,this.auth=zo(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{OP(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new bP(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;Y_(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{o(h)}).catch(()=>{o(LT)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ZP().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(c=>{if(!r&&Y_(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=YP();u.length!==0&&(u+=c),NT(u).then(()=>{i(c,a,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function ry(t,e,r,n=!1,i=!1){const a=new rF(t);let o;if(i)o=LT;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const c=Object.assign({},e);return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function nF(t,e,r,n,i){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ry(t,e,r,r==="getOobCode");return n(t,o)}else return n(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await ry(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(t,e){const r=jg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Yl(a,e??{}))return i;ha(i,"already-initialized")}return r.initialize({options:e})}function aF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ba);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function sF(t,e,r){const n=zo(t);at(n._canInitEmulator,n,"emulator-config-failed"),at(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=MT(e),{host:o,port:c}=oF(e),u=c===null?"":`:${c}`;n.config.emulator={url:`${a}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),lF()}function MT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oF(t){const e=MT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:ny(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:ny(o)}}}function ny(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function lF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ma("not implemented")}_getIdTokenResponse(e){return Ma("not implemented")}_linkToIdToken(e,r){return Ma("not implemented")}_getReauthenticationResolver(e){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zl(t,e){return ET(t,"POST","/v1/accounts:signInWithIdp",Ju(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF="http://localhost";class No extends VT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new No(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ha("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,a=$g(r,["providerId","signInMethod"]);if(!n||!i)return null;const o=new No(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return zl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,zl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,zl(e,r)}buildRequest(){const e={requestUri:cF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Yu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends qg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends Zu{constructor(){super("facebook.com")}static credential(e){return No._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ps.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends Zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return No._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return La.credential(r,n)}catch{return null}}}La.GOOGLE_SIGN_IN_METHOD="google.com";La.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends Zu{constructor(){super("github.com")}static credential(e){return No._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.GITHUB_SIGN_IN_METHOD="github.com";Fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends Zu{constructor(){super("twitter.com")}static credential(e,r){return No._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return bs.credential(r,n)}catch{return null}}}bs.TWITTER_SIGN_IN_METHOD="twitter.com";bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uF(t,e){return ET(t,"POST","/v1/accounts:signUp",Ju(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Va._fromIdTokenResponse(e,n,i),o=iy(n);return new Lo({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=iy(n);return new Lo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function iy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0 extends Ja{constructor(e,r,n,i){var a;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,g0.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new g0(e,r,n,i)}}function BT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?g0._fromErrorAndOperation(t,a,e,n):a})}async function fF(t,e,r=!1){const n=await Pu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Lo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hF(t,e,r=!1){const{auth:n}=t;if(oa(n.app))return Promise.reject(js(n));const i="reauthenticate";try{const a=await Pu(t,BT(n,i,e,t),r);at(a.idToken,n,"internal-error");const o=Gg(a.idToken);at(o,n,"internal-error");const{sub:c}=o;return at(t.uid===c,n,"user-mismatch"),Lo._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ha(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dF(t,e,r=!1){if(oa(t.app))return Promise.reject(js(t));const n="signIn",i=await BT(t,n,e),a=await Lo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(t){const e=zo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $H(t,e,r){if(oa(t.app))return Promise.reject(js(t));const n=zo(t),o=await nF(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",uF).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&pF(t),u}),c=await Lo._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function mF(t,e,r,n){return br(t).onIdTokenChanged(e,r,n)}function gF(t,e,r){return br(t).beforeAuthStateChanged(e,r)}function vF(t,e,r,n){return br(t).onAuthStateChanged(e,r,n)}function HH(t){return br(t).signOut()}const v0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(v0,"1"),this.storage.removeItem(v0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF=1e3,_F=10;class jT extends UT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);HP()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_F):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},xF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}jT.type="LOCAL";const yF=jT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T extends UT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}$T.type="SESSION";const HT=$T;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ed(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(o).map(async h=>h(r.origin,a)),u=await EF(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ed.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const h=Xg("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(g){const v=g;if(v.data.eventId===h)switch(v.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(v.data.response);break;default:clearTimeout(d),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(){return window}function TF(t){la().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(){return typeof la().WorkerGlobalScope<"u"&&typeof la().importScripts=="function"}async function SF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function kF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function AF(){return zT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="firebaseLocalStorageDb",CF=1,x0="firebaseLocalStorage",GT="fbase_key";class ef{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function td(t,e){return t.transaction([x0],e?"readwrite":"readonly").objectStore(x0)}function IF(){const t=indexedDB.deleteDatabase(WT);return new ef(t).toPromise()}function Km(){const t=indexedDB.open(WT,CF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(x0,{keyPath:GT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(x0)?e(n):(n.close(),await IF(),e(await Km()))})})}async function ay(t,e,r){const n=td(t,!0).put({[GT]:e,value:r});return new ef(n).toPromise()}async function RF(t,e){const r=td(t,!1).get(e),n=await new ef(r).toPromise();return n===void 0?null:n.value}function sy(t,e){const r=td(t,!0).delete(e);return new ef(r).toPromise()}const PF=800,FF=3;class KT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Km(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>FF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ed._getInstance(AF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await SF(),!this.activeServiceWorker)return;this.sender=new wF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||kF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Km();return await ay(e,v0,"1"),await sy(e,v0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ay(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>RF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>sy(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=td(i,!1).getAll();return new ef(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KT.type="LOCAL";const bF=KT;new Qu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(t,e){return e?Ba(e):(at(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends VT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return zl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return zl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function OF(t){return dF(t.auth,new Yg(t),t.bypassAuthState)}function DF(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),hF(r,new Yg(t),t.bypassAuthState)}async function NF(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),fF(r,new Yg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OF;case"linkViaPopup":case"linkViaRedirect":return NF;case"reauthViaPopup":case"reauthViaRedirect":return DF;default:ha(this.auth,"internal-error")}}resolve(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF=new Qu(2e3,1e4);async function zH(t,e,r){if(oa(t.app))return Promise.reject(Bi(t,"operation-not-supported-in-this-environment"));const n=zo(t);SP(t,e,qg);const i=qT(n,r);return new Io(n,"signInViaPopup",e,i).executeNotNull()}class Io extends XT{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Io.currentPopupAction&&Io.currentPopupAction.cancel(),Io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Ka(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Bi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Bi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LF.get())};e()}}Io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF="pendingRedirect",Zh=new Map;class VF extends XT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Zh.get(this.auth._key());if(!e){try{const n=await BF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Zh.set(this.auth._key(),e)}return this.bypassAuthState||Zh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BF(t,e){const r=$F(e),n=jF(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function UF(t,e){Zh.set(t._key(),e)}function jF(t){return Ba(t._redirectPersistence)}function $F(t){return Jh(MF,t.config.apiKey,t.name)}async function HF(t,e,r=!1){if(oa(t.app))return Promise.reject(js(t));const n=zo(t),i=qT(n,e),o=await new VF(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zF=10*60*1e3;class WF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!YT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Bi(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=zF&&this.cachedEventUids.clear(),this.cachedEventUids.has(oy(e))}saveEventToCache(e){this.cachedEventUids.add(oy(e)),this.lastProcessedEventTime=Date.now()}}function oy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function YT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function GF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return YT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KF(t,e={}){return Ho(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XF=/^https?/;async function YF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await KF(t);for(const r of e)try{if(QF(r))return}catch{}ha(t,"unauthorized-domain")}function QF(t){const e=Wm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!XF.test(r))return!1;if(qF.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=new Qu(3e4,6e4);function ly(){const t=la().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function ZF(t){return new Promise((e,r)=>{var n,i,a;function o(){ly(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ly(),r(Bi(t,"network-request-failed"))},timeout:JF.get()})}if(!((i=(n=la().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=la().gapi)===null||a===void 0)&&a.load)o();else{const c=JP("iframefcb");return la()[c]=()=>{gapi.load?o():r(Bi(t,"network-request-failed"))},NT(`${QP()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw e0=null,e})}let e0=null;function eb(t){return e0=e0||ZF(t),e0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb=new Qu(5e3,15e3),rb="__/auth/iframe",nb="emulator/auth/iframe",ib={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ab=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sb(t){const e=t.config;at(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Wg(e,nb):`https://${t.config.authDomain}/${rb}`,n={apiKey:e.apiKey,appName:t.name,v:dc},i=ab.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Yu(n).slice(1)}`}async function ob(t){const e=await eb(t),r=la().gapi;return at(r,t,"internal-error"),e.open({where:document.body,url:sb(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ib,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=Bi(t,"network-request-failed"),c=la().setTimeout(()=>{a(o)},tb.get());function u(){la().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cb=500,ub=600,fb="_blank",hb="http://localhost";class cy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function db(t,e,r,n=cb,i=ub){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u=Object.assign(Object.assign({},lb),{width:n.toString(),height:i.toString(),top:a,left:o}),h=dn().toLowerCase();r&&(c=IT(h)?fb:r),AT(h)&&(e=e||hb,u.scrollbars="yes");const d=Object.entries(u).reduce((v,[y,E])=>`${v}${y}=${E},`,"");if($P(h)&&c!=="_self")return pb(e||"",c),new cy(null);const g=window.open(e||"",c,d);at(g,t,"popup-blocked");try{g.focus()}catch{}return new cy(g)}function pb(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb="__/auth/handler",gb="emulator/auth/handler",vb=encodeURIComponent("fac");async function uy(t,e,r,n,i,a){at(t.config.authDomain,t,"auth-domain-config-required"),at(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:dc,eventId:i};if(e instanceof qg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",f4(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof Zu){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const u=await t._getAppCheckToken(),h=u?`#${vb}=${encodeURIComponent(u)}`:"";return`${xb(t)}?${Yu(c).slice(1)}${h}`}function xb({config:t}){return t.emulator?Wg(t,gb):`https://${t.authDomain}/${mb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm="webStorageSupport";class _b{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HT,this._completeRedirectFn=HF,this._overrideRedirectResult=UF}async _openPopup(e,r,n,i){var a;Ka((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await uy(e,r,n,Wm(),i);return db(e,o,Xg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await uy(e,r,n,Wm(),i);return TF(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Ka(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await ob(e),n=new WF(e);return r.register("authEvent",i=>(at(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(dm,{type:dm},i=>{var a;const o=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[dm];o!==void 0&&r(!!o),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=YF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return OT()||CT()||Kg()}}const yb=_b;var fy="@firebase/auth",hy="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Tb(t){Ql(new Do("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;at(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DT(t)},h=new qP(n,i,a,u);return aF(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ql(new Do("auth-internal",e=>{const r=zo(e.getProvider("auth").getImmediate());return(n=>new Eb(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Us(fy,hy,wb(t)),Us(fy,hy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb=5*60,kb=uT("authIdTokenMaxAge")||Sb;let dy=null;const Ab=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>kb)return;const i=r==null?void 0:r.token;dy!==i&&(dy=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Cb(t=pT()){const e=jg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=iF(t,{popupRedirectResolver:yb,persistence:[bF,yF,HT]}),n=uT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Ab(a.toString());gF(r,o,()=>o(r.currentUser)),mF(r,c=>o(c))}}const i=lT("auth");return i&&sF(r,`http://${i}`),r}function Ib(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}XP({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Bi("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",Ib().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Tb("Browser");var Rb="firebase",Pb="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Us(Rb,Pb,"app");var py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fo,QT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,R){function P(){}P.prototype=R.prototype,A.D=R.prototype,A.prototype=new P,A.prototype.constructor=A,A.C=function(L,M,N){for(var U=Array(arguments.length-2),be=2;be<arguments.length;be++)U[be-2]=arguments[be];return R.prototype[M].apply(L,U)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,R,P){P||(P=0);var L=Array(16);if(typeof R=="string")for(var M=0;16>M;++M)L[M]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(M=0;16>M;++M)L[M]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=A.g[0],P=A.g[1],M=A.g[2];var N=A.g[3],U=R+(N^P&(M^N))+L[0]+3614090360&4294967295;R=P+(U<<7&4294967295|U>>>25),U=N+(M^R&(P^M))+L[1]+3905402710&4294967295,N=R+(U<<12&4294967295|U>>>20),U=M+(P^N&(R^P))+L[2]+606105819&4294967295,M=N+(U<<17&4294967295|U>>>15),U=P+(R^M&(N^R))+L[3]+3250441966&4294967295,P=M+(U<<22&4294967295|U>>>10),U=R+(N^P&(M^N))+L[4]+4118548399&4294967295,R=P+(U<<7&4294967295|U>>>25),U=N+(M^R&(P^M))+L[5]+1200080426&4294967295,N=R+(U<<12&4294967295|U>>>20),U=M+(P^N&(R^P))+L[6]+2821735955&4294967295,M=N+(U<<17&4294967295|U>>>15),U=P+(R^M&(N^R))+L[7]+4249261313&4294967295,P=M+(U<<22&4294967295|U>>>10),U=R+(N^P&(M^N))+L[8]+1770035416&4294967295,R=P+(U<<7&4294967295|U>>>25),U=N+(M^R&(P^M))+L[9]+2336552879&4294967295,N=R+(U<<12&4294967295|U>>>20),U=M+(P^N&(R^P))+L[10]+4294925233&4294967295,M=N+(U<<17&4294967295|U>>>15),U=P+(R^M&(N^R))+L[11]+2304563134&4294967295,P=M+(U<<22&4294967295|U>>>10),U=R+(N^P&(M^N))+L[12]+1804603682&4294967295,R=P+(U<<7&4294967295|U>>>25),U=N+(M^R&(P^M))+L[13]+4254626195&4294967295,N=R+(U<<12&4294967295|U>>>20),U=M+(P^N&(R^P))+L[14]+2792965006&4294967295,M=N+(U<<17&4294967295|U>>>15),U=P+(R^M&(N^R))+L[15]+1236535329&4294967295,P=M+(U<<22&4294967295|U>>>10),U=R+(M^N&(P^M))+L[1]+4129170786&4294967295,R=P+(U<<5&4294967295|U>>>27),U=N+(P^M&(R^P))+L[6]+3225465664&4294967295,N=R+(U<<9&4294967295|U>>>23),U=M+(R^P&(N^R))+L[11]+643717713&4294967295,M=N+(U<<14&4294967295|U>>>18),U=P+(N^R&(M^N))+L[0]+3921069994&4294967295,P=M+(U<<20&4294967295|U>>>12),U=R+(M^N&(P^M))+L[5]+3593408605&4294967295,R=P+(U<<5&4294967295|U>>>27),U=N+(P^M&(R^P))+L[10]+38016083&4294967295,N=R+(U<<9&4294967295|U>>>23),U=M+(R^P&(N^R))+L[15]+3634488961&4294967295,M=N+(U<<14&4294967295|U>>>18),U=P+(N^R&(M^N))+L[4]+3889429448&4294967295,P=M+(U<<20&4294967295|U>>>12),U=R+(M^N&(P^M))+L[9]+568446438&4294967295,R=P+(U<<5&4294967295|U>>>27),U=N+(P^M&(R^P))+L[14]+3275163606&4294967295,N=R+(U<<9&4294967295|U>>>23),U=M+(R^P&(N^R))+L[3]+4107603335&4294967295,M=N+(U<<14&4294967295|U>>>18),U=P+(N^R&(M^N))+L[8]+1163531501&4294967295,P=M+(U<<20&4294967295|U>>>12),U=R+(M^N&(P^M))+L[13]+2850285829&4294967295,R=P+(U<<5&4294967295|U>>>27),U=N+(P^M&(R^P))+L[2]+4243563512&4294967295,N=R+(U<<9&4294967295|U>>>23),U=M+(R^P&(N^R))+L[7]+1735328473&4294967295,M=N+(U<<14&4294967295|U>>>18),U=P+(N^R&(M^N))+L[12]+2368359562&4294967295,P=M+(U<<20&4294967295|U>>>12),U=R+(P^M^N)+L[5]+4294588738&4294967295,R=P+(U<<4&4294967295|U>>>28),U=N+(R^P^M)+L[8]+2272392833&4294967295,N=R+(U<<11&4294967295|U>>>21),U=M+(N^R^P)+L[11]+1839030562&4294967295,M=N+(U<<16&4294967295|U>>>16),U=P+(M^N^R)+L[14]+4259657740&4294967295,P=M+(U<<23&4294967295|U>>>9),U=R+(P^M^N)+L[1]+2763975236&4294967295,R=P+(U<<4&4294967295|U>>>28),U=N+(R^P^M)+L[4]+1272893353&4294967295,N=R+(U<<11&4294967295|U>>>21),U=M+(N^R^P)+L[7]+4139469664&4294967295,M=N+(U<<16&4294967295|U>>>16),U=P+(M^N^R)+L[10]+3200236656&4294967295,P=M+(U<<23&4294967295|U>>>9),U=R+(P^M^N)+L[13]+681279174&4294967295,R=P+(U<<4&4294967295|U>>>28),U=N+(R^P^M)+L[0]+3936430074&4294967295,N=R+(U<<11&4294967295|U>>>21),U=M+(N^R^P)+L[3]+3572445317&4294967295,M=N+(U<<16&4294967295|U>>>16),U=P+(M^N^R)+L[6]+76029189&4294967295,P=M+(U<<23&4294967295|U>>>9),U=R+(P^M^N)+L[9]+3654602809&4294967295,R=P+(U<<4&4294967295|U>>>28),U=N+(R^P^M)+L[12]+3873151461&4294967295,N=R+(U<<11&4294967295|U>>>21),U=M+(N^R^P)+L[15]+530742520&4294967295,M=N+(U<<16&4294967295|U>>>16),U=P+(M^N^R)+L[2]+3299628645&4294967295,P=M+(U<<23&4294967295|U>>>9),U=R+(M^(P|~N))+L[0]+4096336452&4294967295,R=P+(U<<6&4294967295|U>>>26),U=N+(P^(R|~M))+L[7]+1126891415&4294967295,N=R+(U<<10&4294967295|U>>>22),U=M+(R^(N|~P))+L[14]+2878612391&4294967295,M=N+(U<<15&4294967295|U>>>17),U=P+(N^(M|~R))+L[5]+4237533241&4294967295,P=M+(U<<21&4294967295|U>>>11),U=R+(M^(P|~N))+L[12]+1700485571&4294967295,R=P+(U<<6&4294967295|U>>>26),U=N+(P^(R|~M))+L[3]+2399980690&4294967295,N=R+(U<<10&4294967295|U>>>22),U=M+(R^(N|~P))+L[10]+4293915773&4294967295,M=N+(U<<15&4294967295|U>>>17),U=P+(N^(M|~R))+L[1]+2240044497&4294967295,P=M+(U<<21&4294967295|U>>>11),U=R+(M^(P|~N))+L[8]+1873313359&4294967295,R=P+(U<<6&4294967295|U>>>26),U=N+(P^(R|~M))+L[15]+4264355552&4294967295,N=R+(U<<10&4294967295|U>>>22),U=M+(R^(N|~P))+L[6]+2734768916&4294967295,M=N+(U<<15&4294967295|U>>>17),U=P+(N^(M|~R))+L[13]+1309151649&4294967295,P=M+(U<<21&4294967295|U>>>11),U=R+(M^(P|~N))+L[4]+4149444226&4294967295,R=P+(U<<6&4294967295|U>>>26),U=N+(P^(R|~M))+L[11]+3174756917&4294967295,N=R+(U<<10&4294967295|U>>>22),U=M+(R^(N|~P))+L[2]+718787259&4294967295,M=N+(U<<15&4294967295|U>>>17),U=P+(N^(M|~R))+L[9]+3951481745&4294967295,A.g[0]=A.g[0]+R&4294967295,A.g[1]=A.g[1]+(M+(U<<21&4294967295|U>>>11))&4294967295,A.g[2]=A.g[2]+M&4294967295,A.g[3]=A.g[3]+N&4294967295}n.prototype.u=function(A,R){R===void 0&&(R=A.length);for(var P=R-this.blockSize,L=this.B,M=this.h,N=0;N<R;){if(M==0)for(;N<=P;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<R;)if(L[M++]=A.charCodeAt(N++),M==this.blockSize){i(this,L),M=0;break}}else for(;N<R;)if(L[M++]=A[N++],M==this.blockSize){i(this,L),M=0;break}}this.h=M,this.o+=R},n.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var R=1;R<A.length-8;++R)A[R]=0;var P=8*this.o;for(R=A.length-8;R<A.length;++R)A[R]=P&255,P/=256;for(this.u(A),A=Array(16),R=P=0;4>R;++R)for(var L=0;32>L;L+=8)A[P++]=this.g[R]>>>L&255;return A};function a(A,R){var P=c;return Object.prototype.hasOwnProperty.call(P,A)?P[A]:P[A]=R(A)}function o(A,R){this.h=R;for(var P=[],L=!0,M=A.length-1;0<=M;M--){var N=A[M]|0;L&&N==R||(P[M]=N,L=!1)}this.g=P}var c={};function u(A){return-128<=A&&128>A?a(A,function(R){return new o([R|0],0>R?-1:0)}):new o([A|0],0>A?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return g;if(0>A)return w(h(-A));for(var R=[],P=1,L=0;A>=P;L++)R[L]=A/P|0,P*=4294967296;return new o(R,0)}function d(A,R){if(A.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(A.charAt(0)=="-")return w(d(A.substring(1),R));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=h(Math.pow(R,8)),L=g,M=0;M<A.length;M+=8){var N=Math.min(8,A.length-M),U=parseInt(A.substring(M,M+N),R);8>N?(N=h(Math.pow(R,N)),L=L.j(N).add(h(U))):(L=L.j(P),L=L.add(h(U)))}return L}var g=u(0),v=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(_(this))return-w(this).m();for(var A=0,R=1,P=0;P<this.g.length;P++){var L=this.i(P);A+=(0<=L?L:4294967296+L)*R,R*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(E(this))return"0";if(_(this))return"-"+w(this).toString(A);for(var R=h(Math.pow(A,6)),P=this,L="";;){var M=B(P,R).g;P=k(P,M.j(R));var N=((0<P.g.length?P.g[0]:P.h)>>>0).toString(A);if(P=M,E(P))return N+L;for(;6>N.length;)N="0"+N;L=N+L}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function E(A){if(A.h!=0)return!1;for(var R=0;R<A.g.length;R++)if(A.g[R]!=0)return!1;return!0}function _(A){return A.h==-1}t.l=function(A){return A=k(this,A),_(A)?-1:E(A)?0:1};function w(A){for(var R=A.g.length,P=[],L=0;L<R;L++)P[L]=~A.g[L];return new o(P,~A.h).add(v)}t.abs=function(){return _(this)?w(this):this},t.add=function(A){for(var R=Math.max(this.g.length,A.g.length),P=[],L=0,M=0;M<=R;M++){var N=L+(this.i(M)&65535)+(A.i(M)&65535),U=(N>>>16)+(this.i(M)>>>16)+(A.i(M)>>>16);L=U>>>16,N&=65535,U&=65535,P[M]=U<<16|N}return new o(P,P[P.length-1]&-2147483648?-1:0)};function k(A,R){return A.add(w(R))}t.j=function(A){if(E(this)||E(A))return g;if(_(this))return _(A)?w(this).j(w(A)):w(w(this).j(A));if(_(A))return w(this.j(w(A)));if(0>this.l(y)&&0>A.l(y))return h(this.m()*A.m());for(var R=this.g.length+A.g.length,P=[],L=0;L<2*R;L++)P[L]=0;for(L=0;L<this.g.length;L++)for(var M=0;M<A.g.length;M++){var N=this.i(L)>>>16,U=this.i(L)&65535,be=A.i(M)>>>16,Ee=A.i(M)&65535;P[2*L+2*M]+=U*Ee,F(P,2*L+2*M),P[2*L+2*M+1]+=N*Ee,F(P,2*L+2*M+1),P[2*L+2*M+1]+=U*be,F(P,2*L+2*M+1),P[2*L+2*M+2]+=N*be,F(P,2*L+2*M+2)}for(L=0;L<R;L++)P[L]=P[2*L+1]<<16|P[2*L];for(L=R;L<2*R;L++)P[L]=0;return new o(P,0)};function F(A,R){for(;(A[R]&65535)!=A[R];)A[R+1]+=A[R]>>>16,A[R]&=65535,R++}function C(A,R){this.g=A,this.h=R}function B(A,R){if(E(R))throw Error("division by zero");if(E(A))return new C(g,g);if(_(A))return R=B(w(A),R),new C(w(R.g),w(R.h));if(_(R))return R=B(A,w(R)),new C(w(R.g),R.h);if(30<A.g.length){if(_(A)||_(R))throw Error("slowDivide_ only works with positive integers.");for(var P=v,L=R;0>=L.l(A);)P=V(P),L=V(L);var M=z(P,1),N=z(L,1);for(L=z(L,2),P=z(P,2);!E(L);){var U=N.add(L);0>=U.l(A)&&(M=M.add(P),N=U),L=z(L,1),P=z(P,1)}return R=k(A,M.j(R)),new C(M,R)}for(M=g;0<=A.l(R);){for(P=Math.max(1,Math.floor(A.m()/R.m())),L=Math.ceil(Math.log(P)/Math.LN2),L=48>=L?1:Math.pow(2,L-48),N=h(P),U=N.j(R);_(U)||0<U.l(A);)P-=L,N=h(P),U=N.j(R);E(N)&&(N=v),M=M.add(N),A=k(A,U)}return new C(M,A)}t.A=function(A){return B(this,A).h},t.and=function(A){for(var R=Math.max(this.g.length,A.g.length),P=[],L=0;L<R;L++)P[L]=this.i(L)&A.i(L);return new o(P,this.h&A.h)},t.or=function(A){for(var R=Math.max(this.g.length,A.g.length),P=[],L=0;L<R;L++)P[L]=this.i(L)|A.i(L);return new o(P,this.h|A.h)},t.xor=function(A){for(var R=Math.max(this.g.length,A.g.length),P=[],L=0;L<R;L++)P[L]=this.i(L)^A.i(L);return new o(P,this.h^A.h)};function V(A){for(var R=A.g.length+1,P=[],L=0;L<R;L++)P[L]=A.i(L)<<1|A.i(L-1)>>>31;return new o(P,A.h)}function z(A,R){var P=R>>5;R%=32;for(var L=A.g.length-P,M=[],N=0;N<L;N++)M[N]=0<R?A.i(N+P)>>>R|A.i(N+P+1)<<32-R:A.i(N+P);return new o(M,A.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,QT=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,Fo=o}).apply(typeof py<"u"?py:typeof self<"u"?self:typeof window<"u"?window:{});var Ph=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var JT,au,ZT,t0,qm,e2,t2,r2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,T,I){return p==Array.prototype||p==Object.prototype||(p[T]=I.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ph=="object"&&Ph];for(var T=0;T<p.length;++T){var I=p[T];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function i(p,T){if(T)e:{var I=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var se=p[j];if(!(se in I))break e;I=I[se]}p=p[p.length-1],j=I[p],T=T(j),T!=j&&T!=null&&e(I,p,{configurable:!0,writable:!0,value:T})}}function a(p,T){p instanceof String&&(p+="");var I=0,j=!1,se={next:function(){if(!j&&I<p.length){var me=I++;return{value:T(me,p[me]),done:!1}}return j=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}i("Array.prototype.values",function(p){return p||function(){return a(this,function(T,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(p){var T=typeof p;return T=T!="object"?T:p?Array.isArray(p)?"array":T:"null",T=="array"||T=="object"&&typeof p.length=="number"}function h(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function d(p,T,I){return p.call.apply(p.bind,arguments)}function g(p,T,I){if(!p)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,j),p.apply(T,se)}}return function(){return p.apply(T,arguments)}}function v(p,T,I){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:g,v.apply(null,arguments)}function y(p,T){var I=Array.prototype.slice.call(arguments,1);return function(){var j=I.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function E(p,T){function I(){}I.prototype=T.prototype,p.aa=T.prototype,p.prototype=new I,p.prototype.constructor=p,p.Qb=function(j,se,me){for(var Me=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Me[Nt-2]=arguments[Nt];return T.prototype[se].apply(j,Me)}}function _(p){const T=p.length;if(0<T){const I=Array(T);for(let j=0;j<T;j++)I[j]=p[j];return I}return[]}function w(p,T){for(let I=1;I<arguments.length;I++){const j=arguments[I];if(u(j)){const se=p.length||0,me=j.length||0;p.length=se+me;for(let Me=0;Me<me;Me++)p[se+Me]=j[Me]}else p.push(j)}}class k{constructor(T,I){this.i=T,this.j=I,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function F(p){return/^[\s\xa0]*$/.test(p)}function C(){var p=c.navigator;return p&&(p=p.userAgent)?p:""}function B(p){return B[" "](p),p}B[" "]=function(){};var V=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function z(p,T,I){for(const j in p)T.call(I,p[j],j,p)}function A(p,T){for(const I in p)T.call(void 0,p[I],I,p)}function R(p){const T={};for(const I in p)T[I]=p[I];return T}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(p,T){let I,j;for(let se=1;se<arguments.length;se++){j=arguments[se];for(I in j)p[I]=j[I];for(let me=0;me<P.length;me++)I=P[me],Object.prototype.hasOwnProperty.call(j,I)&&(p[I]=j[I])}}function M(p){var T=1;p=p.split(":");const I=[];for(;0<T&&p.length;)I.push(p.shift()),T--;return p.length&&I.push(p.join(":")),I}function N(p){c.setTimeout(()=>{throw p},0)}function U(){var p=ie;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class be{constructor(){this.h=this.g=null}add(T,I){const j=Ee.get();j.set(T,I),this.h?this.h.next=j:this.g=j,this.h=j}}var Ee=new k(()=>new Ce,p=>p.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(T,I){this.h=T,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Te,ye=!1,ie=new be,ve=()=>{const p=c.Promise.resolve(void 0);Te=()=>{p.then(te)}};var te=()=>{for(var p;p=U();){try{p.h.call(p.g)}catch(I){N(I)}var T=Ee;T.j(p),100>T.h&&(T.h++,p.next=T.g,T.g=p)}ye=!1};function O(){this.s=this.s,this.C=this.C}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};c.addEventListener("test",I,T),c.removeEventListener("test",I,T)}catch{}return p}();function Z(p,T){if(re.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var I=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget){if(V){e:{try{B(T.nodeName);var se=!0;break e}catch{}se=!1}se||(T=null)}}else I=="mouseover"?T=p.fromElement:I=="mouseout"&&(T=p.toElement);this.relatedTarget=T,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ce[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Z.aa.h.call(this)}}E(Z,re);var ce={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var _e="closure_listenable_"+(1e6*Math.random()|0),Se=0;function we(p,T,I,j,se){this.listener=p,this.proxy=null,this.src=T,this.type=I,this.capture=!!j,this.ha=se,this.key=++Se,this.da=this.fa=!1}function xe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Je(p){this.src=p,this.g={},this.h=0}Je.prototype.add=function(p,T,I,j,se){var me=p.toString();p=this.g[me],p||(p=this.g[me]=[],this.h++);var Me=kt(p,T,j,se);return-1<Me?(T=p[Me],I||(T.fa=!1)):(T=new we(T,this.src,me,!!j,se),T.fa=I,p.push(T)),T};function Y(p,T){var I=T.type;if(I in p.g){var j=p.g[I],se=Array.prototype.indexOf.call(j,T,void 0),me;(me=0<=se)&&Array.prototype.splice.call(j,se,1),me&&(xe(T),p.g[I].length==0&&(delete p.g[I],p.h--))}}function kt(p,T,I,j){for(var se=0;se<p.length;++se){var me=p[se];if(!me.da&&me.listener==T&&me.capture==!!I&&me.ha==j)return se}return-1}var ct="closure_lm_"+(1e6*Math.random()|0),dt={};function ut(p,T,I,j,se){if(Array.isArray(T)){for(var me=0;me<T.length;me++)ut(p,T[me],I,j,se);return null}return I=vn(I),p&&p[_e]?p.K(T,I,h(j)?!!j.capture:!!j,se):Ve(p,T,I,!1,j,se)}function Ve(p,T,I,j,se,me){if(!T)throw Error("Invalid event type");var Me=h(se)?!!se.capture:!!se,Nt=gn(p);if(Nt||(p[ct]=Nt=new Je(p)),I=Nt.add(T,I,j,Me,me),I.proxy)return I;if(j=Vt(),I.proxy=j,j.src=p,j.listener=I,p.addEventListener)ee||(se=Me),se===void 0&&(se=!1),p.addEventListener(T.toString(),j,se);else if(p.attachEvent)p.attachEvent(Tr(T.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Vt(){function p(I){return T.call(p.src,p.listener,I)}const T=_i;return p}function wr(p,T,I,j,se){if(Array.isArray(T))for(var me=0;me<T.length;me++)wr(p,T[me],I,j,se);else j=h(j)?!!j.capture:!!j,I=vn(I),p&&p[_e]?(p=p.i,T=String(T).toString(),T in p.g&&(me=p.g[T],I=kt(me,I,j,se),-1<I&&(xe(me[I]),Array.prototype.splice.call(me,I,1),me.length==0&&(delete p.g[T],p.h--)))):p&&(p=gn(p))&&(T=p.g[T.toString()],p=-1,T&&(p=kt(T,I,j,se)),(I=-1<p?T[p]:null)&&ur(I))}function ur(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[_e])Y(T.i,p);else{var I=p.type,j=p.proxy;T.removeEventListener?T.removeEventListener(I,j,p.capture):T.detachEvent?T.detachEvent(Tr(I),j):T.addListener&&T.removeListener&&T.removeListener(j),(I=gn(T))?(Y(I,p),I.h==0&&(I.src=null,T[ct]=null)):xe(p)}}}function Tr(p){return p in dt?dt[p]:dt[p]="on"+p}function _i(p,T){if(p.da)p=!0;else{T=new Z(T,this);var I=p.listener,j=p.ha||p.src;p.fa&&ur(p),p=I.call(j,T)}return p}function gn(p){return p=p[ct],p instanceof Je?p:null}var fr="__closure_events_fn_"+(1e9*Math.random()>>>0);function vn(p){return typeof p=="function"?p:(p[fr]||(p[fr]=function(T){return p.handleEvent(T)}),p[fr])}function Lt(){O.call(this),this.i=new Je(this),this.M=this,this.F=null}E(Lt,O),Lt.prototype[_e]=!0,Lt.prototype.removeEventListener=function(p,T,I,j){wr(this,p,T,I,j)};function jt(p,T){var I,j=p.F;if(j)for(I=[];j;j=j.F)I.push(j);if(p=p.M,j=T.type||T,typeof T=="string")T=new re(T,p);else if(T instanceof re)T.target=T.target||p;else{var se=T;T=new re(j,p),L(T,se)}if(se=!0,I)for(var me=I.length-1;0<=me;me--){var Me=T.g=I[me];se=$t(Me,j,!0,T)&&se}if(Me=T.g=p,se=$t(Me,j,!0,T)&&se,se=$t(Me,j,!1,T)&&se,I)for(me=0;me<I.length;me++)Me=T.g=I[me],se=$t(Me,j,!1,T)&&se}Lt.prototype.N=function(){if(Lt.aa.N.call(this),this.i){var p=this.i,T;for(T in p.g){for(var I=p.g[T],j=0;j<I.length;j++)xe(I[j]);delete p.g[T],p.h--}}this.F=null},Lt.prototype.K=function(p,T,I,j){return this.i.add(String(p),T,!1,I,j)},Lt.prototype.L=function(p,T,I,j){return this.i.add(String(p),T,!0,I,j)};function $t(p,T,I,j){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();for(var se=!0,me=0;me<T.length;++me){var Me=T[me];if(Me&&!Me.da&&Me.capture==I){var Nt=Me.listener,Sr=Me.ha||Me.src;Me.fa&&Y(p.i,Me),se=Nt.call(Sr,j)!==!1&&se}}return se&&!j.defaultPrevented}function Jr(p,T,I){if(typeof p=="function")I&&(p=v(p,I));else if(p&&typeof p.handleEvent=="function")p=v(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:c.setTimeout(p,T||0)}function rt(p){p.g=Jr(()=>{p.g=null,p.i&&(p.i=!1,rt(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class Ot extends O{constructor(T,I){super(),this.m=T,this.l=I,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:rt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hr(p){O.call(this),this.h=p,this.g={}}E(hr,O);var Ht=[];function $n(p){z(p.g,function(T,I){this.g.hasOwnProperty(I)&&ur(T)},p),p.g={}}hr.prototype.N=function(){hr.aa.N.call(this),$n(this)},hr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rs=c.JSON.stringify,ro=c.JSON.parse,no=class{stringify(p){return c.JSON.stringify(p,void 0)}parse(p){return c.JSON.parse(p,void 0)}};function Gi(){}Gi.prototype.h=null;function xa(p){return p.h||(p.h=p.i())}function _a(){}var Rn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ri(){re.call(this,"d")}E(ri,re);function yi(){re.call(this,"c")}E(yi,re);var ni={},io=null;function ya(){return io=io||new Lt}ni.La="serverreachability";function ao(p){re.call(this,ni.La,p)}E(ao,re);function Ei(p){const T=ya();jt(T,new ao(T))}ni.STAT_EVENT="statevent";function so(p,T){re.call(this,ni.STAT_EVENT,p),this.stat=T}E(so,re);function Jt(p){const T=ya();jt(T,new so(T,p))}ni.Ma="timingevent";function ns(p,T){re.call(this,ni.Ma,p),this.size=T}E(ns,re);function xn(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){p()},T)}function Ea(){this.g=!0}Ea.prototype.xa=function(){this.g=!1};function wa(p,T,I,j,se,me){p.info(function(){if(p.g)if(me)for(var Me="",Nt=me.split("&"),Sr=0;Sr<Nt.length;Sr++){var _t=Nt[Sr].split("=");if(1<_t.length){var Or=_t[0];_t=_t[1];var dr=Or.split("_");Me=2<=dr.length&&dr[1]=="type"?Me+(Or+"="+_t+"&"):Me+(Or+"=redacted&")}}else Me=null;else Me=me;return"XMLHTTP REQ ("+j+") [attempt "+se+"]: "+T+`
`+I+`
`+Me})}function is(p,T,I,j,se,me,Me){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+se+"]: "+T+`
`+I+`
`+me+" "+Me})}function D(p,T,I,j){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+H(p,I)+(j?" "+j:"")})}function K(p,T){p.info(function(){return"TIMEOUT: "+T})}Ea.prototype.info=function(){};function H(p,T){if(!p.g)return T;if(!T)return null;try{var I=JSON.parse(T);if(I){for(p=0;p<I.length;p++)if(Array.isArray(I[p])){var j=I[p];if(!(2>j.length)){var se=j[1];if(Array.isArray(se)&&!(1>se.length)){var me=se[0];if(me!="noop"&&me!="stop"&&me!="close")for(var Me=1;Me<se.length;Me++)se[Me]=""}}}}return rs(I)}catch{return T}}var W={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function le(){}E(le,Gi),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},X=new le;function ge(p,T,I,j){this.j=p,this.i=T,this.l=I,this.R=j||1,this.U=new hr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ue}function ue(){this.i=null,this.g="",this.h=!1}var he={},de={};function Pe(p,T,I){p.L=1,p.v=cs(zn(T)),p.m=I,p.P=!0,Le(p,null)}function Le(p,T){p.F=Date.now(),Fe(p),p.A=zn(p.v);var I=p.A,j=p.R;Array.isArray(j)||(j=[String(j)]),fs(I.i,"t",j),p.C=0,I=p.j.J,p.h=new ue,p.g=bf(p.j,I?T:null,!p.m),0<p.O&&(p.M=new Ot(v(p.Y,p,p.g),p.O)),T=p.U,I=p.g,j=p.ca;var se="readystatechange";Array.isArray(se)||(se&&(Ht[0]=se.toString()),se=Ht);for(var me=0;me<se.length;me++){var Me=ut(I,se[me],j||T.handleEvent,!1,T.h||T);if(!Me)break;T.g[Me.key]=Me}T=p.H?R(p.H):{},p.m?(p.u||(p.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,T)):(p.u="GET",p.g.ea(p.A,p.u,null,T)),Ei(),wa(p.i,p.u,p.A,p.l,p.R,p.m)}ge.prototype.ca=function(p){p=p.target;const T=this.M;T&&Fn(p)==3?T.j():this.Y(p)},ge.prototype.Y=function(p){try{if(p==this.g)e:{const dr=Fn(this.g);var T=this.g.Ba();const ai=this.g.Z();if(!(3>dr)&&(dr!=3||this.g&&(this.h.h||this.g.oa()||Cc(this.g)))){this.J||dr!=4||T==7||(T==8||0>=ai?Ei(3):Ei(2)),It(this);var I=this.g.Z();this.X=I;t:if(Be(this)){var j=Cc(this.g);p="";var se=j.length,me=Fn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dt(this),At(this);var Me="";break t}this.h.i=new c.TextDecoder}for(T=0;T<se;T++)this.h.h=!0,p+=this.h.i.decode(j[T],{stream:!(me&&T==se-1)});j.length=0,this.h.g+=p,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=I==200,is(this.i,this.u,this.A,this.l,this.R,dr,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,Sr=this.g;if((Nt=Sr.g?Sr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(Nt)){var _t=Nt;break t}}_t=null}if(I=_t)D(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wi(this,I);else{this.o=!1,this.s=3,Jt(12),Dt(this),At(this);break e}}if(this.P){I=!0;let Gn;for(;!this.J&&this.C<Me.length;)if(Gn=De(this,Me),Gn==de){dr==4&&(this.s=4,Jt(14),I=!1),D(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==he){this.s=4,Jt(15),D(this.i,this.l,Me,"[Invalid Chunk]"),I=!1;break}else D(this.i,this.l,Gn,null),wi(this,Gn);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dr!=4||Me.length!=0||this.h.h||(this.s=1,Jt(16),I=!1),this.o=this.o&&I,!I)D(this.i,this.l,Me,"[Invalid Chunked Response]"),Dt(this),At(this);else if(0<Me.length&&!this.W){this.W=!0;var Or=this.j;Or.g==this&&Or.ba&&!Or.M&&(Or.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),Rc(Or),Or.M=!0,Jt(11))}}else D(this.i,this.l,Me,null),wi(this,Me);dr==4&&Dt(this),this.o&&!this.J&&(dr==4?fl(this.j,this):(this.o=!1,Fe(this)))}else sl(this.g),I==400&&0<Me.indexOf("Unknown SID")?(this.s=3,Jt(12)):(this.s=0,Jt(13)),Dt(this),At(this)}}}catch{}finally{}};function Be(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function De(p,T){var I=p.C,j=T.indexOf(`
`,I);return j==-1?de:(I=Number(T.substring(I,j)),isNaN(I)?he:(j+=1,j+I>T.length?de:(T=T.slice(j,j+I),p.C=j+I,T)))}ge.prototype.cancel=function(){this.J=!0,Dt(this)};function Fe(p){p.S=Date.now()+p.I,et(p,p.I)}function et(p,T){if(p.B!=null)throw Error("WatchDog timer not null");p.B=xn(v(p.ba,p),T)}function It(p){p.B&&(c.clearTimeout(p.B),p.B=null)}ge.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(K(this.i,this.A),this.L!=2&&(Ei(),Jt(17)),Dt(this),this.s=2,At(this)):et(this,this.S-p)};function At(p){p.j.G==0||p.J||fl(p.j,p)}function Dt(p){It(p);var T=p.M;T&&typeof T.ma=="function"&&T.ma(),p.M=null,$n(p.U),p.g&&(T=p.g,p.g=null,T.abort(),T.ma())}function wi(p,T){try{var I=p.j;if(I.G!=0&&(I.g==p||zt(I.h,p))){if(!p.K&&zt(I.h,p)&&I.G==3){try{var j=I.Da.g.parse(T)}catch{j=null}if(Array.isArray(j)&&j.length==3){var se=j;if(se[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<p.F)ul(I),Ci(I);else break e;cl(I),Jt(18)}}else I.za=se[1],0<I.za-I.T&&37500>se[2]&&I.F&&I.v==0&&!I.C&&(I.C=xn(v(I.Za,I),6e3));if(1>=as(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else Ca(I,11)}else if((p.K||I.g==p)&&ul(I),!F(T))for(se=I.Da.g.parse(T),T=0;T<se.length;T++){let _t=se[T];if(I.T=_t[0],_t=_t[1],I.G==2)if(_t[0]=="c"){I.K=_t[1],I.ia=_t[2];const Or=_t[3];Or!=null&&(I.la=Or,I.j.info("VER="+I.la));const dr=_t[4];dr!=null&&(I.Aa=dr,I.j.info("SVER="+I.Aa));const ai=_t[5];ai!=null&&typeof ai=="number"&&0<ai&&(j=1.5*ai,I.L=j,I.j.info("backChannelRequestTimeoutMs_="+j)),j=I;const Gn=p.g;if(Gn){const ho=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ho){var me=j.h;me.g||ho.indexOf("spdy")==-1&&ho.indexOf("quic")==-1&&ho.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(Tc(me,me.h),me.h=null))}if(j.D){const dl=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;dl&&(j.ya=dl,Mt(j.I,j.D,dl))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-p.F,I.j.info("Handshake RTT: "+I.R+"ms")),j=I;var Me=p;if(j.qa=Ff(j,j.J?j.ia:null,j.W),Me.K){_f(j.h,Me);var Nt=Me,Sr=j.L;Sr&&(Nt.I=Sr),Nt.B&&(It(Nt),Fe(Nt)),j.g=Me}else fo(j);0<I.i.length&&Qi(I)}else _t[0]!="stop"&&_t[0]!="close"||Ca(I,7);else I.G==3&&(_t[0]=="stop"||_t[0]=="close"?_t[0]=="stop"?Ca(I,7):jr(I):_t[0]!="noop"&&I.l&&I.l.ta(_t),I.v=0)}}Ei(4)}catch{}}var Ki=class{constructor(p,T){this.g=p,this.map=T}};function Hn(p){this.l=p||10,c.PerformanceNavigationTiming?(p=c.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sr(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function as(p){return p.h?1:p.g?p.g.size:0}function zt(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Tc(p,T){p.g?p.g.add(T):p.h=T}function _f(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}Hn.prototype.cancel=function(){if(this.i=yf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function yf(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const I of p.g.values())T=T.concat(I.D);return T}return _(p.i)}function tl(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(u(p)){for(var T=[],I=p.length,j=0;j<I;j++)T.push(p[j]);return T}T=[],I=0;for(j in p)T[I++]=p[j];return T}function rl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(u(p)||typeof p=="string"){var T=[];p=p.length;for(var I=0;I<p;I++)T.push(I);return T}T=[],I=0;for(const j in p)T[I++]=j;return T}}}function ss(p,T){if(p.forEach&&typeof p.forEach=="function")p.forEach(T,void 0);else if(u(p)||typeof p=="string")Array.prototype.forEach.call(p,T,void 0);else for(var I=rl(p),j=tl(p),se=j.length,me=0;me<se;me++)T.call(void 0,j[me],I&&I[me],p)}var oo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pd(p,T){if(p){p=p.split("&");for(var I=0;I<p.length;I++){var j=p[I].indexOf("="),se=null;if(0<=j){var me=p[I].substring(0,j);se=p[I].substring(j+1)}else me=p[I];T(me,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Ta(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Ta){this.h=p.h,lo(this,p.j),this.o=p.o,this.g=p.g,os(this,p.s),this.l=p.l;var T=p.i,I=new qi;I.i=T.i,T.g&&(I.g=new Map(T.g),I.h=T.h),ls(this,I),this.m=p.m}else p&&(T=String(p).match(oo))?(this.h=!1,lo(this,T[1]||"",!0),this.o=gt(T[2]||""),this.g=gt(T[3]||"",!0),os(this,T[4]),this.l=gt(T[5]||"",!0),ls(this,T[6]||"",!0),this.m=gt(T[7]||"")):(this.h=!1,this.i=new qi(null,this.h))}Ta.prototype.toString=function(){var p=[],T=this.j;T&&p.push(us(T,nl,!0),":");var I=this.g;return(I||T=="file")&&(p.push("//"),(T=this.o)&&p.push(us(T,nl,!0),"@"),p.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&p.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(us(I,I.charAt(0)=="/"?Tf:wf,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",us(I,Sc)),p.join("")};function zn(p){return new Ta(p)}function lo(p,T,I){p.j=I?gt(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function os(p,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);p.s=T}else p.s=null}function ls(p,T,I){T instanceof qi?(p.i=T,Xi(p.i,p.h)):(I||(T=us(T,Sf)),p.i=new qi(T,p.h))}function Mt(p,T,I){p.i.set(T,I)}function cs(p){return Mt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function gt(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function us(p,T,I){return typeof p=="string"?(p=encodeURI(p).replace(T,Ef),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Ef(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var nl=/[#\/\?@]/g,wf=/[#\?:]/g,Tf=/[#\?]/g,Sf=/[#\?@]/g,Sc=/#/g;function qi(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function Ur(p){p.g||(p.g=new Map,p.h=0,p.i&&Pd(p.i,function(T,I){p.add(decodeURIComponent(T.replace(/\+/g," ")),I)}))}t=qi.prototype,t.add=function(p,T){Ur(this),this.i=null,p=ii(this,p);var I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(T),this.h+=1,this};function Ti(p,T){Ur(p),T=ii(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Si(p,T){return Ur(p),T=ii(p,T),p.g.has(T)}t.forEach=function(p,T){Ur(this),this.g.forEach(function(I,j){I.forEach(function(se){p.call(T,se,j,this)},this)},this)},t.na=function(){Ur(this);const p=Array.from(this.g.values()),T=Array.from(this.g.keys()),I=[];for(let j=0;j<T.length;j++){const se=p[j];for(let me=0;me<se.length;me++)I.push(T[j])}return I},t.V=function(p){Ur(this);let T=[];if(typeof p=="string")Si(this,p)&&(T=T.concat(this.g.get(ii(this,p))));else{p=Array.from(this.g.values());for(let I=0;I<p.length;I++)T=T.concat(p[I])}return T},t.set=function(p,T){return Ur(this),this.i=null,p=ii(this,p),Si(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=this.V(p),0<p.length?String(p[0]):T):T};function fs(p,T,I){Ti(p,T),0<I.length&&(p.i=null,p.g.set(ii(p,T),_(I)),p.h+=I.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(var I=0;I<T.length;I++){var j=T[I];const me=encodeURIComponent(String(j)),Me=this.V(j);for(j=0;j<Me.length;j++){var se=me;Me[j]!==""&&(se+="="+encodeURIComponent(String(Me[j]))),p.push(se)}}return this.i=p.join("&")};function ii(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function Xi(p,T){T&&!p.j&&(Ur(p),p.i=null,p.g.forEach(function(I,j){var se=j.toLowerCase();j!=se&&(Ti(this,j),fs(this,se,I))},p)),p.j=T}function Fd(p,T){const I=new Ea;if(c.Image){const j=new Image;j.onload=y(Pn,I,"TestLoadImage: loaded",!0,T,j),j.onerror=y(Pn,I,"TestLoadImage: error",!1,T,j),j.onabort=y(Pn,I,"TestLoadImage: abort",!1,T,j),j.ontimeout=y(Pn,I,"TestLoadImage: timeout",!1,T,j),c.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else T(!1)}function kf(p,T){const I=new Ea,j=new AbortController,se=setTimeout(()=>{j.abort(),Pn(I,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:j.signal}).then(me=>{clearTimeout(se),me.ok?Pn(I,"TestPingServer: ok",!0,T):Pn(I,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(se),Pn(I,"TestPingServer: error",!1,T)})}function Pn(p,T,I,j,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),j(I)}catch{}}function bd(){this.g=new no}function Af(p,T,I){const j=I||"";try{ss(p,function(se,me){let Me=se;h(se)&&(Me=rs(se)),T.push(j+me+"="+encodeURIComponent(Me))})}catch(se){throw T.push(j+"type="+encodeURIComponent("_badmap")),se}}function Sa(p){this.l=p.Ub||null,this.j=p.eb||!1}E(Sa,Gi),Sa.prototype.g=function(){return new co(this.l,this.j)},Sa.prototype.i=function(p){return function(){return p}}({});function co(p,T){Lt.call(this),this.D=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(co,Lt),t=co.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=T,this.readyState=1,Ai(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(T.body=p),(this.D||c).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ki(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ai(this)),this.g&&(this.readyState=3,Ai(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cf(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cf(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?ki(this):Ai(this),this.readyState==3&&Cf(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,ki(this))},t.Qa=function(p){this.g&&(this.response=p,ki(this))},t.ga=function(){this.g&&ki(this)};function ki(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Ai(p)}t.setRequestHeader=function(p,T){this.u.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var I=T.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=T.next();return p.join(`\r
`)};function Ai(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function ka(p){let T="";return z(p,function(I,j){T+=j,T+=":",T+=I,T+=`\r
`}),T}function hs(p,T,I){e:{for(j in I){var j=!1;break e}j=!0}j||(I=ka(I),typeof p=="string"?I!=null&&encodeURIComponent(String(I)):Mt(p,T,I))}function qt(p){Lt.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(qt,Lt);var Od=/^https?$/i,kc=["POST","PUT"];t=qt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,T,I,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?xa(this.o):xa(X),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(me){uo(this,me);return}if(p=I||"",I=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var se in j)I.set(se,j[se]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const me of j.keys())I.set(me,j.get(me));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(I.keys()).find(me=>me.toLowerCase()=="content-type"),se=c.FormData&&p instanceof c.FormData,!(0<=Array.prototype.indexOf.call(kc,T,void 0))||j||se||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,Me]of I)this.g.setRequestHeader(me,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{al(this),this.u=!0,this.g.send(p),this.u=!1}catch(me){uo(this,me)}};function uo(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.m=5,il(p),Wn(p)}function il(p){p.A||(p.A=!0,jt(p,"complete"),jt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,jt(this,"complete"),jt(this,"abort"),Wn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wn(this,!0)),qt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ac(this):this.bb())},t.bb=function(){Ac(this)};function Ac(p){if(p.h&&typeof o<"u"&&(!p.v[1]||Fn(p)!=4||p.Z()!=2)){if(p.u&&Fn(p)==4)Jr(p.Ea,0,p);else if(jt(p,"readystatechange"),Fn(p)==4){p.h=!1;try{const Me=p.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var I;if(!(I=T)){var j;if(j=Me===0){var se=String(p.D).match(oo)[1]||null;!se&&c.self&&c.self.location&&(se=c.self.location.protocol.slice(0,-1)),j=!Od.test(se?se.toLowerCase():"")}I=j}if(I)jt(p,"complete"),jt(p,"success");else{p.m=6;try{var me=2<Fn(p)?p.g.statusText:""}catch{me=""}p.l=me+" ["+p.Z()+"]",il(p)}}finally{Wn(p)}}}}function Wn(p,T){if(p.g){al(p);const I=p.g,j=p.v[0]?()=>{}:null;p.g=null,p.v=null,T||jt(p,"ready");try{I.onreadystatechange=j}catch{}}}function al(p){p.I&&(c.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Fn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Fn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),ro(T)}};function Cc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function sl(p){const T={};p=(p.g&&2<=Fn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(F(p[j]))continue;var I=M(p[j]);const se=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const me=T[se]||[];T[se]=me,me.push(I)}A(T,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(p,T,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||T}function Ic(p){this.Aa=0,this.i=[],this.j=new Ea,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yi("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yi("baseRetryDelayMs",5e3,p),this.cb=Yi("retryDelaySeedMs",1e4,p),this.Wa=Yi("forwardChannelMaxRetries",2,p),this.wa=Yi("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Hn(p&&p.concurrentRequestLimit),this.Da=new bd,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ic.prototype,t.la=8,t.G=1,t.connect=function(p,T,I,j){Jt(0),this.W=p,this.H=T||{},I&&j!==void 0&&(this.H.OSID=I,this.H.OAID=j),this.F=this.X,this.I=Ff(this,null,this.W),Qi(this)};function jr(p){if(ol(p),p.G==3){var T=p.U++,I=zn(p.I);if(Mt(I,"SID",p.K),Mt(I,"RID",T),Mt(I,"TYPE","terminate"),Aa(p,I),T=new ge(p,p.j,T),T.L=2,T.v=cs(zn(I)),I=!1,c.navigator&&c.navigator.sendBeacon)try{I=c.navigator.sendBeacon(T.v.toString(),"")}catch{}!I&&c.Image&&(new Image().src=T.v,I=!0),I||(T.g=bf(T.j,null),T.g.ea(T.v)),T.F=Date.now(),Fe(T)}Pf(p)}function Ci(p){p.g&&(Rc(p),p.g.cancel(),p.g=null)}function ol(p){Ci(p),p.u&&(c.clearTimeout(p.u),p.u=null),ul(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&c.clearTimeout(p.s),p.s=null)}function Qi(p){if(!sr(p.h)&&!p.s){p.s=!0;var T=p.Ga;Te||ve(),ye||(Te(),ye=!0),ie.add(T,p),p.B=0}}function Dd(p,T){return as(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=T.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=xn(v(p.Ga,p,T),Rf(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const se=new ge(this,this.j,p);let me=this.o;if(this.S&&(me?(me=R(me),L(me,this.S)):me=this.S),this.m!==null||this.O||(se.H=me,me=null),this.P)e:{for(var T=0,I=0;I<this.i.length;I++){t:{var j=this.i[I];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(T+=j,4096<T){T=I;break e}if(T===4096||I===this.i.length-1){T=I+1;break e}}T=1e3}else T=1e3;T=ds(this,se,T),I=zn(this.I),Mt(I,"RID",p),Mt(I,"CVER",22),this.D&&Mt(I,"X-HTTP-Session-Id",this.D),Aa(this,I),me&&(this.O?T="headers="+encodeURIComponent(String(ka(me)))+"&"+T:this.m&&hs(I,this.m,me)),Tc(this.h,se),this.Ua&&Mt(I,"TYPE","init"),this.P?(Mt(I,"$req",T),Mt(I,"SID","null"),se.T=!0,Pe(se,I,null)):Pe(se,I,T),this.G=2}}else this.G==3&&(p?ll(this,p):this.i.length==0||sr(this.h)||ll(this))};function ll(p,T){var I;T?I=T.l:I=p.U++;const j=zn(p.I);Mt(j,"SID",p.K),Mt(j,"RID",I),Mt(j,"AID",p.T),Aa(p,j),p.m&&p.o&&hs(j,p.m,p.o),I=new ge(p,p.j,I,p.B+1),p.m===null&&(I.H=p.o),T&&(p.i=T.D.concat(p.i)),T=ds(p,I,1e3),I.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Tc(p.h,I),Pe(I,j,T)}function Aa(p,T){p.H&&z(p.H,function(I,j){Mt(T,j,I)}),p.l&&ss({},function(I,j){Mt(T,j,I)})}function ds(p,T,I){I=Math.min(p.i.length,I);var j=p.l?v(p.l.Na,p.l,p):null;e:{var se=p.i;let me=-1;for(;;){const Me=["count="+I];me==-1?0<I?(me=se[0].g,Me.push("ofs="+me)):me=0:Me.push("ofs="+me);let Nt=!0;for(let Sr=0;Sr<I;Sr++){let _t=se[Sr].g;const Or=se[Sr].map;if(_t-=me,0>_t)me=Math.max(0,se[Sr].g-100),Nt=!1;else try{Af(Or,Me,"req"+_t+"_")}catch{j&&j(Or)}}if(Nt){j=Me.join("&");break e}}}return p=p.i.splice(0,I),T.D=p,j}function fo(p){if(!p.g&&!p.u){p.Y=1;var T=p.Fa;Te||ve(),ye||(Te(),ye=!0),ie.add(T,p),p.v=0}}function cl(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=xn(v(p.Fa,p),Rf(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,If(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=xn(v(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Jt(10),Ci(this),If(this))};function Rc(p){p.A!=null&&(c.clearTimeout(p.A),p.A=null)}function If(p){p.g=new ge(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var T=zn(p.qa);Mt(T,"RID","rpc"),Mt(T,"SID",p.K),Mt(T,"AID",p.T),Mt(T,"CI",p.F?"0":"1"),!p.F&&p.ja&&Mt(T,"TO",p.ja),Mt(T,"TYPE","xmlhttp"),Aa(p,T),p.m&&p.o&&hs(T,p.m,p.o),p.L&&(p.g.I=p.L);var I=p.g;p=p.ia,I.L=1,I.v=cs(zn(T)),I.m=null,I.P=!0,Le(I,p)}t.Za=function(){this.C!=null&&(this.C=null,Ci(this),cl(this),Jt(19))};function ul(p){p.C!=null&&(c.clearTimeout(p.C),p.C=null)}function fl(p,T){var I=null;if(p.g==T){ul(p),Rc(p),p.g=null;var j=2}else if(zt(p.h,T))I=T.D,_f(p.h,T),j=1;else return;if(p.G!=0){if(T.o)if(j==1){I=T.m?T.m.length:0,T=Date.now()-T.F;var se=p.B;j=ya(),jt(j,new ns(j,I)),Qi(p)}else fo(p);else if(se=T.s,se==3||se==0&&0<T.X||!(j==1&&Dd(p,T)||j==2&&cl(p)))switch(I&&0<I.length&&(T=p.h,T.i=T.i.concat(I)),se){case 1:Ca(p,5);break;case 4:Ca(p,10);break;case 3:Ca(p,6);break;default:Ca(p,2)}}}function Rf(p,T){let I=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(I*=2),I*T}function Ca(p,T){if(p.j.info("Error code "+T),T==2){var I=v(p.fb,p),j=p.Xa;const se=!j;j=new Ta(j||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||lo(j,"https"),cs(j),se?Fd(j.toString(),I):kf(j.toString(),I)}else Jt(2);p.G=0,p.l&&p.l.sa(T),Pf(p),ol(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))};function Pf(p){if(p.G=0,p.ka=[],p.l){const T=yf(p.h);(T.length!=0||p.i.length!=0)&&(w(p.ka,T),w(p.ka,p.i),p.h.i.length=0,_(p.i),p.i.length=0),p.l.ra()}}function Ff(p,T,I){var j=I instanceof Ta?zn(I):new Ta(I);if(j.g!="")T&&(j.g=T+"."+j.g),os(j,j.s);else{var se=c.location;j=se.protocol,T=T?T+"."+se.hostname:se.hostname,se=+se.port;var me=new Ta(null);j&&lo(me,j),T&&(me.g=T),se&&os(me,se),I&&(me.l=I),j=me}return I=p.D,T=p.ya,I&&T&&Mt(j,I,T),Mt(j,"VER",p.la),Aa(p,j),j}function bf(p,T,I){if(T&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Ca&&!p.pa?new qt(new Sa({eb:I})):new qt(p.pa),T.Ha(p.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pc(){}t=Pc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function hl(){}hl.prototype.g=function(p,T){return new _n(p,T)};function _n(p,T){Lt.call(this),this.g=new Ic(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(p?p["X-WebChannel-Client-Profile"]=T.va:p={"X-WebChannel-Client-Profile":T.va}),this.g.S=p,(p=T&&T.Sb)&&!F(p)&&(this.g.m=p),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!F(T)&&(this.g.D=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Ji(this)}E(_n,Lt),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){jr(this.g)},_n.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.u&&(I={},I.__data__=rs(p),p=I);T.i.push(new Ki(T.Ya++,p)),T.G==3&&Qi(T)},_n.prototype.N=function(){this.g.l=null,delete this.j,jr(this.g),delete this.g,_n.aa.N.call(this)};function Of(p){ri.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const I in T){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}E(Of,ri);function Df(){yi.call(this),this.status=1}E(Df,yi);function Ji(p){this.g=p}E(Ji,Pc),Ji.prototype.ua=function(){jt(this.g,"a")},Ji.prototype.ta=function(p){jt(this.g,new Of(p))},Ji.prototype.sa=function(p){jt(this.g,new Df)},Ji.prototype.ra=function(){jt(this.g,"b")},hl.prototype.createWebChannel=hl.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,r2=function(){return new hl},t2=function(){return ya()},e2=ni,qm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},W.NO_ERROR=0,W.TIMEOUT=8,W.HTTP_ERROR=6,t0=W,q.COMPLETE="complete",ZT=q,_a.EventType=Rn,Rn.OPEN="a",Rn.CLOSE="b",Rn.ERROR="c",Rn.MESSAGE="d",Lt.prototype.listen=Lt.prototype.K,au=_a,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,JT=qt}).apply(typeof Ph<"u"?Ph:typeof self<"u"?self:typeof window<"u"?window:{});const my="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pc="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo=new Bg("@firebase/firestore");function Ll(){return Mo.logLevel}function je(t,...e){if(Mo.logLevel<=pt.DEBUG){const r=e.map(Qg);Mo.debug(`Firestore (${pc}): ${t}`,...r)}}function qa(t,...e){if(Mo.logLevel<=pt.ERROR){const r=e.map(Qg);Mo.error(`Firestore (${pc}): ${t}`,...r)}}function Jl(t,...e){if(Mo.logLevel<=pt.WARN){const r=e.map(Qg);Mo.warn(`Firestore (${pc}): ${t}`,...r)}}function Qg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t="Unexpected state"){const e=`FIRESTORE (${pc}) INTERNAL ASSERTION FAILED: `+t;throw qa(e),new Error(e)}function bt(t,e){t||it()}function lt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Ja{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Fb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(on.UNAUTHENTICATED))}shutdown(){}}class bb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Ob{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){bt(this.o===void 0);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new $a;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new $a,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new $a)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(bt(typeof n.accessToken=="string"),new n2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string"),new on(e)}}class Db{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=on.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Nb{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Db(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Lb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Mb{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){bt(this.o===void 0);const n=a=>{a.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,je("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(bt(typeof r.token=="string"),this.R=r.token,new Lb(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Vb(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%e.length))}return n}}function vt(t,e){return t<e?-1:t>e?1:0}function Zl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{static now(){return Rr.fromMillis(Date.now())}static fromDate(e){return Rr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Rr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new $e(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new Rr(0,0))}static max(){return new st(new Rr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,r,n){r===void 0?r=0:r>e.length&&it(),n===void 0?n=e.length-r:n>e.length-r&&it(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=e.get(i),o=r.get(i);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Kt extends Fu{construct(e,r,n){return new Kt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(ke.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Kt(r)}static emptyPath(){return new Kt([])}}const Bb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qr extends Fu{construct(e,r,n){return new qr(e,r,n)}static isValidIdentifier(e){return Bb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new qr(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new $e(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new $e(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new $e(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(n+=c,i++):(a(),i++)}if(a(),o)throw new $e(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qr(r)}static emptyPath(){return new qr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Kt.fromString(e))}static fromName(e){return new qe(Kt.fromString(e).popFirst(5))}static empty(){return new qe(Kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Kt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Kt(e.slice()))}}function Ub(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=st.fromTimestamp(n===1e9?new Rr(r+1,0):new Rr(r,n));return new Ws(i,qe.empty(),e)}function jb(t){return new Ws(t.readTime,t.key,-1)}class Ws{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ws(st.min(),qe.empty(),-1)}static max(){return new Ws(st.max(),qe.empty(),-1)}}function $b(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=qe.comparator(t.documentKey,e.documentKey),r!==0?r:vt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(t){if(t.code!==ke.FAILED_PRECONDITION||t.message!==Hb)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&it(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ae((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ae?r:Ae.resolve(r)}catch(r){return Ae.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ae.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ae.reject(r)}static resolve(e){return new Ae((r,n)=>{r(e)})}static reject(e){return new Ae((r,n)=>{n(e)})}static waitFor(e){return new Ae((r,n)=>{let i=0,a=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++a,o&&a===i&&r()},u=>n(u))}),o=!0,a===i&&r()})}static or(e){let r=Ae.resolve(!1);for(const n of e)r=r.next(i=>i?Ae.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new Ae((n,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;r(e[h]).next(d=>{o[h]=d,++c,c===a&&n(o)},d=>i(d))}})}static doWhile(e,r){return new Ae((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function Wb(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function gc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}rd.oe=-1;function nd(t){return t==null}function _0(t){return t===0&&1/t==-1/0}function Gb(t){return typeof t=="number"&&Number.isInteger(t)&&!_0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=gy(e)),e=qb(t.get(r),e);return gy(e)}function qb(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function gy(t){return t+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Js(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function a2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,r){this.comparator=e,this.root=r||Wr.EMPTY}insert(e,r){return new tr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fh(this.root,e,this.comparator,!0)}}class Fh{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wr{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Wr.RED,this.left=i??Wr.EMPTY,this.right=a??Wr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Wr(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Wr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Wr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw it();const e=this.left.check();if(e!==this.right.check())throw it();return e+(this.isRed()?0:1)}}Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw it()}get value(){throw it()}get color(){throw it()}get left(){throw it()}get right(){throw it()}copy(e,r,n,i,a){return this}insert(e,r,n){return new Wr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new xy(this.data.getIterator())}getIteratorFrom(e){return new xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.fields=e,e.sort(qr.comparator)}static empty(){return new Zn([])}unionWith(e){let r=new Pr(qr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Zl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new s2("Invalid base64 string: "+a):a}}(e);return new Qr(r)}static fromUint8Array(e){const r=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new Qr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qr.EMPTY_BYTE_STRING=new Qr("");const Xb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gs(t){if(bt(!!t),typeof t=="string"){let e=0;const r=Xb.exec(t);if(bt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:cr(t.seconds),nanos:cr(t.nanos)}}function cr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function id(t){const e=t.mapValue.fields.__previous_value__;return Jg(e)?id(e):e}function bu(t){const e=Gs(t.mapValue.fields.__local_write_time__.timestampValue);return new Rr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,r,n,i,a,o,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class Ou{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ou("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ou&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function qs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Jg(t)?4:Jb(t)?9007199254740991:Qb(t)?10:11:it()}function da(t,e){if(t===e)return!0;const r=qs(t);if(r!==qs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bu(t).isEqual(bu(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Gs(i.timestampValue),c=Gs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Ks(i.bytesValue).isEqual(Ks(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return cr(i.geoPointValue.latitude)===cr(a.geoPointValue.latitude)&&cr(i.geoPointValue.longitude)===cr(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return cr(i.integerValue)===cr(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=cr(i.doubleValue),c=cr(a.doubleValue);return o===c?_0(o)===_0(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Zl(t.arrayValue.values||[],e.arrayValue.values||[],da);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(vy(o)!==vy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!da(o[u],c[u])))return!1;return!0}(t,e);default:return it()}}function Du(t,e){return(t.values||[]).find(r=>da(r,e))!==void 0}function ec(t,e){if(t===e)return 0;const r=qs(t),n=qs(e);if(r!==n)return vt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return vt(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=cr(a.integerValue||a.doubleValue),u=cr(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return _y(t.timestampValue,e.timestampValue);case 4:return _y(bu(t),bu(e));case 5:return vt(t.stringValue,e.stringValue);case 6:return function(a,o){const c=Ks(a),u=Ks(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const d=vt(c[h],u[h]);if(d!==0)return d}return vt(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=vt(cr(a.latitude),cr(o.latitude));return c!==0?c:vt(cr(a.longitude),cr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yy(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,h,d;const g=a.fields||{},v=o.fields||{},y=(c=g.value)===null||c===void 0?void 0:c.arrayValue,E=(u=v.value)===null||u===void 0?void 0:u.arrayValue,_=vt(((h=y==null?void 0:y.values)===null||h===void 0?void 0:h.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return _!==0?_:yy(y,E)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===bh.mapValue&&o===bh.mapValue)return 0;if(a===bh.mapValue)return 1;if(o===bh.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const v=vt(u[g],d[g]);if(v!==0)return v;const y=ec(c[u[g]],h[d[g]]);if(y!==0)return y}return vt(u.length,d.length)}(t.mapValue,e.mapValue);default:throw it()}}function _y(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return vt(t,e);const r=Gs(t),n=Gs(e),i=vt(r.seconds,n.seconds);return i!==0?i:vt(r.nanos,n.nanos)}function yy(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=ec(r[i],n[i]);if(a)return a}return vt(r.length,n.length)}function tc(t){return Xm(t)}function Xm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Gs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ks(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return qe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=Xm(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const o of n)a?a=!1:i+=",",i+=`${o}:${Xm(r.fields[o])}`;return i+"}"}(t.mapValue):it()}function r0(t){switch(qs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=id(t);return e?16+r0(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+r0(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Js(n.fields,(a,o)=>{i+=a.length+r0(o)}),i}(t.mapValue);default:throw it()}}function Ey(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ym(t){return!!t&&"integerValue"in t}function Zg(t){return!!t&&"arrayValue"in t}function wy(t){return!!t&&"nullValue"in t}function Ty(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function n0(t){return!!t&&"mapValue"in t}function Qb(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function mu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Js(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=mu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=mu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Jb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e){this.value=e}static empty(){return new Un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!n0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(r)}setAll(e){let r=qr.emptyPath(),n={},i=[];e.forEach((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}o?n[c.lastSegment()]=mu(o):i.push(c.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());n0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return da(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];n0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Js(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Un(mu(this.value))}}function o2(t){const e=[];return Js(t.fields,(r,n)=>{const i=new qr([r]);if(n0(n)){const a=o2(n.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new Zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,r,n,i,a,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new cn(e,0,st.min(),st.min(),st.min(),Un.empty(),0)}static newFoundDocument(e,r,n,i){return new cn(e,1,r,st.min(),n,i,0)}static newNoDocument(e,r){return new cn(e,2,r,st.min(),st.min(),Un.empty(),0)}static newUnknownDocument(e,r){return new cn(e,3,r,st.min(),st.min(),Un.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,r){this.position=e,this.inclusive=r}}function Sy(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?n=qe.comparator(qe.fromName(o.referenceValue),r.key):n=ec(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function ky(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!da(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,r="asc"){this.field=e,this.dir=r}}function Zb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2{}class yr extends l2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new tO(e,r,n):r==="array-contains"?new iO(e,n):r==="in"?new aO(e,n):r==="not-in"?new sO(e,n):r==="array-contains-any"?new oO(e,n):new yr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new rO(e,n):new nO(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ec(r,this.value)):r!==null&&qs(this.value)===qs(r)&&this.matchesComparison(ec(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $i extends l2{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new $i(e,r)}matches(e){return c2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function c2(t){return t.op==="and"}function u2(t){return eO(t)&&c2(t)}function eO(t){for(const e of t.filters)if(e instanceof $i)return!1;return!0}function Qm(t){if(t instanceof yr)return t.field.canonicalString()+t.op.toString()+tc(t.value);if(u2(t))return t.filters.map(e=>Qm(e)).join(",");{const e=t.filters.map(r=>Qm(r)).join(",");return`${t.op}(${e})`}}function f2(t,e){return t instanceof yr?function(n,i){return i instanceof yr&&n.op===i.op&&n.field.isEqual(i.field)&&da(n.value,i.value)}(t,e):t instanceof $i?function(n,i){return i instanceof $i&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,o,c)=>a&&f2(o,i.filters[c]),!0):!1}(t,e):void it()}function h2(t){return t instanceof yr?function(r){return`${r.field.canonicalString()} ${r.op} ${tc(r.value)}`}(t):t instanceof $i?function(r){return r.op.toString()+" {"+r.getFilters().map(h2).join(" ,")+"}"}(t):"Filter"}class tO extends yr{constructor(e,r,n){super(e,r,n),this.key=qe.fromName(n.referenceValue)}matches(e){const r=qe.comparator(e.key,this.key);return this.matchesComparison(r)}}class rO extends yr{constructor(e,r){super(e,"in",r),this.keys=d2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class nO extends yr{constructor(e,r){super(e,"not-in",r),this.keys=d2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function d2(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>qe.fromName(n.referenceValue))}class iO extends yr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zg(r)&&Du(r.arrayValue,this.value)}}class aO extends yr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Du(this.value.arrayValue,r)}}class sO extends yr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Du(this.value.arrayValue,r)}}class oO extends yr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Du(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,r=null,n=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.ue=null}}function Ay(t,e=null,r=[],n=[],i=null,a=null,o=null){return new lO(t,e,r,n,i,a,o)}function e1(t){const e=lt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Qm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),nd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>tc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>tc(n)).join(",")),e.ue=r}return e.ue}function t1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Zb(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!f2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ky(t.startAt,e.startAt)&&ky(t.endAt,e.endAt)}function Jm(t){return qe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,r=null,n=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function cO(t,e,r,n,i,a,o,c){return new tf(t,e,r,n,i,a,o,c)}function r1(t){return new tf(t)}function Cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function p2(t){return t.collectionGroup!==null}function gu(t){const e=lt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Pr(qr.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new E0(a,n))}),r.has(qr.keyField().canonicalString())||e.ce.push(new E0(qr.keyField(),n))}return e.ce}function ca(t){const e=lt(t);return e.le||(e.le=uO(e,gu(t))),e.le}function uO(t,e){if(t.limitType==="F")return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new E0(i.field,a)});const r=t.endAt?new y0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new y0(t.startAt.position,t.startAt.inclusive):null;return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Zm(t,e){const r=t.filters.concat([e]);return new tf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function eg(t,e,r){return new tf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ad(t,e){return t1(ca(t),ca(e))&&t.limitType===e.limitType}function m2(t){return`${e1(ca(t))}|lt:${t.limitType}`}function Ml(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>h2(i)).join(", ")}]`),nd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>tc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>tc(i)).join(",")),`Target(${n})`}(ca(t))}; limitType=${t.limitType})`}function sd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):qe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of gu(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(o,c,u){const h=Sy(o,c,u);return o.inclusive?h<=0:h<0}(n.startAt,gu(n),i)||n.endAt&&!function(o,c,u){const h=Sy(o,c,u);return o.inclusive?h>=0:h>0}(n.endAt,gu(n),i))}(t,e)}function fO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function g2(t){return(e,r)=>{let n=!1;for(const i of gu(t)){const a=hO(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function hO(t,e,r){const n=t.field.isKeyField()?qe.comparator(e.key,r.key):function(a,o,c){const u=o.data.field(a),h=c.data.field(a);return u!==null&&h!==null?ec(u,h):it()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return it()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Js(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return a2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO=new tr(qe.comparator);function Xa(){return dO}const v2=new tr(qe.comparator);function su(...t){let e=v2;for(const r of t)e=e.insert(r.key,r);return e}function x2(t){let e=v2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ro(){return vu()}function _2(){return vu()}function vu(){return new Wo(t=>t.toString(),(t,e)=>t.isEqual(e))}const pO=new tr(qe.comparator),mO=new Pr(qe.comparator);function mt(...t){let e=mO;for(const r of t)e=e.add(r);return e}const gO=new Pr(vt);function vO(){return gO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_0(e)?"-0":e}}function y2(t){return{integerValue:""+t}}function xO(t,e){return Gb(e)?y2(e):n1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(){this._=void 0}}function _O(t,e,r){return t instanceof w0?function(i,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Jg(a)&&(a=id(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof rc?w2(t,e):t instanceof nc?T2(t,e):function(i,a){const o=E2(i,a),c=Iy(o)+Iy(i.Pe);return Ym(o)&&Ym(i.Pe)?y2(c):n1(i.serializer,c)}(t,e)}function yO(t,e,r){return t instanceof rc?w2(t,e):t instanceof nc?T2(t,e):r}function E2(t,e){return t instanceof T0?function(n){return Ym(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class w0 extends od{}class rc extends od{constructor(e){super(),this.elements=e}}function w2(t,e){const r=S2(e);for(const n of t.elements)r.some(i=>da(i,n))||r.push(n);return{arrayValue:{values:r}}}class nc extends od{constructor(e){super(),this.elements=e}}function T2(t,e){let r=S2(e);for(const n of t.elements)r=r.filter(i=>!da(i,n));return{arrayValue:{values:r}}}class T0 extends od{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Iy(t){return cr(t.integerValue||t.doubleValue)}function S2(t){return Zg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,r){this.field=e,this.transform=r}}function EO(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof rc&&i instanceof rc||n instanceof nc&&i instanceof nc?Zl(n.elements,i.elements,da):n instanceof T0&&i instanceof T0?da(n.Pe,i.Pe):n instanceof w0&&i instanceof w0}(t.transform,e.transform)}class wO{constructor(e,r){this.version=e,this.transformResults=r}}class kn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new kn}static exists(e){return new kn(void 0,e)}static updateTime(e){return new kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function i0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ld{}function A2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new cd(t.key,kn.none()):new rf(t.key,t.data,kn.none());{const r=t.data,n=Un.empty();let i=new Pr(qr.comparator);for(let a of e.fields)if(!i.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),i=i.add(a)}return new Zs(t.key,n,new Zn(i.toArray()),kn.none())}}function TO(t,e,r){t instanceof rf?function(i,a,o){const c=i.value.clone(),u=Py(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Zs?function(i,a,o){if(!i0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=Py(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(C2(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function xu(t,e,r,n){return t instanceof rf?function(a,o,c,u){if(!i0(a.precondition,o))return c;const h=a.value.clone(),d=Fy(a.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Zs?function(a,o,c,u){if(!i0(a.precondition,o))return c;const h=Fy(a.fieldTransforms,u,o),d=o.data;return d.setAll(C2(a)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(a,o,c){return i0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,r)}function SO(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=E2(n.transform,i||null);a!=null&&(r===null&&(r=Un.empty()),r.set(n.field,a))}return r||null}function Ry(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Zl(n,i,(a,o)=>EO(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class rf extends ld{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zs extends ld{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function C2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Py(t,e,r){const n=new Map;bt(t.length===r.length);for(let i=0;i<r.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);n.set(a.field,yO(o,c,r[i]))}return n}function Fy(t,e,r){const n=new Map;for(const i of t){const a=i.transform,o=r.data.field(i.field);n.set(i.field,_O(a,o,e))}return n}class cd extends ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kO extends ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&TO(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=xu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=xu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=_2();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=r.has(i.key)?null:c;const u=A2(o,c);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(st.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),mt())}isEqual(e){return this.batchId===e.batchId&&Zl(this.mutations,e.mutations,(r,n)=>Ry(r,n))&&Zl(this.baseMutations,e.baseMutations,(r,n)=>Ry(r,n))}}class i1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){bt(e.mutations.length===n.length);let i=function(){return pO}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,n[o].version);return new i1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gr,yt;function RO(t){switch(t){default:return it();case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0}}function I2(t){if(t===void 0)return qa("GRPC error has no .code"),ke.UNKNOWN;switch(t){case gr.OK:return ke.OK;case gr.CANCELLED:return ke.CANCELLED;case gr.UNKNOWN:return ke.UNKNOWN;case gr.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case gr.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case gr.INTERNAL:return ke.INTERNAL;case gr.UNAVAILABLE:return ke.UNAVAILABLE;case gr.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case gr.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case gr.NOT_FOUND:return ke.NOT_FOUND;case gr.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case gr.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case gr.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case gr.ABORTED:return ke.ABORTED;case gr.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case gr.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case gr.DATA_LOSS:return ke.DATA_LOSS;default:return it()}}(yt=gr||(gr={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO=new Fo([4294967295,4294967295],0);function by(t){const e=PO().encode(t),r=new QT;return r.update(e),new Uint8Array(r.digest())}function Oy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Fo([r,n],0),new Fo([i,a],0)]}class a1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ou(`Invalid padding: ${r}`);if(n<0)throw new ou(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ou(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*e.length-r,this.Ie=Fo.fromNumber(this.Te)}Ee(e,r,n){let i=e.add(r.multiply(Fo.fromNumber(n)));return i.compare(FO)===1&&(i=new Fo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const r=by(e),[n,i]=Oy(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new a1(a,i,r);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.Te===0)return;const r=by(e),[n,i]=Oy(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,nf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ud(st.min(),i,new tr(vt),Xa(),mt())}}class nf{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new nf(n,r,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class R2{constructor(e,r){this.targetId=e,this.me=r}}class P2{constructor(e,r,n=Qr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Dy{constructor(){this.fe=0,this.ge=Ny(),this.pe=Qr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=mt(),r=mt(),n=mt();return this.ge.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:it()}}),new nf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Ny()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,bt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class bO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xa(),this.qe=Oh(),this.Qe=Oh(),this.Ke=new tr(vt)}$e(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(r,e.Ve):this.We(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.We(r,e.key,e.Ve)}Ge(e){this.forEachTarget(e,r=>{const n=this.ze(r);switch(e.state){case 0:this.je(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.je(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.je(r)&&(this.He(r),n.De(e.resumeToken));break;default:it()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.je(i)&&r(i)})}Je(e){const r=e.targetId,n=e.me.count,i=this.Ye(r);if(i){const a=i.target;if(Jm(a))if(n===0){const o=new qe(a.path);this.We(r,o,cn.newNoDocument(o,st.min()))}else bt(n===1);else{const o=this.Ze(r);if(o!==n){const c=this.Xe(e),u=c?this.et(c,e,o):1;if(u!==0){this.He(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,h)}}}}}Xe(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let o,c;try{o=Ks(n).toUint8Array()}catch(u){if(u instanceof s2)return Jl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new a1(o,i,a)}catch(u){return Jl(u instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Te===0?null:c}et(e,r,n){return r.me.count===n-this.rt(e,r.targetId)?0:2}rt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const o=this.Le.nt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.We(r,a,null),i++)}),i}it(e){const r=new Map;this.Be.forEach((a,o)=>{const c=this.Ye(o);if(c){if(a.current&&Jm(c.target)){const u=new qe(c.target.path);this.st(u).has(o)||this.ot(o,u)||this.We(o,u,cn.newNoDocument(u,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=mt();this.Qe.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Ye(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const i=new ud(e,r,this.Ke,this.ke,n);return this.ke=Xa(),this.qe=Oh(),this.Qe=Oh(),this.Ke=new tr(vt),i}Ue(e,r){if(!this.je(e))return;const n=this.ot(e,r.key)?2:0;this.ze(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e)),this.Qe=this.Qe.insert(r.key,this._t(r.key).add(e))}We(e,r,n){if(!this.je(e))return;const i=this.ze(e);this.ot(e,r)?i.Fe(r,1):i.Me(r),this.Qe=this.Qe.insert(r,this._t(r).delete(e)),this.Qe=this.Qe.insert(r,this._t(r).add(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ze(e){const r=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let r=this.Be.get(e);return r||(r=new Dy,this.Be.set(e,r)),r}_t(e){let r=this.Qe.get(e);return r||(r=new Pr(vt),this.Qe=this.Qe.insert(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Pr(vt),this.qe=this.qe.insert(e,r)),r}je(e){const r=this.Ye(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}Ye(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new Dy),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.We(e,r,null)})}ot(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Oh(){return new tr(qe.comparator)}function Ny(){return new tr(qe.comparator)}const OO={asc:"ASCENDING",desc:"DESCENDING"},DO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NO={and:"AND",or:"OR"};class LO{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function tg(t,e){return t.useProto3Json||nd(e)?e:{value:e}}function S0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function F2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MO(t,e){return S0(t,e.toTimestamp())}function ua(t){return bt(!!t),st.fromTimestamp(function(r){const n=Gs(r);return new Rr(n.seconds,n.nanos)}(t))}function s1(t,e){return rg(t,e).canonicalString()}function rg(t,e){const r=function(i){return new Kt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function b2(t){const e=Kt.fromString(t);return bt(M2(e)),e}function ng(t,e){return s1(t.databaseId,e.path)}function pm(t,e){const r=b2(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new qe(D2(r))}function O2(t,e){return s1(t.databaseId,e)}function VO(t){const e=b2(t);return e.length===4?Kt.emptyPath():D2(e)}function ig(t){return new Kt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function D2(t){return bt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ly(t,e,r){return{name:ng(t,e),fields:r.value.mapValue.fields}}function BO(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:it()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(h,d){return h.useProto3Json?(bt(d===void 0||typeof d=="string"),Qr.fromBase64String(d||"")):(bt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Qr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const d=h.code===void 0?ke.UNKNOWN:I2(h.code);return new $e(d,h.message||"")}(o);r=new P2(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=pm(t,n.document.name),a=ua(n.document.updateTime),o=n.document.createTime?ua(n.document.createTime):st.min(),c=new Un({mapValue:{fields:n.document.fields}}),u=cn.newFoundDocument(i,a,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new a0(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=pm(t,n.document),a=n.readTime?ua(n.readTime):st.min(),o=cn.newNoDocument(i,a),c=n.removedTargetIds||[];r=new a0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=pm(t,n.document),a=n.removedTargetIds||[];r=new a0([],a,i,null)}else{if(!("filter"in e))return it();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,o=new IO(i,a),c=n.targetId;r=new R2(c,o)}}return r}function UO(t,e){let r;if(e instanceof rf)r={update:Ly(t,e.key,e.value)};else if(e instanceof cd)r={delete:ng(t,e.key)};else if(e instanceof Zs)r={update:Ly(t,e.key,e.data),updateMask:XO(e.fieldMask)};else{if(!(e instanceof kO))return it();r={verify:ng(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const c=o.transform;if(c instanceof w0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof rc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof nc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof T0)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw it()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:MO(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:it()}(t,e.precondition)),r}function jO(t,e){return t&&t.length>0?(bt(e!==void 0),t.map(r=>function(i,a){let o=i.updateTime?ua(i.updateTime):ua(a);return o.isEqual(st.min())&&(o=ua(a)),new wO(o,i.transformResults||[])}(r,e))):[]}function $O(t,e){return{documents:[O2(t,e.path)]}}function HO(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=O2(t,i);const a=function(h){if(h.length!==0)return L2($i.create(h,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(h){if(h.length!==0)return h.map(d=>function(v){return{field:Vl(v.field),direction:GO(v.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=tg(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ct:r,parent:i}}function zO(t){let e=VO(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){bt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(g){const v=N2(g);return v instanceof $i&&u2(v)?v.getFilters():[v]}(r.where));let o=[];r.orderBy&&(o=function(g){return g.map(v=>function(E){return new E0(Bl(E.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(v))}(r.orderBy));let c=null;r.limit&&(c=function(g){let v;return v=typeof g=="object"?g.value:g,nd(v)?null:v}(r.limit));let u=null;r.startAt&&(u=function(g){const v=!!g.before,y=g.values||[];return new y0(y,v)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const v=!g.before,y=g.values||[];return new y0(y,v)}(r.endAt)),cO(e,i,o,a,c,"F",u,h)}function WO(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function N2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Bl(r.unaryFilter.field);return yr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Bl(r.unaryFilter.field);return yr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Bl(r.unaryFilter.field);return yr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bl(r.unaryFilter.field);return yr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return it()}}(t):t.fieldFilter!==void 0?function(r){return yr.create(Bl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return it()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return $i.create(r.compositeFilter.filters.map(n=>N2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return it()}}(r.compositeFilter.op))}(t):it()}function GO(t){return OO[t]}function KO(t){return DO[t]}function qO(t){return NO[t]}function Vl(t){return{fieldPath:t.canonicalString()}}function Bl(t){return qr.fromServerFormat(t.fieldPath)}function L2(t){return t instanceof yr?function(r){if(r.op==="=="){if(Ty(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NAN"}};if(wy(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ty(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NOT_NAN"}};if(wy(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vl(r.field),op:KO(r.op),value:r.value}}}(t):t instanceof $i?function(r){const n=r.getFilters().map(i=>L2(i));return n.length===1?n[0]:{compositeFilter:{op:qO(r.op),filters:n}}}(t):it()}function XO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function M2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,r,n,i,a=st.min(),o=st.min(),c=Qr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e){this.ht=e}}function QO(t){const e=zO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?eg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(){this.ln=new ZO}addToCollectionParentIndex(e,r){return this.ln.add(r),Ae.resolve()}getCollectionParents(e,r){return Ae.resolve(this.ln.getEntries(r))}addFieldIndex(e,r){return Ae.resolve()}deleteFieldIndex(e,r){return Ae.resolve()}deleteAllFieldIndexes(e){return Ae.resolve()}createTargetIndexes(e,r){return Ae.resolve()}getDocumentsMatchingTarget(e,r){return Ae.resolve(null)}getIndexType(e,r){return Ae.resolve(0)}getFieldIndexes(e,r){return Ae.resolve([])}getNextCollectionGroupToUpdate(e){return Ae.resolve(null)}getMinOffset(e,r){return Ae.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,r){return Ae.resolve(Ws.min())}updateCollectionGroup(e,r,n){return Ae.resolve()}updateIndexEntries(e,r){return Ae.resolve()}}class ZO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(Kt.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(Kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(41943040,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new ic(0)}static Qn(){return new ic(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vy([t,e],[r,n]){const i=vt(t,r);return i===0?vt(e,n):i}class eD{constructor(e){this.Gn=e,this.buffer=new Pr(Vy),this.zn=0}jn(){return++this.zn}Hn(e){const r=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Vy(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class tD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){je("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){gc(r)?je("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await mc(r)}await this.Yn(3e5)})}}class rD{constructor(e,r){this.Zn=e,this.params=r}calculateTargetCount(e,r){return this.Zn.Xn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return Ae.resolve(rd.oe);const n=new eD(r);return this.Zn.forEachTarget(e,i=>n.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>n.Hn(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Zn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Zn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),Ae.resolve(My)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),My):this.tr(e,r))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,r){let n,i,a,o,c,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),Ll()<=pt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),Ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function nD(t,e){return new rD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(){this.changes=new Wo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,cn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ae.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&xu(n.mutation,i,Zn.empty(),Rr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,mt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=mt()){const i=Ro();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let o=su();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Ro();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,mt()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,c)=>{r.set(o,c)})})}computeViews(e,r,n,i){let a=Xa();const o=vu(),c=function(){return vu()}();return r.forEach((u,h)=>{const d=n.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof Zs)?a=a.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),xu(d.mutation,h,d.mutation.getFieldMask(),Rr.now())):o.set(h.key,Zn.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,d)=>o.set(h,d)),r.forEach((h,d)=>{var g;return c.set(h,new aD(d,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,r){const n=vu();let i=new tr((o,c)=>o-c),a=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let d=n.get(u)||Zn.empty();d=c.applyToLocalView(h,d),n.set(u,d);const g=(i.get(c.batchId)||mt()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,d=u.value,g=_2();d.forEach(v=>{if(!a.has(v)){const y=A2(r.get(v),n.get(v));y!==null&&g.set(v,y),a=a.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return Ae.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(o){return qe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):p2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):Ae.resolve(Ro());let c=-1,u=a;return o.next(h=>Ae.forEach(h,(d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(d)?Ae.resolve():this.remoteDocumentCache.getEntry(e,d).next(v=>{u=u.insert(d,v)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,mt())).next(d=>({batchId:c,changes:x2(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new qe(r)).next(n=>{let i=su();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let o=su();return this.indexManager.getCollectionParents(e,a).next(c=>Ae.forEach(c,u=>{const h=function(g,v){return new tf(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(d=>{d.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(o=>{a.forEach((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,cn.newInvalidDocument(d)))});let c=su();return o.forEach((u,h)=>{const d=a.get(u);d!==void 0&&xu(d.mutation,h,Zn.empty(),Rr.now()),sd(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,r){return Ae.resolve(this.Tr.get(r))}saveBundleMetadata(e,r){return this.Tr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ua(i.createTime)}}(r)),Ae.resolve()}getNamedQuery(e,r){return Ae.resolve(this.Ir.get(r))}saveNamedQuery(e,r){return this.Ir.set(r.name,function(i){return{name:i.name,query:QO(i.bundledQuery),readTime:ua(i.readTime)}}(r)),Ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(){this.overlays=new tr(qe.comparator),this.Er=new Map}getOverlay(e,r){return Ae.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ro();return Ae.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.Tt(e,r,a)}),Ae.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Er.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Er.delete(n)),Ae.resolve()}getOverlaysForCollection(e,r,n){const i=Ro(),a=r.length+1,o=new qe(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>n&&i.set(u.getKey(),u)}return Ae.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new tr((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=a.get(h.largestBatchId);d===null&&(d=Ro(),a=a.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Ro(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,d)=>c.set(h,d)),!(c.size()>=i)););return Ae.resolve(c)}Tt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Er.get(i.largestBatchId).delete(n.key);this.Er.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new CO(r,n));let a=this.Er.get(r);a===void 0&&(a=mt(),this.Er.set(r,a)),this.Er.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(){this.sessionToken=Qr.EMPTY_BYTE_STRING}getSessionToken(e){return Ae.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(){this.dr=new Pr(Mr.Ar),this.Rr=new Pr(Mr.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,r){const n=new Mr(e,r);this.dr=this.dr.add(n),this.Rr=this.Rr.add(n)}mr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.gr(new Mr(e,r))}pr(e,r){e.forEach(n=>this.removeReference(n,r))}yr(e){const r=new qe(new Kt([])),n=new Mr(r,e),i=new Mr(r,e+1),a=[];return this.Rr.forEachInRange([n,i],o=>{this.gr(o),a.push(o.key)}),a}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const r=new qe(new Kt([])),n=new Mr(r,e),i=new Mr(r,e+1);let a=mt();return this.Rr.forEachInRange([n,i],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new Mr(e,0),n=this.dr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Mr{constructor(e,r){this.key=e,this.br=r}static Ar(e,r){return qe.comparator(e.key,r.key)||vt(e.br,r.br)}static Vr(e,r){return vt(e.br,r.br)||qe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Dr=1,this.vr=new Pr(Mr.Ar)}checkEmpty(e){return Ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new AO(a,r,n,i);this.mutationQueue.push(o);for(const c of i)this.vr=this.vr.add(new Mr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Ae.resolve(o)}lookupMutationBatch(e,r){return Ae.resolve(this.Cr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Fr(n),a=i<0?0:i;return Ae.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Ae.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return Ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Mr(r,0),i=new Mr(r,Number.POSITIVE_INFINITY),a=[];return this.vr.forEachInRange([n,i],o=>{const c=this.Cr(o.br);a.push(c)}),Ae.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(vt);return r.forEach(i=>{const a=new Mr(i,0),o=new Mr(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([a,o],c=>{n=n.add(c.br)})}),Ae.resolve(this.Mr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;qe.isDocumentKey(a)||(a=a.child(""));const o=new Mr(new qe(a),0);let c=new Pr(vt);return this.vr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.br)),!0)},o),Ae.resolve(this.Mr(c))}Mr(e){const r=[];return e.forEach(n=>{const i=this.Cr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){bt(this.Or(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.vr;return Ae.forEach(r.mutations,i=>{const a=new Mr(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=n})}Ln(e){}containsKey(e,r){const n=new Mr(r,0),i=this.vr.firstAfterOrEqual(n);return Ae.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ae.resolve()}Or(e,r){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const r=this.Fr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.Nr=e,this.docs=function(){return new tr(qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,o=this.Nr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ae.resolve(n?n.document.mutableCopy():cn.newInvalidDocument(r))}getEntries(e,r){let n=Xa();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():cn.newInvalidDocument(i))}),Ae.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Xa();const o=r.path,c=new qe(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||$b(jb(d),n)<=0||(i.has(d.key)||sd(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return Ae.resolve(a)}getAllFromCollectionGroup(e,r,n,i){it()}Lr(e,r){return Ae.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new hD(this)}getSize(e){return Ae.resolve(this.size)}}class hD extends iD{constructor(e){super(),this.hr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.hr.addEntry(e,i)):this.hr.removeEntry(n)}),Ae.waitFor(r)}getFromCache(e,r){return this.hr.getEntry(e,r)}getAllFromCache(e,r){return this.hr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dD{constructor(e){this.persistence=e,this.Br=new Wo(r=>e1(r),t1),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.kr=0,this.qr=new o1,this.targetCount=0,this.Qr=ic.qn()}forEachTarget(e,r){return this.Br.forEach((n,i)=>r(i)),Ae.resolve()}getLastRemoteSnapshotVersion(e){return Ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ae.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),Ae.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.kr&&(this.kr=r),Ae.resolve()}Un(e){this.Br.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.Qr=new ic(r),this.highestTargetId=r),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,r){return this.Un(r),this.targetCount+=1,Ae.resolve()}updateTargetData(e,r){return this.Un(r),Ae.resolve()}removeTargetData(e,r){return this.Br.delete(r.target),this.qr.yr(r.targetId),this.targetCount-=1,Ae.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.Br.forEach((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.Br.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),Ae.waitFor(a).next(()=>i)}getTargetCount(e){return Ae.resolve(this.targetCount)}getTargetData(e,r){const n=this.Br.get(r)||null;return Ae.resolve(n)}addMatchingKeys(e,r,n){return this.qr.mr(r,n),Ae.resolve()}removeMatchingKeys(e,r,n){this.qr.pr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),Ae.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.qr.yr(r),Ae.resolve()}getMatchingKeysForTargetId(e,r){const n=this.qr.Sr(r);return Ae.resolve(n)}containsKey(e,r){return Ae.resolve(this.qr.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e,r){this.Kr={},this.overlays={},this.$r=new rd(0),this.Ur=!1,this.Ur=!0,this.Wr=new cD,this.referenceDelegate=e(this),this.Gr=new dD(this),this.indexManager=new JO,this.remoteDocumentCache=function(i){return new fD(i)}(n=>this.referenceDelegate.zr(n)),this.serializer=new YO(r),this.jr=new oD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new lD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.Kr[e.toKey()];return n||(n=new uD(r,this.referenceDelegate),this.Kr[e.toKey()]=n),n}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const i=new pD(this.$r.next());return this.referenceDelegate.Hr(),n(i).next(a=>this.referenceDelegate.Jr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Yr(e,r){return Ae.or(Object.values(this.Kr).map(n=>()=>n.containsKey(e,r)))}}class pD extends zb{constructor(e){super(),this.currentSequenceNumber=e}}class l1{constructor(e){this.persistence=e,this.Zr=new o1,this.Xr=null}static ei(e){return new l1(e)}get ti(){if(this.Xr)return this.Xr;throw it()}addReference(e,r,n){return this.Zr.addReference(n,r),this.ti.delete(n.toString()),Ae.resolve()}removeReference(e,r,n){return this.Zr.removeReference(n,r),this.ti.add(n.toString()),Ae.resolve()}markPotentiallyOrphaned(e,r){return this.ti.add(r.toString()),Ae.resolve()}removeTarget(e,r){this.Zr.yr(r.targetId).forEach(i=>this.ti.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.ti.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Hr(){this.Xr=new Set}Jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ae.forEach(this.ti,n=>{const i=qe.fromPath(n);return this.ni(e,i).next(a=>{a||r.removeEntry(i,st.min())})}).next(()=>(this.Xr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ni(e,r).next(n=>{n?this.ti.delete(r.toString()):this.ti.add(r.toString())})}zr(e){return 0}ni(e,r){return Ae.or([()=>Ae.resolve(this.Zr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Yr(e,r)])}}class k0{constructor(e,r){this.persistence=e,this.ri=new Wo(n=>Kb(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=nD(this,r)}static ei(e,r){return new k0(e,r)}Hr(){}Jr(e){return Ae.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}Xn(e){const r=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}nr(e){let r=0;return this.er(e,n=>{r++}).next(()=>r)}er(e,r){return Ae.forEach(this.ri,(n,i)=>this.ir(e,n,i).next(a=>a?Ae.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.Lr(e,o=>this.ir(e,o,r).next(c=>{c||(n++,a.removeEntry(o,st.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.ri.set(r,e.currentSequenceNumber),Ae.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.ri.set(n,e.currentSequenceNumber),Ae.resolve()}removeReference(e,r,n){return this.ri.set(n,e.currentSequenceNumber),Ae.resolve()}updateLimboDocument(e,r){return this.ri.set(r,e.currentSequenceNumber),Ae.resolve()}zr(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=r0(e.data.value)),r}ir(e,r,n){return Ae.or([()=>this.persistence.Yr(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.ri.get(r);return Ae.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Wi=n,this.Gi=i}static zi(e,r){let n=mt(),i=mt();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new c1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return a4()?8:Wb(dn())>0?6:4}()}initialize(e,r){this.Zi=e,this.indexManager=r,this.ji=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.Xi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.es(e,r,i,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new mD;return this.ts(e,r,o).next(c=>{if(a.result=c,this.Hi)return this.ns(e,r,o,c.size)})}).next(()=>a.result)}ns(e,r,n,i){return n.documentReadCount<this.Ji?(Ll()<=pt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Ml(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),Ae.resolve()):(Ll()<=pt.DEBUG&&je("QueryEngine","Query:",Ml(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Yi*i?(Ll()<=pt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Ml(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ca(r))):Ae.resolve())}Xi(e,r){if(Cy(r))return Ae.resolve(null);let n=ca(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=eg(r,null,"F"),n=ca(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=mt(...a);return this.Zi.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.rs(r,c);return this.ss(r,h,o,u.readTime)?this.Xi(e,eg(r,null,"F")):this.os(e,h,r,u)}))})))}es(e,r,n,i){return Cy(r)||i.isEqual(st.min())?Ae.resolve(null):this.Zi.getDocuments(e,n).next(a=>{const o=this.rs(r,a);return this.ss(r,o,n,i)?Ae.resolve(null):(Ll()<=pt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ml(r)),this.os(e,o,r,Ub(i,-1)).next(c=>c))})}rs(e,r){let n=new Pr(g2(e));return r.forEach((i,a)=>{sd(e,a)&&(n=n.add(a))}),n}ss(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}ts(e,r,n){return Ll()<=pt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Ml(r)),this.Zi.getDocumentsMatchingQuery(e,r,Ws.min(),n)}os(e,r,n,i){return this.Zi.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,r,n,i){this.persistence=e,this._s=r,this.serializer=i,this.us=new tr(vt),this.cs=new Wo(a=>e1(a),t1),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(n)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sD(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.us))}}function xD(t,e,r,n){return new vD(t,e,r,n)}async function B2(t,e){const r=lt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Ps(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],c=[];let u=mt();for(const h of i){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of a){c.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ts:h,removedBatchIds:o,addedBatchIds:c}))})})}function _D(t,e){const r=lt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.hs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,d){const g=h.batch,v=g.keys();let y=Ae.resolve();return v.forEach(E=>{y=y.next(()=>d.getEntry(u,E)).next(_=>{const w=h.docVersions.get(E);bt(w!==null),_.version.compareTo(w)<0&&(g.applyToRemoteDocument(_,h),_.isValidDocument()&&(_.setReadTime(h.commitVersion),d.addEntry(_)))})}),y.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=mt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function U2(t){const e=lt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Gr.getLastRemoteSnapshotVersion(r))}function yD(t,e){const r=lt(t),n=e.snapshotVersion;let i=r.us;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.hs.newChangeBuffer({trackRemovals:!0});i=r.us;const c=[];e.targetChanges.forEach((d,g)=>{const v=i.get(g);if(!v)return;c.push(r.Gr.removeMatchingKeys(a,d.removedDocuments,g).next(()=>r.Gr.addMatchingKeys(a,d.addedDocuments,g)));let y=v.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?y=y.withResumeToken(Qr.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,n)),i=i.insert(g,y),function(_,w,k){return _.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-_.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(v,y,d)&&c.push(r.Gr.updateTargetData(a,y))});let u=Xa(),h=mt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),c.push(ED(a,o,e.documentUpdates).next(d=>{u=d.Is,h=d.Es})),!n.isEqual(st.min())){const d=r.Gr.getLastRemoteSnapshotVersion(a).next(g=>r.Gr.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(d)}return Ae.waitFor(c).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(r.us=i,a))}function ED(t,e,r){let n=mt(),i=mt();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=Xa();return r.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(st.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):je("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Is:o,Es:i}})}function wD(t,e){const r=lt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function TD(t,e){const r=lt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Gr.getTargetData(n,e).next(a=>a?(i=a,Ae.resolve(i)):r.Gr.allocateTargetId(n).next(o=>(i=new Ds(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Gr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.us.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.us=r.us.insert(n.targetId,n),r.cs.set(e,n.targetId)),n})}async function ag(t,e,r){const n=lt(t),i=n.us.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!gc(o))throw o;je("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.us=n.us.remove(e),n.cs.delete(i.target)}function By(t,e,r){const n=lt(t);let i=st.min(),a=mt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,d){const g=lt(u),v=g.cs.get(d);return v!==void 0?Ae.resolve(g.us.get(v)):g.Gr.getTargetData(h,d)}(n,o,ca(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Gr.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>n._s.getDocumentsMatchingQuery(o,e,r?i:st.min(),r?a:mt())).next(c=>(SD(n,fO(e),c),{documents:c,ds:a})))}function SD(t,e,r){let n=t.ls.get(e)||st.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.ls.set(e,n)}class Uy{constructor(){this.activeTargetIds=vO()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class kD{constructor(){this._o=new Uy,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,r,n){this.ao[e]=r}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new Uy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dh=null;function mm(){return Dh===null?Dh=function(){return 268435456+Math.round(2147483648*Math.random())}():Dh++,"0x"+Dh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class RD extends class{get Co(){return!1}constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Fo=n+"://"+r.host,this.Mo=`projects/${i}/databases/${a}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Oo(r,n,i,a,o){const c=mm(),u=this.No(r,n.toUriEncodedString());je("RestConnection",`Sending RPC '${r}' ${c}:`,u,i);const h={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(h,a,o),this.Bo(r,u,h,i).then(d=>(je("RestConnection",`Received RPC '${r}' ${c}: `,d),d),d=>{throw Jl("RestConnection",`RPC '${r}' ${c} failed with error: `,d,"url: ",u,"request:",i),d})}ko(r,n,i,a,o,c){return this.Oo(r,n,i,a,o)}Lo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),i&&i.headers.forEach((a,o)=>r[o]=a)}No(r,n){const i=CD[r];return`${this.Fo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,r,n,i){const a=mm();return new Promise((o,c)=>{const u=new JT;u.setWithCredentials(!0),u.listenOnce(ZT.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case t0.NO_ERROR:const d=u.getResponseJson();je(nn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case t0.TIMEOUT:je(nn,`RPC '${e}' ${a} timed out`),c(new $e(ke.DEADLINE_EXCEEDED,"Request time out"));break;case t0.HTTP_ERROR:const g=u.getStatus();if(je(nn,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v==null?void 0:v.error;if(y&&y.status&&y.message){const E=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(k)>=0?k:ke.UNKNOWN}(y.status);c(new $e(E,y.message))}else c(new $e(ke.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new $e(ke.UNAVAILABLE,"Connection failed."));break;default:it()}}finally{je(nn,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(i);je(nn,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",h,n,15)})}qo(e,r,n){const i=mm(),a=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=r2(),c=t2(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Lo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=a.join("");je(nn,`Creating RPC '${e}' stream ${i}: ${d}`,u);const g=o.createWebChannel(d,u);let v=!1,y=!1;const E=new ID({Eo:w=>{y?je(nn,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(v||(je(nn,`Opening RPC '${e}' stream ${i} transport.`),g.open(),v=!0),je(nn,`RPC '${e}' stream ${i} sending:`,w),g.send(w))},Ao:()=>g.close()}),_=(w,k,F)=>{w.listen(k,C=>{try{F(C)}catch(B){setTimeout(()=>{throw B},0)}})};return _(g,au.EventType.OPEN,()=>{y||(je(nn,`RPC '${e}' stream ${i} transport opened.`),E.So())}),_(g,au.EventType.CLOSE,()=>{y||(y=!0,je(nn,`RPC '${e}' stream ${i} transport closed`),E.Do())}),_(g,au.EventType.ERROR,w=>{y||(y=!0,Jl(nn,`RPC '${e}' stream ${i} transport errored:`,w),E.Do(new $e(ke.UNAVAILABLE,"The operation could not be completed")))}),_(g,au.EventType.MESSAGE,w=>{var k;if(!y){const F=w.data[0];bt(!!F);const C=F,B=(C==null?void 0:C.error)||((k=C[0])===null||k===void 0?void 0:k.error);if(B){je(nn,`RPC '${e}' stream ${i} received error:`,B);const V=B.status;let z=function(P){const L=gr[P];if(L!==void 0)return I2(L)}(V),A=B.message;z===void 0&&(z=ke.INTERNAL,A="Unknown error status: "+V+" with message "+B.message),y=!0,E.Do(new $e(z,A)),g.close()}else je(nn,`RPC '${e}' stream ${i} received:`,F),E.vo(F)}}),_(c,e2.STAT_EVENT,w=>{w.stat===qm.PROXY?je(nn,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===qm.NOPROXY&&je(nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.bo()},0),E}}function gm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(t){return new LO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,r,n=1e3,i=1.5,a=6e4){this.li=e,this.timerId=r,this.Qo=n,this.Ko=i,this.$o=a,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const r=Math.floor(this.Uo+this.Ho()),n=Math.max(0,Date.now()-this.Go),i=Math.max(0,r-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,r,n,i,a,o,c,u){this.li=e,this.Yo=n,this.Zo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new j2(e,r)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,r){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():r&&r.code===ke.RESOURCE_EXHAUSTED?(qa(r.toString()),qa("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):r&&r.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(r)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),r=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Xo===r&&this.I_(n,i)},n=>{e(()=>{const i=new $e(ke.UNKNOWN,"Fetching auth token failed: "+n.message);return this.E_(i)})})}I_(e,r){const n=this.T_(this.Xo);this.stream=this.d_(e,r),this.stream.Ro(()=>{n(()=>this.listener.Ro())}),this.stream.mo(()=>{n(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{n(()=>this.E_(i))}),this.stream.onMessage(i=>{n(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return r=>{this.li.enqueueAndForget(()=>this.Xo===e?r():(je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class PD extends $2{constructor(e,r,n,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}d_(e,r){return this.connection.qo("Listen",e,r)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const r=BO(this.serializer,e),n=function(a){if(!("targetChange"in a))return st.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?st.min():o.readTime?ua(o.readTime):st.min()}(e);return this.listener.R_(r,n)}V_(e){const r={};r.database=ig(this.serializer),r.addTarget=function(a,o){let c;const u=o.target;if(c=Jm(u)?{documents:$O(a,u)}:{query:HO(a,u).ct},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=F2(a,o.resumeToken);const h=tg(a,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(st.min())>0){c.readTime=S0(a,o.snapshotVersion.toTimestamp());const h=tg(a,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=WO(this.serializer,e);n&&(r.labels=n),this.c_(r)}m_(e){const r={};r.database=ig(this.serializer),r.removeTarget=e,this.c_(r)}}class FD extends $2{constructor(e,r,n,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,r){return this.connection.qo("Write",e,r)}A_(e){return bt(!!e.streamToken),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){bt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const r=jO(e.writeResults,e.commitTime),n=ua(e.commitTime);return this.listener.y_(n,r)}w_(){const e={};e.database=ig(this.serializer),this.c_(e)}g_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>UO(this.serializer,n))};this.c_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new $e(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,r,n,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Oo(e,rg(r,n),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $e(ke.UNKNOWN,a.toString())})}ko(e,r,n,i,a){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.ko(e,rg(r,n),i,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(ke.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class OD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(qa(r),this.C_=!1):je("OnlineStateTracker",r)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=a,this.Q_.uo(o=>{n.enqueueAndForget(async()=>{Go(this)&&(je("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=lt(u);h.k_.add(4),await af(h),h.K_.set("Unknown"),h.k_.delete(4),await hd(h)}(this))})}),this.K_=new OD(n,i)}}async function hd(t){if(Go(t))for(const e of t.q_)await e(!0)}async function af(t){for(const e of t.q_)await e(!1)}function H2(t,e){const r=lt(t);r.B_.has(e.targetId)||(r.B_.set(e.targetId,e),d1(r)?h1(r):vc(r).s_()&&f1(r,e))}function u1(t,e){const r=lt(t),n=vc(r);r.B_.delete(e),n.s_()&&z2(r,e),r.B_.size===0&&(n.s_()?n.a_():Go(r)&&r.K_.set("Unknown"))}function f1(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}vc(t).V_(e)}function z2(t,e){t.U_.xe(e),vc(t).m_(e)}function h1(t){t.U_=new bO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),vc(t).start(),t.K_.F_()}function d1(t){return Go(t)&&!vc(t).i_()&&t.B_.size>0}function Go(t){return lt(t).k_.size===0}function W2(t){t.U_=void 0}async function ND(t){t.K_.set("Online")}async function LD(t){t.B_.forEach((e,r)=>{f1(t,e)})}async function MD(t,e){W2(t),d1(t)?(t.K_.O_(e),h1(t)):t.K_.set("Unknown")}async function VD(t,e,r){if(t.K_.set("Online"),e instanceof P2&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const c of a.targetIds)i.B_.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.B_.delete(c),i.U_.removeTarget(c))}(t,e)}catch(n){je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await A0(t,n)}else if(e instanceof a0?t.U_.$e(e):e instanceof R2?t.U_.Je(e):t.U_.Ge(e),!r.isEqual(st.min()))try{const n=await U2(t.localStore);r.compareTo(n)>=0&&await function(a,o){const c=a.U_.it(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=a.B_.get(h);d&&a.B_.set(h,d.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const d=a.B_.get(u);if(!d)return;a.B_.set(u,d.withResumeToken(Qr.EMPTY_BYTE_STRING,d.snapshotVersion)),z2(a,u);const g=new Ds(d.target,u,h,d.sequenceNumber);f1(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){je("RemoteStore","Failed to raise snapshot:",n),await A0(t,n)}}async function A0(t,e,r){if(!gc(e))throw e;t.k_.add(1),await af(t),t.K_.set("Offline"),r||(r=()=>U2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je("RemoteStore","Retrying IndexedDB access"),await r(),t.k_.delete(1),await hd(t)})}function G2(t,e){return e().catch(r=>A0(t,r,e))}async function dd(t){const e=lt(t),r=Xs(e);let n=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;BD(e);)try{const i=await wD(e.localStore,n);if(i===null){e.L_.length===0&&r.a_();break}n=i.batchId,UD(e,i)}catch(i){await A0(e,i)}K2(e)&&q2(e)}function BD(t){return Go(t)&&t.L_.length<10}function UD(t,e){t.L_.push(e);const r=Xs(t);r.s_()&&r.f_&&r.g_(e.mutations)}function K2(t){return Go(t)&&!Xs(t).i_()&&t.L_.length>0}function q2(t){Xs(t).start()}async function jD(t){Xs(t).w_()}async function $D(t){const e=Xs(t);for(const r of t.L_)e.g_(r.mutations)}async function HD(t,e,r){const n=t.L_.shift(),i=i1.from(n,e,r);await G2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await dd(t)}async function zD(t,e){e&&Xs(t).f_&&await async function(n,i){if(function(o){return RO(o)&&o!==ke.ABORTED}(i.code)){const a=n.L_.shift();Xs(n).__(),await G2(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await dd(n)}}(t,e),K2(t)&&q2(t)}async function $y(t,e){const r=lt(t);r.asyncQueue.verifyOperationInProgress(),je("RemoteStore","RemoteStore received new credentials");const n=Go(r);r.k_.add(3),await af(r),n&&r.K_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.k_.delete(3),await hd(r)}async function WD(t,e){const r=lt(t);e?(r.k_.delete(2),await hd(r)):e||(r.k_.add(2),await af(r),r.K_.set("Unknown"))}function vc(t){return t.W_||(t.W_=function(r,n,i){const a=lt(r);return a.b_(),new PD(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Ro:ND.bind(null,t),mo:LD.bind(null,t),po:MD.bind(null,t),R_:VD.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),d1(t)?h1(t):t.K_.set("Unknown")):(await t.W_.stop(),W2(t))})),t.W_}function Xs(t){return t.G_||(t.G_=function(r,n,i){const a=lt(r);return a.b_(),new FD(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:jD.bind(null,t),po:zD.bind(null,t),p_:$D.bind(null,t),y_:HD.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await dd(t)):(await t.G_.stop(),t.L_.length>0&&(je("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new $a,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,c=new p1(e,r,o,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function m1(t,e){if(qa("AsyncQueue",`${e}: ${t}`),gc(t))return new $e(ke.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{static emptySet(e){return new Wl(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||qe.comparator(r.key,n.key):(r,n)=>qe.comparator(r.key,n.key),this.keyedMap=su(),this.sortedSet=new tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Wl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Wl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(){this.z_=new tr(qe.comparator)}track(e){const r=e.doc.key,n=this.z_.get(r);n?e.type!==0&&n.type===3?this.z_=this.z_.insert(r,e):e.type===3&&n.type!==1?this.z_=this.z_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.z_=this.z_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.z_=this.z_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.z_=this.z_.remove(r):e.type===1&&n.type===2?this.z_=this.z_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.z_=this.z_.insert(r,{type:2,doc:e.doc}):it():this.z_=this.z_.insert(r,e)}j_(){const e=[];return this.z_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ac{constructor(e,r,n,i,a,o,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,a){const o=[];return r.forEach(c=>{o.push({type:0,doc:c})}),new ac(e,r,Wl.emptySet(r),o,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ad(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class KD{constructor(){this.queries=zy(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(r,n){const i=lt(r),a=i.queries;i.queries=zy(),a.forEach((o,c)=>{for(const u of c.J_)u.onError(n)})})(this,new $e(ke.ABORTED,"Firestore shutting down"))}}function zy(){return new Wo(t=>m2(t),ad)}async function X2(t,e){const r=lt(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.Y_()&&e.Z_()&&(n=2):(a=new GD,n=e.Z_()?0:1);try{switch(n){case 0:a.H_=await r.onListen(i,!0);break;case 1:a.H_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const c=m1(o,`Initialization of query '${Ml(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,a),a.J_.push(e),e.ea(r.onlineState),a.H_&&e.ta(a.H_)&&g1(r)}async function Y2(t,e){const r=lt(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const o=a.J_.indexOf(e);o>=0&&(a.J_.splice(o,1),a.J_.length===0?i=e.Z_()?0:1:!a.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function qD(t,e){const r=lt(t);let n=!1;for(const i of e){const a=i.query,o=r.queries.get(a);if(o){for(const c of o.J_)c.ta(i)&&(n=!0);o.H_=i}}n&&g1(r)}function XD(t,e,r){const n=lt(t),i=n.queries.get(e);if(i)for(const a of i.J_)a.onError(r);n.queries.delete(e)}function g1(t){t.X_.forEach(e=>{e.next()})}var sg,Wy;(Wy=sg||(sg={})).na="default",Wy.Cache="cache";class Q2{constructor(e,r,n){this.query=e,this.ra=r,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=n||{}}ta(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ac(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.ia?this.oa(e)&&(this.ra.next(e),r=!0):this._a(e,this.onlineState)&&(this.aa(e),r=!0),this.sa=e,r}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let r=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),r=!0),r}_a(e,r){if(!e.fromCache||!this.Z_())return!0;const n=r!=="Offline";return(!this.options.ua||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const r=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}aa(e){e=ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e){this.key=e}}class Z2{constructor(e){this.key=e}}class YD{constructor(e,r){this.query=e,this.da=r,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=mt(),this.mutatedKeys=mt(),this.Va=g2(e),this.ma=new Wl(this.Va)}get fa(){return this.da}ga(e,r){const n=r?r.pa:new Hy,i=r?r.ma:this.ma;let a=r?r.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,g)=>{const v=i.get(d),y=sd(this.query,g)?g:null,E=!!v&&this.mutatedKeys.has(v.key),_=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;v&&y?v.data.isEqual(y.data)?E!==_&&(n.track({type:3,doc:y}),w=!0):this.ya(v,y)||(n.track({type:2,doc:y}),w=!0,(u&&this.Va(y,u)>0||h&&this.Va(y,h)<0)&&(c=!0)):!v&&y?(n.track({type:0,doc:y}),w=!0):v&&!y&&(n.track({type:1,doc:v}),w=!0,(u||h)&&(c=!0)),w&&(y?(o=o.add(y),a=_?a.add(d):a.delete(d)):(o=o.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{ma:o,pa:n,ss:c,mutatedKeys:a}}ya(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((d,g)=>function(y,E){const _=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it()}};return _(y)-_(E)}(d.type,g.type)||this.Va(d.doc,g.doc)),this.wa(n),i=i!=null&&i;const c=r&&!i?this.Sa():[],u=this.Ra.size===0&&this.current&&!i?1:0,h=u!==this.Aa;return this.Aa=u,o.length!==0||h?{snapshot:new ac(this.query,e.ma,a,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),ba:c}:{ba:c}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Hy,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(r=>this.da=this.da.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.da=this.da.delete(r)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=mt(),this.ma.forEach(n=>{this.Da(n.key)&&(this.Ra=this.Ra.add(n.key))});const r=[];return e.forEach(n=>{this.Ra.has(n)||r.push(new Z2(n))}),this.Ra.forEach(n=>{e.has(n)||r.push(new J2(n))}),r}va(e){this.da=e.ds,this.Ra=mt();const r=this.ga(e.documents);return this.applyChanges(r,!0)}Ca(){return ac.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class QD{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class JD{constructor(e){this.key=e,this.Fa=!1}}class ZD{constructor(e,r,n,i,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new Wo(c=>m2(c),ad),this.Oa=new Map,this.Na=new Set,this.La=new tr(qe.comparator),this.Ba=new Map,this.ka=new o1,this.qa={},this.Qa=new Map,this.Ka=ic.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function e3(t,e,r=!0){const n=aS(t);let i;const a=n.xa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Ca()):i=await eS(n,e,r,!0),i}async function t3(t,e){const r=aS(t);await eS(r,e,!0,!1)}async function eS(t,e,r,n){const i=await TD(t.localStore,ca(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let c;return n&&(c=await r3(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&r&&H2(t.remoteStore,i),c}async function r3(t,e,r,n,i){t.Ua=(g,v,y)=>async function(_,w,k,F){let C=w.view.ga(k);C.ss&&(C=await By(_.localStore,w.query,!1).then(({documents:A})=>w.view.ga(A,C)));const B=F&&F.targetChanges.get(w.targetId),V=F&&F.targetMismatches.get(w.targetId)!=null,z=w.view.applyChanges(C,_.isPrimaryClient,B,V);return Ky(_,w.targetId,z.ba),z.snapshot}(t,g,v,y);const a=await By(t.localStore,e,!0),o=new YD(e,a.ds),c=o.ga(a.documents),u=nf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=o.applyChanges(c,t.isPrimaryClient,u);Ky(t,r,h.ba);const d=new QD(e,r,o);return t.xa.set(e,d),t.Oa.has(r)?t.Oa.get(r).push(e):t.Oa.set(r,[e]),h.snapshot}async function n3(t,e,r){const n=lt(t),i=n.xa.get(e),a=n.Oa.get(i.targetId);if(a.length>1)return n.Oa.set(i.targetId,a.filter(o=>!ad(o,e))),void n.xa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ag(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&u1(n.remoteStore,i.targetId),og(n,i.targetId)}).catch(mc)):(og(n,i.targetId),await ag(n.localStore,i.targetId,!0))}async function i3(t,e){const r=lt(t),n=r.xa.get(e),i=r.Oa.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),u1(r.remoteStore,n.targetId))}async function a3(t,e,r){const n=h3(t);try{const i=await function(o,c){const u=lt(o),h=Rr.now(),d=c.reduce((y,E)=>y.add(E.key),mt());let g,v;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let E=Xa(),_=mt();return u.hs.getEntries(y,d).next(w=>{E=w,E.forEach((k,F)=>{F.isValidDocument()||(_=_.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,E)).next(w=>{g=w;const k=[];for(const F of c){const C=SO(F,g.get(F.key).overlayedDocument);C!=null&&k.push(new Zs(F.key,C,o2(C.value.mapValue),kn.exists(!0)))}return u.mutationQueue.addMutationBatch(y,h,k,c)}).next(w=>{v=w;const k=w.applyToLocalDocumentSet(g,_);return u.documentOverlayCache.saveOverlays(y,w.batchId,k)})}).then(()=>({batchId:v.batchId,changes:x2(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let h=o.qa[o.currentUser.toKey()];h||(h=new tr(vt)),h=h.insert(c,u),o.qa[o.currentUser.toKey()]=h}(n,i.batchId,r),await sf(n,i.changes),await dd(n.remoteStore)}catch(i){const a=m1(i,"Failed to persist write");r.reject(a)}}async function tS(t,e){const r=lt(t);try{const n=await yD(r.localStore,e);e.targetChanges.forEach((i,a)=>{const o=r.Ba.get(a);o&&(bt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Fa=!0:i.modifiedDocuments.size>0?bt(o.Fa):i.removedDocuments.size>0&&(bt(o.Fa),o.Fa=!1))}),await sf(r,n,e)}catch(n){await mc(n)}}function Gy(t,e,r){const n=lt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.xa.forEach((a,o)=>{const c=o.view.ea(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=lt(o);u.onlineState=c;let h=!1;u.queries.forEach((d,g)=>{for(const v of g.J_)v.ea(c)&&(h=!0)}),h&&g1(u)}(n.eventManager,e),i.length&&n.Ma.R_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function s3(t,e,r){const n=lt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Ba.get(e),a=i&&i.key;if(a){let o=new tr(qe.comparator);o=o.insert(a,cn.newNoDocument(a,st.min()));const c=mt().add(a),u=new ud(st.min(),new Map,new tr(vt),o,c);await tS(n,u),n.La=n.La.remove(a),n.Ba.delete(e),v1(n)}else await ag(n.localStore,e,!1).then(()=>og(n,e,r)).catch(mc)}async function o3(t,e){const r=lt(t),n=e.batch.batchId;try{const i=await _D(r.localStore,e);nS(r,n,null),rS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await sf(r,i)}catch(i){await mc(i)}}async function l3(t,e,r){const n=lt(t);try{const i=await function(o,c){const u=lt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(bt(g!==null),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>u.localDocuments.getDocuments(h,d))})}(n.localStore,e);nS(n,e,r),rS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await sf(n,i)}catch(i){await mc(i)}}function rS(t,e){(t.Qa.get(e)||[]).forEach(r=>{r.resolve()}),t.Qa.delete(e)}function nS(t,e,r){const n=lt(t);let i=n.qa[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.qa[n.currentUser.toKey()]=i}}function og(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Oa.get(e))t.xa.delete(n),r&&t.Ma.Wa(n,r);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(n=>{t.ka.containsKey(n)||iS(t,n)})}function iS(t,e){t.Na.delete(e.path.canonicalString());const r=t.La.get(e);r!==null&&(u1(t.remoteStore,r),t.La=t.La.remove(e),t.Ba.delete(r),v1(t))}function Ky(t,e,r){for(const n of r)n instanceof J2?(t.ka.addReference(n.key,e),c3(t,n)):n instanceof Z2?(je("SyncEngine","Document no longer in limbo: "+n.key),t.ka.removeReference(n.key,e),t.ka.containsKey(n.key)||iS(t,n.key)):it()}function c3(t,e){const r=e.key,n=r.path.canonicalString();t.La.get(r)||t.Na.has(n)||(je("SyncEngine","New document in limbo: "+r),t.Na.add(n),v1(t))}function v1(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const r=new qe(Kt.fromString(e)),n=t.Ka.next();t.Ba.set(n,new JD(r)),t.La=t.La.insert(r,n),H2(t.remoteStore,new Ds(ca(r1(r.path)),n,"TargetPurposeLimboResolution",rd.oe))}}async function sf(t,e,r){const n=lt(t),i=[],a=[],o=[];n.xa.isEmpty()||(n.xa.forEach((c,u)=>{o.push(n.Ua(u,e,r).then(h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r==null?void 0:r.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);const g=c1.zi(u.targetId,h);a.push(g)}}))}),await Promise.all(o),n.Ma.R_(i),await async function(u,h){const d=lt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>Ae.forEach(h,v=>Ae.forEach(v.Wi,y=>d.persistence.referenceDelegate.addReference(g,v.targetId,y)).next(()=>Ae.forEach(v.Gi,y=>d.persistence.referenceDelegate.removeReference(g,v.targetId,y)))))}catch(g){if(!gc(g))throw g;je("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const v=g.targetId;if(!g.fromCache){const y=d.us.get(v),E=y.snapshotVersion,_=y.withLastLimboFreeSnapshotVersion(E);d.us=d.us.insert(v,_)}}}(n.localStore,a))}async function u3(t,e){const r=lt(t);if(!r.currentUser.isEqual(e)){je("SyncEngine","User change. New user:",e.toKey());const n=await B2(r.localStore,e);r.currentUser=e,function(a,o){a.Qa.forEach(c=>{c.forEach(u=>{u.reject(new $e(ke.CANCELLED,o))})}),a.Qa.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await sf(r,n.Ts)}}function f3(t,e){const r=lt(t),n=r.Ba.get(e);if(n&&n.Fa)return mt().add(n.key);{let i=mt();const a=r.Oa.get(e);if(!a)return i;for(const o of a){const c=r.xa.get(o);i=i.unionWith(c.view.fa)}return i}}function aS(t){const e=lt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=f3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s3.bind(null,e),e.Ma.R_=qD.bind(null,e.eventManager),e.Ma.Wa=XD.bind(null,e.eventManager),e}function h3(t){const e=lt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=o3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l3.bind(null,e),e}class C0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fd(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,r){return null}Ya(e,r){return null}Ha(e){return xD(this.persistence,new gD,e.initialUser,this.serializer)}ja(e){return new V2(l1.ei,this.serializer)}za(e){return new kD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}C0.provider={build:()=>new C0};class d3 extends C0{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,r){bt(this.persistence.referenceDelegate instanceof k0);const n=this.persistence.referenceDelegate.garbageCollector;return new tD(n,e.asyncQueue,r)}ja(e){const r=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new V2(n=>k0.ei(n,r),this.serializer)}}class lg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Gy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=u3.bind(null,this.syncEngine),await WD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new KD}()}createDatastore(e){const r=fd(e.databaseInfo.databaseId),n=function(a){return new RD(a)}(e.databaseInfo);return function(a,o,c,u){return new bD(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,o,c){return new DD(n,i,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Gy(this.syncEngine,r,0),function(){return jy.p()?new jy:new AD}())}createSyncEngine(e,r){return function(i,a,o,c,u,h,d){const g=new ZD(i,a,o,c,u,h);return d&&(g.$a=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=lt(i);je("RemoteStore","RemoteStore shutting down."),a.k_.add(5),await af(a),a.Q_.shutdown(),a.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}lg.provider={build:()=>new lg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):qa("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=on.UNAUTHENTICATED,this.clientId=i2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{je("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(je("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $a;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=m1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function vm(t,e){t.asyncQueue.verifyOperationInProgress(),je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await B2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await m3(t);je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>$y(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>$y(e.remoteStore,i)),t._onlineComponents=e}async function m3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je("FirestoreClient","Using user provided OfflineComponentProvider");try{await vm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ke.FAILED_PRECONDITION||i.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Jl("Error using user provided cache. Falling back to memory cache: "+r),await vm(t,new C0)}}else je("FirestoreClient","Using default OfflineComponentProvider"),await vm(t,new d3(void 0));return t._offlineComponents}async function oS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je("FirestoreClient","Using user provided OnlineComponentProvider"),await qy(t,t._uninitializedComponentsProvider._online)):(je("FirestoreClient","Using default OnlineComponentProvider"),await qy(t,new lg))),t._onlineComponents}function g3(t){return oS(t).then(e=>e.syncEngine)}async function lS(t){const e=await oS(t),r=e.eventManager;return r.onListen=e3.bind(null,e.syncEngine),r.onUnlisten=n3.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=t3.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=i3.bind(null,e.syncEngine),r}function v3(t,e,r={}){const n=new $a;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new sS({next:v=>{d.eu(),o.enqueueAndForget(()=>Y2(a,g));const y=v.docs.has(c);!y&&v.fromCache?h.reject(new $e(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&v.fromCache&&u&&u.source==="server"?h.reject(new $e(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new Q2(r1(c.path),d,{includeMetadataChanges:!0,ua:!0});return X2(a,g)}(await lS(t),t.asyncQueue,e,r,n)),n.promise}function x3(t,e,r={}){const n=new $a;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new sS({next:v=>{d.eu(),o.enqueueAndForget(()=>Y2(a,g)),v.fromCache&&u.source==="server"?h.reject(new $e(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new Q2(c,d,{includeMetadataChanges:!0,ua:!0});return X2(a,g)}(await lS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e,r){if(!r)throw new $e(ke.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _3(t,e,r,n){if(e===!0&&n===!0)throw new $e(ke.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Yy(t){if(!qe.isDocumentKey(t))throw new $e(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(qe.isDocumentKey(t))throw new $e(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function pd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":it()}function mi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=pd(t);throw new $e(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $e(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new $e(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new $e(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new $e(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class md{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Fb;switch(n.type){case"firstParty":return new Nb(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Xy.get(r);n&&(je("ComponentProvider","Removing Datastore"),Xy.delete(r),n.terminate())}(this),Promise.resolve()}}function y3(t,e,r,n={}){var i;const a=(t=mi(t,md))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&Jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=on.MOCK_USER;else{c=JR(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new $e(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new on(h)}t._authCredentials=new bb(new n2(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new xc(this.firestore,e,this._query)}}class An{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}}class $s extends xc{constructor(e,r,n){super(e,r,r1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new qe(e))}withConverter(e){return new $s(this.firestore,e,this._path)}}function Za(t,e,...r){if(t=br(t),uS("collection","path",e),t instanceof md){const n=Kt.fromString(e,...r);return Qy(n),new $s(t,null,n)}{if(!(t instanceof An||t instanceof $s))throw new $e(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Qy(n),new $s(t.firestore,null,n)}}function gi(t,e,...r){if(t=br(t),arguments.length===1&&(e=i2.newId()),uS("doc","path",e),t instanceof md){const n=Kt.fromString(e,...r);return Yy(n),new An(t,null,new qe(n))}{if(!(t instanceof An||t instanceof $s))throw new $e(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Yy(n),new An(t.firestore,t instanceof $s?t.converter:null,new qe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new j2(this,"async_queue_retry"),this.fu=()=>{const n=gm();n&&je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.r_.Jo()},this.gu=e;const r=gm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const r=gm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const r=new $a;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!gc(e))throw e;je("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const r=this.gu.then(()=>(this.Ru=!0,e().catch(n=>{this.Au=n,this.Ru=!1;const i=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(n);throw qa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.Ru=!1,n))));return this.gu=r,r}enqueueAfterDelay(e,r,n){this.pu(),this.mu.indexOf(e)>-1&&(r=0);const i=p1.createAndSchedule(this,e,r,n,a=>this.Su(a));return this.du.push(i),i}pu(){this.Au&&it()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const r of this.du)if(r.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.du)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const r=this.du.indexOf(e);this.du.splice(r,1)}}class eo extends md{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Zy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zy(e),this._firestoreClient=void 0,await e}}}function E3(t,e){const r=typeof t=="object"?t:pT(),n=typeof t=="string"?t:"(default)",i=jg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=YR("firestore");a&&y3(i,...a)}return i}function gd(t){if(t._terminated)throw new $e(ke.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||w3(t),t._firestoreClient}function w3(t){var e,r,n;const i=t._freezeSettings(),a=function(c,u,h,d){return new Yb(c,u,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,cS(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new p3(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sc(Qr.fromBase64String(e))}catch(r){throw new $e(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new sc(Qr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3=/^__.*__$/;class S3{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms):new rf(e,this.data,r,this.fieldTransforms)}}class fS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function hS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it()}}class vd{constructor(e,r,n,i,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Fu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new vd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.xu({path:n,Nu:!1});return i.Lu(e),i}Bu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.xu({path:n,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return I0(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(hS(this.Mu)&&T3.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class k3{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||fd(e)}$u(e,r,n,i=!1){return new vd({Mu:e,methodName:r,Ku:n,path:qr.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cf(t){const e=t._freezeSettings(),r=fd(t._databaseId);return new k3(t._databaseId,!!e.ignoreUndefinedProperties,r)}function y1(t,e,r,n,i,a={}){const o=t.$u(a.merge||a.mergeFields?2:0,e,r,i);T1("Data must be an object, but it was:",o,n);const c=gS(n,o);let u,h;if(a.merge)u=new Zn(o.fieldMask),h=o.fieldTransforms;else if(a.mergeFields){const d=[];for(const g of a.mergeFields){const v=cg(e,g,r);if(!o.contains(v))throw new $e(ke.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);xS(d,v)||d.push(v)}u=new Zn(d),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new S3(new Un(c),u,h)}class xd extends lf{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xd}}function dS(t,e,r){return new vd({Mu:3,Ku:e.settings.Ku,methodName:t._methodName,Nu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class E1 extends lf{constructor(e,r){super(e),this.Uu=r}_toFieldTransform(e){const r=dS(this,e,!0),n=this.Uu.map(a=>Ko(a,r)),i=new rc(n);return new k2(e.path,i)}isEqual(e){return e instanceof E1&&Yl(this.Uu,e.Uu)}}class w1 extends lf{constructor(e,r){super(e),this.Uu=r}_toFieldTransform(e){const r=dS(this,e,!0),n=this.Uu.map(a=>Ko(a,r)),i=new nc(n);return new k2(e.path,i)}isEqual(e){return e instanceof w1&&Yl(this.Uu,e.Uu)}}function pS(t,e,r,n){const i=t.$u(1,e,r);T1("Data must be an object, but it was:",i,n);const a=[],o=Un.empty();Js(n,(u,h)=>{const d=S1(e,u,r);h=br(h);const g=i.Bu(d);if(h instanceof xd)a.push(d);else{const v=Ko(h,g);v!=null&&(a.push(d),o.set(d,v))}});const c=new Zn(a);return new fS(o,c,i.fieldTransforms)}function mS(t,e,r,n,i,a){const o=t.$u(1,e,r),c=[cg(e,n,r)],u=[i];if(a.length%2!=0)throw new $e(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<a.length;v+=2)c.push(cg(e,a[v])),u.push(a[v+1]);const h=[],d=Un.empty();for(let v=c.length-1;v>=0;--v)if(!xS(h,c[v])){const y=c[v];let E=u[v];E=br(E);const _=o.Bu(y);if(E instanceof xd)h.push(y);else{const w=Ko(E,_);w!=null&&(h.push(y),d.set(y,w))}}const g=new Zn(h);return new fS(d,g,o.fieldTransforms)}function A3(t,e,r,n=!1){return Ko(r,t.$u(n?4:3,e))}function Ko(t,e){if(vS(t=br(t)))return T1("Unsupported field value:",e,t),gS(t,e);if(t instanceof lf)return function(n,i){if(!hS(i.Mu))throw i.qu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(n,i){const a=[];let o=0;for(const c of n){let u=Ko(c,i.ku(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return xO(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Rr.fromDate(n);return{timestampValue:S0(i.serializer,a)}}if(n instanceof Rr){const a=new Rr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:S0(i.serializer,a)}}if(n instanceof x1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof sc)return{bytesValue:F2(i.serializer,n._byteString)};if(n instanceof An){const a=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw i.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:s1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof _1)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.qu("VectorValues must only contain numeric values.");return n1(c.serializer,u)})}}}}}}(n,i);throw i.qu(`Unsupported field value: ${pd(n)}`)}(t,e)}function gS(t,e){const r={};return a2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Js(t,(n,i)=>{const a=Ko(i,e.Ou(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function vS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Rr||t instanceof x1||t instanceof sc||t instanceof An||t instanceof lf||t instanceof _1)}function T1(t,e,r){if(!vS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=pd(r);throw n==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+n)}}function cg(t,e,r){if((e=br(e))instanceof of)return e._internalPath;if(typeof e=="string")return S1(t,e);throw I0("Field path arguments must be of type string or ",t,!1,void 0,r)}const C3=new RegExp("[~\\*/\\[\\]]");function S1(t,e,r){if(e.search(C3)>=0)throw I0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new of(...e.split("."))._internalPath}catch{throw I0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function I0(t,e,r,n,i){const a=n&&!n.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new $e(ke.INVALID_ARGUMENT,c+t+u)}function xS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new I3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(k1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class I3 extends _S{data(){return super.data()}}function k1(t,e){return typeof e=="string"?S1(t,e):e instanceof of?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R3(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class A1{}class P3 extends A1{}function qH(t,e,...r){let n=[];e instanceof A1&&n.push(e),n=n.concat(r),function(a){const o=a.filter(u=>u instanceof C1).length,c=a.filter(u=>u instanceof _d).length;if(o>1||o>0&&c>0)throw new $e(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class _d extends P3{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new _d(e,r,n)}_apply(e){const r=this._parse(e);return yS(e._query,r),new xc(e.firestore,e.converter,Zm(e._query,r))}_parse(e){const r=cf(e.firestore);return function(a,o,c,u,h,d,g){let v;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new $e(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){tE(g,d);const y=[];for(const E of g)y.push(eE(u,a,E));v={arrayValue:{values:y}}}else v=eE(u,a,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||tE(g,d),v=A3(c,o,g,d==="in"||d==="not-in");return yr.create(h,d,v)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function XH(t,e,r){const n=e,i=k1("where",t);return _d._create(i,n,r)}class C1 extends A1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new C1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:$i.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)yS(o,u),o=Zm(o,u)}(e._query,r),new xc(e.firestore,e.converter,Zm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function eE(t,e,r){if(typeof(r=br(r))=="string"){if(r==="")throw new $e(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!p2(e)&&r.indexOf("/")!==-1)throw new $e(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Kt.fromString(r));if(!qe.isDocumentKey(n))throw new $e(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Ey(t,new qe(n))}if(r instanceof An)return Ey(t,r._key);throw new $e(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${pd(r)}.`)}function tE(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yS(t,e){const r=function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new $e(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class F3{convertValue(e,r="none"){switch(qs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw it()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Js(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,i;const a=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>cr(o.doubleValue));return new _1(a)}convertGeoPoint(e){return new x1(cr(e.latitude),cr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=id(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(bu(e));default:return null}}convertTimestamp(e){const r=Gs(e);return new Rr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Kt.fromString(e);bt(M2(n));const i=new Ou(n.get(1),n.get(3)),a=new qe(n.popFirst(5));return i.isEqual(r)||qa(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ES extends _S{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new s0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(k1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class s0 extends ES{data(e={}){return super.data(e)}}class b3{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new lu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new s0(this._firestore,this._userDataWriter,n.key,n,new lu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const u=new s0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new s0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:O3(c.type),doc:u,oldIndex:h,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function O3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YH(t){t=mi(t,An);const e=mi(t.firestore,eo);return v3(gd(e),t._key).then(r=>D3(e,t,r))}class wS extends F3{constructor(e){super(),this.firestore=e}convertBytes(e){return new sc(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,r)}}function uf(t){t=mi(t,xc);const e=mi(t.firestore,eo),r=gd(e),n=new wS(e);return R3(t._query),x3(r,t._query).then(i=>new b3(e,n,t,i))}function QH(t,e,r){t=mi(t,An);const n=mi(t.firestore,eo),i=I1(t.converter,e,r);return ff(n,[y1(cf(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,kn.none())])}function qo(t,e,r,...n){t=mi(t,An);const i=mi(t.firestore,eo),a=cf(i);let o;return o=typeof(e=br(e))=="string"||e instanceof of?mS(a,"updateDoc",t._key,e,r,n):pS(a,"updateDoc",t._key,e),ff(i,[o.toMutation(t._key,kn.exists(!0))])}function R1(t){return ff(mi(t.firestore,eo),[new cd(t._key,kn.none())])}function P1(t,e){const r=mi(t.firestore,eo),n=gi(t),i=I1(t.converter,e);return ff(r,[y1(cf(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,kn.exists(!1))]).then(()=>n)}function ff(t,e){return function(n,i){const a=new $a;return n.asyncQueue.enqueueAndForget(async()=>a3(await g3(n),i,a)),a.promise}(gd(t),e)}function D3(t,e,r){const n=r.docs.get(e._key),i=new wS(t);return new ES(t,i,e._key,n,new lu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=cf(e)}set(e,r,n){this._verifyNotCommitted();const i=xm(e,this._firestore),a=I1(i.converter,r,n),o=y1(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,kn.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const a=xm(e,this._firestore);let o;return o=typeof(r=br(r))=="string"||r instanceof of?mS(this._dataReader,"WriteBatch.update",a._key,r,n,i):pS(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=xm(e,this._firestore);return this._mutations=this._mutations.concat(new cd(r._key,kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(ke.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function xm(t,e){if((t=br(t)).firestore!==e)throw new $e(ke.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function TS(...t){return new E1("arrayUnion",t)}function SS(...t){return new w1("arrayRemove",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(t){return gd(t=mi(t,eo)),new N3(t,e=>ff(t,e))}(function(e,r=!0){(function(i){pc=i})(dc),Ql(new Do("firestore",(n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),c=new eo(new Ob(n.getProvider("auth-internal")),new Mb(n.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new $e(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ou(h.options.projectId,d)}(o,i),o);return a=Object.assign({useFetchStreams:r},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),Us(my,"4.7.5",e),Us(my,"4.7.5","esm2017")})();const M3={apiKey:"AIzaSyAxlL6dXgQ2JOjkwUNeWTdpretOWzf55tk",authDomain:"learn-track-center.firebaseapp.com",projectId:"learn-track-center",storageBucket:"learn-track-center.firebasestorage.app",messagingSenderId:'"651698569013",',appId:"1:651698569013:web:d8a9a0d97fef19f23bd67c",measurementId:"G-SHQ8L381Z5"},kS=dT(M3),Er=E3(kS),V3=Cb(kS),JH=new La,AS=()=>{const[t,e]=G.useState(null),[r,n]=G.useState(!0);return G.useEffect(()=>{const i=vF(V3,a=>{e(a),n(!1)});return()=>i()},[]),{user:t,loading:r}},yd=({type:t="loader",children:e,text:r,className:n})=>Q.jsx("div",{className:`loading-container ${n}`,children:t==="spinner"||e?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"spinner"}),r&&Q.jsx("p",{children:r}),Q.jsx("p",{children:e})]}):Q.jsxs(Q.Fragment,{children:[r&&Q.jsx("div",{className:"loading-text",children:Q.jsx("p",{children:r})}),Q.jsx("div",{className:"loader",children:e})]})}),Yn=({element:t})=>{const{user:e,loading:r}=AS();return r?Q.jsx(yd,{}):e?Q.jsx(Q.Fragment,{children:t}):Q.jsx(eT,{to:"/",replace:!0})};function ug(t,e){const[r,n]=G.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):e}catch(i){return console.error(i),e}});return G.useEffect(()=>{try{window.localStorage.setItem(t,JSON.stringify(r))}catch(i){console.error(i)}},[t,r]),[r,n]}const B3=({message:t,type:e,timeout:r=5e3,onClose:n})=>(G.useEffect(()=>{if(r===0)return;const i=setTimeout(()=>{n()},r);return()=>clearTimeout(i)},[n,r]),Q.jsxs("div",{className:`notification ${e}`,children:[Q.jsx("span",{children:t}),Q.jsx("button",{className:"close-button",onClick:n,children:""})]})),CS=G.createContext(void 0),F1=()=>{const t=G.useContext(CS);if(!t)throw new Error("useNotification must be used within a NotificationProvider");return t},U3=({children:t})=>{const[e,r]=G.useState([]),n=(a,o,c)=>{const u=Date.now();r(h=>{const d=[...h,{id:u,message:a,type:o,timeout:c}];return d.length>5?d.slice(-5):d}),c&&c>0&&setTimeout(()=>{i(u)},c)},i=a=>{r(o=>o.filter(c=>c.id!==a))};return Q.jsxs(CS.Provider,{value:{showNotification:n},children:[Q.jsx("div",{className:"notification-container",children:e.map(a=>Q.jsx(B3,{message:a.message,type:a.type,onClose:()=>i(a.id),timeout:a.timeout},a.id))}),t]})},j3=async()=>{const t=Za(Er,"courses");return(await uf(t)).docs.map(r=>({id:r.id,...r.data()}))},$3=async t=>{const e=Za(Er,`periods/${t}/courses`);return(await uf(e)).docs.map(n=>({id:n.id,...n.data()}))},H3=async(t,e)=>{const r=Za(Er,`periods/${t}/courses`),n=await P1(r,{...e});console.log("Course added with ID: ",n.id);const i=gi(Er,`periods/${t}`);await qo(i,{coursesIds:TS(n.id)})},z3=async(t,e)=>{const r=gi(Er,`periods/${t}/courses`,e);await R1(r);const n=gi(Er,`periods/${t}`);await qo(n,{coursesIds:SS(e)})},W3=async(t,e,r)=>{const n=gi(Er,`periods/${t}/courses`,e),{id:i,...a}=r;await qo(n,a),console.log("Course updated with ID: ",e)},IS=G.createContext(void 0),G3=({children:t})=>{const[e,r]=G.useState(!1),[n,i]=G.useState("");return Q.jsxs(IS.Provider,{value:{isLoading:e,loadingText:n,setIsLoading:r,setLoadingText:i},children:[e&&Q.jsx(yd,{text:n}),t]})},RS=()=>{const t=G.useContext(IS);if(t===void 0)throw new Error("useLoading must be used within a LoadingProvider");return t},PS=async()=>{const t=Za(Er,"teachers");return(await uf(t)).docs.map(n=>({id:n.id,...n.data()}))},K3=async t=>{const e=Za(Er,"teachers");await P1(e,t)},q3=async t=>{const e=gi(Er,"teachers",t);await R1(e)},X3=t=>{const[e,r]=G.useState([]),[n,i]=G.useState(!0),[a,o]=G.useState(null),[c,u]=ug("availableTeachers",[]),[h,d]=ug("availableCourses",[]),{showNotification:g}=F1(),{setIsLoading:v}=RS();G.useEffect(()=>{v(n)},[n,v]);const y=async()=>{try{i(!0);const B=(await $3(t)).map(V=>{const z=c.find(A=>A.id===V.teacherId);return{...V,teacherName:z?z.name:"Unknown Teacher"}});r(B)}catch{g("Error fetching courses","error")}finally{i(!1)}},E=async()=>{try{i(!0);const C=await j3();d(C)}catch{g("Error fetching courses","error")}finally{i(!1)}},_=async()=>{try{i(!0);const C=await PS();u(C)}catch{g("Error fetching courses","error")}finally{i(!1)}};return G.useEffect(()=>{y(),E(),_()},[]),{courses:e,availableCourses:h,availableTeachers:c,loading:n,error:a,handleAddCourse:async C=>{try{if(e.filter(B=>B.courseId===C.courseId).length>0){g("Course already added","error");return}i(!0),await H3(t,C),y()}catch{g("Error adding course","error")}finally{i(!1)}},handleDeleteCourse:async C=>{try{if(!C)return;i(!0),await z3(t,C),y()}catch{o("Error deleting course"),g("Error deleting course","error")}finally{i(!1)}},handleUpdateCourse:async(C,B)=>{try{if(!t)return;i(!0),await W3(t,C,B),y()}catch{o("Error update course"),g("Error update course","error")}finally{i(!1)}}}};function Vo(t){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vo(t)}function Y3(t,e){if(Vo(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FS(t){var e=Y3(t,"string");return Vo(e)=="symbol"?e:e+""}function cu(t,e,r){return(e=FS(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rE(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Qe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rE(Object(r),!0).forEach(function(n){cu(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Q3(t){if(Array.isArray(t))return t}function J3(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,o,c=[],u=!0,h=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(d){h=!0,i=d}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw i}}return c}}function fg(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function bS(t,e){if(t){if(typeof t=="string")return fg(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fg(t,e):void 0}}function Z3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ha(t,e){return Q3(t)||J3(t,e)||bS(t,e)||Z3()}function eN(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}function es(t,e){if(t==null)return{};var r,n,i=eN(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var tN=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function rN(t){var e=t.defaultInputValue,r=e===void 0?"":e,n=t.defaultMenuIsOpen,i=n===void 0?!1:n,a=t.defaultValue,o=a===void 0?null:a,c=t.inputValue,u=t.menuIsOpen,h=t.onChange,d=t.onInputChange,g=t.onMenuClose,v=t.onMenuOpen,y=t.value,E=es(t,tN),_=G.useState(c!==void 0?c:r),w=Ha(_,2),k=w[0],F=w[1],C=G.useState(u!==void 0?u:i),B=Ha(C,2),V=B[0],z=B[1],A=G.useState(y!==void 0?y:o),R=Ha(A,2),P=R[0],L=R[1],M=G.useCallback(function(ye,ie){typeof h=="function"&&h(ye,ie),L(ye)},[h]),N=G.useCallback(function(ye,ie){var ve;typeof d=="function"&&(ve=d(ye,ie)),F(ve!==void 0?ve:ye)},[d]),U=G.useCallback(function(){typeof v=="function"&&v(),z(!0)},[v]),be=G.useCallback(function(){typeof g=="function"&&g(),z(!1)},[g]),Ee=c!==void 0?c:k,Ce=u!==void 0?u:V,Te=y!==void 0?y:P;return Qe(Qe({},E),{},{inputValue:Ee,menuIsOpen:Ce,onChange:M,onInputChange:N,onMenuClose:be,onMenuOpen:U,value:Te})}function Ze(){return Ze=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ze.apply(null,arguments)}function nN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FS(n.key),n)}}function iN(t,e,r){return nE(t.prototype,e),nE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hg(t,e){return hg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},hg(t,e)}function aN(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hg(t,e)}function R0(t){return R0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R0(t)}function OS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OS=function(){return!!t})()}function sN(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oN(t,e){if(e&&(Vo(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sN(t)}function lN(t){var e=OS();return function(){var r,n=R0(t);if(e){var i=R0(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return oN(this,r)}}function cN(t){if(Array.isArray(t))return fg(t)}function uN(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function fN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b1(t){return cN(t)||uN(t)||bS(t)||fN()}var hN=!1;function dN(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function pN(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var mN=function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!hN:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(pN(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=dN(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t}(),sn="-ms-",P0="-moz-",Rt="-webkit-",DS="comm",O1="rule",D1="decl",gN="@import",NS="@keyframes",vN="@layer",xN=Math.abs,Ed=String.fromCharCode,_N=Object.assign;function yN(t,e){return Gr(t,0)^45?(((e<<2^Gr(t,0))<<2^Gr(t,1))<<2^Gr(t,2))<<2^Gr(t,3):0}function LS(t){return t.trim()}function EN(t,e){return(t=e.exec(t))?t[0]:t}function Pt(t,e,r){return t.replace(e,r)}function dg(t,e){return t.indexOf(e)}function Gr(t,e){return t.charCodeAt(e)|0}function Nu(t,e,r){return t.slice(e,r)}function aa(t){return t.length}function N1(t){return t.length}function Nh(t,e){return e.push(t),t}function wN(t,e){return t.map(e).join("")}var wd=1,oc=1,MS=0,jn=0,_r=0,_c="";function Td(t,e,r,n,i,a,o){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:wd,column:oc,length:o,return:""}}function nu(t,e){return _N(Td("",null,null,"",null,null,0),t,{length:-t.length},e)}function TN(){return _r}function SN(){return _r=jn>0?Gr(_c,--jn):0,oc--,_r===10&&(oc=1,wd--),_r}function ei(){return _r=jn<MS?Gr(_c,jn++):0,oc++,_r===10&&(oc=1,wd++),_r}function fa(){return Gr(_c,jn)}function o0(){return jn}function hf(t,e){return Nu(_c,t,e)}function Lu(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function VS(t){return wd=oc=1,MS=aa(_c=t),jn=0,[]}function BS(t){return _c="",t}function l0(t){return LS(hf(jn-1,pg(t===91?t+2:t===40?t+1:t)))}function kN(t){for(;(_r=fa())&&_r<33;)ei();return Lu(t)>2||Lu(_r)>3?"":" "}function AN(t,e){for(;--e&&ei()&&!(_r<48||_r>102||_r>57&&_r<65||_r>70&&_r<97););return hf(t,o0()+(e<6&&fa()==32&&ei()==32))}function pg(t){for(;ei();)switch(_r){case t:return jn;case 34:case 39:t!==34&&t!==39&&pg(_r);break;case 40:t===41&&pg(t);break;case 92:ei();break}return jn}function CN(t,e){for(;ei()&&t+_r!==57;)if(t+_r===84&&fa()===47)break;return"/*"+hf(e,jn-1)+"*"+Ed(t===47?t:ei())}function IN(t){for(;!Lu(fa());)ei();return hf(t,jn)}function RN(t){return BS(c0("",null,null,null,[""],t=VS(t),0,[0],t))}function c0(t,e,r,n,i,a,o,c,u){for(var h=0,d=0,g=o,v=0,y=0,E=0,_=1,w=1,k=1,F=0,C="",B=i,V=a,z=n,A=C;w;)switch(E=F,F=ei()){case 40:if(E!=108&&Gr(A,g-1)==58){dg(A+=Pt(l0(F),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:A+=l0(F);break;case 9:case 10:case 13:case 32:A+=kN(E);break;case 92:A+=AN(o0()-1,7);continue;case 47:switch(fa()){case 42:case 47:Nh(PN(CN(ei(),o0()),e,r),u);break;default:A+="/"}break;case 123*_:c[h++]=aa(A)*k;case 125*_:case 59:case 0:switch(F){case 0:case 125:w=0;case 59+d:k==-1&&(A=Pt(A,/\f/g,"")),y>0&&aa(A)-g&&Nh(y>32?aE(A+";",n,r,g-1):aE(Pt(A," ","")+";",n,r,g-2),u);break;case 59:A+=";";default:if(Nh(z=iE(A,e,r,h,d,i,c,C,B=[],V=[],g),a),F===123)if(d===0)c0(A,e,z,z,B,a,g,c,V);else switch(v===99&&Gr(A,3)===110?100:v){case 100:case 108:case 109:case 115:c0(t,z,z,n&&Nh(iE(t,z,z,0,0,i,c,C,i,B=[],g),V),i,V,g,c,n?B:V);break;default:c0(A,z,z,z,[""],V,0,c,V)}}h=d=y=0,_=k=1,C=A="",g=o;break;case 58:g=1+aa(A),y=E;default:if(_<1){if(F==123)--_;else if(F==125&&_++==0&&SN()==125)continue}switch(A+=Ed(F),F*_){case 38:k=d>0?1:(A+="\f",-1);break;case 44:c[h++]=(aa(A)-1)*k,k=1;break;case 64:fa()===45&&(A+=l0(ei())),v=fa(),d=g=aa(C=A+=IN(o0())),F++;break;case 45:E===45&&aa(A)==2&&(_=0)}}return a}function iE(t,e,r,n,i,a,o,c,u,h,d){for(var g=i-1,v=i===0?a:[""],y=N1(v),E=0,_=0,w=0;E<n;++E)for(var k=0,F=Nu(t,g+1,g=xN(_=o[E])),C=t;k<y;++k)(C=LS(_>0?v[k]+" "+F:Pt(F,/&\f/g,v[k])))&&(u[w++]=C);return Td(t,e,r,i===0?O1:c,u,h,d)}function PN(t,e,r){return Td(t,e,r,DS,Ed(TN()),Nu(t,2,-2),0)}function aE(t,e,r,n){return Td(t,e,r,D1,Nu(t,0,n),Nu(t,n+1,-1),n)}function Gl(t,e){for(var r="",n=N1(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function FN(t,e,r,n){switch(t.type){case vN:if(t.children.length)break;case gN:case D1:return t.return=t.return||t.value;case DS:return"";case NS:return t.return=t.value+"{"+Gl(t.children,n)+"}";case O1:t.value=t.props.join(",")}return aa(r=Gl(t.children,n))?t.return=t.value+"{"+r+"}":""}function bN(t){var e=N1(t);return function(r,n,i,a){for(var o="",c=0;c<e;c++)o+=t[c](r,n,i,a)||"";return o}}function ON(t){return function(e){e.root||(e=e.return)&&t(e)}}function DN(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var NN=function(e,r,n){for(var i=0,a=0;i=a,a=fa(),i===38&&a===12&&(r[n]=1),!Lu(a);)ei();return hf(e,jn)},LN=function(e,r){var n=-1,i=44;do switch(Lu(i)){case 0:i===38&&fa()===12&&(r[n]=1),e[n]+=NN(jn-1,r,n);break;case 2:e[n]+=l0(i);break;case 4:if(i===44){e[++n]=fa()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=Ed(i)}while(i=ei());return e},MN=function(e,r){return BS(LN(VS(e),r))},sE=new WeakMap,VN=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!sE.get(n))&&!i){sE.set(e,!0);for(var a=[],o=MN(r,a),c=n.props,u=0,h=0;u<o.length;u++)for(var d=0;d<c.length;d++,h++)e.props[h]=a[u]?o[u].replace(/&\f/g,c[d]):c[d]+" "+o[u]}}},BN=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function US(t,e){switch(yN(t,e)){case 5103:return Rt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Rt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Rt+t+P0+t+sn+t+t;case 6828:case 4268:return Rt+t+sn+t+t;case 6165:return Rt+t+sn+"flex-"+t+t;case 5187:return Rt+t+Pt(t,/(\w+).+(:[^]+)/,Rt+"box-$1$2"+sn+"flex-$1$2")+t;case 5443:return Rt+t+sn+"flex-item-"+Pt(t,/flex-|-self/,"")+t;case 4675:return Rt+t+sn+"flex-line-pack"+Pt(t,/align-content|flex-|-self/,"")+t;case 5548:return Rt+t+sn+Pt(t,"shrink","negative")+t;case 5292:return Rt+t+sn+Pt(t,"basis","preferred-size")+t;case 6060:return Rt+"box-"+Pt(t,"-grow","")+Rt+t+sn+Pt(t,"grow","positive")+t;case 4554:return Rt+Pt(t,/([^-])(transform)/g,"$1"+Rt+"$2")+t;case 6187:return Pt(Pt(Pt(t,/(zoom-|grab)/,Rt+"$1"),/(image-set)/,Rt+"$1"),t,"")+t;case 5495:case 3959:return Pt(t,/(image-set\([^]*)/,Rt+"$1$`$1");case 4968:return Pt(Pt(t,/(.+:)(flex-)?(.*)/,Rt+"box-pack:$3"+sn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Rt+t+t;case 4095:case 3583:case 4068:case 2532:return Pt(t,/(.+)-inline(.+)/,Rt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(aa(t)-1-e>6)switch(Gr(t,e+1)){case 109:if(Gr(t,e+4)!==45)break;case 102:return Pt(t,/(.+:)(.+)-([^]+)/,"$1"+Rt+"$2-$3$1"+P0+(Gr(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~dg(t,"stretch")?US(Pt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Gr(t,e+1)!==115)break;case 6444:switch(Gr(t,aa(t)-3-(~dg(t,"!important")&&10))){case 107:return Pt(t,":",":"+Rt)+t;case 101:return Pt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Rt+(Gr(t,14)===45?"inline-":"")+"box$3$1"+Rt+"$2$3$1"+sn+"$2box$3")+t}break;case 5936:switch(Gr(t,e+11)){case 114:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Rt+t+sn+t+t}return t}var UN=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case D1:e.return=US(e.value,e.length);break;case NS:return Gl([nu(e,{value:Pt(e.value,"@","@"+Rt)})],i);case O1:if(e.length)return wN(e.props,function(a){switch(EN(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Gl([nu(e,{props:[Pt(a,/:(read-\w+)/,":"+P0+"$1")]})],i);case"::placeholder":return Gl([nu(e,{props:[Pt(a,/:(plac\w+)/,":"+Rt+"input-$1")]}),nu(e,{props:[Pt(a,/:(plac\w+)/,":"+P0+"$1")]}),nu(e,{props:[Pt(a,/:(plac\w+)/,sn+"input-$1")]})],i)}return""})}},jN=[UN],$N=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(_){var w=_.getAttribute("data-emotion");w.indexOf(" ")!==-1&&(document.head.appendChild(_),_.setAttribute("data-s",""))})}var i=e.stylisPlugins||jN,a={},o,c=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(_){for(var w=_.getAttribute("data-emotion").split(" "),k=1;k<w.length;k++)a[w[k]]=!0;c.push(_)});var u,h=[VN,BN];{var d,g=[FN,ON(function(_){d.insert(_)})],v=bN(h.concat(i,g)),y=function(w){return Gl(RN(w),v)};u=function(w,k,F,C){d=F,y(w?w+"{"+k.styles+"}":k.styles),C&&(E.inserted[k.name]=!0)}}var E={key:r,sheet:new mN({key:r,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:u};return E.sheet.hydrate(c),E},_m={exports:{}},Ft={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function HN(){if(oE)return Ft;oE=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,c=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,h=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,g=t?Symbol.for("react.suspense"):60113,v=t?Symbol.for("react.suspense_list"):60120,y=t?Symbol.for("react.memo"):60115,E=t?Symbol.for("react.lazy"):60116,_=t?Symbol.for("react.block"):60121,w=t?Symbol.for("react.fundamental"):60117,k=t?Symbol.for("react.responder"):60118,F=t?Symbol.for("react.scope"):60119;function C(V){if(typeof V=="object"&&V!==null){var z=V.$$typeof;switch(z){case e:switch(V=V.type,V){case u:case h:case n:case a:case i:case g:return V;default:switch(V=V&&V.$$typeof,V){case c:case d:case E:case y:case o:return V;default:return z}}case r:return z}}}function B(V){return C(V)===h}return Ft.AsyncMode=u,Ft.ConcurrentMode=h,Ft.ContextConsumer=c,Ft.ContextProvider=o,Ft.Element=e,Ft.ForwardRef=d,Ft.Fragment=n,Ft.Lazy=E,Ft.Memo=y,Ft.Portal=r,Ft.Profiler=a,Ft.StrictMode=i,Ft.Suspense=g,Ft.isAsyncMode=function(V){return B(V)||C(V)===u},Ft.isConcurrentMode=B,Ft.isContextConsumer=function(V){return C(V)===c},Ft.isContextProvider=function(V){return C(V)===o},Ft.isElement=function(V){return typeof V=="object"&&V!==null&&V.$$typeof===e},Ft.isForwardRef=function(V){return C(V)===d},Ft.isFragment=function(V){return C(V)===n},Ft.isLazy=function(V){return C(V)===E},Ft.isMemo=function(V){return C(V)===y},Ft.isPortal=function(V){return C(V)===r},Ft.isProfiler=function(V){return C(V)===a},Ft.isStrictMode=function(V){return C(V)===i},Ft.isSuspense=function(V){return C(V)===g},Ft.isValidElementType=function(V){return typeof V=="string"||typeof V=="function"||V===n||V===h||V===a||V===i||V===g||V===v||typeof V=="object"&&V!==null&&(V.$$typeof===E||V.$$typeof===y||V.$$typeof===o||V.$$typeof===c||V.$$typeof===d||V.$$typeof===w||V.$$typeof===k||V.$$typeof===F||V.$$typeof===_)},Ft.typeOf=C,Ft}var lE;function zN(){return lE||(lE=1,_m.exports=HN()),_m.exports}var ym,cE;function WN(){if(cE)return ym;cE=1;var t=zN(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function o(E){return t.isMemo(E)?i:a[E.$$typeof]||e}var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,v=Object.prototype;function y(E,_,w){if(typeof _!="string"){if(v){var k=g(_);k&&k!==v&&y(E,k,w)}var F=u(_);h&&(F=F.concat(h(_)));for(var C=o(E),B=o(_),V=0;V<F.length;++V){var z=F[V];if(!r[z]&&!(w&&w[z])&&!(B&&B[z])&&!(C&&C[z])){var A=d(_,z);try{c(E,z,A)}catch{}}}}return E}return ym=y,ym}WN();var GN=!0;function KN(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var jS=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||GN===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},qN=function(e,r,n){jS(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function XN(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var YN={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},QN=/[A-Z]|^ms/g,JN=/_EMO_([^_]+?)_([^]*?)_EMO_/g,$S=function(e){return e.charCodeAt(1)===45},uE=function(e){return e!=null&&typeof e!="boolean"},Em=DN(function(t){return $S(t)?t:t.replace(QN,"-$&").toLowerCase()}),fE=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(JN,function(n,i,a){return sa={name:i,styles:a,next:sa},i})}return YN[e]!==1&&!$S(e)&&typeof r=="number"&&r!==0?r+"px":r};function Mu(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return sa={name:i.name,styles:i.styles,next:sa},i.name;var a=r;if(a.styles!==void 0){var o=a.next;if(o!==void 0)for(;o!==void 0;)sa={name:o.name,styles:o.styles,next:sa},o=o.next;var c=a.styles+";";return c}return ZN(t,e,r)}case"function":{if(t!==void 0){var u=sa,h=r(t);return sa=u,Mu(t,e,h)}break}}var d=r;return d}function ZN(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Mu(t,e,r[i])+";";else for(var a in r){var o=r[a];if(typeof o!="object"){var c=o;uE(c)&&(n+=Em(a)+":"+fE(a,c)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&e==null)for(var u=0;u<o.length;u++)uE(o[u])&&(n+=Em(a)+":"+fE(a,o[u])+";");else{var h=Mu(t,e,o);switch(a){case"animation":case"animationName":{n+=Em(a)+":"+h+";";break}default:n+=a+"{"+h+"}"}}}return n}var hE=/label:\s*([^\s;{]+)\s*(;|$)/g,sa;function HS(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";sa=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=Mu(r,e,a);else{var o=a;i+=o[0]}for(var c=1;c<t.length;c++)if(i+=Mu(r,e,t[c]),n){var u=a;i+=u[c]}hE.lastIndex=0;for(var h="",d;(d=hE.exec(i))!==null;)h+="-"+d[1];var g=XN(i)+h;return{name:g,styles:i,next:sa}}var eL=function(e){return e()},tL=A_.useInsertionEffect?A_.useInsertionEffect:!1,rL=tL||eL,nL=!1,zS=G.createContext(typeof HTMLElement<"u"?$N({key:"css"}):null);zS.Provider;var iL=function(e){return G.forwardRef(function(r,n){var i=G.useContext(zS);return e(r,i,n)})},aL=G.createContext({}),L1={}.hasOwnProperty,mg="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",sL=function(e,r){var n={};for(var i in r)L1.call(r,i)&&(n[i]=r[i]);return n[mg]=e,n},oL=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return jS(r,n,i),rL(function(){return qN(r,n,i)}),null},lL=iL(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[mg],a=[n],o="";typeof t.className=="string"?o=KN(e.registered,a,t.className):t.className!=null&&(o=t.className+" ");var c=HS(a,void 0,G.useContext(aL));o+=e.key+"-"+c.name;var u={};for(var h in t)L1.call(t,h)&&h!=="css"&&h!==mg&&!nL&&(u[h]=t[h]);return u.className=o,r&&(u.ref=r),G.createElement(G.Fragment,null,G.createElement(oL,{cache:e,serialized:c,isStringTag:typeof i=="string"}),G.createElement(i,u))}),cL=lL,Ke=function(e,r){var n=arguments;if(r==null||!L1.call(r,"css"))return G.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=cL,a[1]=sL(e,r);for(var o=2;o<i;o++)a[o]=n[o];return G.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Ke);function M1(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return HS(e)}function uL(){var t=M1.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function fL(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const hL=Math.min,dL=Math.max,F0=Math.round,Lh=Math.floor,b0=t=>({x:t,y:t});function pL(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}function Sd(){return typeof window<"u"}function WS(t){return KS(t)?(t.nodeName||"").toLowerCase():"#document"}function Ya(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function GS(t){var e;return(e=(KS(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function KS(t){return Sd()?t instanceof Node||t instanceof Ya(t).Node:!1}function mL(t){return Sd()?t instanceof Element||t instanceof Ya(t).Element:!1}function V1(t){return Sd()?t instanceof HTMLElement||t instanceof Ya(t).HTMLElement:!1}function dE(t){return!Sd()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ya(t).ShadowRoot}function qS(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=B1(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function gL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vL(t){return["html","body","#document"].includes(WS(t))}function B1(t){return Ya(t).getComputedStyle(t)}function xL(t){if(WS(t)==="html")return t;const e=t.assignedSlot||t.parentNode||dE(t)&&t.host||GS(t);return dE(e)?e.host:e}function XS(t){const e=xL(t);return vL(e)?t.ownerDocument?t.ownerDocument.body:t.body:V1(e)&&qS(e)?e:XS(e)}function O0(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=XS(t),a=i===((n=t.ownerDocument)==null?void 0:n.body),o=Ya(i);if(a){const c=gg(o);return e.concat(o,o.visualViewport||[],qS(i)?i:[],c&&r?O0(c):[])}return e.concat(i,O0(i,[],r))}function gg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function _L(t){const e=B1(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=V1(t),a=i?t.offsetWidth:r,o=i?t.offsetHeight:n,c=F0(r)!==a||F0(n)!==o;return c&&(r=a,n=o),{width:r,height:n,$:c}}function U1(t){return mL(t)?t:t.contextElement}function pE(t){const e=U1(t);if(!V1(e))return b0(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:a}=_L(e);let o=(a?F0(r.width):r.width)/n,c=(a?F0(r.height):r.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const yL=b0(0);function EL(t){const e=Ya(t);return!gL()||!e.visualViewport?yL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function wL(t,e,r){return!1}function mE(t,e,r,n){e===void 0&&(e=!1);const i=t.getBoundingClientRect(),a=U1(t);let o=b0(1);e&&(o=pE(t));const c=wL()?EL(a):b0(0);let u=(i.left+c.x)/o.x,h=(i.top+c.y)/o.y,d=i.width/o.x,g=i.height/o.y;if(a){const v=Ya(a),y=n;let E=v,_=gg(E);for(;_&&n&&y!==E;){const w=pE(_),k=_.getBoundingClientRect(),F=B1(_),C=k.left+(_.clientLeft+parseFloat(F.paddingLeft))*w.x,B=k.top+(_.clientTop+parseFloat(F.paddingTop))*w.y;u*=w.x,h*=w.y,d*=w.x,g*=w.y,u+=C,h+=B,E=Ya(_),_=gg(E)}}return pL({width:d,height:g,x:u,y:h})}function TL(t,e){let r=null,n;const i=GS(t);function a(){var c;clearTimeout(n),(c=r)==null||c.disconnect(),r=null}function o(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),a();const{left:h,top:d,width:g,height:v}=t.getBoundingClientRect();if(c||e(),!g||!v)return;const y=Lh(d),E=Lh(i.clientWidth-(h+g)),_=Lh(i.clientHeight-(d+v)),w=Lh(h),F={rootMargin:-y+"px "+-E+"px "+-_+"px "+-w+"px",threshold:dL(0,hL(1,u))||1};let C=!0;function B(V){const z=V[0].intersectionRatio;if(z!==u){if(!C)return o();z?o(!1,z):n=setTimeout(()=>{o(!1,1e-7)},1e3)}C=!1}try{r=new IntersectionObserver(B,{...F,root:i.ownerDocument})}catch{r=new IntersectionObserver(B,F)}r.observe(t)}return o(!0),a}function SL(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,h=U1(t),d=i||a?[...h?O0(h):[],...O0(e)]:[];d.forEach(k=>{i&&k.addEventListener("scroll",r,{passive:!0}),a&&k.addEventListener("resize",r)});const g=h&&c?TL(h,r):null;let v=-1,y=null;o&&(y=new ResizeObserver(k=>{let[F]=k;F&&F.target===h&&y&&(y.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var C;(C=y)==null||C.observe(e)})),r()}),h&&!u&&y.observe(h),y.observe(e));let E,_=u?mE(t):null;u&&w();function w(){const k=mE(t);_&&(k.x!==_.x||k.y!==_.y||k.width!==_.width||k.height!==_.height)&&r(),_=k,E=requestAnimationFrame(w)}return r(),()=>{var k;d.forEach(F=>{i&&F.removeEventListener("scroll",r),a&&F.removeEventListener("resize",r)}),g==null||g(),(k=y)==null||k.disconnect(),y=null,u&&cancelAnimationFrame(E)}}var vg=G.useLayoutEffect,kL=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],D0=function(){};function AL(t,e){return e?e[0]==="-"?t+e:t+"__"+e:t}function CL(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var a=[].concat(n);if(e&&t)for(var o in e)e.hasOwnProperty(o)&&e[o]&&a.push("".concat(AL(t,o)));return a.filter(function(c){return c}).map(function(c){return String(c).trim()}).join(" ")}var gE=function(e){return LL(e)?e.filter(Boolean):Vo(e)==="object"&&e!==null?[e]:[]},YS=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var r=es(e,kL);return Qe({},r)},ir=function(e,r,n){var i=e.cx,a=e.getStyles,o=e.getClassNames,c=e.className;return{css:a(r,e),className:i(n??{},o(r,e),c)}};function kd(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function IL(t){return kd(t)?window.innerHeight:t.clientHeight}function QS(t){return kd(t)?window.pageYOffset:t.scrollTop}function N0(t,e){if(kd(t)){window.scrollTo(0,e);return}t.scrollTop=e}function RL(t){var e=getComputedStyle(t),r=e.position==="absolute",n=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var i=t;i=i.parentElement;)if(e=getComputedStyle(i),!(r&&e.position==="static")&&n.test(e.overflow+e.overflowY+e.overflowX))return i;return document.documentElement}function PL(t,e,r,n){return r*((t=t/n-1)*t*t+1)+e}function Mh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:D0,i=QS(t),a=e-i,o=10,c=0;function u(){c+=o;var h=PL(c,i,a,r);N0(t,h),c<r?window.requestAnimationFrame(u):n(t)}u()}function vE(t,e){var r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=e.offsetHeight/3;n.bottom+i>r.bottom?N0(t,Math.min(e.offsetTop+e.clientHeight-t.offsetHeight+i,t.scrollHeight)):n.top-i<r.top&&N0(t,Math.max(e.offsetTop-i,0))}function FL(t){var e=t.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function xE(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function bL(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var JS=!1,OL={get passive(){return JS=!0}},Vh=typeof window<"u"?window:{};Vh.addEventListener&&Vh.removeEventListener&&(Vh.addEventListener("p",D0,OL),Vh.removeEventListener("p",D0,!1));var DL=JS;function NL(t){return t!=null}function LL(t){return Array.isArray(t)}function Bh(t,e,r){return t?e:r}var ML=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=Object.entries(e).filter(function(o){var c=Ha(o,1),u=c[0];return!n.includes(u)});return a.reduce(function(o,c){var u=Ha(c,2),h=u[0],d=u[1];return o[h]=d,o},{})},VL=["children","innerProps"],BL=["children","innerProps"];function UL(t){var e=t.maxHeight,r=t.menuEl,n=t.minHeight,i=t.placement,a=t.shouldScroll,o=t.isFixedPosition,c=t.controlHeight,u=RL(r),h={placement:"bottom",maxHeight:e};if(!r||!r.offsetParent)return h;var d=u.getBoundingClientRect(),g=d.height,v=r.getBoundingClientRect(),y=v.bottom,E=v.height,_=v.top,w=r.offsetParent.getBoundingClientRect(),k=w.top,F=o?window.innerHeight:IL(u),C=QS(u),B=parseInt(getComputedStyle(r).marginBottom,10),V=parseInt(getComputedStyle(r).marginTop,10),z=k-V,A=F-_,R=z+C,P=g-C-_,L=y-F+C+B,M=C+_-V,N=160;switch(i){case"auto":case"bottom":if(A>=E)return{placement:"bottom",maxHeight:e};if(P>=E&&!o)return a&&Mh(u,L,N),{placement:"bottom",maxHeight:e};if(!o&&P>=n||o&&A>=n){a&&Mh(u,L,N);var U=o?A-B:P-B;return{placement:"bottom",maxHeight:U}}if(i==="auto"||o){var be=e,Ee=o?z:R;return Ee>=n&&(be=Math.min(Ee-B-c,e)),{placement:"top",maxHeight:be}}if(i==="bottom")return a&&N0(u,L),{placement:"bottom",maxHeight:e};break;case"top":if(z>=E)return{placement:"top",maxHeight:e};if(R>=E&&!o)return a&&Mh(u,M,N),{placement:"top",maxHeight:e};if(!o&&R>=n||o&&z>=n){var Ce=e;return(!o&&R>=n||o&&z>=n)&&(Ce=o?z-V:R-V),a&&Mh(u,M,N),{placement:"top",maxHeight:Ce}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return h}function jL(t){var e={bottom:"top",top:"bottom"};return t?e[t]:"bottom"}var ZS=function(e){return e==="auto"?"bottom":e},$L=function(e,r){var n,i=e.placement,a=e.theme,o=a.borderRadius,c=a.spacing,u=a.colors;return Qe((n={label:"menu"},cu(n,jL(i),"100%"),cu(n,"position","absolute"),cu(n,"width","100%"),cu(n,"zIndex",1),n),r?{}:{backgroundColor:u.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:c.menuGutter,marginTop:c.menuGutter})},ek=G.createContext(null),HL=function(e){var r=e.children,n=e.minMenuHeight,i=e.maxMenuHeight,a=e.menuPlacement,o=e.menuPosition,c=e.menuShouldScrollIntoView,u=e.theme,h=G.useContext(ek)||{},d=h.setPortalPlacement,g=G.useRef(null),v=G.useState(i),y=Ha(v,2),E=y[0],_=y[1],w=G.useState(null),k=Ha(w,2),F=k[0],C=k[1],B=u.spacing.controlHeight;return vg(function(){var V=g.current;if(V){var z=o==="fixed",A=c&&!z,R=UL({maxHeight:i,menuEl:V,minHeight:n,placement:a,shouldScroll:A,isFixedPosition:z,controlHeight:B});_(R.maxHeight),C(R.placement),d==null||d(R.placement)}},[i,a,o,c,n,d,B]),r({ref:g,placerProps:Qe(Qe({},e),{},{placement:F||ZS(a),maxHeight:E})})},zL=function(e){var r=e.children,n=e.innerRef,i=e.innerProps;return Ke("div",Ze({},ir(e,"menu",{menu:!0}),{ref:n},i),r)},WL=zL,GL=function(e,r){var n=e.maxHeight,i=e.theme.spacing.baseUnit;return Qe({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:i,paddingTop:i})},KL=function(e){var r=e.children,n=e.innerProps,i=e.innerRef,a=e.isMulti;return Ke("div",Ze({},ir(e,"menuList",{"menu-list":!0,"menu-list--is-multi":a}),{ref:i},n),r)},tk=function(e,r){var n=e.theme,i=n.spacing.baseUnit,a=n.colors;return Qe({textAlign:"center"},r?{}:{color:a.neutral40,padding:"".concat(i*2,"px ").concat(i*3,"px")})},qL=tk,XL=tk,YL=function(e){var r=e.children,n=r===void 0?"No options":r,i=e.innerProps,a=es(e,VL);return Ke("div",Ze({},ir(Qe(Qe({},a),{},{children:n,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),n)},QL=function(e){var r=e.children,n=r===void 0?"Loading...":r,i=e.innerProps,a=es(e,BL);return Ke("div",Ze({},ir(Qe(Qe({},a),{},{children:n,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),n)},JL=function(e){var r=e.rect,n=e.offset,i=e.position;return{left:r.left,position:i,top:n,width:r.width,zIndex:1}},ZL=function(e){var r=e.appendTo,n=e.children,i=e.controlElement,a=e.innerProps,o=e.menuPlacement,c=e.menuPosition,u=G.useRef(null),h=G.useRef(null),d=G.useState(ZS(o)),g=Ha(d,2),v=g[0],y=g[1],E=G.useMemo(function(){return{setPortalPlacement:y}},[]),_=G.useState(null),w=Ha(_,2),k=w[0],F=w[1],C=G.useCallback(function(){if(i){var A=FL(i),R=c==="fixed"?0:window.pageYOffset,P=A[v]+R;(P!==(k==null?void 0:k.offset)||A.left!==(k==null?void 0:k.rect.left)||A.width!==(k==null?void 0:k.rect.width))&&F({offset:P,rect:A})}},[i,c,v,k==null?void 0:k.offset,k==null?void 0:k.rect.left,k==null?void 0:k.rect.width]);vg(function(){C()},[C]);var B=G.useCallback(function(){typeof h.current=="function"&&(h.current(),h.current=null),i&&u.current&&(h.current=SL(i,u.current,C,{elementResize:"ResizeObserver"in window}))},[i,C]);vg(function(){B()},[B]);var V=G.useCallback(function(A){u.current=A,B()},[B]);if(!r&&c!=="fixed"||!k)return null;var z=Ke("div",Ze({ref:V},ir(Qe(Qe({},e),{},{offset:k.offset,position:c,rect:k.rect}),"menuPortal",{"menu-portal":!0}),a),n);return Ke(ek.Provider,{value:E},r?UR.createPortal(z,r):z)},e6=function(e){var r=e.isDisabled,n=e.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},t6=function(e){var r=e.children,n=e.innerProps,i=e.isDisabled,a=e.isRtl;return Ke("div",Ze({},ir(e,"container",{"--is-disabled":i,"--is-rtl":a}),n),r)},r6=function(e,r){var n=e.theme.spacing,i=e.isMulti,a=e.hasValue,o=e.selectProps.controlShouldRenderValue;return Qe({alignItems:"center",display:i&&a&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},n6=function(e){var r=e.children,n=e.innerProps,i=e.isMulti,a=e.hasValue;return Ke("div",Ze({},ir(e,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":a}),n),r)},i6=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},a6=function(e){var r=e.children,n=e.innerProps;return Ke("div",Ze({},ir(e,"indicatorsContainer",{indicators:!0}),n),r)},_E,s6=["size"],o6=["innerProps","isRtl","size"],l6={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},rk=function(e){var r=e.size,n=es(e,s6);return Ke("svg",Ze({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:l6},n))},j1=function(e){return Ke(rk,Ze({size:20},e),Ke("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},nk=function(e){return Ke(rk,Ze({size:20},e),Ke("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ik=function(e,r){var n=e.isFocused,i=e.theme,a=i.spacing.baseUnit,o=i.colors;return Qe({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:n?o.neutral60:o.neutral20,padding:a*2,":hover":{color:n?o.neutral80:o.neutral40}})},c6=ik,u6=function(e){var r=e.children,n=e.innerProps;return Ke("div",Ze({},ir(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),r||Ke(nk,null))},f6=ik,h6=function(e){var r=e.children,n=e.innerProps;return Ke("div",Ze({},ir(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),r||Ke(j1,null))},d6=function(e,r){var n=e.isDisabled,i=e.theme,a=i.spacing.baseUnit,o=i.colors;return Qe({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:n?o.neutral10:o.neutral20,marginBottom:a*2,marginTop:a*2})},p6=function(e){var r=e.innerProps;return Ke("span",Ze({},r,ir(e,"indicatorSeparator",{"indicator-separator":!0})))},m6=uL(_E||(_E=fL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),g6=function(e,r){var n=e.isFocused,i=e.size,a=e.theme,o=a.colors,c=a.spacing.baseUnit;return Qe({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},r?{}:{color:n?o.neutral60:o.neutral20,padding:c*2})},wm=function(e){var r=e.delay,n=e.offset;return Ke("span",{css:M1({animation:"".concat(m6," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},v6=function(e){var r=e.innerProps,n=e.isRtl,i=e.size,a=i===void 0?4:i,o=es(e,o6);return Ke("div",Ze({},ir(Qe(Qe({},o),{},{innerProps:r,isRtl:n,size:a}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),Ke(wm,{delay:0,offset:n}),Ke(wm,{delay:160,offset:!0}),Ke(wm,{delay:320,offset:!n}))},x6=function(e,r){var n=e.isDisabled,i=e.isFocused,a=e.theme,o=a.colors,c=a.borderRadius,u=a.spacing;return Qe({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:n?o.neutral5:o.neutral0,borderColor:n?o.neutral10:i?o.primary:o.neutral20,borderRadius:c,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:i?o.primary:o.neutral30}})},_6=function(e){var r=e.children,n=e.isDisabled,i=e.isFocused,a=e.innerRef,o=e.innerProps,c=e.menuIsOpen;return Ke("div",Ze({ref:a},ir(e,"control",{control:!0,"control--is-disabled":n,"control--is-focused":i,"control--menu-is-open":c}),o,{"aria-disabled":n||void 0}),r)},y6=_6,E6=["data"],w6=function(e,r){var n=e.theme.spacing;return r?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},T6=function(e){var r=e.children,n=e.cx,i=e.getStyles,a=e.getClassNames,o=e.Heading,c=e.headingProps,u=e.innerProps,h=e.label,d=e.theme,g=e.selectProps;return Ke("div",Ze({},ir(e,"group",{group:!0}),u),Ke(o,Ze({},c,{selectProps:g,theme:d,getStyles:i,getClassNames:a,cx:n}),h),Ke("div",null,r))},S6=function(e,r){var n=e.theme,i=n.colors,a=n.spacing;return Qe({label:"group",cursor:"default",display:"block"},r?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:a.baseUnit*3,paddingRight:a.baseUnit*3,textTransform:"uppercase"})},k6=function(e){var r=YS(e);r.data;var n=es(r,E6);return Ke("div",Ze({},ir(e,"groupHeading",{"group-heading":!0}),n))},A6=T6,C6=["innerRef","isDisabled","isHidden","inputClassName"],I6=function(e,r){var n=e.isDisabled,i=e.value,a=e.theme,o=a.spacing,c=a.colors;return Qe(Qe({visibility:n?"hidden":"visible",transform:i?"translateZ(0)":""},R6),r?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:c.neutral80})},ak={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},R6={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Qe({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},ak)},P6=function(e){return Qe({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},ak)},F6=function(e){var r=e.cx,n=e.value,i=YS(e),a=i.innerRef,o=i.isDisabled,c=i.isHidden,u=i.inputClassName,h=es(i,C6);return Ke("div",Ze({},ir(e,"input",{"input-container":!0}),{"data-value":n||""}),Ke("input",Ze({className:r({input:!0},u),ref:a,style:P6(c),disabled:o},h)))},b6=F6,O6=function(e,r){var n=e.theme,i=n.spacing,a=n.borderRadius,o=n.colors;return Qe({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:o.neutral10,borderRadius:a/2,margin:i.baseUnit/2})},D6=function(e,r){var n=e.theme,i=n.borderRadius,a=n.colors,o=e.cropWithEllipsis;return Qe({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:i/2,color:a.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},N6=function(e,r){var n=e.theme,i=n.spacing,a=n.borderRadius,o=n.colors,c=e.isFocused;return Qe({alignItems:"center",display:"flex"},r?{}:{borderRadius:a/2,backgroundColor:c?o.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},sk=function(e){var r=e.children,n=e.innerProps;return Ke("div",n,r)},L6=sk,M6=sk;function V6(t){var e=t.children,r=t.innerProps;return Ke("div",Ze({role:"button"},r),e||Ke(j1,{size:14}))}var B6=function(e){var r=e.children,n=e.components,i=e.data,a=e.innerProps,o=e.isDisabled,c=e.removeProps,u=e.selectProps,h=n.Container,d=n.Label,g=n.Remove;return Ke(h,{data:i,innerProps:Qe(Qe({},ir(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),a),selectProps:u},Ke(d,{data:i,innerProps:Qe({},ir(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},r),Ke(g,{data:i,innerProps:Qe(Qe({},ir(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},c),selectProps:u}))},U6=B6,j6=function(e,r){var n=e.isDisabled,i=e.isFocused,a=e.isSelected,o=e.theme,c=o.spacing,u=o.colors;return Qe({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:a?u.primary:i?u.primary25:"transparent",color:n?u.neutral20:a?u.neutral0:"inherit",padding:"".concat(c.baseUnit*2,"px ").concat(c.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:a?u.primary:u.primary50}})},$6=function(e){var r=e.children,n=e.isDisabled,i=e.isFocused,a=e.isSelected,o=e.innerRef,c=e.innerProps;return Ke("div",Ze({},ir(e,"option",{option:!0,"option--is-disabled":n,"option--is-focused":i,"option--is-selected":a}),{ref:o,"aria-disabled":n},c),r)},H6=$6,z6=function(e,r){var n=e.theme,i=n.spacing,a=n.colors;return Qe({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:a.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},W6=function(e){var r=e.children,n=e.innerProps;return Ke("div",Ze({},ir(e,"placeholder",{placeholder:!0}),n),r)},G6=W6,K6=function(e,r){var n=e.isDisabled,i=e.theme,a=i.spacing,o=i.colors;return Qe({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:n?o.neutral40:o.neutral80,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},q6=function(e){var r=e.children,n=e.isDisabled,i=e.innerProps;return Ke("div",Ze({},ir(e,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),i),r)},X6=q6,Y6={ClearIndicator:h6,Control:y6,DropdownIndicator:u6,DownChevron:nk,CrossIcon:j1,Group:A6,GroupHeading:k6,IndicatorsContainer:a6,IndicatorSeparator:p6,Input:b6,LoadingIndicator:v6,Menu:WL,MenuList:KL,MenuPortal:ZL,LoadingMessage:QL,NoOptionsMessage:YL,MultiValue:U6,MultiValueContainer:L6,MultiValueLabel:M6,MultiValueRemove:V6,Option:H6,Placeholder:G6,SelectContainer:t6,SingleValue:X6,ValueContainer:n6},Q6=function(e){return Qe(Qe({},Y6),e.components)},yE=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function J6(t,e){return!!(t===e||yE(t)&&yE(e))}function Z6(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!J6(t[r],e[r]))return!1;return!0}function eM(t,e){e===void 0&&(e=Z6);var r=null;function n(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(r&&r.lastThis===this&&e(i,r.lastArgs))return r.lastResult;var o=t.apply(this,i);return r={lastResult:o,lastArgs:i,lastThis:this},o}return n.clear=function(){r=null},n}var tM={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},rM=function(e){return Ke("span",Ze({css:tM},e))},EE=rM,nM={guidance:function(e){var r=e.isSearchable,n=e.isMulti,i=e.tabSelectsValue,a=e.context,o=e.isInitialFocus;switch(a){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(e["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var r=e.action,n=e.label,i=n===void 0?"":n,a=e.labels,o=e.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(a.length>1?"s":""," ").concat(a.join(","),", selected.");case"select-option":return o?"option ".concat(i," is disabled. Select another option."):"option ".concat(i,", selected.");default:return""}},onFocus:function(e){var r=e.context,n=e.focused,i=e.options,a=e.label,o=a===void 0?"":a,c=e.selectValue,u=e.isDisabled,h=e.isSelected,d=e.isAppleDevice,g=function(_,w){return _&&_.length?"".concat(_.indexOf(w)+1," of ").concat(_.length):""};if(r==="value"&&c)return"value ".concat(o," focused, ").concat(g(c,n),".");if(r==="menu"&&d){var v=u?" disabled":"",y="".concat(h?" selected":"").concat(v);return"".concat(o).concat(y,", ").concat(g(i,n),".")}return""},onFilter:function(e){var r=e.inputValue,n=e.resultsMessage;return"".concat(n).concat(r?" for search term "+r:"",".")}},iM=function(e){var r=e.ariaSelection,n=e.focusedOption,i=e.focusedValue,a=e.focusableOptions,o=e.isFocused,c=e.selectValue,u=e.selectProps,h=e.id,d=e.isAppleDevice,g=u.ariaLiveMessages,v=u.getOptionLabel,y=u.inputValue,E=u.isMulti,_=u.isOptionDisabled,w=u.isSearchable,k=u.menuIsOpen,F=u.options,C=u.screenReaderStatus,B=u.tabSelectsValue,V=u.isLoading,z=u["aria-label"],A=u["aria-live"],R=G.useMemo(function(){return Qe(Qe({},nM),g||{})},[g]),P=G.useMemo(function(){var Ee="";if(r&&R.onChange){var Ce=r.option,Te=r.options,ye=r.removedValue,ie=r.removedValues,ve=r.value,te=function(Se){return Array.isArray(Se)?null:Se},O=ye||Ce||te(ve),re=O?v(O):"",ee=Te||ie||void 0,Z=ee?ee.map(v):[],ce=Qe({isDisabled:O&&_(O,c),label:re,labels:Z},r);Ee=R.onChange(ce)}return Ee},[r,R,_,c,v]),L=G.useMemo(function(){var Ee="",Ce=n||i,Te=!!(n&&c&&c.includes(n));if(Ce&&R.onFocus){var ye={focused:Ce,label:v(Ce),isDisabled:_(Ce,c),isSelected:Te,options:a,context:Ce===n?"menu":"value",selectValue:c,isAppleDevice:d};Ee=R.onFocus(ye)}return Ee},[n,i,v,_,R,a,c,d]),M=G.useMemo(function(){var Ee="";if(k&&F.length&&!V&&R.onFilter){var Ce=C({count:a.length});Ee=R.onFilter({inputValue:y,resultsMessage:Ce})}return Ee},[a,y,k,R,F,C,V]),N=(r==null?void 0:r.action)==="initial-input-focus",U=G.useMemo(function(){var Ee="";if(R.guidance){var Ce=i?"value":k?"menu":"input";Ee=R.guidance({"aria-label":z,context:Ce,isDisabled:n&&_(n,c),isMulti:E,isSearchable:w,tabSelectsValue:B,isInitialFocus:N})}return Ee},[z,n,i,E,_,w,k,R,c,B,N]),be=Ke(G.Fragment,null,Ke("span",{id:"aria-selection"},P),Ke("span",{id:"aria-focused"},L),Ke("span",{id:"aria-results"},M),Ke("span",{id:"aria-guidance"},U));return Ke(G.Fragment,null,Ke(EE,{id:h},N&&be),Ke(EE,{"aria-live":A,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!N&&be))},aM=iM,xg=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],sM=new RegExp("["+xg.map(function(t){return t.letters}).join("")+"]","g"),ok={};for(var Tm=0;Tm<xg.length;Tm++)for(var Sm=xg[Tm],km=0;km<Sm.letters.length;km++)ok[Sm.letters[km]]=Sm.base;var lk=function(e){return e.replace(sM,function(r){return ok[r]})},oM=eM(lk),wE=function(e){return e.replace(/^\s+|\s+$/g,"")},lM=function(e){return"".concat(e.label," ").concat(e.value)},cM=function(e){return function(r,n){if(r.data.__isNew__)return!0;var i=Qe({ignoreCase:!0,ignoreAccents:!0,stringify:lM,trim:!0,matchFrom:"any"},e),a=i.ignoreCase,o=i.ignoreAccents,c=i.stringify,u=i.trim,h=i.matchFrom,d=u?wE(n):n,g=u?wE(c(r)):c(r);return a&&(d=d.toLowerCase(),g=g.toLowerCase()),o&&(d=oM(d),g=lk(g)),h==="start"?g.substr(0,d.length)===d:g.indexOf(d)>-1}},uM=["innerRef"];function fM(t){var e=t.innerRef,r=es(t,uM),n=ML(r,"onExited","in","enter","exit","appear");return Ke("input",Ze({ref:e},n,{css:M1({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var hM=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function dM(t){var e=t.isEnabled,r=t.onBottomArrive,n=t.onBottomLeave,i=t.onTopArrive,a=t.onTopLeave,o=G.useRef(!1),c=G.useRef(!1),u=G.useRef(0),h=G.useRef(null),d=G.useCallback(function(w,k){if(h.current!==null){var F=h.current,C=F.scrollTop,B=F.scrollHeight,V=F.clientHeight,z=h.current,A=k>0,R=B-V-C,P=!1;R>k&&o.current&&(n&&n(w),o.current=!1),A&&c.current&&(a&&a(w),c.current=!1),A&&k>R?(r&&!o.current&&r(w),z.scrollTop=B,P=!0,o.current=!0):!A&&-k>C&&(i&&!c.current&&i(w),z.scrollTop=0,P=!0,c.current=!0),P&&hM(w)}},[r,n,i,a]),g=G.useCallback(function(w){d(w,w.deltaY)},[d]),v=G.useCallback(function(w){u.current=w.changedTouches[0].clientY},[]),y=G.useCallback(function(w){var k=u.current-w.changedTouches[0].clientY;d(w,k)},[d]),E=G.useCallback(function(w){if(w){var k=DL?{passive:!1}:!1;w.addEventListener("wheel",g,k),w.addEventListener("touchstart",v,k),w.addEventListener("touchmove",y,k)}},[y,v,g]),_=G.useCallback(function(w){w&&(w.removeEventListener("wheel",g,!1),w.removeEventListener("touchstart",v,!1),w.removeEventListener("touchmove",y,!1))},[y,v,g]);return G.useEffect(function(){if(e){var w=h.current;return E(w),function(){_(w)}}},[e,E,_]),function(w){h.current=w}}var TE=["boxSizing","height","overflow","paddingRight","position"],SE={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function kE(t){t.cancelable&&t.preventDefault()}function AE(t){t.stopPropagation()}function CE(){var t=this.scrollTop,e=this.scrollHeight,r=t+this.offsetHeight;t===0?this.scrollTop=1:r===e&&(this.scrollTop=t-1)}function IE(){return"ontouchstart"in window||navigator.maxTouchPoints}var RE=!!(typeof window<"u"&&window.document&&window.document.createElement),iu=0,Dl={capture:!1,passive:!1};function pM(t){var e=t.isEnabled,r=t.accountForScrollbars,n=r===void 0?!0:r,i=G.useRef({}),a=G.useRef(null),o=G.useCallback(function(u){if(RE){var h=document.body,d=h&&h.style;if(n&&TE.forEach(function(E){var _=d&&d[E];i.current[E]=_}),n&&iu<1){var g=parseInt(i.current.paddingRight,10)||0,v=document.body?document.body.clientWidth:0,y=window.innerWidth-v+g||0;Object.keys(SE).forEach(function(E){var _=SE[E];d&&(d[E]=_)}),d&&(d.paddingRight="".concat(y,"px"))}h&&IE()&&(h.addEventListener("touchmove",kE,Dl),u&&(u.addEventListener("touchstart",CE,Dl),u.addEventListener("touchmove",AE,Dl))),iu+=1}},[n]),c=G.useCallback(function(u){if(RE){var h=document.body,d=h&&h.style;iu=Math.max(iu-1,0),n&&iu<1&&TE.forEach(function(g){var v=i.current[g];d&&(d[g]=v)}),h&&IE()&&(h.removeEventListener("touchmove",kE,Dl),u&&(u.removeEventListener("touchstart",CE,Dl),u.removeEventListener("touchmove",AE,Dl)))}},[n]);return G.useEffect(function(){if(e){var u=a.current;return o(u),function(){c(u)}}},[e,o,c]),function(u){a.current=u}}var mM=function(e){var r=e.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},gM={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function vM(t){var e=t.children,r=t.lockEnabled,n=t.captureEnabled,i=n===void 0?!0:n,a=t.onBottomArrive,o=t.onBottomLeave,c=t.onTopArrive,u=t.onTopLeave,h=dM({isEnabled:i,onBottomArrive:a,onBottomLeave:o,onTopArrive:c,onTopLeave:u}),d=pM({isEnabled:r}),g=function(y){h(y),d(y)};return Ke(G.Fragment,null,r&&Ke("div",{onClick:mM,css:gM}),e(g))}var xM={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},_M=function(e){var r=e.name,n=e.onFocus;return Ke("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:xM,value:"",onChange:function(){}})},yM=_M;function $1(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function EM(){return $1(/^iPhone/i)}function ck(){return $1(/^Mac/i)}function wM(){return $1(/^iPad/i)||ck()&&navigator.maxTouchPoints>1}function TM(){return EM()||wM()}function SM(){return ck()||TM()}var kM=function(e){return e.label},AM=function(e){return e.label},CM=function(e){return e.value},IM=function(e){return!!e.isDisabled},RM={clearIndicator:f6,container:e6,control:x6,dropdownIndicator:c6,group:w6,groupHeading:S6,indicatorsContainer:i6,indicatorSeparator:d6,input:I6,loadingIndicator:g6,loadingMessage:XL,menu:$L,menuList:GL,menuPortal:JL,multiValue:O6,multiValueLabel:D6,multiValueRemove:N6,noOptionsMessage:qL,option:j6,placeholder:z6,singleValue:K6,valueContainer:r6},PM={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},FM=4,uk=4,bM=38,OM=uk*2,DM={baseUnit:uk,controlHeight:bM,menuGutter:OM},Am={borderRadius:FM,colors:PM,spacing:DM},NM={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:xE(),captureMenuScroll:!xE(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:cM(),formatGroupLabel:kM,getOptionLabel:AM,getOptionValue:CM,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:IM,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!bL(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var r=e.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function PE(t,e,r,n){var i=dk(t,e,r),a=pk(t,e,r),o=hk(t,e),c=L0(t,e);return{type:"option",data:e,isDisabled:i,isSelected:a,label:o,value:c,index:n}}function u0(t,e){return t.options.map(function(r,n){if("options"in r){var i=r.options.map(function(o,c){return PE(t,o,e,c)}).filter(function(o){return bE(t,o)});return i.length>0?{type:"group",data:r,options:i,index:n}:void 0}var a=PE(t,r,e,n);return bE(t,a)?a:void 0}).filter(NL)}function fk(t){return t.reduce(function(e,r){return r.type==="group"?e.push.apply(e,b1(r.options.map(function(n){return n.data}))):e.push(r.data),e},[])}function FE(t,e){return t.reduce(function(r,n){return n.type==="group"?r.push.apply(r,b1(n.options.map(function(i){return{data:i.data,id:"".concat(e,"-").concat(n.index,"-").concat(i.index)}}))):r.push({data:n.data,id:"".concat(e,"-").concat(n.index)}),r},[])}function LM(t,e){return fk(u0(t,e))}function bE(t,e){var r=t.inputValue,n=r===void 0?"":r,i=e.data,a=e.isSelected,o=e.label,c=e.value;return(!gk(t)||!a)&&mk(t,{label:o,value:c,data:i},n)}function MM(t,e){var r=t.focusedValue,n=t.selectValue,i=n.indexOf(r);if(i>-1){var a=e.indexOf(r);if(a>-1)return r;if(i<e.length)return e[i]}return null}function VM(t,e){var r=t.focusedOption;return r&&e.indexOf(r)>-1?r:e[0]}var Cm=function(e,r){var n,i=(n=e.find(function(a){return a.data===r}))===null||n===void 0?void 0:n.id;return i||null},hk=function(e,r){return e.getOptionLabel(r)},L0=function(e,r){return e.getOptionValue(r)};function dk(t,e,r){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(e,r):!1}function pk(t,e,r){if(r.indexOf(e)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(e,r);var n=L0(t,e);return r.some(function(i){return L0(t,i)===n})}function mk(t,e,r){return t.filterOption?t.filterOption(e,r):!0}var gk=function(e){var r=e.hideSelectedOptions,n=e.isMulti;return r===void 0?n:r},BM=1,vk=function(t){aN(r,t);var e=lN(r);function r(n){var i;if(nN(this,r),i=e.call(this,n),i.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.isAppleDevice=SM(),i.controlRef=null,i.getControlRef=function(u){i.controlRef=u},i.focusedOptionRef=null,i.getFocusedOptionRef=function(u){i.focusedOptionRef=u},i.menuListRef=null,i.getMenuListRef=function(u){i.menuListRef=u},i.inputRef=null,i.getInputRef=function(u){i.inputRef=u},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(u,h){var d=i.props,g=d.onChange,v=d.name;h.name=v,i.ariaOnChange(u,h),g(u,h)},i.setValue=function(u,h,d){var g=i.props,v=g.closeMenuOnSelect,y=g.isMulti,E=g.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:E}),v&&(i.setState({inputIsHiddenAfterUpdate:!y}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(u,{action:h,option:d})},i.selectOption=function(u){var h=i.props,d=h.blurInputOnSelect,g=h.isMulti,v=h.name,y=i.state.selectValue,E=g&&i.isOptionSelected(u,y),_=i.isOptionDisabled(u,y);if(E){var w=i.getOptionValue(u);i.setValue(y.filter(function(k){return i.getOptionValue(k)!==w}),"deselect-option",u)}else if(!_)g?i.setValue([].concat(b1(y),[u]),"select-option",u):i.setValue(u,"select-option");else{i.ariaOnChange(u,{action:"select-option",option:u,name:v});return}d&&i.blurInput()},i.removeValue=function(u){var h=i.props.isMulti,d=i.state.selectValue,g=i.getOptionValue(u),v=d.filter(function(E){return i.getOptionValue(E)!==g}),y=Bh(h,v,v[0]||null);i.onChange(y,{action:"remove-value",removedValue:u}),i.focusInput()},i.clearValue=function(){var u=i.state.selectValue;i.onChange(Bh(i.props.isMulti,[],null),{action:"clear",removedValues:u})},i.popValue=function(){var u=i.props.isMulti,h=i.state.selectValue,d=h[h.length-1],g=h.slice(0,h.length-1),v=Bh(u,g,g[0]||null);d&&i.onChange(v,{action:"pop-value",removedValue:d})},i.getFocusedOptionId=function(u){return Cm(i.state.focusableOptionsWithIds,u)},i.getFocusableOptionsWithIds=function(){return FE(u0(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return CL.apply(void 0,[i.props.classNamePrefix].concat(h))},i.getOptionLabel=function(u){return hk(i.props,u)},i.getOptionValue=function(u){return L0(i.props,u)},i.getStyles=function(u,h){var d=i.props.unstyled,g=RM[u](h,d);g.boxSizing="border-box";var v=i.props.styles[u];return v?v(g,h):g},i.getClassNames=function(u,h){var d,g;return(d=(g=i.props.classNames)[u])===null||d===void 0?void 0:d.call(g,h)},i.getElementId=function(u){return"".concat(i.state.instancePrefix,"-").concat(u)},i.getComponents=function(){return Q6(i.props)},i.buildCategorizedOptions=function(){return u0(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return fk(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(u,h){i.setState({ariaSelection:Qe({value:u},h)})},i.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(u){i.blockOptionHover=!1},i.onControlMouseDown=function(u){if(!u.defaultPrevented){var h=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&i.onMenuClose():h&&i.openMenu("first"):(h&&(i.openAfterFocus=!0),i.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},i.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!i.props.isDisabled){var h=i.props,d=h.isMulti,g=h.menuIsOpen;i.focusInput(),g?(i.setState({inputIsHiddenAfterUpdate:!d}),i.onMenuClose()):i.openMenu("first"),u.preventDefault()}},i.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(i.clearValue(),u.preventDefault(),i.openAfterFocus=!1,u.type==="touchend"?i.focusInput():setTimeout(function(){return i.focusInput()}))},i.onScroll=function(u){typeof i.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&kd(u.target)&&i.props.onMenuClose():typeof i.props.closeMenuOnScroll=="function"&&i.props.closeMenuOnScroll(u)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(u){var h=u.touches,d=h&&h.item(0);d&&(i.initialTouchX=d.clientX,i.initialTouchY=d.clientY,i.userIsDragging=!1)},i.onTouchMove=function(u){var h=u.touches,d=h&&h.item(0);if(d){var g=Math.abs(d.clientX-i.initialTouchX),v=Math.abs(d.clientY-i.initialTouchY),y=5;i.userIsDragging=g>y||v>y}},i.onTouchEnd=function(u){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(u.target)&&i.menuListRef&&!i.menuListRef.contains(u.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(u){i.userIsDragging||i.onControlMouseDown(u)},i.onClearIndicatorTouchEnd=function(u){i.userIsDragging||i.onClearIndicatorMouseDown(u)},i.onDropdownIndicatorTouchEnd=function(u){i.userIsDragging||i.onDropdownIndicatorMouseDown(u)},i.handleInputChange=function(u){var h=i.props.inputValue,d=u.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(d,{action:"input-change",prevInputValue:h}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(u){i.props.onFocus&&i.props.onFocus(u),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(u){var h=i.props.inputValue;if(i.menuListRef&&i.menuListRef.contains(document.activeElement)){i.inputRef.focus();return}i.props.onBlur&&i.props.onBlur(u),i.onInputChange("",{action:"input-blur",prevInputValue:h}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1})},i.onOptionHover=function(u){if(!(i.blockOptionHover||i.state.focusedOption===u)){var h=i.getFocusableOptions(),d=h.indexOf(u);i.setState({focusedOption:u,focusedOptionId:d>-1?i.getFocusedOptionId(u):null})}},i.shouldHideSelectedOptions=function(){return gk(i.props)},i.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),i.focus()},i.onKeyDown=function(u){var h=i.props,d=h.isMulti,g=h.backspaceRemovesValue,v=h.escapeClearsValue,y=h.inputValue,E=h.isClearable,_=h.isDisabled,w=h.menuIsOpen,k=h.onKeyDown,F=h.tabSelectsValue,C=h.openMenuOnFocus,B=i.state,V=B.focusedOption,z=B.focusedValue,A=B.selectValue;if(!_&&!(typeof k=="function"&&(k(u),u.defaultPrevented))){switch(i.blockOptionHover=!0,u.key){case"ArrowLeft":if(!d||y)return;i.focusValue("previous");break;case"ArrowRight":if(!d||y)return;i.focusValue("next");break;case"Delete":case"Backspace":if(y)return;if(z)i.removeValue(z);else{if(!g)return;d?i.popValue():E&&i.clearValue()}break;case"Tab":if(i.isComposing||u.shiftKey||!w||!F||!V||C&&i.isOptionSelected(V,A))return;i.selectOption(V);break;case"Enter":if(u.keyCode===229)break;if(w){if(!V||i.isComposing)return;i.selectOption(V);break}return;case"Escape":w?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:y}),i.onMenuClose()):E&&v&&i.clearValue();break;case" ":if(y)return;if(!w){i.openMenu("first");break}if(!V)return;i.selectOption(V);break;case"ArrowUp":w?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":w?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!w)return;i.focusOption("pageup");break;case"PageDown":if(!w)return;i.focusOption("pagedown");break;case"Home":if(!w)return;i.focusOption("first");break;case"End":if(!w)return;i.focusOption("last");break;default:return}u.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++BM),i.state.selectValue=gE(n.value),n.menuIsOpen&&i.state.selectValue.length){var a=i.getFocusableOptionsWithIds(),o=i.buildFocusableOptions(),c=o.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=a,i.state.focusedOption=o[c],i.state.focusedOptionId=Cm(a,o[c])}return i}return iN(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&vE(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(i){var a=this.props,o=a.isDisabled,c=a.menuIsOpen,u=this.state.isFocused;(u&&!o&&i.isDisabled||u&&c&&!i.menuIsOpen)&&this.focusInput(),u&&o&&!i.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!o&&i.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(vE(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(i,a){this.props.onInputChange(i,a)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(i){var a=this,o=this.state,c=o.selectValue,u=o.isFocused,h=this.buildFocusableOptions(),d=i==="first"?0:h.length-1;if(!this.props.isMulti){var g=h.indexOf(c[0]);g>-1&&(d=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:h[d],focusedOptionId:this.getFocusedOptionId(h[d])},function(){return a.onMenuOpen()})}},{key:"focusValue",value:function(i){var a=this.state,o=a.selectValue,c=a.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=o.indexOf(c);c||(u=-1);var h=o.length-1,d=-1;if(o.length){switch(i){case"previous":u===0?d=0:u===-1?d=h:d=u-1;break;case"next":u>-1&&u<h&&(d=u+1);break}this.setState({inputIsHidden:d!==-1,focusedValue:o[d]})}}}},{key:"focusOption",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",a=this.props.pageSize,o=this.state.focusedOption,c=this.getFocusableOptions();if(c.length){var u=0,h=c.indexOf(o);o||(h=-1),i==="up"?u=h>0?h-1:c.length-1:i==="down"?u=(h+1)%c.length:i==="pageup"?(u=h-a,u<0&&(u=0)):i==="pagedown"?(u=h+a,u>c.length-1&&(u=c.length-1)):i==="last"&&(u=c.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:c[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(c[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Am):Qe(Qe({},Am),this.props.theme):Am}},{key:"getCommonProps",value:function(){var i=this.clearValue,a=this.cx,o=this.getStyles,c=this.getClassNames,u=this.getValue,h=this.selectOption,d=this.setValue,g=this.props,v=g.isMulti,y=g.isRtl,E=g.options,_=this.hasValue();return{clearValue:i,cx:a,getStyles:o,getClassNames:c,getValue:u,hasValue:_,isMulti:v,isRtl:y,options:E,selectOption:h,selectProps:g,setValue:d,theme:this.getTheme()}}},{key:"hasValue",value:function(){var i=this.state.selectValue;return i.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var i=this.props,a=i.isClearable,o=i.isMulti;return a===void 0?o:a}},{key:"isOptionDisabled",value:function(i,a){return dk(this.props,i,a)}},{key:"isOptionSelected",value:function(i,a){return pk(this.props,i,a)}},{key:"filterOption",value:function(i,a){return mk(this.props,i,a)}},{key:"formatOptionLabel",value:function(i,a){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,c=this.state.selectValue;return this.props.formatOptionLabel(i,{context:a,inputValue:o,selectValue:c})}else return this.getOptionLabel(i)}},{key:"formatGroupLabel",value:function(i){return this.props.formatGroupLabel(i)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var i=this.props,a=i.isDisabled,o=i.isSearchable,c=i.inputId,u=i.inputValue,h=i.tabIndex,d=i.form,g=i.menuIsOpen,v=i.required,y=this.getComponents(),E=y.Input,_=this.state,w=_.inputIsHidden,k=_.ariaSelection,F=this.commonProps,C=c||this.getElementId("input"),B=Qe(Qe(Qe({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":v,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(k==null?void 0:k.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?G.createElement(E,Ze({},F,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:C,innerRef:this.getInputRef,isDisabled:a,isHidden:w,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:h,form:d,type:"text",value:u},B)):G.createElement(fM,Ze({id:C,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:D0,onFocus:this.onInputFocus,disabled:a,tabIndex:h,inputMode:"none",form:d,value:""},B))}},{key:"renderPlaceholderOrValue",value:function(){var i=this,a=this.getComponents(),o=a.MultiValue,c=a.MultiValueContainer,u=a.MultiValueLabel,h=a.MultiValueRemove,d=a.SingleValue,g=a.Placeholder,v=this.commonProps,y=this.props,E=y.controlShouldRenderValue,_=y.isDisabled,w=y.isMulti,k=y.inputValue,F=y.placeholder,C=this.state,B=C.selectValue,V=C.focusedValue,z=C.isFocused;if(!this.hasValue()||!E)return k?null:G.createElement(g,Ze({},v,{key:"placeholder",isDisabled:_,isFocused:z,innerProps:{id:this.getElementId("placeholder")}}),F);if(w)return B.map(function(R,P){var L=R===V,M="".concat(i.getOptionLabel(R),"-").concat(i.getOptionValue(R));return G.createElement(o,Ze({},v,{components:{Container:c,Label:u,Remove:h},isFocused:L,isDisabled:_,key:M,index:P,removeProps:{onClick:function(){return i.removeValue(R)},onTouchEnd:function(){return i.removeValue(R)},onMouseDown:function(U){U.preventDefault()}},data:R}),i.formatOptionLabel(R,"value"))});if(k)return null;var A=B[0];return G.createElement(d,Ze({},v,{data:A,isDisabled:_}),this.formatOptionLabel(A,"value"))}},{key:"renderClearIndicator",value:function(){var i=this.getComponents(),a=i.ClearIndicator,o=this.commonProps,c=this.props,u=c.isDisabled,h=c.isLoading,d=this.state.isFocused;if(!this.isClearable()||!a||u||!this.hasValue()||h)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:g,isFocused:d}))}},{key:"renderLoadingIndicator",value:function(){var i=this.getComponents(),a=i.LoadingIndicator,o=this.commonProps,c=this.props,u=c.isDisabled,h=c.isLoading,d=this.state.isFocused;if(!a||!h)return null;var g={"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:g,isDisabled:u,isFocused:d}))}},{key:"renderIndicatorSeparator",value:function(){var i=this.getComponents(),a=i.DropdownIndicator,o=i.IndicatorSeparator;if(!a||!o)return null;var c=this.commonProps,u=this.props.isDisabled,h=this.state.isFocused;return G.createElement(o,Ze({},c,{isDisabled:u,isFocused:h}))}},{key:"renderDropdownIndicator",value:function(){var i=this.getComponents(),a=i.DropdownIndicator;if(!a)return null;var o=this.commonProps,c=this.props.isDisabled,u=this.state.isFocused,h={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:h,isDisabled:c,isFocused:u}))}},{key:"renderMenu",value:function(){var i=this,a=this.getComponents(),o=a.Group,c=a.GroupHeading,u=a.Menu,h=a.MenuList,d=a.MenuPortal,g=a.LoadingMessage,v=a.NoOptionsMessage,y=a.Option,E=this.commonProps,_=this.state.focusedOption,w=this.props,k=w.captureMenuScroll,F=w.inputValue,C=w.isLoading,B=w.loadingMessage,V=w.minMenuHeight,z=w.maxMenuHeight,A=w.menuIsOpen,R=w.menuPlacement,P=w.menuPosition,L=w.menuPortalTarget,M=w.menuShouldBlockScroll,N=w.menuShouldScrollIntoView,U=w.noOptionsMessage,be=w.onMenuScrollToTop,Ee=w.onMenuScrollToBottom;if(!A)return null;var Ce=function(re,ee){var Z=re.type,ce=re.data,_e=re.isDisabled,Se=re.isSelected,we=re.label,xe=re.value,Je=_===ce,Y=_e?void 0:function(){return i.onOptionHover(ce)},kt=_e?void 0:function(){return i.selectOption(ce)},ct="".concat(i.getElementId("option"),"-").concat(ee),dt={id:ct,onClick:kt,onMouseMove:Y,onMouseOver:Y,tabIndex:-1,role:"option","aria-selected":i.isAppleDevice?void 0:Se};return G.createElement(y,Ze({},E,{innerProps:dt,data:ce,isDisabled:_e,isSelected:Se,key:ct,label:we,type:Z,value:xe,isFocused:Je,innerRef:Je?i.getFocusedOptionRef:void 0}),i.formatOptionLabel(re.data,"menu"))},Te;if(this.hasOptions())Te=this.getCategorizedOptions().map(function(O){if(O.type==="group"){var re=O.data,ee=O.options,Z=O.index,ce="".concat(i.getElementId("group"),"-").concat(Z),_e="".concat(ce,"-heading");return G.createElement(o,Ze({},E,{key:ce,data:re,options:ee,Heading:c,headingProps:{id:_e,data:O.data},label:i.formatGroupLabel(O.data)}),O.options.map(function(Se){return Ce(Se,"".concat(Z,"-").concat(Se.index))}))}else if(O.type==="option")return Ce(O,"".concat(O.index))});else if(C){var ye=B({inputValue:F});if(ye===null)return null;Te=G.createElement(g,E,ye)}else{var ie=U({inputValue:F});if(ie===null)return null;Te=G.createElement(v,E,ie)}var ve={minMenuHeight:V,maxMenuHeight:z,menuPlacement:R,menuPosition:P,menuShouldScrollIntoView:N},te=G.createElement(HL,Ze({},E,ve),function(O){var re=O.ref,ee=O.placerProps,Z=ee.placement,ce=ee.maxHeight;return G.createElement(u,Ze({},E,ve,{innerRef:re,innerProps:{onMouseDown:i.onMenuMouseDown,onMouseMove:i.onMenuMouseMove},isLoading:C,placement:Z}),G.createElement(vM,{captureEnabled:k,onTopArrive:be,onBottomArrive:Ee,lockEnabled:M},function(_e){return G.createElement(h,Ze({},E,{innerRef:function(we){i.getMenuListRef(we),_e(we)},innerProps:{role:"listbox","aria-multiselectable":E.isMulti,id:i.getElementId("listbox")},isLoading:C,maxHeight:ce,focusedOption:_}),Te)}))});return L||P==="fixed"?G.createElement(d,Ze({},E,{appendTo:L,controlElement:this.controlRef,menuPlacement:R,menuPosition:P}),te):te}},{key:"renderFormField",value:function(){var i=this,a=this.props,o=a.delimiter,c=a.isDisabled,u=a.isMulti,h=a.name,d=a.required,g=this.state.selectValue;if(d&&!this.hasValue()&&!c)return G.createElement(yM,{name:h,onFocus:this.onValueInputFocus});if(!(!h||c))if(u)if(o){var v=g.map(function(_){return i.getOptionValue(_)}).join(o);return G.createElement("input",{name:h,type:"hidden",value:v})}else{var y=g.length>0?g.map(function(_,w){return G.createElement("input",{key:"i-".concat(w),name:h,type:"hidden",value:i.getOptionValue(_)})}):G.createElement("input",{name:h,type:"hidden",value:""});return G.createElement("div",null,y)}else{var E=g[0]?this.getOptionValue(g[0]):"";return G.createElement("input",{name:h,type:"hidden",value:E})}}},{key:"renderLiveRegion",value:function(){var i=this.commonProps,a=this.state,o=a.ariaSelection,c=a.focusedOption,u=a.focusedValue,h=a.isFocused,d=a.selectValue,g=this.getFocusableOptions();return G.createElement(aM,Ze({},i,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:c,focusedValue:u,isFocused:h,selectValue:d,focusableOptions:g,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var i=this.getComponents(),a=i.Control,o=i.IndicatorsContainer,c=i.SelectContainer,u=i.ValueContainer,h=this.props,d=h.className,g=h.id,v=h.isDisabled,y=h.menuIsOpen,E=this.state.isFocused,_=this.commonProps=this.getCommonProps();return G.createElement(c,Ze({},_,{className:d,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:v,isFocused:E}),this.renderLiveRegion(),G.createElement(a,Ze({},_,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:v,isFocused:E,menuIsOpen:y}),G.createElement(u,Ze({},_,{isDisabled:v}),this.renderPlaceholderOrValue(),this.renderInput()),G.createElement(o,Ze({},_,{isDisabled:v}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(i,a){var o=a.prevProps,c=a.clearFocusValueOnUpdate,u=a.inputIsHiddenAfterUpdate,h=a.ariaSelection,d=a.isFocused,g=a.prevWasFocused,v=a.instancePrefix,y=i.options,E=i.value,_=i.menuIsOpen,w=i.inputValue,k=i.isMulti,F=gE(E),C={};if(o&&(E!==o.value||y!==o.options||_!==o.menuIsOpen||w!==o.inputValue)){var B=_?LM(i,F):[],V=_?FE(u0(i,F),"".concat(v,"-option")):[],z=c?MM(a,F):null,A=VM(a,B),R=Cm(V,A);C={selectValue:F,focusedOption:A,focusedOptionId:R,focusableOptionsWithIds:V,focusedValue:z,clearFocusValueOnUpdate:!1}}var P=u!=null&&i!==o?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},L=h,M=d&&g;return d&&!M&&(L={value:Bh(k,F,F[0]||null),options:F,action:"initial-input-focus"},M=!g),(h==null?void 0:h.action)==="initial-input-focus"&&(L=null),Qe(Qe(Qe({},C),P),{},{prevProps:i,ariaSelection:L,prevWasFocused:M})}}]),r}(G.Component);vk.defaultProps=NM;var UM=G.forwardRef(function(t,e){var r=rN(t);return G.createElement(vk,Ze({ref:e},r))}),jM=UM;const xk=({options:t,onChange:e,placeholder:r,isMulti:n=!1,defaultValue:i,label:a,value:o})=>Q.jsxs("div",{className:"select-input",children:[a&&Q.jsx("label",{children:a}),Q.jsx(jM,{value:t.find(c=>c.value===o),options:t,onChange:e,placeholder:r,isMulti:n,defaultValue:i,className:"select-input",classNamePrefix:"react-select"})]}),$M=()=>{const[t,e]=G.useState([]),[r,n]=G.useState(!0),[i,a]=G.useState(null),o=async()=>{try{n(!0);const h=await PS();return e(h),h}catch{return a("Error fetching teachers"),[]}finally{n(!1)}};return G.useEffect(()=>{o()},[]),{teachers:t,loadTeachers:o,loading:r,error:i,handleAddTeacher:async h=>{try{await K3(h),o()}catch{a("Error adding teacher")}},handleDeleteTeacher:async h=>{try{await q3(h),o()}catch{a("Error deleting teacher")}}}},HM=({isEditing:t,fields:e,initialData:r,onItemAdded:n,onItemUpdated:i,onCancelEdit:a,clearFormAfterAdd:o=!1})=>{const[c,u]=G.useState({});G.useEffect(()=>{r&&u(r)},[r]);const h=_=>{const{name:w,value:k}=_.target;u({...c,[w]:k})},d=({name:_,value:w})=>{u({...c,[_]:w})},g=()=>u({}),v=async _=>{_.preventDefault(),r&&t?await(i==null?void 0:i(c)):await n(c),o&&g()},y=()=>{g(),a&&a()},E=_=>{const w={key:_.name,name:_.name,placeholder:_.placeholder,value:c[_.name]||"",required:!0,onChange:k=>{const F=k.target.value;h(k),_.onChange&&_.onChange(F)}};switch(_.type){case"select":return _.options&&Q.jsx(xk,{options:_.options,label:_.label,...w,onChange:k=>{const F=k.value;_.onChange?_.onChange(F):d({name:_.name,value:F})}});case"number":return Q.jsx("input",{type:"number",min:"0",max:c[`${_.name}Max`]||100,...w});case"date":return Q.jsx("input",{type:"date",...w});case"input":default:return Q.jsx("input",{type:"text",...w})}};return Q.jsxs("form",{onSubmit:v,className:t?"editing":"",children:[e.map(E),Q.jsxs("div",{className:"buttons-container",children:[Q.jsx("button",{className:"save-button",type:"submit",children:t?"Save":"Add"}),t&&Q.jsx("button",{className:"cancel-button",type:"button",onClick:y,children:"Cancel"})]})]})},zM=({fields:t,sortConfig:e,handleSort:r,showActions:n})=>Q.jsx("table",{className:`list-base-table header-table ${n?"with-actions":""}`,"aria-label":"List header",children:Q.jsx("thead",{children:Q.jsx("tr",{children:t.map(i=>i.view&&Q.jsxs("th",{onClick:()=>r(i.name),children:[i.label||i.placeholder||i.name,(e==null?void 0:e.key)===i.name&&Q.jsx("span",{children:e.direction==="ascending"?" ":" "})]},i.name))})})}),WM=({fields:t,items:e,selectedItem:r,tempChanges:n,handlers:i})=>{const{handleRowClick:a,setTempChanges:o}=i||{},c=(d,g,v)=>{const y=parseFloat(v);isNaN(y)||o(E=>({...E,[d]:{...E[d],[g]:y}}))},u=(d,g)=>{var y;const v=(y=n[d])==null?void 0:y[g];v!==void 0&&!isNaN(v)&&console.log(`Validated value for ${d}.${g}: ${v}`)},h=(d,g)=>{var y,E;if(!g.view)return null;const v=d[g.name];switch(g.type){case"select":const _=(y=g.options)==null?void 0:y.find(w=>w.value===v);return _?_.label:"Unknown";case"number":return Q.jsx("input",{type:"number",name:g.name,min:0,step:.5,max:d[`${g.name}Max`],value:((E=n[d.id])==null?void 0:E[g.name])??v,onChange:w=>c(d.id,g.name,w.target.value),onBlur:()=>u(d.id,g.name),onClick:w=>w.stopPropagation()});default:return v!==void 0?v:"N/A"}};return Q.jsx("div",{className:"table-body-container",children:Q.jsx("table",{className:"list-base-table body-table","aria-label":"List of items",children:Q.jsx("tbody",{children:e.map(d=>Q.jsx("tr",{onClick:()=>a==null?void 0:a(d),className:(r==null?void 0:r.id)===d.id?"selected-row":"","aria-selected":(r==null?void 0:r.id)===d.id,children:t.map(g=>Q.jsx("td",{children:h(d,g)},g.name))},d.id))})})})},GM=({hasPendingChanges:t,config:e,handlers:r})=>{const{ableForm:n,ableImport:i,seeable:a,removeable:o,showForm:c,showImportForm:u,selectedItem:h,viewLinks:d,tempChanges:g}=e,{handleShowForm:v,handleShowImportForm:y,onItemDeleted:E,onSaveAllChanges:_}=r,w=(k,F)=>{console.log("ActionButtons",F),_&&_(k,F)};return Q.jsxs("div",{className:"actions buttons-container compact",children:[n&&Q.jsx("button",{className:c?"add-button":"edit-button",onClick:()=>v(c),"aria-expanded":c,"aria-label":c?"Hide the form":"Show the form",children:c?"Hide Form":"Add"}),n&&i&&!u&&Q.jsx("button",{onClick:()=>y(u),"aria-expanded":u,"aria-label":u?"Add a new item":"Hide the form",children:"Import"}),a&&d&&d.map((k,F)=>Q.jsx($o,{to:h?k.format.replace(":id",h.id):"#",className:`button view-button ${k.class||""} ${h?"":"disabled-link"}`,"aria-label":`View ${k.label}`,onClick:C=>!h&&C.preventDefault(),children:k.label},F)),o&&E&&Q.jsx("button",{disabled:!h,className:"delete-button",onClick:()=>(h==null?void 0:h.id)&&E(h.id),"aria-label":"Delete selected item",children:"Delete"}),t&&Q.jsx("button",{onClick:k=>w(k,g),className:"save-all-button","aria-label":"Save all changes",children:"Save All Changes"})]})},KM=({currentPage:t,totalPages:e,onPageChange:r})=>e<=1?null:Q.jsx("div",{className:"pagination",children:Array.from({length:e},(n,i)=>i+1).map(n=>Q.jsx("button",{onClick:()=>r(n),className:t===n?"active":"",children:n},n))}),OE=t=>{const[e,r]=G.useState(t);return G.useEffect(()=>{r(t)},[t]),[e,r]},qM=t=>{const[e,r]=G.useState(null),n=a=>{let o="ascending";e&&e.key===a&&e.direction==="ascending"&&(o="descending"),r({key:a,direction:o})},i=G.useMemo(()=>e===null?t:[...t].sort((a,o)=>a[e.key]<o[e.key]?e.direction==="ascending"?-1:1:a[e.key]>o[e.key]?e.direction==="ascending"?1:-1:0),[t,e]);return{sortConfig:e,handleSort:n,sortedItems:i}},XM=t=>{const[e,r]=G.useState(""),n=G.useMemo(()=>e?t.filter(i=>Object.values(i).some(a=>a.toString().toLowerCase().includes(e.toLowerCase()))):t,[t,e]);return{filterText:e,setFilterText:r,filteredItems:n}},YM=(t,e)=>{const[r,n]=G.useState(1),i=G.useMemo(()=>{const c=(r-1)*e;return t.slice(c,c+e)},[t,r,e]),a=Math.ceil(t.length/e);return{currentPage:r,paginatedItems:i,totalPages:a,handlePageChange:c=>{n(c)}}},QM=({loading:t=!1,...e})=>{const{fields:r,items:n,ableFilter:i=!1,ableForm:a,ableImport:o,removeable:c,seeable:u,viewLinks:h,onAdd:d,onImport:g,onSelect:v,onItemDeleted:y,onItemsUpdated:E,tempChanges:_,setTempChanges:w,selectedItem:k,showForm:F=!1,showImportForm:C=!1}=e,[B,V]=OE(F),[z,A]=OE(C),[R,P]=G.useState(k),{sortConfig:L,handleSort:M,sortedItems:N}=qM(n),{filterText:U,setFilterText:be,filteredItems:Ee}=XM(N),{currentPage:Ce,paginatedItems:Te,totalPages:ye,handlePageChange:ie}=YM(Ee,20),ve=xe=>{const Je=(R==null?void 0:R.id)===xe.id?null:xe;P(Je),v==null||v(Je)},te=xe=>{V(!xe),d&&d(!xe)},O=xe=>{d&&d(!0),A(!xe),g&&g(!xe)},re=async()=>{E&&(console.log("handleSaveAllChanges",_),await E(_))};G.useEffect(()=>{V(F)},[F]),G.useEffect(()=>{A(C)},[C]);const ee=c||u,Z=n?n.length:0,ce=N.length,_e={ableForm:a,ableImport:o,seeable:u,removeable:c,showForm:B,showImportForm:z,selectedItem:R,viewLinks:h,tempChanges:_,setTempChanges:w},Se={handleShowForm:te,handleShowImportForm:O,onItemDeleted:y,setTempChanges:w,onSaveAllChanges:re},we={setTempChanges:w,handleRowClick:ve};return!t&&Q.jsxs(Q.Fragment,{children:[Q.jsxs("div",{className:"item-count",children:["Total items: ",Z,U&&` (showing ${ce} filtered)`]}),i&&Q.jsx("div",{className:"filter-container",children:Q.jsx("input",{type:"text",placeholder:"Filter items...",value:U,onChange:xe=>be(xe.target.value)})}),ee&&Q.jsx(GM,{config:_e,handlers:Se,hasPendingChanges:Object.keys(_).length>0}),Q.jsxs("div",{className:`table-container ${ee?"with-actions":""}`,children:[Q.jsx(zM,{fields:r,sortConfig:L,handleSort:M,showActions:ee}),Q.jsx(WM,{fields:r,items:Te,selectedItem:R,tempChanges:_,handlers:we})]}),Q.jsx(KM,{currentPage:Ce,totalPages:ye,onPageChange:ie})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _k=1252,JM=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],H1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},z1=function(t){JM.indexOf(t)!=-1&&(_k=H1[0]=t)};function ZM(){z1(1252)}var Mi=function(t){z1(t)};function yk(){Mi(1200),ZM()}function DE(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function e8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function Ek(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var uu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?e8(t.slice(2)):e==254&&r==255?Ek(t.slice(2)):e==65279?t.slice(1):t},Uh=function(e){return String.fromCharCode(e)},NE=function(e){return String.fromCharCode(e)},Vu,Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function LE(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),a=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,i=t.charCodeAt(h++),c=(n&15)<<2|i>>6,u=i&63,isNaN(n)?c=u=64:isNaN(i)&&(u=64),e+=Ns.charAt(a)+Ns.charAt(o)+Ns.charAt(c)+Ns.charAt(u);return e}function ti(t){var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)a=Ns.indexOf(t.charAt(h++)),o=Ns.indexOf(t.charAt(h++)),r=a<<2|o>>4,e+=String.fromCharCode(r),c=Ns.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=Ns.indexOf(t.charAt(h++)),i=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(i));return e}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ys(t){return xt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ME(t){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Li=function(e){return xt?Xo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Yo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function W1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return W1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Os=xt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Xo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function t8(t){for(var e=[],r=0,n=t.length+250,i=Ys(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|c>>6&15|(o&3)<<4,i[r++]=128|c&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Ys(65535),n=65530)}return e.push(i.slice(0,r)),Os(e)}var Cn=/\u0000/g,fu=/[\u0001-\u0006]/g;function Kl(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Vi(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}function G1(t,e){var r=""+t;return r.length>=e?r:nr(" ",e-r.length)+r}function M0(t,e){var r=""+t;return r.length>=e?r:r+nr(" ",e-r.length)}function r8(t,e){var r=""+Math.round(t);return r.length>=e?r:nr("0",e-r.length)+r}function n8(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}var VE=Math.pow(2,32);function Nl(t,e){if(t>VE||t<-VE)return r8(t,e);var r=Math.round(t);return n8(r,e)}function V0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var BE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},UE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function B0(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,o=1,c=0,u=1,h=0,d=0,g=Math.floor(i);h<e&&(g=Math.floor(i),c=g*o+a,d=g*h+u,!(i-g<5e-8));)i=1/(i-g),a=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=a):(d=h,c=o)),!r)return[0,n*c,d];var v=Math.floor(n*c/d);return[v,n*c-v*d,d]}function Po(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,o=[],c={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=f8(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}var wk=new Date(1899,11,31,0,0,0),s8=wk.getTime(),o8=new Date(1900,2,1,0,0,0);function Tk(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=o8&&(r+=24*60*60*1e3),(r-(s8+(t.getTimezoneOffset()-wk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function K1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function l8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c8(t){var e=t<0?12:11,r=K1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function u8(t){var e=K1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Bu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=c8(t):e===10?r=t.toFixed(10).substr(0,12):r=u8(t),K1(l8(r.toUpperCase()))}function Bo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Bu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return vi(14,Tk(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function f8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function h8(t,e,r,n){var i="",a=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return Im[r.m-1][1];case 5:return Im[r.m-1][0];default:return Im[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return BE[r.q][0];default:return BE[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Vi(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(i=Vi(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?Vi(u,h):"";return d}function Ls(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Sk=/%/g;function d8(t,e,r){var n=e.replace(Sk,""),i=e.length-n.length;return za(t,n,r*Math.pow(10,2*i))+nr("%",i)}function p8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function kk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+kk(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ak=/# (\?+)( ?)\/( ?)(\d+)/;function m8(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),o=i-a*n,c=n;return r+(a===0?"":""+a)+" "+(o===0?nr(" ",t[1].length+1+t[4].length):G1(o,t[1].length)+t[2]+"/"+t[3]+Vi(c,t[4].length))}function g8(t,e,r){return r+(e===0?"":""+e)+nr(" ",t[1].length+2+t[4].length)}var Ck=/^#*0*\.([0#]+)/,Ik=/\).*[0#]/,Rk=/\(###\) ###\\?-####/;function wn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function jE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function $E(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function v8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function x8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function di(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Ik)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?di("n",n,r):"("+di("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return p8(t,e,r);if(e.indexOf("%")!==-1)return d8(t,e,r);if(e.indexOf("E")!==-1)return kk(e,r);if(e.charCodeAt(0)===36)return"$"+di(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Nl(u,e.length);if(e.match(/^[#?]+$/))return i=Nl(r,0),i==="0"&&(i=""),i.length>e.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(Ak))return m8(a,u,h);if(e.match(/^#+0+$/))return h+Nl(u,e.length-e.indexOf("0"));if(a=e.match(Ck))return i=jE(r,a[1].length).replace(/^([^\.]+)$/,"$1."+wn(a[1])).replace(/\.$/,"."+wn(a[1])).replace(/\.(\d*)$/,function(E,_){return"."+_+nr("0",wn(a[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+jE(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+Ls(Nl(u,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+di(t,e,-r):Ls(""+(Math.floor(r)+v8(r,a[1].length)))+"."+Vi($E(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return di(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(di(t,e.replace(/[\\-]/g,""),r)),o=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(Rk))return i=di(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=B0(u,Math.pow(10,o)-1,!1),i=""+h,d=za("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=M0(c[2],o),d.length<a[4].length&&(d=wn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=B0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?G1(c[1],o)+a[2]+"/"+a[3]+M0(c[2],o):nr(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Nl(r,0),e.length<=i.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return wn(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=$E(r,a[1].length),r<0?"-"+di(t,e,-r):Ls(x8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Vi(0,3-E.length):"")+E})+"."+Vi(o,a[1].length);switch(e){case"###,##0.00":return di(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Ls(Nl(u,0));return y!=="0"?h+y:"";case"###,###.00":return di(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return di(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function _8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function y8(t,e,r){var n=e.replace(Sk,""),i=e.length-n.length;return za(t,n,r*Math.pow(10,2*i))+nr("%",i)}function Pk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Pk(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ia(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Ik)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ia("n",n,r):"("+ia("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return _8(t,e,r);if(e.indexOf("%")!==-1)return y8(t,e,r);if(e.indexOf("E")!==-1)return Pk(e,r);if(e.charCodeAt(0)===36)return"$"+ia(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Vi(u,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(Ak))return g8(a,u,h);if(e.match(/^#+0+$/))return h+Vi(u,e.length-e.indexOf("0"));if(a=e.match(Ck))return i=(""+r).replace(/^([^\.]+)$/,"$1."+wn(a[1])).replace(/\.$/,"."+wn(a[1])),i=i.replace(/\.(\d*)$/,function(E,_){return"."+_+nr("0",wn(a[1]).length-_.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+Ls(""+u);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ia(t,e,-r):Ls(""+r)+"."+nr("0",a[1].length);if(a=e.match(/^#,#*,#0/))return ia(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(ia(t,e.replace(/[\\-]/g,""),r)),o=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(Rk))return i=ia(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=B0(u,Math.pow(10,o)-1,!1),i=""+h,d=za("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=M0(c[2],o),d.length<a[4].length&&(d=wn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=B0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?G1(c[1],o)+a[2]+"/"+a[3]+M0(c[2],o):nr(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return wn(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ia(t,e,-r):Ls(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Vi(0,3-E.length):"")+E})+"."+Vi(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Ls(""+u);return y!=="0"?h+y:"";default:if(e.match(/\.[0#?]*$/))return ia(t,e.slice(0,e.lastIndexOf(".")),r)+wn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function za(t,e,r){return(r|0)===r?ia(t,e,r):di(t,e,r)}function E8(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Fk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":V0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Fk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function w8(t,e,r,n){for(var i=[],a="",o=0,c="",u="t",h,d,g,v="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!V0(t,o))throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(g);i[i.length]={t:"t",v:a},++o;break;case"\\":var y=t.charAt(++o),E=y==="("||y===")"?y:"t";i[i.length]={t:E,v:y},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Po(e,r,t.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Po(e,r),h==null))return"";for(a=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),i[i.length]={t:c,v:a},u=c;break;case"A":case"a":case"":var _={t:c,v:c};if(h==null&&(h=Po(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?"P":"A"),_.t="T",v="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",o+=5,v="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",o+=5,v="h"):(_.t="t",++o),h==null&&_.t==="T")return"";i[i.length]=_,u=c;break;case"[":for(a=c;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Fk)){if(h==null&&(h=Po(e,r),h==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",yc(t)||(i[i.length]={t:"t",v:a}));break;case".":if(h!=null){for(a=c;++o<t.length&&(c=t.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;t.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"t",v:c},++o;break}var w=0,k=0,F;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,u="h",w<1&&(w=1);break;case"s":(F=i[o].v.match(/\.0+$/))&&(k=Math.max(k,F[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",B;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=h8(i[o].t.charCodeAt(0),i[o].v,h,k),i[o].t="t";break;case"n":case"?":for(B=o+1;i[B]!=null&&((c=i[B].t)==="?"||c==="D"||(c===" "||c==="t")&&i[B+1]!=null&&(i[B+1].t==="?"||i[B+1].t==="t"&&i[B+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[B].v==="/"||i[B].v===" "&&i[B+1]!=null&&i[B+1].t=="?"));)i[o].v+=i[B].v,i[B]={v:"",t:";"},++B;C+=i[o].v,o=B-1;break;case"G":i[o].t="t",i[o].v=Bo(e,r);break}var V="",z,A;if(C.length>0){C.charCodeAt(0)==40?(z=e<0&&C.charCodeAt(0)===45?-e:e,A=za("n",C,z)):(z=e<0&&n>1?-e:e,A=za("n",C,z),z<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),B=A.length-1;var R=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){R=o;break}var P=i.length;if(R===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(B>=i[o].v.length-1?(B-=i[o].v.length,i[o].v=A.substr(B+1,i[o].v.length)):B<0?i[o].v="":(i[o].v=A.substr(0,B+1),B=-1),i[o].t="t",P=o);B>=0&&P<i.length&&(i[P].v=A.substr(0,B+1)+i[P].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(B=A.indexOf(".")-1,o=R;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")-1:i[o].v.length-1,V=i[o].v.substr(d+1);d>=0;--d)B>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(V=A.charAt(B--)+V);i[o].v=V,i[o].t="t",P=o}for(B>=0&&P<i.length&&(i[P].v=A.substr(0,B+1)+i[P].v),B=A.indexOf(".")+1,o=R;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==R)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")+1:0,V=i[o].v.substr(0,d);d<i[o].v.length;++d)B<A.length&&(V+=A.charAt(B++));i[o].v=V,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(z=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=za(i[o].t,i[o].v,z),i[o].t="t");var L="";for(o=0;o!==i.length;++o)i[o]!=null&&(L+=i[o].v);return L}var HE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function T8(t,e){var r=E8(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(HE),c=r[1].match(HE);return zE(e,o)?[n,r[0]]:zE(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,a]}function vi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[t],n==null&&(n=r.table&&r.table[UE[t]]||ft[UE[t]]),n==null&&(n=a8[t]||"General");break}if(V0(n,0))return Bo(e,r);e instanceof Date&&(e=Tk(e,r.date1904));var i=T8(n,e);if(V0(i[1]))return Bo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return w8(i[1],e,r,i[0])}function bo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ft[r]==null){e<0&&(e=r);continue}if(ft[r]==t){e=r;break}}e<0&&(e=391)}return ft[e]=t,e}function bk(){ft=i8()}var S8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ok=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k8(t){var e=typeof t=="number"?ft[t]:t;return e=e.replace(Ok,"(\\d+)"),new RegExp("^"+e+"$")}function A8(t,e,r){var n=-1,i=-1,a=-1,o=-1,c=-1,u=-1;(e.match(Ok)||[]).forEach(function(g,v){var y=parseInt(r[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":o=y;break;case"s":u=y;break;case"m":o>=0?c=y:i=y;break}}),u>=0&&c==-1&&i>=0&&(c=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:n==-1&&i==-1&&a==-1?d:h+"T"+d}var C8=function(){var t={};t.version="1.2.0";function e(){for(var A=0,R=new Array(256),P=0;P!=256;++P)A=P,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,R[P]=A;return typeof Int32Array<"u"?new Int32Array(R):R}var r=e();function n(A){var R=0,P=0,L=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)M[L]=A[L];for(L=0;L!=256;++L)for(P=A[L],R=256+L;R<4096;R+=256)P=M[R]=P>>>8^A[P&255];var N=[];for(L=1;L!=16;++L)N[L-1]=typeof Int32Array<"u"?M.subarray(L*256,L*256+256):M.slice(L*256,L*256+256);return N}var i=n(r),a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],g=i[6],v=i[7],y=i[8],E=i[9],_=i[10],w=i[11],k=i[12],F=i[13],C=i[14];function B(A,R){for(var P=R^-1,L=0,M=A.length;L<M;)P=P>>>8^r[(P^A.charCodeAt(L++))&255];return~P}function V(A,R){for(var P=R^-1,L=A.length-15,M=0;M<L;)P=C[A[M++]^P&255]^F[A[M++]^P>>8&255]^k[A[M++]^P>>16&255]^w[A[M++]^P>>>24]^_[A[M++]]^E[A[M++]]^y[A[M++]]^v[A[M++]]^g[A[M++]]^d[A[M++]]^h[A[M++]]^u[A[M++]]^c[A[M++]]^o[A[M++]]^a[A[M++]]^r[A[M++]];for(L+=15;M<L;)P=P>>>8^r[(P^A[M++])&255];return~P}function z(A,R){for(var P=R^-1,L=0,M=A.length,N=0,U=0;L<M;)N=A.charCodeAt(L++),N<128?P=P>>>8^r[(P^N)&255]:N<2048?(P=P>>>8^r[(P^(192|N>>6&31))&255],P=P>>>8^r[(P^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,U=A.charCodeAt(L++)&1023,P=P>>>8^r[(P^(240|N>>8&7))&255],P=P>>>8^r[(P^(128|N>>2&63))&255],P=P>>>8^r[(P^(128|U>>6&15|(N&3)<<4))&255],P=P>>>8^r[(P^(128|U&63))&255]):(P=P>>>8^r[(P^(224|N>>12&15))&255],P=P>>>8^r[(P^(128|N>>6&63))&255],P=P>>>8^r[(P^(128|N&63))&255]);return~P}return t.table=r,t.bstr=B,t.buf=V,t.str=z,t}(),Et=function(){var e={};e.version="1.2.1";function r(D,K){for(var H=D.split("/"),W=K.split("/"),q=0,X=0,le=Math.min(H.length,W.length);q<le;++q){if(X=H[q].length-W[q].length)return X;if(H[q]!=W[q])return H[q]<W[q]?-1:1}return H.length-W.length}function n(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:n(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(0,K+1)}function i(D){if(D.charAt(D.length-1)=="/")return i(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(K+1)}function a(D,K){typeof K=="string"&&(K=new Date(K));var H=K.getHours();H=H<<6|K.getMinutes(),H=H<<5|K.getSeconds()>>>1,D.write_shift(2,H);var W=K.getFullYear()-1980;W=W<<4|K.getMonth()+1,W=W<<5|K.getDate(),D.write_shift(2,W)}function o(D){var K=D.read_shift(2)&65535,H=D.read_shift(2)&65535,W=new Date,q=H&31;H>>>=5;var X=H&15;H>>>=4,W.setMilliseconds(0),W.setFullYear(H+1980),W.setMonth(X-1),W.setDate(q);var le=K&31;K>>>=5;var ge=K&63;return K>>>=6,W.setHours(K),W.setMinutes(ge),W.setSeconds(le<<1),W}function c(D){Kr(D,0);for(var K={},H=0;D.l<=D.length-4;){var W=D.read_shift(2),q=D.read_shift(2),X=D.l+q,le={};switch(W){case 21589:H=D.read_shift(1),H&1&&(le.mtime=D.read_shift(4)),q>5&&(H&2&&(le.atime=D.read_shift(4)),H&4&&(le.ctime=D.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}D.l=X,K[W]=le}return K}var u;function h(){return u||(u={})}function d(D,K){if(D[0]==80&&D[1]==75)return _a(D,K);if((D[0]|32)==109&&(D[1]|32)==105)return so(D,K);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var H=3,W=512,q=0,X=0,le=0,ge=0,ue=0,he=[],de=D.slice(0,512);Kr(de,0);var Pe=g(de);switch(H=Pe[0],H){case 3:W=512;break;case 4:W=4096;break;case 0:if(Pe[1]==0)return _a(D,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}W!==512&&(de=D.slice(0,W),Kr(de,28));var Le=D.slice(0,W);v(de,H);var Be=de.read_shift(4,"i");if(H===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ge=de.read_shift(4,"i"),q=de.read_shift(4,"i"),ue=de.read_shift(4,"i"),X=de.read_shift(4,"i");for(var De=-1,Fe=0;Fe<109&&(De=de.read_shift(4,"i"),!(De<0));++Fe)he[Fe]=De;var et=y(D,W);w(ue,X,et,W,he);var It=F(et,le,he,W);It[le].name="!Directory",q>0&&ge!==U&&(It[ge].name="!MiniFAT"),It[he[0]].name="!FAT",It.fat_addrs=he,It.ssz=W;var At={},Dt=[],wi=[],Ki=[];C(le,It,et,Dt,q,At,wi,ge),E(wi,Ki,Dt),Dt.shift();var Hn={FileIndex:wi,FullPaths:Ki};return K&&K.raw&&(Hn.raw={header:Le,sectors:et}),Hn}function g(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(be,"Header Signature: "),D.l+=16;var K=D.read_shift(2,"u");return[D.read_shift(2,"u"),K]}function v(D,K){var H=9;switch(D.l+=2,H=D.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function y(D,K){for(var H=Math.ceil(D.length/K)-1,W=[],q=1;q<H;++q)W[q-1]=D.slice(q*K,(q+1)*K);return W[H-1]=D.slice(H*K),W}function E(D,K,H){for(var W=0,q=0,X=0,le=0,ge=0,ue=H.length,he=[],de=[];W<ue;++W)he[W]=de[W]=W,K[W]=H[W];for(;ge<de.length;++ge)W=de[ge],q=D[W].L,X=D[W].R,le=D[W].C,he[W]===W&&(q!==-1&&he[q]!==q&&(he[W]=he[q]),X!==-1&&he[X]!==X&&(he[W]=he[X])),le!==-1&&(he[le]=W),q!==-1&&W!=he[W]&&(he[q]=he[W],de.lastIndexOf(q)<ge&&de.push(q)),X!==-1&&W!=he[W]&&(he[X]=he[W],de.lastIndexOf(X)<ge&&de.push(X));for(W=1;W<ue;++W)he[W]===W&&(X!==-1&&he[X]!==X?he[W]=he[X]:q!==-1&&he[q]!==q&&(he[W]=he[q]));for(W=1;W<ue;++W)if(D[W].type!==0){if(ge=W,ge!=he[ge])do ge=he[ge],K[W]=K[ge]+"/"+K[W];while(ge!==0&&he[ge]!==-1&&ge!=he[ge]);he[W]=-1}for(K[0]+="/",W=1;W<ue;++W)D[W].type!==2&&(K[W]+="/")}function _(D,K,H){for(var W=D.start,q=D.size,X=[],le=W;H&&q>0&&le>=0;)X.push(K.slice(le*N,le*N+N)),q-=N,le=Co(H,le*4);return X.length===0?Cr(0):Os(X).slice(0,D.size)}function w(D,K,H,W,q){var X=U;if(D===U){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var le=H[D],ge=(W>>>2)-1;if(!le)return;for(var ue=0;ue<ge&&(X=Co(le,ue*4))!==U;++ue)q.push(X);w(Co(le,W-4),K-1,H,W,q)}}function k(D,K,H,W,q){var X=[],le=[];q||(q=[]);var ge=W-1,ue=0,he=0;for(ue=K;ue>=0;){q[ue]=!0,X[X.length]=ue,le.push(D[ue]);var de=H[Math.floor(ue*4/W)];if(he=ue*4&ge,W<4+he)throw new Error("FAT boundary crossed: "+ue+" 4 "+W);if(!D[de])break;ue=Co(D[de],he)}return{nodes:X,data:ew([le])}}function F(D,K,H,W){var q=D.length,X=[],le=[],ge=[],ue=[],he=W-1,de=0,Pe=0,Le=0,Be=0;for(de=0;de<q;++de)if(ge=[],Le=de+K,Le>=q&&(Le-=q),!le[Le]){ue=[];var De=[];for(Pe=Le;Pe>=0;){De[Pe]=!0,le[Pe]=!0,ge[ge.length]=Pe,ue.push(D[Pe]);var Fe=H[Math.floor(Pe*4/W)];if(Be=Pe*4&he,W<4+Be)throw new Error("FAT boundary crossed: "+Pe+" 4 "+W);if(!D[Fe]||(Pe=Co(D[Fe],Be),De[Pe]))break}X[Le]={nodes:ge,data:ew([ue])}}return X}function C(D,K,H,W,q,X,le,ge){for(var ue=0,he=W.length?2:0,de=K[D].data,Pe=0,Le=0,Be;Pe<de.length;Pe+=128){var De=de.slice(Pe,Pe+128);Kr(De,64),Le=De.read_shift(2),Be=J1(De,0,Le-he),W.push(Be);var Fe={name:Be,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},et=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);et!==0&&(Fe.ct=B(De,De.l-8));var It=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);It!==0&&(Fe.mt=B(De,De.l-8)),Fe.start=De.read_shift(4,"i"),Fe.size=De.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=U,Fe.name=""),Fe.type===5?(ue=Fe.start,q>0&&ue!==U&&(K[ue].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",K[Fe.start]===void 0&&(K[Fe.start]=k(H,Fe.start,K.fat_addrs,K.ssz)),K[Fe.start].name=Fe.name,Fe.content=K[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:ue!==U&&Fe.start!==U&&K[ue]&&(Fe.content=_(Fe,K[ue].data,(K[ge]||{}).data))),Fe.content&&Kr(Fe.content,0),X[Be]=Fe,le.push(Fe)}}function B(D,K){return new Date((Qn(D,K+4)/1e7*Math.pow(2,32)+Qn(D,K)/1e7-11644473600)*1e3)}function V(D,K){return h(),d(u.readFileSync(D),K)}function z(D,K){var H=K&&K.type;switch(H||xt&&Buffer.isBuffer(D)&&(H="buffer"),H||"base64"){case"file":return V(D,K);case"base64":return d(Li(ti(D)),K);case"binary":return d(Li(D),K)}return d(D,K)}function A(D,K){var H=K||{},W=H.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=W+"/",D.FileIndex[0]={name:W,type:5}),H.CLSID&&(D.FileIndex[0].clsid=H.CLSID),R(D)}function R(D){var K="Sh33tJ5";if(!Et.find(D,"/"+K)){var H=Cr(4);H[0]=55,H[1]=H[3]=50,H[2]=54,D.FileIndex.push({name:K,type:2,content:H,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+K),P(D)}}function P(D,K){A(D);for(var H=!1,W=!1,q=D.FullPaths.length-1;q>=0;--q){var X=D.FileIndex[q];switch(X.type){case 0:W?H=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(X.R*X.L*X.C)&&(H=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!K)){var le=new Date(1987,1,19),ge=0,ue=Object.create?Object.create(null):{},he=[];for(q=0;q<D.FullPaths.length;++q)ue[D.FullPaths[q]]=!0,D.FileIndex[q].type!==0&&he.push([D.FullPaths[q],D.FileIndex[q]]);for(q=0;q<he.length;++q){var de=n(he[q][0]);W=ue[de],W||(he.push([de,{name:i(de).replace("/",""),type:1,clsid:Ce,ct:le,mt:le,content:null}]),ue[de]=!0)}for(he.sort(function(Be,De){return r(Be[0],De[0])}),D.FullPaths=[],D.FileIndex=[],q=0;q<he.length;++q)D.FullPaths[q]=he[q][0],D.FileIndex[q]=he[q][1];for(q=0;q<he.length;++q){var Pe=D.FileIndex[q],Le=D.FullPaths[q];if(Pe.name=i(Le).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||Ce,q===0)Pe.C=he.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Le.slice(-1)=="/"){for(ge=q+1;ge<he.length&&n(D.FullPaths[ge])!=Le;++ge);for(Pe.C=ge>=he.length?-1:ge,ge=q+1;ge<he.length&&n(D.FullPaths[ge])!=n(Le);++ge);Pe.R=ge>=he.length?-1:ge,Pe.type=1}else n(D.FullPaths[q+1]||"")==n(Le)&&(Pe.R=q+1),Pe.type=2}}}function L(D,K){var H=K||{};if(H.fileType=="mad")return Jt(D,H);switch(P(D),H.fileType){case"zip":return ri(D,H)}var W=function(Be){for(var De=0,Fe=0,et=0;et<Be.FileIndex.length;++et){var It=Be.FileIndex[et];if(It.content){var At=It.content.length;At>0&&(At<4096?De+=At+63>>6:Fe+=At+511>>9)}}for(var Dt=Be.FullPaths.length+3>>2,wi=De+7>>3,Ki=De+127>>7,Hn=wi+Fe+Dt+Ki,sr=Hn+127>>7,as=sr<=109?0:Math.ceil((sr-109)/127);Hn+sr+as+127>>7>sr;)as=++sr<=109?0:Math.ceil((sr-109)/127);var zt=[1,as,sr,Ki,Dt,Fe,De,0];return Be.FileIndex[0].size=De<<6,zt[7]=(Be.FileIndex[0].start=zt[0]+zt[1]+zt[2]+zt[3]+zt[4]+zt[5])+(zt[6]+7>>3),zt}(D),q=Cr(W[7]<<9),X=0,le=0;{for(X=0;X<8;++X)q.write_shift(1,Ee[X]);for(X=0;X<8;++X)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),X=0;X<3;++X)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,W[2]),q.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:U),q.write_shift(4,W[3]),q.write_shift(-4,W[1]?W[0]-1:U),q.write_shift(4,W[1]),X=0;X<109;++X)q.write_shift(-4,X<W[2]?W[1]+X:-1)}if(W[1])for(le=0;le<W[1];++le){for(;X<236+le*127;++X)q.write_shift(-4,X<W[2]?W[1]+X:-1);q.write_shift(-4,le===W[1]-1?U:le+1)}var ge=function(Be){for(le+=Be;X<le-1;++X)q.write_shift(-4,X+1);Be&&(++X,q.write_shift(-4,U))};for(le=X=0,le+=W[1];X<le;++X)q.write_shift(-4,Te.DIFSECT);for(le+=W[2];X<le;++X)q.write_shift(-4,Te.FATSECT);ge(W[3]),ge(W[4]);for(var ue=0,he=0,de=D.FileIndex[0];ue<D.FileIndex.length;++ue)de=D.FileIndex[ue],de.content&&(he=de.content.length,!(he<4096)&&(de.start=le,ge(he+511>>9)));for(ge(W[6]+7>>3);q.l&511;)q.write_shift(-4,Te.ENDOFCHAIN);for(le=X=0,ue=0;ue<D.FileIndex.length;++ue)de=D.FileIndex[ue],de.content&&(he=de.content.length,!(!he||he>=4096)&&(de.start=le,ge(he+63>>6)));for(;q.l&511;)q.write_shift(-4,Te.ENDOFCHAIN);for(X=0;X<W[4]<<2;++X){var Pe=D.FullPaths[X];if(!Pe||Pe.length===0){for(ue=0;ue<17;++ue)q.write_shift(4,0);for(ue=0;ue<3;++ue)q.write_shift(4,-1);for(ue=0;ue<12;++ue)q.write_shift(4,0);continue}de=D.FileIndex[X],X===0&&(de.start=de.size?de.start-1:U);var Le=X===0&&H.root||de.name;if(he=2*(Le.length+1),q.write_shift(64,Le,"utf16le"),q.write_shift(2,he),q.write_shift(1,de.type),q.write_shift(1,de.color),q.write_shift(-4,de.L),q.write_shift(-4,de.R),q.write_shift(-4,de.C),de.clsid)q.write_shift(16,de.clsid,"hex");else for(ue=0;ue<4;++ue)q.write_shift(4,0);q.write_shift(4,de.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,de.start),q.write_shift(4,de.size),q.write_shift(4,0)}for(X=1;X<D.FileIndex.length;++X)if(de=D.FileIndex[X],de.size>=4096)if(q.l=de.start+1<<9,xt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+511&-512;else{for(ue=0;ue<de.size;++ue)q.write_shift(1,de.content[ue]);for(;ue&511;++ue)q.write_shift(1,0)}for(X=1;X<D.FileIndex.length;++X)if(de=D.FileIndex[X],de.size>0&&de.size<4096)if(xt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+63&-64;else{for(ue=0;ue<de.size;++ue)q.write_shift(1,de.content[ue]);for(;ue&63;++ue)q.write_shift(1,0)}if(xt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function M(D,K){var H=D.FullPaths.map(function(ue){return ue.toUpperCase()}),W=H.map(function(ue){var he=ue.split("/");return he[he.length-(ue.slice(-1)=="/"?2:1)]}),q=!1;K.charCodeAt(0)===47?(q=!0,K=H[0].slice(0,-1)+K):q=K.indexOf("/")!==-1;var X=K.toUpperCase(),le=q===!0?H.indexOf(X):W.indexOf(X);if(le!==-1)return D.FileIndex[le];var ge=!X.match(fu);for(X=X.replace(Cn,""),ge&&(X=X.replace(fu,"!")),le=0;le<H.length;++le)if((ge?H[le].replace(fu,"!"):H[le]).replace(Cn,"")==X||(ge?W[le].replace(fu,"!"):W[le]).replace(Cn,"")==X)return D.FileIndex[le];return null}var N=64,U=-2,be="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",Te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(D,K,H){h();var W=L(D,H);u.writeFileSync(K,W)}function ie(D){for(var K=new Array(D.length),H=0;H<D.length;++H)K[H]=String.fromCharCode(D[H]);return K.join("")}function ve(D,K){var H=L(D,K);switch(K&&K.type||"buffer"){case"file":return h(),u.writeFileSync(K.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return LE(typeof H=="string"?H:ie(H));case"buffer":if(xt)return Buffer.isBuffer(H)?H:Xo(H);case"array":return typeof H=="string"?Li(H):H}return H}var te;function O(D){try{var K=D.InflateRaw,H=new K;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)te=D;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function re(D,K){if(!te)return Gi(D,K);var H=te.InflateRaw,W=new H,q=W._processChunk(D.slice(D.l),W._finishFlushFlag);return D.l+=W.bytesRead,q}function ee(D){return te?te.deflateRawSync(D):rt(D)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Se(D){var K=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(K>>16|K>>8|K)&255}for(var we=typeof Uint8Array<"u",xe=we?new Uint8Array(256):[],Je=0;Je<256;++Je)xe[Je]=Se(Je);function Y(D,K){var H=xe[D&255];return K<=8?H>>>8-K:(H=H<<8|xe[D>>8&255],K<=16?H>>>16-K:(H=H<<8|xe[D>>16&255],H>>>24-K))}function kt(D,K){var H=K&7,W=K>>>3;return(D[W]|(H<=6?0:D[W+1]<<8))>>>H&3}function ct(D,K){var H=K&7,W=K>>>3;return(D[W]|(H<=5?0:D[W+1]<<8))>>>H&7}function dt(D,K){var H=K&7,W=K>>>3;return(D[W]|(H<=4?0:D[W+1]<<8))>>>H&15}function ut(D,K){var H=K&7,W=K>>>3;return(D[W]|(H<=3?0:D[W+1]<<8))>>>H&31}function Ve(D,K){var H=K&7,W=K>>>3;return(D[W]|(H<=1?0:D[W+1]<<8))>>>H&127}function Vt(D,K,H){var W=K&7,q=K>>>3,X=(1<<H)-1,le=D[q]>>>W;return H<8-W||(le|=D[q+1]<<8-W,H<16-W)||(le|=D[q+2]<<16-W,H<24-W)||(le|=D[q+3]<<24-W),le&X}function wr(D,K,H){var W=K&7,q=K>>>3;return W<=5?D[q]|=(H&7)<<W:(D[q]|=H<<W&255,D[q+1]=(H&7)>>8-W),K+3}function ur(D,K,H){var W=K&7,q=K>>>3;return H=(H&1)<<W,D[q]|=H,K+1}function Tr(D,K,H){var W=K&7,q=K>>>3;return H<<=W,D[q]|=H&255,H>>>=8,D[q+1]=H,K+8}function _i(D,K,H){var W=K&7,q=K>>>3;return H<<=W,D[q]|=H&255,H>>>=8,D[q+1]=H&255,D[q+2]=H>>>8,K+16}function gn(D,K){var H=D.length,W=2*H>K?2*H:K+5,q=0;if(H>=K)return D;if(xt){var X=ME(W);if(D.copy)D.copy(X);else for(;q<D.length;++q)X[q]=D[q];return X}else if(we){var le=new Uint8Array(W);if(le.set)le.set(D);else for(;q<H;++q)le[q]=D[q];return le}return D.length=W,D}function fr(D){for(var K=new Array(D),H=0;H<D;++H)K[H]=0;return K}function vn(D,K,H){var W=1,q=0,X=0,le=0,ge=0,ue=D.length,he=we?new Uint16Array(32):fr(32);for(X=0;X<32;++X)he[X]=0;for(X=ue;X<H;++X)D[X]=0;ue=D.length;var de=we?new Uint16Array(ue):fr(ue);for(X=0;X<ue;++X)he[q=D[X]]++,W<q&&(W=q),de[X]=0;for(he[0]=0,X=1;X<=W;++X)he[X+16]=ge=ge+he[X-1]<<1;for(X=0;X<ue;++X)ge=D[X],ge!=0&&(de[X]=he[ge+16]++);var Pe=0;for(X=0;X<ue;++X)if(Pe=D[X],Pe!=0)for(ge=Y(de[X],W)>>W-Pe,le=(1<<W+4-Pe)-1;le>=0;--le)K[ge|le<<Pe]=Pe&15|X<<4;return W}var Lt=we?new Uint16Array(512):fr(512),jt=we?new Uint16Array(32):fr(32);if(!we){for(var $t=0;$t<512;++$t)Lt[$t]=0;for($t=0;$t<32;++$t)jt[$t]=0}(function(){for(var D=[],K=0;K<32;K++)D.push(5);vn(D,jt,32);var H=[];for(K=0;K<=143;K++)H.push(8);for(;K<=255;K++)H.push(9);for(;K<=279;K++)H.push(7);for(;K<=287;K++)H.push(8);vn(H,Lt,288)})();var Jr=function(){for(var K=we?new Uint8Array(32768):[],H=0,W=0;H<_e.length-1;++H)for(;W<_e[H+1];++W)K[W]=H;for(;W<32768;++W)K[W]=29;var q=we?new Uint8Array(259):[];for(H=0,W=0;H<ce.length-1;++H)for(;W<ce[H+1];++W)q[W]=H;function X(ge,ue){for(var he=0;he<ge.length;){var de=Math.min(65535,ge.length-he),Pe=he+de==ge.length;for(ue.write_shift(1,+Pe),ue.write_shift(2,de),ue.write_shift(2,~de&65535);de-- >0;)ue[ue.l++]=ge[he++]}return ue.l}function le(ge,ue){for(var he=0,de=0,Pe=we?new Uint16Array(32768):[];de<ge.length;){var Le=Math.min(65535,ge.length-de);if(Le<10){for(he=wr(ue,he,+(de+Le==ge.length)),he&7&&(he+=8-(he&7)),ue.l=he/8|0,ue.write_shift(2,Le),ue.write_shift(2,~Le&65535);Le-- >0;)ue[ue.l++]=ge[de++];he=ue.l*8;continue}he=wr(ue,he,+(de+Le==ge.length)+2);for(var Be=0;Le-- >0;){var De=ge[de];Be=(Be<<5^De)&32767;var Fe=-1,et=0;if((Fe=Pe[Be])&&(Fe|=de&-32768,Fe>de&&(Fe-=32768),Fe<de))for(;ge[Fe+et]==ge[de+et]&&et<250;)++et;if(et>2){De=q[et],De<=22?he=Tr(ue,he,xe[De+1]>>1)-1:(Tr(ue,he,3),he+=5,Tr(ue,he,xe[De-23]>>5),he+=3);var It=De<8?0:De-4>>2;It>0&&(_i(ue,he,et-ce[De]),he+=It),De=K[de-Fe],he=Tr(ue,he,xe[De]>>3),he-=3;var At=De<4?0:De-2>>1;At>0&&(_i(ue,he,de-Fe-_e[De]),he+=At);for(var Dt=0;Dt<et;++Dt)Pe[Be]=de&32767,Be=(Be<<5^ge[de])&32767,++de;Le-=et-1}else De<=143?De=De+48:he=ur(ue,he,1),he=Tr(ue,he,xe[De]),Pe[Be]=de&32767,++de}he=Tr(ue,he,0)-1}return ue.l=(he+7)/8|0,ue.l}return function(ue,he){return ue.length<8?X(ue,he):le(ue,he)}}();function rt(D){var K=Cr(50+Math.floor(D.length*1.1)),H=Jr(D,K);return K.slice(0,H)}var Ot=we?new Uint16Array(32768):fr(32768),hr=we?new Uint16Array(32768):fr(32768),Ht=we?new Uint16Array(128):fr(128),$n=1,rs=1;function ro(D,K){var H=ut(D,K)+257;K+=5;var W=ut(D,K)+1;K+=5;var q=dt(D,K)+4;K+=4;for(var X=0,le=we?new Uint8Array(19):fr(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,he=we?new Uint8Array(8):fr(8),de=we?new Uint8Array(8):fr(8),Pe=le.length,Le=0;Le<q;++Le)le[Z[Le]]=X=ct(D,K),ue<X&&(ue=X),he[X]++,K+=3;var Be=0;for(he[0]=0,Le=1;Le<=ue;++Le)de[Le]=Be=Be+he[Le-1]<<1;for(Le=0;Le<Pe;++Le)(Be=le[Le])!=0&&(ge[Le]=de[Be]++);var De=0;for(Le=0;Le<Pe;++Le)if(De=le[Le],De!=0){Be=xe[ge[Le]]>>8-De;for(var Fe=(1<<7-De)-1;Fe>=0;--Fe)Ht[Be|Fe<<De]=De&7|Le<<3}var et=[];for(ue=1;et.length<H+W;)switch(Be=Ht[Ve(D,K)],K+=Be&7,Be>>>=3){case 16:for(X=3+kt(D,K),K+=2,Be=et[et.length-1];X-- >0;)et.push(Be);break;case 17:for(X=3+ct(D,K),K+=3;X-- >0;)et.push(0);break;case 18:for(X=11+Ve(D,K),K+=7;X-- >0;)et.push(0);break;default:et.push(Be),ue<Be&&(ue=Be);break}var It=et.slice(0,H),At=et.slice(H);for(Le=H;Le<286;++Le)It[Le]=0;for(Le=W;Le<30;++Le)At[Le]=0;return $n=vn(It,Ot,286),rs=vn(At,hr,30),K}function no(D,K){if(D[0]==3&&!(D[1]&3))return[Ys(K),2];for(var H=0,W=0,q=ME(K||1<<18),X=0,le=q.length>>>0,ge=0,ue=0;!(W&1);){if(W=ct(D,H),H+=3,W>>>1)W>>1==1?(ge=9,ue=5):(H=ro(D,H),ge=$n,ue=rs);else{H&7&&(H+=8-(H&7));var he=D[H>>>3]|D[(H>>>3)+1]<<8;if(H+=32,he>0)for(!K&&le<X+he&&(q=gn(q,X+he),le=q.length);he-- >0;)q[X++]=D[H>>>3],H+=8;continue}for(;;){!K&&le<X+32767&&(q=gn(q,X+32767),le=q.length);var de=Vt(D,H,ge),Pe=W>>>1==1?Lt[de]:Ot[de];if(H+=Pe&15,Pe>>>=4,!(Pe>>>8&255))q[X++]=Pe;else{if(Pe==256)break;Pe-=257;var Le=Pe<8?0:Pe-4>>2;Le>5&&(Le=0);var Be=X+ce[Pe];Le>0&&(Be+=Vt(D,H,Le),H+=Le),de=Vt(D,H,ue),Pe=W>>>1==1?jt[de]:hr[de],H+=Pe&15,Pe>>>=4;var De=Pe<4?0:Pe-2>>1,Fe=_e[Pe];for(De>0&&(Fe+=Vt(D,H,De),H+=De),!K&&le<Be&&(q=gn(q,Be+100),le=q.length);X<Be;)q[X]=q[X-Fe],++X}}}return K?[q,H+7>>>3]:[q.slice(0,X),H+7>>>3]}function Gi(D,K){var H=D.slice(D.l||0),W=no(H,K);return D.l+=W[1],W[0]}function xa(D,K){if(D)typeof console<"u"&&console.error(K);else throw new Error(K)}function _a(D,K){var H=D;Kr(H,0);var W=[],q=[],X={FileIndex:W,FullPaths:q};A(X,{root:K.root});for(var le=H.length-4;(H[le]!=80||H[le+1]!=75||H[le+2]!=5||H[le+3]!=6)&&le>=0;)--le;H.l=le+4,H.l+=4;var ge=H.read_shift(2);H.l+=6;var ue=H.read_shift(4);for(H.l=ue,le=0;le<ge;++le){H.l+=20;var he=H.read_shift(4),de=H.read_shift(4),Pe=H.read_shift(2),Le=H.read_shift(2),Be=H.read_shift(2);H.l+=8;var De=H.read_shift(4),Fe=c(H.slice(H.l+Pe,H.l+Pe+Le));H.l+=Pe+Le+Be;var et=H.l;H.l=De+4,Rn(H,he,de,X,Fe),H.l=et}return X}function Rn(D,K,H,W,q){D.l+=2;var X=D.read_shift(2),le=D.read_shift(2),ge=o(D);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ue=D.read_shift(4),he=D.read_shift(4),de=D.read_shift(4),Pe=D.read_shift(2),Le=D.read_shift(2),Be="",De=0;De<Pe;++De)Be+=String.fromCharCode(D[D.l++]);if(Le){var Fe=c(D.slice(D.l,D.l+Le));(Fe[21589]||{}).mt&&(ge=Fe[21589].mt),((q||{})[21589]||{}).mt&&(ge=q[21589].mt)}D.l+=Le;var et=D.slice(D.l,D.l+he);switch(le){case 8:et=re(D,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var It=!1;X&8&&(ue=D.read_shift(4),ue==134695760&&(ue=D.read_shift(4),It=!0),he=D.read_shift(4),de=D.read_shift(4)),he!=K&&xa(It,"Bad compressed size: "+K+" != "+he),de!=H&&xa(It,"Bad uncompressed size: "+H+" != "+de),xn(W,Be,et,{unsafe:!0,mt:ge})}function ri(D,K){var H=K||{},W=[],q=[],X=Cr(1),le=H.compression?8:0,ge=0,ue=0,he=0,de=0,Pe=0,Le=D.FullPaths[0],Be=Le,De=D.FileIndex[0],Fe=[],et=0;for(ue=1;ue<D.FullPaths.length;++ue)if(Be=D.FullPaths[ue].slice(Le.length),De=D.FileIndex[ue],!(!De.size||!De.content||Be=="Sh33tJ5")){var It=de,At=Cr(Be.length);for(he=0;he<Be.length;++he)At.write_shift(1,Be.charCodeAt(he)&127);At=At.slice(0,At.l),Fe[Pe]=C8.buf(De.content,0);var Dt=De.content;le==8&&(Dt=ee(Dt)),X=Cr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),De.mt?a(X,De.mt):X.write_shift(4,0),X.write_shift(-4,Fe[Pe]),X.write_shift(4,Dt.length),X.write_shift(4,De.content.length),X.write_shift(2,At.length),X.write_shift(2,0),de+=X.length,W.push(X),de+=At.length,W.push(At),de+=Dt.length,W.push(Dt),X=Cr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),X.write_shift(4,0),X.write_shift(-4,Fe[Pe]),X.write_shift(4,Dt.length),X.write_shift(4,De.content.length),X.write_shift(2,At.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,It),et+=X.l,q.push(X),et+=At.length,q.push(At),++Pe}return X=Cr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Pe),X.write_shift(2,Pe),X.write_shift(4,et),X.write_shift(4,de),X.write_shift(2,0),Os([Os(W),Os(q),X])}var yi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ni(D,K){if(D.ctype)return D.ctype;var H=D.name||"",W=H.match(/\.([^\.]+)$/);return W&&yi[W[1]]||K&&(W=(H=K).match(/[\.\\]([^\.\\])+$/),W&&yi[W[1]])?yi[W[1]]:"application/octet-stream"}function io(D){for(var K=LE(D),H=[],W=0;W<K.length;W+=76)H.push(K.slice(W,W+76));return H.join(`\r
`)+`\r
`}function ya(D){var K=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var de=he.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],W=K.split(`\r
`),q=0;q<W.length;++q){var X=W[q];if(X.length==0){H.push("");continue}for(var le=0;le<X.length;){var ge=76,ue=X.slice(le,le+ge);ue.charAt(ge-1)=="="?ge--:ue.charAt(ge-2)=="="?ge-=2:ue.charAt(ge-3)=="="&&(ge-=3),ue=X.slice(le,le+ge),le+=ge,le<X.length&&(ue+="="),H.push(ue)}}return H.join(`\r
`)}function ao(D){for(var K=[],H=0;H<D.length;++H){for(var W=D[H];H<=D.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+D[++H];K.push(W)}for(var q=0;q<K.length;++q)K[q]=K[q].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Li(K.join(`\r
`))}function Ei(D,K,H){for(var W="",q="",X="",le,ge=0;ge<10;++ge){var ue=K[ge];if(!ue||ue.match(/^\s*$/))break;var he=ue.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":W=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":q=he[2].trim();break}}switch(++ge,q.toLowerCase()){case"base64":le=Li(ti(K.slice(ge).join("")));break;case"quoted-printable":le=ao(K.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var de=xn(D,W.slice(H.length),le,{unsafe:!0});X&&(de.ctype=X)}function so(D,K){if(ie(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=K&&K.root||"",W=(xt&&Buffer.isBuffer(D)?D.toString("binary"):ie(D)).split(`\r
`),q=0,X="";for(q=0;q<W.length;++q)if(X=W[q],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),H||(H=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),X.slice(0,H.length)!=H););var le=(W[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ge="--"+(le[1]||""),ue=[],he=[],de={FileIndex:ue,FullPaths:he};A(de);var Pe,Le=0;for(q=0;q<W.length;++q){var Be=W[q];Be!==ge&&Be!==ge+"--"||(Le++&&Ei(de,W.slice(Pe,q),H),Pe=q)}return de}function Jt(D,K){var H=K||{},W=H.boundary||"SheetJS";W="------="+W;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],X=D.FullPaths[0],le=X,ge=D.FileIndex[0],ue=1;ue<D.FullPaths.length;++ue)if(le=D.FullPaths[ue].slice(X.length),ge=D.FileIndex[ue],!(!ge.size||!ge.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var he=ge.content,de=xt&&Buffer.isBuffer(he)?he.toString("binary"):ie(he),Pe=0,Le=Math.min(1024,de.length),Be=0,De=0;De<=Le;++De)(Be=de.charCodeAt(De))>=32&&Be<128&&++Pe;var Fe=Pe>=Le*4/5;q.push(W),q.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+le),q.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),q.push("Content-Type: "+ni(ge,le)),q.push(""),q.push(Fe?ya(de):io(de))}return q.push(W+`--\r
`),q.join(`\r
`)}function ns(D){var K={};return A(K,D),K}function xn(D,K,H,W){var q=W&&W.unsafe;q||A(D);var X=!q&&Et.find(D,K);if(!X){var le=D.FullPaths[0];K.slice(0,le.length)==le?le=K:(le.slice(-1)!="/"&&(le+="/"),le=(le+K).replace("//","/")),X={name:i(K),type:2},D.FileIndex.push(X),D.FullPaths.push(le),q||Et.utils.cfb_gc(D)}return X.content=H,X.size=H?H.length:0,W&&(W.CLSID&&(X.clsid=W.CLSID),W.mt&&(X.mt=W.mt),W.ct&&(X.ct=W.ct)),X}function Ea(D,K){A(D);var H=Et.find(D,K);if(H){for(var W=0;W<D.FileIndex.length;++W)if(D.FileIndex[W]==H)return D.FileIndex.splice(W,1),D.FullPaths.splice(W,1),!0}return!1}function wa(D,K,H){A(D);var W=Et.find(D,K);if(W){for(var q=0;q<D.FileIndex.length;++q)if(D.FileIndex[q]==W)return D.FileIndex[q].name=i(H),D.FullPaths[q]=H,!0}return!1}function is(D){P(D,!0)}return e.find=M,e.read=z,e.parse=d,e.write=ve,e.writeFile=ye,e.utils={cfb_new:ns,cfb_add:xn,cfb_del:Ea,cfb_mov:wa,cfb_gc:is,ReadShift:_u,CheckField:tA,prep_blob:Kr,bconcat:Os,use_zlib:O,_deflateRaw:rt,_inflateRaw:Gi,consts:Te},e}();function I8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function pa(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function q1(t){for(var e=[],r=pa(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var U0=new Date(1899,11,30,0,0,0);function In(t,e){var r=t.getTime(),n=U0.getTime()+(t.getTimezoneOffset()-U0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Dk=new Date,R8=U0.getTime()+(Dk.getTimezoneOffset()-U0.getTimezoneOffset())*6e4,WE=Dk.getTimezoneOffset();function Ad(t){var e=new Date;return e.setTime(t*24*60*60*1e3+R8),e.getTimezoneOffset()!==WE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-WE)*6e4),e}function P8(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[a],10)}return e}var GE=new Date("2017-02-19T19:06:09.000Z"),Nk=isNaN(GE.getFullYear())?new Date("2/19/17"):GE,F8=Nk.getFullYear()==2017;function Br(t,e){var r=new Date(t);if(F8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Nk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Uo(t,e){if(xt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return du(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return du(Ek(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return du(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return du(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Xr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Xr(t[r]));return e}function nr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ui(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var b8=["january","february","march","april","may","june","july","august","september","october","november","december"];function lc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&b8.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var O8=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],c=1;c<a.length;++c)o.push(i),o.push(a[c]);return o}}();function Lk(t){return t?t.content&&t.type?Uo(t.content,!0):t.data?uu(t.data):t.asNodeBuffer&&xt?uu(t.asNodeBuffer().toString("binary")):t.asBinary?uu(t.asBinary()):t._data&&t._data.getContent?uu(Uo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Mk(t){if(!t)return null;if(t.data)return DE(t.data);if(t.asNodeBuffer&&xt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?DE(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function D8(t){return t&&t.name.slice(-4)===".bin"?Mk(t):Lk(t)}function pi(t,e){for(var r=t.FullPaths||pa(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function X1(t,e){var r=pi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function vr(t,e,r){if(!r)return D8(X1(t,e));if(!e)return null;try{return vr(t,e)}catch{return null}}function Jn(t,e,r){if(!r)return Lk(X1(t,e));if(!e)return null;try{return Jn(t,e)}catch{return null}}function N8(t,e,r){return Mk(X1(t,e))}function KE(t){for(var e=t.FullPaths||pa(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function L8(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return xt?n=Xo(r):n=t8(r),Et.utils.cfb_add(t,e,n)}Et.utils.cfb_add(t,e,r)}else t.file(e,r)}function Vk(t,e){switch(e.type){case"base64":return Et.read(t,{type:"base64"});case"binary":return Et.read(t,{type:"binary"});case"buffer":case"array":return Et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function hu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Bk=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,M8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,V8=/<[^>]*>/g,mn=Bk.match(qE)?qE:V8,B8=/<\w*:/,U8=/<(\/?)\w+:/;function tt(t,e,r){for(var n={},i=0,a=0;i!==t.length&&!((a=t.charCodeAt(i))===32||a===10||a===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(M8),c=0,u="",h=0,d="",g="",v=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],a=0;a!=g.length&&g.charCodeAt(a)!==61;++a);for(d=g.slice(0,a).trim();g.charCodeAt(a+1)==32;)++a;for(v=(i=g.charCodeAt(a+1))==34||i==39?1:0,u=g.slice(a+1+v,g.length-v),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var y=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[y]&&d.slice(c-3,c)=="ext")continue;n[y]=u,n[y.toLowerCase()]=u}}return n}function ga(t){return t.replace(U8,"<$1")}var Uk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j8=q1(Uk),St=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(t,function(c,u){return Uk[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),$8=/[&<>'"]/g,H8=/[\u0000-\u001f]/g;function Y1(t){var e=t+"";return e.replace($8,function(r){return j8[r]}).replace(/\n/g,"<br/>").replace(H8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var XE=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Yt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rm(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function YE(t){var e=Ys(2*t.length),r,n,i=1,a=0,o=0,c;for(n=0;n<t.length;n+=i)i=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),i=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function QE(t){return Xo(t,"binary").toString("utf8")}var jh="foo bar baz",Ut=xt&&(QE(jh)==Rm(jh)&&QE||YE(jh)==Rm(jh)&&YE)||Rm,du=xt?function(t){return Xo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Uu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),jk=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),z8=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),W8=/<\/?(?:vt:)?variant>/g,G8=/<(?:vt:)([^>]*)>([\s\S]*)</;function JE(t,e){var r=tt(t),n=t.match(z8(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(W8,"").match(G8);o&&i.push({v:Ut(o[2]),t:o[1]})}),i}var K8=/(^\s|\s$|\n)/;function q8(t){return pa(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function X8(t,e,r){return"<"+t+(r!=null?q8(r):"")+(e!=null?(e.match(K8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Q1(t){if(xt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ut(Yo(W1(t)));throw new Error("Bad input format: expected Buffer or string")}var ju=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Y8={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Q8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function J8(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Z8(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,o=n?-e:e;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)t[r+c]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var ZE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},ew=xt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Xo(e)})):ZE(t)}:ZE,tw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ua(t,i)));return n.join("").replace(Cn,"")},J1=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Cn,""):tw(t,e,r)}:tw,rw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},$k=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):rw(t,e,r)}:rw,nw=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ul(t,i)));return n.join("")},df=xt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):nw(e,r,n)}:nw,Hk=function(t,e){var r=Qn(t,e);return r>0?df(t,e+4,e+4+r-1):""},zk=Hk,Wk=function(t,e){var r=Qn(t,e);return r>0?df(t,e+4,e+4+r-1):""},Gk=Wk,Kk=function(t,e){var r=2*Qn(t,e);return r>0?df(t,e+4,e+4+r-1):""},qk=Kk,Xk=function(e,r){var n=Qn(e,r);return n>0?J1(e,r+4,r+4+n):""},Yk=Xk,Qk=function(t,e){var r=Qn(t,e);return r>0?df(t,e+4,e+4+r):""},Jk=Qk,Zk=function(t,e){return J8(t,e)},j0=Zk,eA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xt&&(zk=function(e,r){if(!Buffer.isBuffer(e))return Hk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Gk=function(e,r){if(!Buffer.isBuffer(e))return Wk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},qk=function(e,r){if(!Buffer.isBuffer(e))return Kk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Yk=function(e,r){if(!Buffer.isBuffer(e))return Xk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Jk=function(e,r){if(!Buffer.isBuffer(e))return Qk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},j0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Zk(e,r)},eA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ul=function(t,e){return t[e]},Ua=function(t,e){return t[e+1]*256+t[e]},e5=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Qn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Co=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},t5=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function _u(t,e){var r="",n,i,a=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(Ua(this,h)),h+=2;t*=2;break;case"utf8":r=df(this,this.l,this.l+t);break;case"utf16le":t*=2,r=J1(this,this.l,this.l+t);break;case"wstr":return _u.call(this,t,"dbcs");case"lpstr-ansi":r=zk(this,this.l),t=4+Qn(this,this.l);break;case"lpstr-cp":r=Gk(this,this.l),t=4+Qn(this,this.l);break;case"lpwstr":r=qk(this,this.l),t=4+2*Qn(this,this.l);break;case"lpp4":t=4+Qn(this,this.l),r=Yk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Qn(this,this.l),r=Jk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ul(this,this.l+t++))!==0;)a.push(Uh(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=Ua(this,this.l+t))!==0;)a.push(Uh(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Ul(this,h),this.l=h+1,c=_u.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Uh(Ua(this,h))),h+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Ul(this,h),this.l=h+1,c=_u.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Uh(Ul(this,h))),h+=1}r=a.join("");break;default:switch(t){case 1:return n=Ul(this,this.l),this.l++,n;case 2:return n=(e==="i"?e5:Ua)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Co:t5)(this,this.l),this.l+=4,n):(i=Qn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=j0(this,this.l):i=j0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=$k(this,this.l,t);break}}return this.l+=t,r}var r5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},n5=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},i5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function a5(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)i5(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,r5(this,e,this.l);break;case 8:if(n=8,r==="f"){Z8(this,e,this.l);break}case 16:break;case-4:n=4,n5(this,e,this.l);break}return this.l+=n,this}function tA(t,e){var r=$k(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Kr(t,e){t.l=e,t.read_shift=_u,t.chk=tA,t.write_shift=a5}function pn(t,e){t.l+=e}function Cr(t){var e=Ys(t);return Kr(e,0),e}function ts(t,e,r){if(t){var n,i,a;Kr(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=K0[c]||K0[65535];for(n=t.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=t.read_shift(1))&127)<<7*i;u=t.l+a;var d=h.f&&h.f(t,a,r);if(t.l=u,e(d,h,c))return}}}function _g(){var t=[],e=xt?256:2048,r=function(h){var d=Cr(h);return Kr(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(h){return n&&h<n.length-n.l?n:(i(),n=r(Math.max(h+1,e)))},o=function(){return i(),Os(t)},c=function(h){i(),n=h,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:c,end:o,_bufs:t}}function yu(t,e,r){var n=Xr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iw(t,e,r){var n=Xr(t);return n.s=yu(n.s,e.s,r),n.e=yu(n.e,e.s,r),n}function Eu(t,e){if(t.cRel&&t.c<0)for(t=Xr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Xr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=l5(r)),!t.rRel&&t.rRel!=null&&(r=s5(r)),r}function Pm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ir(t.s.c)+":"+(t.e.cRel?"":"$")+Ir(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Yr(t.s.r)+":"+(t.e.rRel?"":"$")+Yr(t.e.r):Eu(t.s,e.biff)+":"+Eu(t.e,e.biff)}function Z1(t){return parseInt(o5(t),10)-1}function Yr(t){return""+(t+1)}function s5(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function o5(t){return t.replace(/\$(\d+)$/,"$1")}function ev(t){for(var e=c5(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ir(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function l5(t){return t.replace(/^([A-Z])/,"$$$1")}function c5(t){return t.replace(/^\$([A-Z])/,"$1")}function u5(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ec(t){var e=t.indexOf(":");return e==-1?{s:Sn(t),e:Sn(t)}:{s:Sn(t.slice(0,e)),e:Sn(t.slice(e+1))}}function wt(t,e){return typeof e>"u"||typeof e=="number"?wt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function ar(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function aw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=vi(t.z,r?In(e):e)}catch{}try{return t.w=vi((t.XF||{}).numFmtId||(r?14:0),r?In(e):e)}catch{return""+e}}function Qa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Zo[t.v]||t.v:e==null?aw(t,t.v):aw(t,e))}function to(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function rA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),o=0,c=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Sn(n.origin):n.origin;o=u.r,c=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ar(a["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[g].length;++v)if(!(typeof e[g][v]>"u")){var y={v:e[g][v]},E=o+g,_=c+v;if(h.s.r>E&&(h.s.r=E),h.s.c>_&&(h.s.c=_),h.e.r<E&&(h.e.r=E),h.e.c<_&&(h.e.c=_),e[g][v]&&typeof e[g][v]=="object"&&!Array.isArray(e[g][v])&&!(e[g][v]instanceof Date))y=e[g][v];else if(Array.isArray(y.v)&&(y.f=e[g][v][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||ft[14],n.cellDates?(y.t="d",y.w=vi(y.z,In(y.v))):(y.t="n",y.v=In(y.v),y.w=vi(y.z,y.v))):y.t="s";if(i)a[E]||(a[E]=[]),a[E][_]&&a[E][_].z&&(y.z=a[E][_].z),a[E][_]=y;else{var w=ot({c:_,r:E});a[w]&&a[w].z&&(y.z=a[w].z),a[w]=y}}}return h.s.c<1e7&&(a["!ref"]=wt(h)),a}function wc(t,e){return rA(null,t,e)}function f5(t){return t.read_shift(4,"i")}function hn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function h5(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function tv(t,e){var r=t.l,n=t.read_shift(1),i=hn(t),a=[],o={t:i,h:i};if(n&1){for(var c=t.read_shift(4),u=0;u!=c;++u)a.push(h5(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}var d5=tv;function xi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var p5=hn;function rv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var m5=hn,yg=rv;function nv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?j0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Co(e,0)>>2;return r?i/100:i}function nA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Jo=nA;function un(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function g5(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var h=Oo[i];h&&(e.rgb=Hu(h));break;case 2:e.rgb=Hu([o,c,u]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function v5(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function iA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function x5(t){return iA(t,1)}function _5(t){return iA(t,2)}var iv=2,Vn=3,$h=11,sw=12,$0=19,Hh=64,y5=65,E5=71,w5=4108,T5=4126,Vr=80,aA=81,S5=[Vr,aA],k5={1:{n:"CodePage",t:iv},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Vn},5:{n:"LineCount",t:Vn},6:{n:"ParagraphCount",t:Vn},7:{n:"SlideCount",t:Vn},8:{n:"NoteCount",t:Vn},9:{n:"HiddenCount",t:Vn},10:{n:"MultimediaClipCount",t:Vn},11:{n:"ScaleCrop",t:$h},12:{n:"HeadingPairs",t:w5},13:{n:"TitlesOfParts",t:T5},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:$h},17:{n:"CharacterCount",t:Vn},19:{n:"SharedDoc",t:$h},22:{n:"HyperlinksChanged",t:$h},23:{n:"AppVersion",t:Vn,p:"version"},24:{n:"DigSig",t:y5},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},A5={1:{n:"CodePage",t:iv},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:Hh},11:{n:"LastPrinted",t:Hh},12:{n:"CreatedDate",t:Hh},13:{n:"ModifiedDate",t:Hh},14:{n:"PageCount",t:Vn},15:{n:"WordCount",t:Vn},16:{n:"CharCount",t:Vn},17:{n:"Thumbnail",t:E5},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Vn},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},ow={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},C5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function I5(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var R5=I5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Oo=Xr(R5),Zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function P5(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function F5(t){var e=P5();if(!t||!t.match)return e;var r={};if((t.match(mn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(B8,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[lw[i.ContentType]]!==void 0&&e[lw[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Y8.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var jl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Eg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function wu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(mn)||[]).forEach(function(i){var a=tt(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var c=a.TargetMode==="External"?a.Target:hu(a.Target,e);r[c]=o,n[a.Id]=o}}),r["!id"]=n,r}var b5="application/vnd.oasis.opendocument.spreadsheet";function O5(t,e){for(var r=Q1(t),n,i;n=ju.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==b5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Tu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],D5=function(){for(var t=new Array(Tu.length),e=0;e<Tu.length;++e){var r=Tu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function oA(t){var e={};t=Ut(t);for(var r=0;r<Tu.length;++r){var n=Tu[r],i=t.match(D5[r]);i!=null&&i.length>0&&(e[n[1]]=St(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Br(e[n[1]]))}return e}var N5=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function lA(t,e,r,n){var i=[];if(typeof t=="string")i=JE(t,n);else for(var a=0;a<t.length;++a)i=i.concat(t[a].map(function(d){return{v:d}}));var o=typeof e=="string"?JE(e,n).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(u=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function L5(t,e,r){var n={};return e||(e={}),t=Ut(t),N5.forEach(function(i){var a=(t.match(Uu(i[0]))||[])[1];switch(i[2]){case"string":a&&(e[i[1]]=St(a));break;case"bool":e[i[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&lA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var M5=/<[^>]+>[^<]*/g;function V5(t,e){var r={},n="",i=t.match(M5);if(i)for(var a=0;a!=i.length;++a){var o=i[a],c=tt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=St(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=St(d);break;case"bool":r[n]=Yt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Br(d);break;case"cy":case"error":r[n]=St(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}var B5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Fm;function U5(t,e,r){Fm||(Fm=q1(B5)),e=Fm[e]||e,t[e]=r}function av(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function cA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function uA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function fA(t,e,r){return e===31?uA(t):cA(t,e,r)}function wg(t,e,r){return fA(t,e,r===!1?0:4)}function j5(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return fA(t,e,0)}function $5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Cn,""),t.l-i&2&&(t.l+=2)}return r}function H5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Cn,"");return r}function z5(t){var e=t.l,r=H0(t,aA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=H0(t,Vn);return[r,n]}function W5(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(z5(t));return r}function cw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Cn,"").replace(fu,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function hA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function G5(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function H0(t,e,r){var n=t.read_shift(2),i,a=r||{};if(t.l+=2,e!==sw&&n!==e&&S5.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===sw?n:e){case 2:return i=t.read_shift(2,"i"),a.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return cA(t,n,4).replace(Cn,"");case 31:return uA(t);case 64:return av(t);case 65:return hA(t);case 71:return G5(t);case 80:return wg(t,n,!a.raw).replace(Cn,"");case 81:return j5(t,n).replace(Cn,"");case 4108:return W5(t);case 4126:case 4127:return n==4127?$5(t):H5(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function uw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0,c=0,u=-1,h={};for(o=0;o!=i;++o){var d=t.read_shift(4),g=t.read_shift(4);a[o]=[d,g+r]}a.sort(function(F,C){return F[1]-C[1]});var v={};for(o=0;o!=i;++o){if(t.l!==a[o][1]){var y=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,y=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],y=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],y=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(y=!1,t.l=a[o][1]),y)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[a[o][0]];if(v[E.n]=H0(t,E.t,{raw:!0}),E.p==="version"&&(v[E.n]=String(v[E.n]>>16)+"."+("0000"+String(v[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(v[E.n]){case 0:v[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Mi(c=v[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[E.n])}}else if(a[o][0]===1){if(c=v.CodePage=H0(t,iv),Mi(c),u!==-1){var _=t.l;t.l=a[u][1],h=cw(t,c),t.l=_}}else if(a[o][0]===0){if(c===0){u=o,t.l=a[o+1][1];continue}h=cw(t,c)}else{var w=h[a[o][0]],k;switch(t[t.l]){case 65:t.l+=4,k=hA(t);break;case 30:t.l+=4,k=wg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=wg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=lr(t,4);break;case 64:t.l+=4,k=Br(av(t));break;default:throw new Error("unparsed value: "+t[t.l])}v[w]=k}}return t.l=r+n,v}function fw(t,e,r){var n=t.content;if(!n)return{};Kr(n,0);var i,a,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==Et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=uw(n,e),v={SystemIdentifier:h};for(var y in g)v[y]=g[y];if(v.FMTID=a,i===1)return v;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var E;try{E=uw(n,null)}catch{}for(y in E)v[y]=E[y];return v.FMTID=[a,o],v}function Rs(t,e){return t.read_shift(e),null}function K5(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function lr(t,e){return t.read_shift(e)===1}function xr(t){return t.read_shift(2,"u")}function dA(t,e){return K5(t,e,xr)}function q5(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function pf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function X5(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,c,u={};i&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return i&&(t.l+=4*o),n&&(t.l+=c),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function jo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function mf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):jo(t,n,r)}function el(t,e,r){if(r.biff>5)return mf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Y5(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Q5(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Cn,"");return n&&(t.l+=24),i}function J5(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(Cn,"");return r+o}function Z5(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Q5(t);case"0303000000000000c000000000000046":return J5(t);default:throw new Error("Unsupported Moniker "+r)}}function zh(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Cn,""):"";return r}function eV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var a,o,c,u,h="",d,g;i&16&&(a=zh(t,r-t.l)),i&128&&(o=zh(t,r-t.l)),(i&257)===257&&(c=zh(t,r-t.l)),(i&257)===1&&(u=Z5(t,r-t.l)),i&8&&(h=zh(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(g=av(t)),t.l=r;var v=o||c||u||"";v&&h&&(v+="#"+h),v||(v="#"+h),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var y={Target:v};return d&&(y.guid=d),g&&(y.time=g),a&&(y.Tooltip=a),y}function pA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function mA(t,e){var r=pA(t);return r[3]=0,r}function va(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function tV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function rV(t,e,r){return e===0?"":el(t,e,r)}function nV(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,a,o]}function gA(t){var e=t.read_shift(2),r=nv(t);return[e,r]}function iV(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=pf(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,i}function Cd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function vA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var aV=vA;function xA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function sV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function oV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function an(t){t.l+=2,t.l+=t.read_shift(2)}var lV={0:an,4:an,5:an,6:an,7:oV,8:an,9:an,10:an,11:an,12:an,13:sV,14:an,15:an,16:an,17:an,18:an,19:an,20:an,21:xA};function cV(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(lV[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Wh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function uV(t,e){return e===0||t.read_shift(2),1200}function fV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=el(t,0,r);return t.read_shift(e+n-t.l),i}function hV(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dV(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=pf(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function pV(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0;o!=i&&t.l<r;++o)a.push(X5(t));return a.Count=n,a.Unique=i,a}function mV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function gV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function vV(t){var e=tV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function xV(t){return t.read_shift(2),t.read_shift(4)}function hw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function _V(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function yV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function EV(){}function wV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=pf(t,0,r),n}function TV(t){var e=va(t);return e.isst=t.read_shift(4),e}function SV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=va(t);r.biff==2&&t.l++;var a=mf(t,n-t.l,r);return i.val=a,i}function kV(t,e,r){var n=t.read_shift(2),i=el(t,0,r);return[n,i]}var AV=el;function dw(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,a=t.read_shift(i),o=t.read_shift(i),c=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:a,c},e:{r:o,c:u}}}function CV(t){var e=t.read_shift(2),r=t.read_shift(2),n=gA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function IV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(gA(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function RV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function PV(t,e,r,n){var i={},a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return i.patternType=C5[c>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function FV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=PV(t,e,n.fStyle,r),n}function bV(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function pw(t,e,r){var n=va(t);(r.biff==2||e==9)&&++t.l;var i=q5(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function OV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=va(t),i=un(t);return n.val=i,n}var mw=rV;function DV(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=jo(t,a),c=[];n>t.l;)c.push(mf(t));return[a,i,o,c]}function gw(t,e,r){var n=t.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=iV(t,e-2,r)),a.body=i||t.read_shift(e-2),typeof i=="string"&&(a.Name=i),a}var NV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vw(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=jo(t,o,r);i&32&&(h=NV[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:gU(t,d,r,c);return{chKey:a,Name:h,itab:u,rgce:g}}function _A(t,e,r){if(r.biff<8)return LV(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(nV(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function LV(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=pf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function MV(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),a=jo(t,n,r),o=jo(t,i,r);return[a,o]}function VV(t,e,r){var n=vA(t);t.l++;var i=t.read_shift(1);return e-=8,[vU(t,e,r),i,n]}function xw(t,e,r){var n=aV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,pU(t,e,r)]}function BV(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function UV(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=el(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},c,o,a]}}function jV(t,e,r){return UV(t,e,r)}function $V(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cd(t));return r}function HV(t,e,r){if(r&&r.biff<8)return WV(t,e,r);var n=xA(t),i=cV(t,e-22,n[1]);return{cmo:n,ft:i}}var zV={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function WV(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((zV[n]||pn)(t,e,r)),{cmo:[i,n,a],ft:o}}function GV(t,e,r){var n=t.l,i="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=Y5(t,6,r);var c=t.read_shift(2);t.read_shift(2),xr(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=jo(t,t.lens[h+1]-t.lens[h]-1);if(i+=g,i.length>=(d?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function KV(t,e){var r=Cd(t);t.l+=16;var n=eV(t,e-24);return[r,n]}function qV(t,e){t.read_shift(2);var r=Cd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Cn,""),[r,n]}function XV(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ow[r]||r,r=t.read_shift(2),e[1]=ow[r]||r,e}function YV(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(mA(t));return r}function QV(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(mA(t));return r}function JV(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function yA(t,e,r){if(!r.cellStyles)return pn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var h={s:i,e:a,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function ZV(t,e){var r={};return e<32||(t.l+=16,r.header=un(t),r.footer=un(t),t.l+=2),r}function e9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var t9=va,r9=dA,n9=mf;function i9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function a9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=va(t);++t.l;var i=el(t,e-7,r);return n.t="str",n.val=i,n}function s9(t){var e=va(t);++t.l;var r=un(t);return e.t="n",e.val=r,e}function o9(t){var e=va(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function l9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function c9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function u9(t,e,r){var n=t.l+e,i=va(t),a=t.read_shift(2),o=jo(t,a,r);return t.l=n,i.t="str",i.val=o,i}var f9=[2,3,48,49,131,139,140,245],_w=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=q1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=Ys(1);switch(u.type){case"base64":d=Li(ti(c));break;case"binary":d=Li(c);break;case"buffer":case"array":d=c;break}Kr(d,0);var g=d.read_shift(1),v=!!(g&136),y=!1,E=!1;switch(g){case 2:break;case 3:break;case 48:y=!0,v=!0;break;case 49:y=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var _=0,w=521;g==2&&(_=d.read_shift(2)),d.l+=3,g!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),g!=2&&(w=d.read_shift(2));var k=d.read_shift(2),F=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=t[d[d.l]]),d.l+=1,d.l+=2),E&&(d.l+=36);for(var C=[],B={},V=Math.min(d.length,g==2?521:w-10-(y?264:0)),z=E?32:11;d.l<V&&d[d.l]!=13;)switch(B={},B.name=Vu.utils.decode(F,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,B.type=String.fromCharCode(d.read_shift(1)),g!=2&&!E&&(B.offset=d.read_shift(4)),B.len=d.read_shift(1),g==2&&(B.offset=d.read_shift(2)),B.dec=d.read_shift(1),B.name.length&&C.push(B),g!=2&&(d.l+=E?13:14),B.type){case"B":(!y||B.len!=8)&&u.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,R=0;for(h[0]=[],R=0;R!=C.length;++R)h[0][R]=C[R].name;for(;_-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,h[++A]=[],R=0,R=0;R!=C.length;++R){var P=d.slice(d.l,d.l+C[R].len);d.l+=C[R].len,Kr(P,0);var L=Vu.utils.decode(F,P);switch(C[R].type){case"C":L.trim().length&&(h[A][R]=L.replace(/\s+$/,""));break;case"D":L.length===8?h[A][R]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):h[A][R]=L;break;case"F":h[A][R]=parseFloat(L.trim());break;case"+":case"I":h[A][R]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":h[A][R]=!0;break;case"N":case"F":h[A][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[A][R]="##MEMO##"+(E?parseInt(L.trim(),10):P.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(h[A][R]=+L||0);break;case"@":h[A][R]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":h[A][R]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":h[A][R]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][R]=-P.read_shift(-8,"f");break;case"B":if(y&&C[R].len==8){h[A][R]=P.read_shift(8,"f");break}case"G":case"P":P.l+=C[R].len;break;case"0":if(C[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[R].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=C,h}function n(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=wc(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function i(c,u){try{return to(n(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&Mi(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=_g(),g=Rg(c,{header:1,raw:!0,cellDates:!0}),v=g[0],y=g.slice(1),E=c["!cols"]||[],_=0,w=0,k=0,F=1;for(_=0;_<v.length;++_){if(((E[_]||{}).DBF||{}).name){v[_]=E[_].DBF.name,++k;continue}if(v[_]!=null){if(++k,typeof v[_]=="number"&&(v[_]=v[_].toString(10)),typeof v[_]!="string")throw new Error("DBF Invalid column name "+v[_]+" |"+typeof v[_]+"|");if(v.indexOf(v[_])!==_){for(w=0;w<1024;++w)if(v.indexOf(v[_]+"_"+w)==-1){v[_]+="_"+w;break}}}}var C=ar(c["!ref"]),B=[],V=[],z=[];for(_=0;_<=C.e.c-C.s.c;++_){var A="",R="",P=0,L=[];for(w=0;w<y.length;++w)y[w][_]!=null&&L.push(y[w][_]);if(L.length==0||v[_]==null){B[_]="?";continue}for(w=0;w<L.length;++w){switch(typeof L[w]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=L[w]instanceof Date?"D":"C";break;default:R="C"}P=Math.max(P,String(L[w]).length),A=A&&A!=R?"C":R}P>250&&(P=250),R=((E[_]||{}).DBF||{}).type,R=="C"&&E[_].DBF.len>P&&(P=E[_].DBF.len),A=="B"&&R=="N"&&(A="N",z[_]=E[_].DBF.dec,P=E[_].DBF.len),V[_]=A=="C"||R=="N"?P:a[A]||0,F+=V[_],B[_]=A}var M=d.next(32);for(M.write_shift(4,318902576),M.write_shift(4,y.length),M.write_shift(2,296+32*k),M.write_shift(2,F),_=0;_<4;++_)M.write_shift(4,0);for(M.write_shift(4,0|(+e[_k]||3)<<8),_=0,w=0;_<v.length;++_)if(v[_]!=null){var N=d.next(32),U=(v[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,U,"sbcs"),N.write_shift(1,B[_]=="?"?"C":B[_],"sbcs"),N.write_shift(4,w),N.write_shift(1,V[_]||a[B[_]]||0),N.write_shift(1,z[_]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),w+=V[_]||a[B[_]]||0}var be=d.next(264);for(be.write_shift(4,13),_=0;_<65;++_)be.write_shift(4,0);for(_=0;_<y.length;++_){var Ee=d.next(F);for(Ee.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(B[w]){case"L":Ee.write_shift(1,y[_][w]==null?63:y[_][w]?84:70);break;case"B":Ee.write_shift(8,y[_][w]||0,"f");break;case"N":var Ce="0";for(typeof y[_][w]=="number"&&(Ce=y[_][w].toFixed(z[w]||0)),k=0;k<V[w]-Ce.length;++k)Ee.write_shift(1,32);Ee.write_shift(1,Ce,"sbcs");break;case"D":y[_][w]?(Ee.write_shift(4,("0000"+y[_][w].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(y[_][w].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+y[_][w].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Te=String(y[_][w]!=null?y[_][w]:"").slice(0,V[w]);for(Ee.write_shift(1,Te,"sbcs"),k=0;k<V[w]-Te.length;++k)Ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),h9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,y){var E=t[y];return typeof E=="number"?NE(E):E},n=function(v,y,E){var _=y.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return _==59?v:NE(_)};t["|"]=254;function i(v,y){switch(y.type){case"base64":return a(ti(v),y);case"binary":return a(v,y);case"buffer":return a(xt&&Buffer.isBuffer(v)?v.toString("binary"):Yo(v),y);case"array":return a(Uo(v),y)}throw new Error("Unrecognized type "+y.type)}function a(v,y){var E=v.split(/[\n\r]+/),_=-1,w=-1,k=0,F=0,C=[],B=[],V=null,z={},A=[],R=[],P=[],L=0,M;for(+y.codepage>=0&&Mi(+y.codepage);k!==E.length;++k){L=0;var N=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),U=N.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),be=U[0],Ee;if(N.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&B.push(N.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,Te=!1,ye=!1,ie=!1,ve=-1,te=-1;for(F=1;F<U.length;++F)switch(U[F].charAt(0)){case"A":break;case"X":w=parseInt(U[F].slice(1))-1,Te=!0;break;case"Y":for(_=parseInt(U[F].slice(1))-1,Te||(w=0),M=C.length;M<=_;++M)C[M]=[];break;case"K":Ee=U[F].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(Ui(Ee))?isNaN(lc(Ee).getDate())||(Ee=Br(Ee)):(Ee=Ui(Ee),V!==null&&yc(V)&&(Ee=Ad(Ee))),Ce=!0;break;case"E":ie=!0;var O=ql(U[F].slice(1),{r:_,c:w});C[_][w]=[C[_][w],O];break;case"S":ye=!0,C[_][w]=[C[_][w],"S5S"];break;case"G":break;case"R":ve=parseInt(U[F].slice(1))-1;break;case"C":te=parseInt(U[F].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+N)}if(Ce&&(C[_][w]&&C[_][w].length==2?C[_][w][0]=Ee:C[_][w]=Ee,V=null),ye){if(ie)throw new Error("SYLK shared formula cannot have own formula");var re=ve>-1&&C[ve][te];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");C[_][w][1]=PA(re[1],{r:_-ve,c:w-te})}break;case"F":var ee=0;for(F=1;F<U.length;++F)switch(U[F].charAt(0)){case"X":w=parseInt(U[F].slice(1))-1,++ee;break;case"Y":for(_=parseInt(U[F].slice(1))-1,M=C.length;M<=_;++M)C[M]=[];break;case"M":L=parseInt(U[F].slice(1))/20;break;case"F":break;case"G":break;case"P":V=B[parseInt(U[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=U[F].slice(1).split(" "),M=parseInt(P[0],10);M<=parseInt(P[1],10);++M)L=parseInt(P[2],10),R[M-1]=L===0?{hidden:!0}:{wch:L},cc(R[M-1]);break;case"C":w=parseInt(U[F].slice(1))-1,R[w]||(R[w]={});break;case"R":_=parseInt(U[F].slice(1))-1,A[_]||(A[_]={}),L>0?(A[_].hpt=L,A[_].hpx=zu(L)):L===0&&(A[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+N)}ee<1&&(V=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+N)}}return A.length>0&&(z["!rows"]=A),R.length>0&&(z["!cols"]=R),y&&y.sheetRows&&(C=C.slice(0,y.sheetRows)),[C,z]}function o(v,y){var E=i(v,y),_=E[0],w=E[1],k=wc(_,y);return pa(w).forEach(function(F){k[F]=w[F]}),k}function c(v,y){return to(o(v,y),y)}function u(v,y,E,_){var w="C;Y"+(E+1)+";X"+(_+1)+";K";switch(v.t){case"n":w+=v.v||0,v.f&&!v.F&&(w+=";E"+JB(v.f,{r:E,c:_}));break;case"b":w+=v.v?"TRUE":"FALSE";break;case"e":w+=v.w||v.v;break;case"d":w+='"'+(v.w||v.v)+'"';break;case"s":w+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function h(v,y){y.forEach(function(E,_){var w="F;W"+(_+1)+" "+(_+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=W0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=G0(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function d(v,y){y.forEach(function(E,_){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*CA(E.hpx)+";"),w.length>2&&v.push(w+"R"+(_+1))})}function g(v,y){var E=["ID;PWXL;N;E"],_=[],w=ar(v["!ref"]),k,F=Array.isArray(v),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&h(E,v["!cols"]),v["!rows"]&&d(E,v["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var B=w.s.r;B<=w.e.r;++B)for(var V=w.s.c;V<=w.e.c;++V){var z=ot({r:B,c:V});k=F?(v[B]||[])[V]:v[z],!(!k||k.v==null&&(!k.f||k.F))&&_.push(u(k,v,B,V))}return E.join(C)+C+_.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:o,from_sheet:g}}(),d9=function(){function t(a,o){switch(o.type){case"base64":return e(ti(a),o);case"binary":return e(a,o);case"buffer":return e(xt&&Buffer.isBuffer(a)?a.toString("binary"):Yo(a),o);case"array":return e(Uo(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var c=a.split(`
`),u=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++u]=[],h=0;continue}if(!(u<0)){var v=c[d].trim().split(","),y=v[0],E=v[1];++d;for(var _=c[d]||"";(_.match(/["]/g)||[]).length&1&&d<c.length-1;)_+=`
`+c[++d];switch(_=_.trim(),+y){case-1:if(_==="BOT"){g[++u]=[],h=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?g[u][h]=!0:_==="FALSE"?g[u][h]=!1:isNaN(Ui(E))?isNaN(lc(E).getDate())?g[u][h]=E:g[u][h]=Br(E):g[u][h]=Ui(E),++h;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),g[u][h++]=_!==""?_:null;break}if(_==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(a,o){return wc(t(a,o),o)}function n(a,o){return to(r(a,o),o)}var i=function(){var a=function(u,h,d,g,v){u.push(h),u.push(d+","+g),u.push('"'+v.replace(/"/g,'""')+'"')},o=function(u,h,d,g){u.push(h+","+d),u.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var h=[],d=ar(u["!ref"]),g,v=Array.isArray(u);a(h,"TABLE",0,1,"sheetjs"),a(h,"VECTORS",0,d.e.r-d.s.r+1,""),a(h,"TUPLES",0,d.e.c-d.s.c+1,""),a(h,"DATA",0,0,"");for(var y=d.s.r;y<=d.e.r;++y){o(h,-1,0,"BOT");for(var E=d.s.c;E<=d.e.c;++E){var _=ot({r:y,c:E});if(g=v?(u[y]||[])[E]:u[_],!g){o(h,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,w,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=vi(g.z||ft[14],In(Br(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var k=`\r
`,F=h.join(k);return F}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),p9=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,v){for(var y=g.split(`
`),E=-1,_=-1,w=0,k=[];w!==y.length;++w){var F=y[w].trim().split(":");if(F[0]==="cell"){var C=Sn(F[1]);if(k.length<=C.r)for(E=k.length;E<=C.r;++E)k[E]||(k[E]=[]);switch(E=C.r,_=C.c,F[2]){case"t":k[E][_]=t(F[3]);break;case"v":k[E][_]=+F[3];break;case"vtf":var B=F[F.length-1];case"vtc":switch(F[3]){case"nl":k[E][_]=!!+F[4];break;default:k[E][_]=+F[4];break}F[2]=="vtf"&&(k[E][_]=[k[E][_],B])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function n(g,v){return wc(r(g,v),v)}function i(g,v){return to(n(g,v),v)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var v=[],y=[],E,_="",w=Ec(g["!ref"]),k=Array.isArray(g),F=w.s.r;F<=w.e.r;++F)for(var C=w.s.c;C<=w.e.c;++C)if(_=ot({r:F,c:C}),E=k?(g[F]||[])[C]:g[_],!(!E||E.v==null||E.t==="z")){switch(y=["cell",_,"t"],E.t){case"s":case"str":y.push(e(E.v));break;case"n":E.f?(y[2]="vtf",y[3]="n",y[4]=E.v,y[5]=e(E.f)):(y[2]="v",y[3]=E.v);break;case"b":y[2]="vt"+(E.f?"f":"c"),y[3]="nl",y[4]=E.v?"1":"0",y[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var B=In(Br(E.v));y[2]="vtc",y[3]="nd",y[4]=""+B,y[5]=E.w||vi(E.z||ft[14],B);break;case"e":continue}v.push(y.join(":"))}return v.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function d(g){return[a,o,c,o,h(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),$u=function(){function t(d,g,v,y,E){E.raw?g[v][y]=d:d===""||(d==="TRUE"?g[v][y]=!0:d==="FALSE"?g[v][y]=!1:isNaN(Ui(d))?isNaN(lc(d).getDate())?g[v][y]=d:g[v][y]=Br(d):g[v][y]=Ui(d))}function e(d,g){var v=g||{},y=[];if(!d||d.length===0)return y;for(var E=d.split(/[\r\n]/),_=E.length-1;_>=0&&E[_].length===0;)--_;for(var w=10,k=0,F=0;F<=_;++F)k=E[F].indexOf(" "),k==-1?k=E[F].length:k++,w=Math.max(w,k);for(F=0;F<=_;++F){y[F]=[];var C=0;for(t(E[F].slice(0,w).trim(),y,F,C,v),C=1;C<=(E[F].length-w)/10+1;++C)t(E[F].slice(w+(C-1)*10,w+C*10).trim(),y,F,C,v)}return v.sheetRows&&(y=y.slice(0,v.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var g={},v=!1,y=0,E=0;y<d.length;++y)(E=d.charCodeAt(y))==34?v=!v:!v&&E in r&&(g[E]=(g[E]||0)+1);E=[];for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&E.push([g[y],y]);if(!E.length){g=n;for(y in g)Object.prototype.hasOwnProperty.call(g,y)&&E.push([g[y],y])}return E.sort(function(_,w){return _[0]-w[0]||n[_[1]]-n[w[1]]}),r[E.pop()[1]]||44}function a(d,g){var v=g||{},y="",E=v.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(y=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(y=d.charAt(4),d=d.slice(6)):y=i(d.slice(0,1024)):v.FS?y=v.FS:y=i(d.slice(0,1024));var w=0,k=0,F=0,C=0,B=0,V=y.charCodeAt(0),z=!1,A=0,R=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=v.dateNF!=null?k8(v.dateNF):null;function L(){var M=d.slice(C,B),N={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)N.t="z";else if(v.raw)N.t="s",N.v=M;else if(M.trim().length===0)N.t="s",N.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(N.t="s",N.v=M.slice(2,-1).replace(/""/g,'"')):e7(M)?(N.t="n",N.f=M.slice(1)):(N.t="s",N.v=M);else if(M=="TRUE")N.t="b",N.v=!0;else if(M=="FALSE")N.t="b",N.v=!1;else if(!isNaN(F=Ui(M)))N.t="n",v.cellText!==!1&&(N.w=M),N.v=F;else if(!isNaN(lc(M).getDate())||P&&M.match(P)){N.z=v.dateNF||ft[14];var U=0;P&&M.match(P)&&(M=A8(M,v.dateNF,M.match(P)||[]),U=1),v.cellDates?(N.t="d",N.v=Br(M,U)):(N.t="n",N.v=In(Br(M,U))),v.cellText!==!1&&(N.w=vi(N.z,N.v instanceof Date?In(N.v):N.v)),v.cellNF||delete N.z}else N.t="s",N.v=M;if(N.t=="z"||(v.dense?(E[w]||(E[w]=[]),E[w][k]=N):E[ot({c:k,r:w})]=N),C=B+1,R=d.charCodeAt(C),_.e.c<k&&(_.e.c=k),_.e.r<w&&(_.e.r=w),A==V)++k;else if(k=0,++w,v.sheetRows&&v.sheetRows<=w)return!0}e:for(;B<d.length;++B)switch(A=d.charCodeAt(B)){case 34:R===34&&(z=!z);break;case V:case 10:case 13:if(!z&&L())break e;break}return B-C>0&&L(),E["!ref"]=wt(_),E}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):wc(e(d,g),g)}function c(d,g){var v="",y=g.type=="string"?[0,0,0,0]:dv(d,g);switch(g.type){case"base64":v=ti(d);break;case"binary":v=d;break;case"buffer":g.codepage==65001?v=d.toString("utf8"):g.codepage&&typeof Vu<"u"||(v=xt&&Buffer.isBuffer(d)?d.toString("binary"):Yo(d));break;case"array":v=Uo(d);break;case"string":v=d;break;default:throw new Error("Unrecognized type "+g.type)}return y[0]==239&&y[1]==187&&y[2]==191?v=Ut(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=Ut(v):g.type=="binary"&&typeof Vu<"u",v.slice(0,19)=="socialcalc:version:"?p9.to_sheet(g.type=="string"?v:Ut(v),g):o(v,g)}function u(d,g){return to(c(d,g),g)}function h(d){for(var g=[],v=ar(d["!ref"]),y,E=Array.isArray(d),_=v.s.r;_<=v.e.r;++_){for(var w=[],k=v.s.c;k<=v.e.c;++k){var F=ot({r:_,c:k});if(y=E?(d[_]||[])[k]:d[F],!y||y.v==null){w.push("          ");continue}for(var C=(y.w||(Qa(y),y.w)||"").slice(0,10);C.length<10;)C+=" ";w.push(C+(k===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}}();function m9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=h9.to_workbook(t,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return $u.to_workbook(t,e)}}var Su=function(){function t(O,re,ee){if(O){Kr(O,O.l||0);for(var Z=ee.Enum||ve;O.l<O.length;){var ce=O.read_shift(2),_e=Z[ce]||Z[65535],Se=O.read_shift(2),we=O.l+Se,xe=_e.f&&_e.f(O,Se,ee);if(O.l=we,re(xe,_e,ce))return}}}function e(O,re){switch(re.type){case"base64":return r(Li(ti(O)),re);case"binary":return r(Li(O),re);case"buffer":case"array":return r(O,re)}throw"Unsupported type "+re.type}function r(O,re){if(!O)return O;var ee=re||{},Z=ee.dense?[]:{},ce="Sheet1",_e="",Se=0,we={},xe=[],Je=[],Y={s:{r:0,c:0},e:{r:0,c:0}},kt=ee.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)ee.Enum=ve,t(O,function(Ve,Vt,wr){switch(wr){case 0:ee.vers=Ve,Ve>=4096&&(ee.qpro=!0);break;case 6:Y=Ve;break;case 204:Ve&&(_e=Ve);break;case 222:_e=Ve;break;case 15:case 51:ee.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:wr==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=ee.dateNF||ft[14],ee.cellDates&&(Ve[1].t="d",Ve[1].v=Ad(Ve[1].v))),ee.qpro&&Ve[3]>Se&&(Z["!ref"]=wt(Y),we[ce]=Z,xe.push(ce),Z=ee.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Se=Ve[3],ce=_e||"Sheet"+(Se+1),_e="");var ur=ee.dense?(Z[Ve[0].r]||[])[Ve[0].c]:Z[ot(Ve[0])];if(ur){ur.t=Ve[1].t,ur.v=Ve[1].v,Ve[1].z!=null&&(ur.z=Ve[1].z),Ve[1].f!=null&&(ur.f=Ve[1].f);break}ee.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[ot(Ve[0])]=Ve[1];break}},ee);else if(O[2]==26||O[2]==14)ee.Enum=te,O[2]==14&&(ee.qpro=!0,O.l=0),t(O,function(Ve,Vt,wr){switch(wr){case 204:ce=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>Se&&(Z["!ref"]=wt(Y),we[ce]=Z,xe.push(ce),Z=ee.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Se=Ve[3],ce="Sheet"+(Se+1)),kt>0&&Ve[0].r>=kt)break;ee.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[ot(Ve[0])]=Ve[1],Y.e.c<Ve[0].c&&(Y.e.c=Ve[0].c),Y.e.r<Ve[0].r&&(Y.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(Je[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:Je[Ve[0]]=Ve[1],Ve[0]==Se&&(ce=Ve[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(Z["!ref"]=wt(Y),we[_e||ce]=Z,xe.push(_e||ce),!Je.length)return{SheetNames:xe,Sheets:we};for(var ct={},dt=[],ut=0;ut<Je.length;++ut)we[xe[ut]]?(dt.push(Je[ut]||xe[ut]),ct[Je[ut]]=we[Je[ut]]||we[xe[ut]]):(dt.push(Je[ut]),ct[Je[ut]]={"!ref":"A1"});return{SheetNames:dt,Sheets:ct}}function n(O,re){var ee=re||{};if(+ee.codepage>=0&&Mi(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=_g(),ce=ar(O["!ref"]),_e=Array.isArray(O),Se=[];Ni(Z,0,a(1030)),Ni(Z,6,u(ce));for(var we=Math.min(ce.e.r,8191),xe=ce.s.r;xe<=we;++xe)for(var Je=Yr(xe),Y=ce.s.c;Y<=ce.e.c;++Y){xe===ce.s.r&&(Se[Y]=Ir(Y));var kt=Se[Y]+Je,ct=_e?(O[xe]||[])[Y]:O[kt];if(!(!ct||ct.t=="z"))if(ct.t=="n")(ct.v|0)==ct.v&&ct.v>=-32768&&ct.v<=32767?Ni(Z,13,y(xe,Y,ct.v)):Ni(Z,14,_(xe,Y,ct.v));else{var dt=Qa(ct);Ni(Z,15,g(xe,Y,dt.slice(0,239)))}}return Ni(Z,1),Z.end()}function i(O,re){var ee=re||{};if(+ee.codepage>=0&&Mi(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=_g();Ni(Z,0,o(O));for(var ce=0,_e=0;ce<O.SheetNames.length;++ce)(O.Sheets[O.SheetNames[ce]]||{})["!ref"]&&Ni(Z,27,ie(O.SheetNames[ce],_e++));var Se=0;for(ce=0;ce<O.SheetNames.length;++ce){var we=O.Sheets[O.SheetNames[ce]];if(!(!we||!we["!ref"])){for(var xe=ar(we["!ref"]),Je=Array.isArray(we),Y=[],kt=Math.min(xe.e.r,8191),ct=xe.s.r;ct<=kt;++ct)for(var dt=Yr(ct),ut=xe.s.c;ut<=xe.e.c;++ut){ct===xe.s.r&&(Y[ut]=Ir(ut));var Ve=Y[ut]+dt,Vt=Je?(we[ct]||[])[ut]:we[Ve];if(!(!Vt||Vt.t=="z"))if(Vt.t=="n")Ni(Z,23,L(ct,ut,Se,Vt.v));else{var wr=Qa(Vt);Ni(Z,22,A(ct,ut,Se,wr.slice(0,239)))}}++Se}}return Ni(Z,1),Z.end()}function a(O){var re=Cr(2);return re.write_shift(2,O),re}function o(O){var re=Cr(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var ee=0,Z=0,ce=0,_e=0;_e<O.SheetNames.length;++_e){var Se=O.SheetNames[_e],we=O.Sheets[Se];if(!(!we||!we["!ref"])){++ce;var xe=Ec(we["!ref"]);ee<xe.e.r&&(ee=xe.e.r),Z<xe.e.c&&(Z=xe.e.c)}}return ee>8191&&(ee=8191),re.write_shift(2,ee),re.write_shift(1,ce),re.write_shift(1,Z),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function c(O,re,ee){var Z={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&ee.qpro?(Z.s.c=O.read_shift(1),O.l++,Z.s.r=O.read_shift(2),Z.e.c=O.read_shift(1),O.l++,Z.e.r=O.read_shift(2),Z):(Z.s.c=O.read_shift(2),Z.s.r=O.read_shift(2),re==12&&ee.qpro&&(O.l+=2),Z.e.c=O.read_shift(2),Z.e.r=O.read_shift(2),re==12&&ee.qpro&&(O.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(O){var re=Cr(8);return re.write_shift(2,O.s.c),re.write_shift(2,O.s.r),re.write_shift(2,O.e.c),re.write_shift(2,O.e.r),re}function h(O,re,ee){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(Z[0].c=O.read_shift(1),Z[3]=O.read_shift(1),Z[0].r=O.read_shift(2),O.l+=2):(Z[2]=O.read_shift(1),Z[0].c=O.read_shift(2),Z[0].r=O.read_shift(2)),Z}function d(O,re,ee){var Z=O.l+re,ce=h(O,re,ee);if(ce[1].t="s",ee.vers==20768){O.l++;var _e=O.read_shift(1);return ce[1].v=O.read_shift(_e,"utf8"),ce}return ee.qpro&&O.l++,ce[1].v=O.read_shift(Z-O.l,"cstr"),ce}function g(O,re,ee){var Z=Cr(7+ee.length);Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,O),Z.write_shift(1,39);for(var ce=0;ce<Z.length;++ce){var _e=ee.charCodeAt(ce);Z.write_shift(1,_e>=128?95:_e)}return Z.write_shift(1,0),Z}function v(O,re,ee){var Z=h(O,re,ee);return Z[1].v=O.read_shift(2,"i"),Z}function y(O,re,ee){var Z=Cr(7);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,O),Z.write_shift(2,ee,"i"),Z}function E(O,re,ee){var Z=h(O,re,ee);return Z[1].v=O.read_shift(8,"f"),Z}function _(O,re,ee){var Z=Cr(13);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,O),Z.write_shift(8,ee,"f"),Z}function w(O,re,ee){var Z=O.l+re,ce=h(O,re,ee);if(ce[1].v=O.read_shift(8,"f"),ee.qpro)O.l=Z;else{var _e=O.read_shift(2);B(O.slice(O.l,O.l+_e),ce),O.l+=_e}return ce}function k(O,re,ee){var Z=re&32768;return re&=-32769,re=(Z?O:0)+(re>=8192?re-16384:re),(Z?"":"$")+(ee?Ir(re):Yr(re))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function B(O,re){Kr(O,0);for(var ee=[],Z=0,ce="",_e="",Se="",we="";O.l<O.length;){var xe=O[O.l++];switch(xe){case 0:ee.push(O.read_shift(8,"f"));break;case 1:_e=k(re[0].c,O.read_shift(2),!0),ce=k(re[0].r,O.read_shift(2),!1),ee.push(_e+ce);break;case 2:{var Je=k(re[0].c,O.read_shift(2),!0),Y=k(re[0].r,O.read_shift(2),!1);_e=k(re[0].c,O.read_shift(2),!0),ce=k(re[0].r,O.read_shift(2),!1),ee.push(Je+Y+":"+_e+ce)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(O.read_shift(2));break;case 6:{for(var kt="";xe=O[O.l++];)kt+=String.fromCharCode(xe);ee.push('"'+kt.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:we=ee.pop(),Se=ee.pop(),ee.push(["AND","OR"][xe-20]+"("+Se+","+we+")");break;default:if(xe<32&&C[xe])we=ee.pop(),Se=ee.pop(),ee.push(Se+C[xe]+we);else if(F[xe]){if(Z=F[xe][1],Z==69&&(Z=O[O.l++]),Z>ee.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+ee.join("|")+"|");return}var ct=ee.slice(-Z);ee.length-=Z,ee.push(F[xe][0]+"("+ct.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}ee.length==1?re[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function V(O){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=O.read_shift(2),re[3]=O[O.l++],re[0].c=O[O.l++],re}function z(O,re){var ee=V(O);return ee[1].t="s",ee[1].v=O.read_shift(re-4,"cstr"),ee}function A(O,re,ee,Z){var ce=Cr(6+Z.length);ce.write_shift(2,O),ce.write_shift(1,ee),ce.write_shift(1,re),ce.write_shift(1,39);for(var _e=0;_e<Z.length;++_e){var Se=Z.charCodeAt(_e);ce.write_shift(1,Se>=128?95:Se)}return ce.write_shift(1,0),ce}function R(O,re){var ee=V(O);ee[1].v=O.read_shift(2);var Z=ee[1].v>>1;if(ee[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return ee[1].v=Z,ee}function P(O,re){var ee=V(O),Z=O.read_shift(4),ce=O.read_shift(4),_e=O.read_shift(2);if(_e==65535)return Z===0&&ce===3221225472?(ee[1].t="e",ee[1].v=15):Z===0&&ce===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Se=_e&32768;return _e=(_e&32767)-16446,ee[1].v=(1-Se*2)*(ce*Math.pow(2,_e+32)+Z*Math.pow(2,_e)),ee}function L(O,re,ee,Z){var ce=Cr(14);if(ce.write_shift(2,O),ce.write_shift(1,ee),ce.write_shift(1,re),Z==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var _e=0,Se=0,we=0,xe=0;return Z<0&&(_e=1,Z=-Z),Se=Math.log2(Z)|0,Z/=Math.pow(2,Se-31),xe=Z>>>0,xe&2147483648||(Z/=2,++Se,xe=Z>>>0),Z-=xe,xe|=2147483648,xe>>>=0,Z*=Math.pow(2,32),we=Z>>>0,ce.write_shift(4,we),ce.write_shift(4,xe),Se+=16383+(_e?32768:0),ce.write_shift(2,Se),ce}function M(O,re){var ee=P(O);return O.l+=re-14,ee}function N(O,re){var ee=V(O),Z=O.read_shift(4);return ee[1].v=Z>>6,ee}function U(O,re){var ee=V(O),Z=O.read_shift(8,"f");return ee[1].v=Z,ee}function be(O,re){var ee=U(O);return O.l+=re-10,ee}function Ee(O,re){return O[O.l+re-1]==0?O.read_shift(re,"cstr"):""}function Ce(O,re){var ee=O[O.l++];ee>re-1&&(ee=re-1);for(var Z="";Z.length<ee;)Z+=String.fromCharCode(O[O.l++]);return Z}function Te(O,re,ee){if(!(!ee.qpro||re<21)){var Z=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ce=O.read_shift(re-21,"cstr");return[Z,ce]}}function ye(O,re){for(var ee={},Z=O.l+re;O.l<Z;){var ce=O.read_shift(2);if(ce==14e3){for(ee[ce]=[0,""],ee[ce][0]=O.read_shift(2);O[O.l];)ee[ce][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return ee}function ie(O,re){var ee=Cr(5+O.length);ee.write_shift(2,14e3),ee.write_shift(2,re);for(var Z=0;Z<O.length;++Z){var ce=O.charCodeAt(Z);ee[ee.l++]=ce>127?95:ce}return ee[ee.l++]=0,ee}var ve={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function g9(t){var e={},r=t.match(mn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=H1[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return e}var v9=function(){var t=Uu("t"),e=Uu("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:St(o[1])},u=a.match(e);return u&&(c.s=g9(u[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(c){return c.v})}}(),x9=function(){var e=/(\r\n|\n)/g;function r(i,a,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),a.push('<span style="'+c.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),_9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,y9=/<(?:\w+:)?r>/,E9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function sv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=St(Ut(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ut(t),r&&(n.h=Y1(n.t))):t.match(y9)&&(n.r=Ut(t),n.t=St(Ut((t.replace(E9,"").match(_9)||[]).join("").replace(mn,""))),r&&(n.h=x9(v9(n.r)))),n):{t:""}}var w9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,T9=/<(?:\w+:)?(?:si|sstItem)>/g,S9=/<\/(?:\w+:)?(?:si|sstItem)>/;function k9(t,e){var r=[],n="";if(!t)return r;var i=t.match(w9);if(i){n=i[2].replace(T9,"").split(S9);for(var a=0;a!=n.length;++a){var o=sv(n[a].trim(),e);o!=null&&(r[r.length]=o)}i=tt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function A9(t){return[t.read_shift(4),t.read_shift(4)]}function C9(t,e){var r=[],n=!1;return ts(t,function(a,o,c){switch(c){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function EA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Wa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function I9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function R9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),a=[];i-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function P9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(R9(t));return e}function F9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function b9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function O9(t){var e=b9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function wA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function TA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function D9(t){var e=Wa(t);switch(e.Minor){case 2:return[e.Minor,N9(t)];case 3:return[e.Minor,L9()];case 4:return[e.Minor,M9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function N9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=wA(t,r),i=TA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function L9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function M9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(mn,function(a){var o=tt(a);switch(ga(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function V9(t,e){var r={},n=r.EncryptionVersionInfo=Wa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=wA(t,i),e-=i,r.EncryptionVerifier=TA(t,e),r}function B9(t){var e={},r=e.EncryptionVersionInfo=Wa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function U9(t){var e=0,r,n=EA(t),i=n.length+1,a,o,c,u,h;for(r=Ys(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],c=e&16384?1:0,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var SA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,c){return n(o^c)},a=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=EA(o),u=a(c),h=c.length,d=Ys(16),g=0;g!=16;++g)d[g]=0;var v,y,E;for((h&1)===1&&(v=u>>8,d[h]=i(t[0],v),--h,v=u&255,y=c[c.length-1],d[h]=i(y,v));h>0;)--h,v=u>>8,d[h]=i(c[h],v),--h,v=u&255,d[h]=i(c[h],v);for(h=15,E=15-c.length;E>0;)v=u>>8,d[h]=i(t[E],v),--h,--E,v=u&255,d[h]=i(c[h],v),--h,--E;return d}}(),j9=function(t,e,r,n,i){i||(i=e),n||(n=SA(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},$9=function(t){var e=0,r=SA(t);return function(n){var i=j9("",n,e,r);return e=i[1],i[0]}};function H9(t,e,r,n){var i={key:xr(t),verificationBytes:xr(t)};return r.password&&(i.verifier=U9(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=$9(r.password)),i}function z9(t,e,r){var n=r;return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=B9(t):n.Data=V9(t,e),n}function W9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?z9(t,e-2,n):H9(t,r.biff>=8?e:e-2,r,n),n}var G9=function(){function t(i,a){switch(a.type){case"base64":return e(ti(i),a);case"binary":return e(i,a);case"buffer":return e(xt&&Buffer.isBuffer(i)?i.toString("binary"):Yo(i),a);case"array":return e(Uo(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var o=a||{},c=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var v=/\\\w+\b/g,y=0,E,_=-1;E=v.exec(d);){switch(E[0]){case"\\cell":var w=d.slice(y,v.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var k={v:w,t:"s"};Array.isArray(c)?c[g][_]=k:c[ot({r:g,c:_})]=k}break}y=v.lastIndex}_>h.e.c&&(h.e.c=_)}),c["!ref"]=wt(h),c}function r(i,a){return to(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=ar(i["!ref"]),c,u=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=ot({r:h,c:d});c=u?(i[h]||[])[d]:i[g],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(Qa(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function K9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Hu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function q9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),a=Math.min(e,r,n),o=i-a;if(o===0)return[0,0,e];var c=0,u=0,h=i+a;switch(u=o/(h>1?2-h:h),i){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,u,h/2]}function X9(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=i*c,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-c),o[0]+=u,o[1]+=i;break;case 2:u=i*(c-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-c),o[1]+=u,o[2]+=i;break;case 4:u=i*(c-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-c),o[2]+=u,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function z0(t,e){if(e===0)return t;var r=q9(K9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Hu(X9(r))}var kA=6,Y9=15,Q9=1,Tn=kA;function W0(t){return Math.floor((t+Math.round(128/Tn)/256)*Tn)}function G0(t){return Math.floor((t-5)/Tn*100+.5)/100}function Tg(t){return Math.round((t*Tn+5)/Tn*256)/256}function bm(t){return Tg(G0(W0(t)))}function ov(t){var e=Math.abs(t-bm(t)),r=Tn;if(e>.005)for(Tn=Q9;Tn<Y9;++Tn)Math.abs(t-bm(t))<=e&&(e=Math.abs(t-bm(t)),r=Tn);Tn=r}function cc(t){t.width?(t.wpx=W0(t.width),t.wch=G0(t.wpx),t.MDW=Tn):t.wpx?(t.wch=G0(t.wpx),t.width=Tg(t.wch),t.MDW=Tn):typeof t.wch=="number"&&(t.width=Tg(t.wch),t.wpx=W0(t.width),t.MDW=Tn),t.customWidth&&delete t.customWidth}var J9=96,AA=J9;function CA(t){return t*96/AA}function zu(t){return t*AA/96}var Z9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eB(t,e,r,n){e.Borders=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=Yt(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=Yt(c.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in borders")}})}function tB(t,e,r,n){e.Fills=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fills")}})}function rB(t,e,r,n){e.Fonts=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Ut(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?Yt(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?Yt(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?Yt(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?Yt(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?Yt(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?Yt(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?Yt(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=H1[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=Yt(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var u=Oo[i.color.index];i.color.index==81&&(u=Oo[1]),u||(u=Oo[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=z0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fonts")}})}function nB(t,e,r){e.NumberFmt=[];for(var n=pa(ft),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ft[n[i]];var a=t[0].match(mn);if(a)for(i=0;i<a.length;++i){var o=tt(a[i]);switch(ga(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=St(Ut(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}bo(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Gh=["numFmtId","fillId","fontId","borderId","xfId"],Kh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function iB(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(mn)||[]).forEach(function(a){var o=tt(a),c=0;switch(ga(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<Gh.length;++c)n[Gh[c]]&&(n[Gh[c]]=parseInt(n[Gh[c]],10));for(c=0;c<Kh.length;++c)n[Kh[c]]&&(n[Kh[c]]=Yt(n[Kh[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Yt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var aB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&nB(g,d,h),(g=c.match(i))&&rB(g,d,u,h),(g=c.match(n))&&tB(g,d,u,h),(g=c.match(a))&&eB(g,d,u,h),(g=c.match(r))&&iB(g,d,h),d}}();function sB(t,e){var r=t.read_shift(2),n=hn(t);return[r,n]}function oB(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=v5(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=g5(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=hn(t),n}var lB=pn;function cB(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var uB=pn;function fB(t,e,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return ts(t,function(u,h,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],bo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=z0(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(h.T>0)a.push(d);else if(h.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var hB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dB(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(mn)||[]).forEach(function(i){var a=tt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[hB.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function pB(){}function mB(){}var gB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,xB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function _B(t,e,r){e.themeElements={};var n;[["clrScheme",gB,dB],["fontScheme",vB,pB],["fmtScheme",xB,mB]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var yB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function IA(t,e){(!t||t.length===0)&&(t=EB());var r,n={};if(!(r=t.match(yB)))throw new Error("themeElements not found in theme");return _B(r[0],n,e),n.raw=t,n}function EB(t,e){var r=[Bk];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wB(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=Vk(a,{type:"array"})}catch{return}var c=Jn(o,"theme/theme/theme1.xml",!0);if(c)return IA(c,r)}}function TB(t){return t.read_shift(4)}function SB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=kB(t,4);break;case 2:e.xclrValue=pA(t);break;case 3:e.xclrValue=TB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function kB(t,e){return pn(t,e)}function AB(t,e){return pn(t,e)}function CB(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=SB(t);break;case 6:n[1]=AB(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function IB(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),a=[];i-- >0;)a.push(CB(t,r-t.l));return{ixfe:n,ext:a}}function RB(t,e){e.forEach(function(r){switch(r[0]){}})}function PB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:hn(t)}}function FB(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function bB(t){return t.l+=4,t.read_shift(4)!=0}function OB(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,c=2;return ts(t,function(u,h,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function DB(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,a=2,o;return t.replace(mn,function(c){var u=tt(c);switch(ga(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function NB(t){var e=[];if(!t)return e;var r=1;return(t.match(mn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function LB(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function MB(t,e,r){var n=[];return ts(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function VB(t,e,r,n){if(!t)return t;var i=n||{},a=!1;ts(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function BB(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function yw(t,e,r,n){var i=Array.isArray(t),a;e.forEach(function(o){var c=Sn(o.ref);if(i?(t[c.r]||(t[c.r]=[]),a=t[c.r][c.c]):a=t[o.ref],!a){a={t:"z"},i?t[c.r][c.c]=a:t[o.ref]=a;var u=ar(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=wt(u);h!==t["!ref"]&&(t["!ref"]=h)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=a.c.length-1;g>=0;--g){if(!r&&a.c[g].T)return;r&&!a.c[g].T&&a.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}a.c.push(d)})}function UB(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=tt(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Sn(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!g&&!!g[1]&&sv(g[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=v.h),n.push(h)}}}}),n}function jB(t,e){var r=[],n=!1,i={},a=0;return t.replace(mn,function(c,u){var h=tt(c);switch(ga(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+c.length;break;case"</text>":i.t=t.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function $B(t,e){var r=[],n=!1;return t.replace(mn,function(a){var o=tt(a);switch(ga(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function HB(t){var e={};e.iauthor=t.read_shift(4);var r=Jo(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}var zB=hn;function WB(t,e){var r=[],n=[],i={},a=!1;return ts(t,function(c,u,h){switch(h){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}var GB="application/vnd.ms-office.vbaProject";function KB(t){var e=Et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Et.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Et.write(e)}function qB(){return{"!type":"dialog"}}function XB(){return{"!type":"dialog"}}function YB(){return{"!type":"macro"}}function QB(){return{"!type":"macro"}}var ql=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,o){var c=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,i+(c?"":"$")+Ir(d)+(u?"":"$")+Yr(h)}return function(i,a){return e=a,i.replace(t,r)}}(),RA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,JB=function(){return function(e,r){return e.replace(RA,function(n,i,a,o,c,u){var h=ev(o)-(a?0:r.c),d=Z1(u)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",v=h==0?"":a?h+1:"["+h+"]";return i+"R"+g+"C"+v})}}();function PA(t,e){return t.replace(RA,function(r,n,i,a,o,c){return n+(i=="$"?i+a:Ir(ev(a)+e.c))+(o=="$"?o+c:Yr(Z1(c)+e.r))})}function ZB(t,e,r){var n=Ec(e),i=n.s,a=Sn(r),o={r:a.r-i.r,c:a.c-i.c};return PA(t,o)}function e7(t){return t.length!=1}function Ew(t){return t.replace(/_xlfn\./g,"")}function mr(t){t.l+=1}function Qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function FA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return bA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),o=Qs(t),c=Qs(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function bA(t){var e=Qs(t),r=Qs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function t7(t,e,r){if(r.biff<8)return bA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=Qs(t),o=Qs(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function OA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return r7(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Qs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function r7(t){var e=Qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function n7(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function i7(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return a7(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function a7(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function s7(t,e,r){var n=(t[t.l++]&96)>>5,i=FA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function o7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=FA(t,a,r);return[n,i,o]}function l7(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function c7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function u7(t,e,r){var n=(t[t.l++]&96)>>5,i=t7(t,e-1,r);return[n,i]}function f7(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ww(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function h7(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function d7(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function p7(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function m7(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function g7(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function DA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function v7(t){return t.read_shift(2),DA(t)}function x7(t){return t.read_shift(2),DA(t)}function _7(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=OA(t,0,r);return[n,i]}function y7(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=i7(t,0,r);return[n,i]}function E7(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=OA(t,0,r);return[n,i,a]}function w7(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[TU[i],MA[i],n]}function T7(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:S7(t);return[i,(a[0]===0?MA:wU)[a[1]]]}function S7(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function k7(t,e,r){t.l+=r&&r.biff==2?3:4}function A7(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function C7(t){return t.l++,Zo[t.read_shift(1)]}function I7(t){return t.l++,t.read_shift(2)}function R7(t){return t.l++,t.read_shift(1)!==0}function P7(t){return t.l++,un(t)}function F7(t,e,r){return t.l++,pf(t,e-1,r)}function b7(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=lr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Zo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=un(t);break;case 2:r[1]=el(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function O7(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Jo:Cd)(t));return i}function D7(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=b7(t,r.biff);return o}function N7(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function L7(t,e,r){if(r.biff==5)return M7(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function M7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function V7(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function B7(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function U7(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function j7(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var $7=pn,H7=pn,z7=pn;function gf(t,e,r){return t.l+=2,[n7(t)]}function lv(t){return t.l+=6,[]}var W7=gf,G7=lv,K7=lv,q7=gf;function NA(t){return t.l+=2,[xr(t),t.read_shift(2)&1]}var X7=gf,Y7=NA,Q7=lv,J7=gf,Z7=gf,eU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),o=eU[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:a}}function rU(t){return t.l+=2,[t.read_shift(4)]}function nU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function iU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function aU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function sU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function oU(t){return t.l+=4,[0,0]}var Tw={1:{n:"PtgExp",f:A7},2:{n:"PtgTbl",f:z7},3:{n:"PtgAdd",f:mr},4:{n:"PtgSub",f:mr},5:{n:"PtgMul",f:mr},6:{n:"PtgDiv",f:mr},7:{n:"PtgPower",f:mr},8:{n:"PtgConcat",f:mr},9:{n:"PtgLt",f:mr},10:{n:"PtgLe",f:mr},11:{n:"PtgEq",f:mr},12:{n:"PtgGe",f:mr},13:{n:"PtgGt",f:mr},14:{n:"PtgNe",f:mr},15:{n:"PtgIsect",f:mr},16:{n:"PtgUnion",f:mr},17:{n:"PtgRange",f:mr},18:{n:"PtgUplus",f:mr},19:{n:"PtgUminus",f:mr},20:{n:"PtgPercent",f:mr},21:{n:"PtgParen",f:mr},22:{n:"PtgMissArg",f:mr},23:{n:"PtgStr",f:F7},26:{n:"PtgSheet",f:nU},27:{n:"PtgEndSheet",f:iU},28:{n:"PtgErr",f:C7},29:{n:"PtgBool",f:R7},30:{n:"PtgInt",f:I7},31:{n:"PtgNum",f:P7},32:{n:"PtgArray",f:f7},33:{n:"PtgFunc",f:w7},34:{n:"PtgFuncVar",f:T7},35:{n:"PtgName",f:N7},36:{n:"PtgRef",f:_7},37:{n:"PtgArea",f:s7},38:{n:"PtgMemArea",f:V7},39:{n:"PtgMemErr",f:$7},40:{n:"PtgMemNoMem",f:H7},41:{n:"PtgMemFunc",f:B7},42:{n:"PtgRefErr",f:U7},43:{n:"PtgAreaErr",f:l7},44:{n:"PtgRefN",f:y7},45:{n:"PtgAreaN",f:u7},46:{n:"PtgMemAreaN",f:aU},47:{n:"PtgMemNoMemN",f:sU},57:{n:"PtgNameX",f:L7},58:{n:"PtgRef3d",f:E7},59:{n:"PtgArea3d",f:o7},60:{n:"PtgRefErr3d",f:j7},61:{n:"PtgAreaErr3d",f:c7},255:{}},lU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cU={1:{n:"PtgElfLel",f:NA},2:{n:"PtgElfRw",f:J7},3:{n:"PtgElfCol",f:W7},6:{n:"PtgElfRwV",f:Z7},7:{n:"PtgElfColV",f:q7},10:{n:"PtgElfRadical",f:X7},11:{n:"PtgElfRadicalS",f:Q7},13:{n:"PtgElfColS",f:G7},15:{n:"PtgElfColSV",f:K7},16:{n:"PtgElfRadicalLel",f:Y7},25:{n:"PtgList",f:tU},29:{n:"PtgSxName",f:rU},255:{}},uU={0:{n:"PtgAttrNoop",f:oU},1:{n:"PtgAttrSemi",f:g7},2:{n:"PtgAttrIf",f:p7},4:{n:"PtgAttrChoose",f:h7},8:{n:"PtgAttrGoto",f:d7},16:{n:"PtgAttrSum",f:k7},32:{n:"PtgAttrBaxcel",f:ww},33:{n:"PtgAttrBaxcel",f:ww},64:{n:"PtgAttrSpace",f:v7},65:{n:"PtgAttrSpaceSemi",f:x7},128:{n:"PtgAttrIfError",f:m7},255:{}};function vf(t,e,r,n){if(n.biff<8)return pn(t,e);for(var i=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=D7(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=O7(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&a.push(pn(t,e)),a}function xf(t,e,r){for(var n=t.l+e,i,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],i=Tw[a]||Tw[lU[a]],(a===24||a===25)&&(i=(a===24?cU:uU)[t[t.l+1]]),!i||!i.f?pn(t,e):o.push([i.n,i.f(t,e,r)]);return o}function fU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var hU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function LA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sw(t,e,r){var n=LA(t,e,r);return n=="#REF"?n:dU(n,r)}function ln(t,e,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],u,h,d,g=0,v=0,y,E="";if(!t[0]||!t[0][0])return"";for(var _=-1,w="",k=0,F=t[0].length;k<F;++k){var C=t[0][k];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),_>=0){switch(t[0][_][1][0]){case 0:w=nr(" ",t[0][_][1][1]);break;case 1:w=nr("\r",t[0][_][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}h=h+w,_=-1}c.push(h+hU[C[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=yu(C[1][1],o,i),c.push(Eu(d,a));break;case"PtgRefN":d=r?yu(C[1][1],r,i):C[1][1],c.push(Eu(d,a));break;case"PtgRef3d":g=C[1][1],d=yu(C[1][2],o,i),E=Sw(n,g,i),c.push(E+"!"+Eu(d,a));break;case"PtgFunc":case"PtgFuncVar":var B=C[1][0],V=C[1][1];B||(B=0),B&=127;var z=B==0?[]:c.slice(-B);c.length-=B,V==="User"&&(V=z.shift()),c.push(V+"("+z.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":y=iw(C[1][1],r?{s:r}:o,i),c.push(Pm(y,i));break;case"PtgArea":y=iw(C[1][1],o,i),c.push(Pm(y,i));break;case"PtgArea3d":g=C[1][1],y=C[1][2],E=Sw(n,g,i),c.push(E+"!"+Pm(y,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var A=(n.names||[])[v-1]||(n[0]||[])[v],R=A?A.Name:"SH33TJSNAME"+String(v);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),c.push(R);break;case"PtgNameX":var P=C[1][1];v=C[1][2];var L;if(i.biff<=5)P<0&&(P=-P),n[P]&&(L=n[P][v]);else{var M="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][v]&&n[P][v].itab>0&&(M=n.SheetNames[n[P][v].itab-1]+"!"):M=n.SheetNames[v-1]+"!"),n[P]&&n[P][v])M+=n[P][v].Name;else if(n[0]&&n[0][v])M+=n[0][v].Name;else{var N=(LA(n,P,i)||"").split(";;");N[v-1]?M=N[v-1]:M+="SH33TJSERRX"}c.push(M);break}L||(L={Name:"SH33TJSERRY"}),c.push(L.Name);break;case"PtgParen":var U="(",be=")";if(_>=0){switch(w="",t[0][_][1][0]){case 2:U=nr(" ",t[0][_][1][1])+U;break;case 3:U=nr("\r",t[0][_][1][1])+U;break;case 4:be=nr(" ",t[0][_][1][1])+be;break;case 5:be=nr("\r",t[0][_][1][1])+be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][_][1][0])}_=-1}c.push(U+c.pop()+be);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:C[1][1],r:C[1][0]};var Ee={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var Ce=n.sharedf[ot(d)];c.push(ln(Ce,o,Ee,n,i))}else{var Te=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(ln(h[1],o,Ee,n,i)),Te=!0;break}Te||c.push(C[1])}break;case"PtgArray":c.push("{"+fU(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&ye.indexOf(t[0][k][0])==-1){C=t[0][_];var ie=!0;switch(C[1][0]){case 4:ie=!1;case 0:w=nr(" ",C[1][1]);break;case 5:ie=!1;case 1:w=nr("\r",C[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((ie?w:"")+c.pop()+(ie?"":w)),_=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function pU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],pn(t,e-2)];var c=xf(t,o,r);return e!==o+i&&(a=vf(t,e-o-i,c,r)),t.l=n,[c,a]}function mU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],pn(t,e-2)];var c=xf(t,o,r);return e!==o+i&&(a=vf(t,e-o-i,c,r)),t.l=n,[c,a]}function gU(t,e,r,n){var i=t.l+e,a=xf(t,n,r),o;return i!==t.l&&(o=vf(t,i-t.l,a,r)),[a,o]}function vU(t,e,r){var n=t.l+e,i,a=t.read_shift(2),o=xf(t,a,r);return a==65535?[[],pn(t,e-2)]:(e!==a+2&&(i=vf(t,n-a-2,o,r)),[o,i])}function xU(t){var e;if(Ua(t,t.l+6)!==65535)return[un(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Om(t,e,r){var n=t.l+e,i=va(t);r.biff==2&&++t.l;var a=xU(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=mU(t,n-t.l,r);return{cell:i,val:a[0],formula:c,shared:o>>3&1,tt:a[1]}}function Id(t,e,r){var n=t.read_shift(4),i=xf(t,n,r),a=t.read_shift(4),o=a>0?vf(t,a,i,r):null;return[i,o]}var _U=Id,Rd=Id,yU=Id,EU=Id,wU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},MA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Dm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var ku={},Xl={};function Au(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function VA(t,e,r,n,i,a){try{n.cellNF&&(t.z=ft[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Br(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ft[e]==null&&bo(S8[e]||"General",e),t.t==="e")t.w=t.w||Zo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bu(t.v);else if(t.t==="d"){var o=In(t.v);(o|0)===o?t.w=o.toString(10):t.w=Bu(o)}else{if(t.v===void 0)return"";t.w=Bo(t.v,Xl)}else t.t==="d"?t.w=vi(e,In(t.v),Xl):t.w=vi(e,t.v,Xl)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=z0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=z0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&a.Fills)throw c}}}function SU(t,e){var r=ar(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=wt(r))}var kU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,AU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,CU=/<(?:\w:)?hyperlink [^>]*>/mg,IU=/"(\w*:\w*)"/,RU=/<(?:\w:)?col\b[^>]*[\/]?>/g,PU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,FU=/<(?:\w:)?pageMargins[^>]*\/>/g,BA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function DU(t,e,r,n,i,a,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(AU);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var v=h.match(BA);v?cv(v[0],c,i,r):(v=h.match(bU))&&NU(v[0],v[1]||"",c,i,r);var y=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var E=h.slice(y,y+50).match(IU);E&&SU(c,E[1])}var _=h.match(OU);_&&_[1]&&jU(_[1],i);var w=[];if(e.cellStyles){var k=h.match(RU);k&&VU(w,k)}g&&$U(g[1],c,e,u,a,o);var F=d.match(PU);F&&(c["!autofilter"]=BU(F[0]));var C=[],B=d.match(kU);if(B)for(y=0;y!=B.length;++y)C[y]=ar(B[y].slice(B[y].indexOf('"')+1));var V=d.match(CU);V&&LU(c,V,n);var z=d.match(FU);if(z&&(c["!margins"]=MU(tt(z[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=wt(u)),e.sheetRows>0&&c["!ref"]){var A=ar(c["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=wt(A))}return w.length>0&&(c["!cols"]=w),C.length>0&&(c["!merges"]=C),c}function cv(t,e,r,n){var i=tt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=St(Ut(i.codeName)))}function NU(t,e,r,n,i){cv(t.slice(0,t.indexOf(">")),r,n,i)}function LU(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var a=tt(Ut(e[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+St(a.location))):(a.Target="#"+St(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var c=ar(a.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=ot({c:h,r:u});n?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function MU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function VU(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=tt(e[n],!0);i.hidden&&(i.hidden=Yt(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ov(i.width)),cc(i);a<=o;)t[a++]=Xr(i)}}function BU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var UU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jU(t,e){e.Views||(e.Views=[{}]),(t.match(UU)||[]).forEach(function(r,n){var i=tt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Yt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var $U=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Uu("v"),o=Uu("f");return function(u,h,d,g,v,y){for(var E=0,_="",w=[],k=[],F=0,C=0,B=0,V="",z,A,R=0,P=0,L,M,N=0,U=0,be=Array.isArray(y.CellXf),Ee,Ce=[],Te=[],ye=Array.isArray(h),ie=[],ve={},te=!1,O=!!d.sheetStubs,re=u.split(e),ee=0,Z=re.length;ee!=Z;++ee){_=re[ee].trim();var ce=_.length;if(ce!==0){var _e=0;e:for(E=0;E<ce;++E)switch(_[E]){case">":if(_[E-1]!="/"){++E;break e}if(d&&d.cellStyles){if(A=tt(_.slice(_e,E),!0),R=A.r!=null?parseInt(A.r,10):R+1,P=-1,d.sheetRows&&d.sheetRows<R)continue;ve={},te=!1,A.ht&&(te=!0,ve.hpt=parseFloat(A.ht),ve.hpx=zu(ve.hpt)),A.hidden=="1"&&(te=!0,ve.hidden=!0),A.outlineLevel!=null&&(te=!0,ve.level=+A.outlineLevel),te&&(ie[R-1]=ve)}break;case"<":_e=E;break}if(_e>=E)break;if(A=tt(_.slice(_e,E),!0),R=A.r!=null?parseInt(A.r,10):R+1,P=-1,!(d.sheetRows&&d.sheetRows<R)){g.s.r>R-1&&(g.s.r=R-1),g.e.r<R-1&&(g.e.r=R-1),d&&d.cellStyles&&(ve={},te=!1,A.ht&&(te=!0,ve.hpt=parseFloat(A.ht),ve.hpx=zu(ve.hpt)),A.hidden=="1"&&(te=!0,ve.hidden=!0),A.outlineLevel!=null&&(te=!0,ve.level=+A.outlineLevel),te&&(ie[R-1]=ve)),w=_.slice(E).split(t);for(var Se=0;Se!=w.length&&w[Se].trim().charAt(0)=="<";++Se);for(w=w.slice(Se),E=0;E!=w.length;++E)if(_=w[E].trim(),_.length!==0){if(k=_.match(r),F=E,C=0,B=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,k!=null&&k.length===2){for(F=0,V=k[1],C=0;C!=V.length&&!((B=V.charCodeAt(C)-64)<1||B>26);++C)F=26*F+B;--F,P=F}else++P;for(C=0;C!=_.length&&_.charCodeAt(C)!==62;++C);if(++C,A=tt(_.slice(0,C),!0),A.r||(A.r=ot({r:R-1,c:P})),V=_.slice(C),z={t:""},(k=V.match(a))!=null&&k[1]!==""&&(z.v=St(k[1])),d.cellFormula){if((k=V.match(o))!=null&&k[1]!==""){if(z.f=St(Ut(k[1])).replace(/\r\n/g,`
`),d.xlfn||(z.f=Ew(z.f)),k[0].indexOf('t="array"')>-1)z.F=(V.match(i)||[])[1],z.F.indexOf(":")>-1&&Ce.push([ar(z.F),z.F]);else if(k[0].indexOf('t="shared"')>-1){M=tt(k[0]);var we=St(Ut(k[1]));d.xlfn||(we=Ew(we)),Te[parseInt(M.si,10)]=[M,we,A.r]}}else(k=V.match(/<f[^>]*\/>/))&&(M=tt(k[0]),Te[M.si]&&(z.f=ZB(Te[M.si][1],Te[M.si][2],A.r)));var xe=Sn(A.r);for(C=0;C<Ce.length;++C)xe.r>=Ce[C][0].s.r&&xe.r<=Ce[C][0].e.r&&xe.c>=Ce[C][0].s.c&&xe.c<=Ce[C][0].e.c&&(z.F=Ce[C][1])}if(A.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(O)z.t="z";else continue;else z.t=A.t||"n";switch(g.s.c>P&&(g.s.c=P),g.e.c<P&&(g.e.c=P),z.t){case"n":if(z.v==""||z.v==null){if(!O)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!O)continue;z.t="z"}else L=ku[parseInt(z.v,10)],z.v=L.t,z.r=L.r,d.cellHTML&&(z.h=L.h);break;case"str":z.t="s",z.v=z.v!=null?Ut(z.v):"",d.cellHTML&&(z.h=Y1(z.v));break;case"inlineStr":k=V.match(n),z.t="s",k!=null&&(L=sv(k[1]))?(z.v=L.t,d.cellHTML&&(z.h=L.h)):z.v="";break;case"b":z.v=Yt(z.v);break;case"d":d.cellDates?z.v=Br(z.v,1):(z.v=In(Br(z.v,1)),z.t="n");break;case"e":(!d||d.cellText!==!1)&&(z.w=z.v),z.v=sA[z.v];break}if(N=U=0,Ee=null,be&&A.s!==void 0&&(Ee=y.CellXf[A.s],Ee!=null&&(Ee.numFmtId!=null&&(N=Ee.numFmtId),d.cellStyles&&Ee.fillId!=null&&(U=Ee.fillId))),VA(z,N,U,d,v,y),d.cellDates&&be&&z.t=="n"&&yc(ft[N])&&(z.t="d",z.v=Ad(z.v)),A.cm&&d.xlmeta){var Je=(d.xlmeta.Cell||[])[+A.cm-1];Je&&Je.type=="XLDAPR"&&(z.D=!0)}if(ye){var Y=Sn(A.r);h[Y.r]||(h[Y.r]=[]),h[Y.r][Y.c]=z}else h[A.r]=z}}}}ie.length>0&&(h["!rows"]=ie)}}();function HU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var zU=Jo;function WU(){}function GU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=p5(t),r}function KU(t){var e=xi(t);return[e]}function qU(t){var e=Qo(t);return[e]}function XU(t){var e=xi(t),r=t.read_shift(1);return[e,r,"b"]}function YU(t){var e=Qo(t),r=t.read_shift(1);return[e,r,"b"]}function QU(t){var e=xi(t),r=t.read_shift(1);return[e,r,"e"]}function JU(t){var e=Qo(t),r=t.read_shift(1);return[e,r,"e"]}function ZU(t){var e=xi(t),r=t.read_shift(4);return[e,r,"s"]}function ej(t){var e=Qo(t),r=t.read_shift(4);return[e,r,"s"]}function tj(t){var e=xi(t),r=un(t);return[e,r,"n"]}function UA(t){var e=Qo(t),r=un(t);return[e,r,"n"]}function rj(t){var e=xi(t),r=nv(t);return[e,r,"n"]}function nj(t){var e=Qo(t),r=nv(t);return[e,r,"n"]}function ij(t){var e=xi(t),r=tv(t);return[e,r,"is"]}function aj(t){var e=xi(t),r=hn(t);return[e,r,"str"]}function sj(t){var e=Qo(t),r=hn(t);return[e,r,"str"]}function oj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"b"];if(r.cellFormula){t.l+=2;var c=Rd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function lj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"e"];if(r.cellFormula){t.l+=2;var c=Rd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function cj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=un(t),o=[i,a,"n"];if(r.cellFormula){t.l+=2;var c=Rd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function uj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=hn(t),o=[i,a,"str"];if(r.cellFormula){t.l+=2;var c=Rd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}var fj=Jo;function hj(t,e){var r=t.l+e,n=Jo(t),i=rv(t),a=hn(t),o=hn(t),c=hn(t);t.l=r;var u={rfx:n,relId:i,loc:a,display:c};return o&&(u.Tooltip=o),u}function dj(){}function pj(t,e,r){var n=t.l+e,i=nA(t),a=t.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var c=_U(t,n-t.l,r);o[1]=c}else t.l=n;return o}function mj(t,e,r){var n=t.l+e,i=Jo(t),a=[i];if(r.cellFormula){var o=EU(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}var gj=["left","right","top","bottom","header","footer"];function vj(t){var e={};return gj.forEach(function(r){e[r]=un(t)}),e}function xj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function _j(){}function yj(){}function Ej(t,e,r,n,i,a,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,v=!1,y,E,_,w,k,F,C,B,V,z=[];c.biff=12,c["!row"]=0;var A=0,R=!1,P=[],L={},M=c.supbooks||i.supbooks||[[]];if(M.sharedf=L,M.arrayf=P,M.SheetNames=i.SheetNames||i.Sheets.map(function(ye){return ye.name}),!c.supbooks&&(c.supbooks=M,i.Names))for(var N=0;N<i.Names.length;++N)M[0][N+1]=i.Names[N];var U=[],be=[],Ee=!1;K0[16]={n:"BrtShortReal",f:UA};var Ce;if(ts(t,function(ie,ve,te){if(!v)switch(te){case 148:h=ie;break;case 0:y=ie,c.sheetRows&&c.sheetRows<=y.r&&(v=!0),B=Yr(w=y.r),c["!row"]=y.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=zu(ie.hpt)),be[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:ie[2]},ie[2]){case"n":E.v=ie[1];break;case"s":C=ku[ie[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!ie[1];break;case"e":E.v=ie[1],c.cellText!==!1&&(E.w=Zo[E.v]);break;case"str":E.t="s",E.v=ie[1];break;case"is":E.t="s",E.v=ie[1].t;break}if((_=o.CellXf[ie[0].iStyleRef])&&VA(E,_.numFmtId,null,c,a,o),k=ie[0].c==-1?k+1:ie[0].c,c.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Ir(k)+B]=E,c.cellFormula){for(R=!1,A=0;A<P.length;++A){var O=P[A];y.r>=O[0].s.r&&y.r<=O[0].e.r&&k>=O[0].s.c&&k<=O[0].e.c&&(E.F=wt(O[0]),R=!0)}!R&&ie.length>3&&(E.f=ie[3])}if(d.s.r>y.r&&(d.s.r=y.r),d.s.c>k&&(d.s.c=k),d.e.r<y.r&&(d.e.r=y.r),d.e.c<k&&(d.e.c=k),c.cellDates&&_&&E.t=="n"&&yc(ft[_.numFmtId])){var re=Po(E.v);re&&(E.t="d",E.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;E={t:"z",v:void 0},k=ie[0].c==-1?k+1:ie[0].c,c.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Ir(k)+B]=E,d.s.r>y.r&&(d.s.r=y.r),d.s.c>k&&(d.s.c=k),d.e.r<y.r&&(d.e.r=y.r),d.e.c<k&&(d.e.c=k),Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 176:z.push(ie);break;case 49:Ce=((c.xlmeta||{}).Cell||[])[ie-1];break;case 494:var ee=n["!id"][ie.relId];for(ee?(ie.Target=ee.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=ee):ie.relId==""&&(ie.Target="#"+ie.loc),w=ie.rfx.s.r;w<=ie.rfx.e.r;++w)for(k=ie.rfx.s.c;k<=ie.rfx.e.c;++k)c.dense?(u[w]||(u[w]=[]),u[w][k]||(u[w][k]={t:"z",v:void 0}),u[w][k].l=ie):(F=ot({c:k,r:w}),u[F]||(u[F]={t:"z",v:void 0}),u[F].l=ie);break;case 426:if(!c.cellFormula)break;P.push(ie),V=c.dense?u[w][k]:u[Ir(k)+B],V.f=ln(ie[1],d,{r:y.r,c:k},M,c),V.F=wt(ie[0]);break;case 427:if(!c.cellFormula)break;L[ot(ie[0].s)]=ie[1],V=c.dense?u[w][k]:u[Ir(k)+B],V.f=ln(ie[1],d,{r:y.r,c:k},M,c);break;case 60:if(!c.cellStyles)break;for(;ie.e>=ie.s;)U[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Ee||(Ee=!0,ov(ie.w/256)),cc(U[ie.e+1]);break;case 161:u["!autofilter"]={ref:wt(ie)};break;case 476:u["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(u["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!ve.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=wt(h||d)),c.sheetRows&&u["!ref"]){var Te=ar(u["!ref"]);c.sheetRows<=+Te.e.r&&(Te.e.r=c.sheetRows-1,Te.e.r>d.e.r&&(Te.e.r=d.e.r),Te.e.r<Te.s.r&&(Te.s.r=Te.e.r),Te.e.c>d.e.c&&(Te.e.c=d.e.c),Te.e.c<Te.s.c&&(Te.s.c=Te.e.c),u["!fullref"]=u["!ref"],u["!ref"]=wt(Te))}return z.length>0&&(u["!merges"]=z),U.length>0&&(u["!cols"]=U),be.length>0&&(u["!rows"]=be),u}function wj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=St((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,i,n]}function Tj(t,e,r,n,i,a){var o=a||{"!type":"chart"};if(!t)return a;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var v=wj(g);d.s.r=d.s.c=0,d.e.c=c,h=Ir(c),v[0].forEach(function(y,E){o[h+Yr(E)]={t:"n",v:y,z:v[1]},u=E}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=wt(d)),o}function Sj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(BA);return c&&cv(c[0],a,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function kj(t,e){t.l+=10;var r=hn(t);return{name:r}}function Aj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ts(t,function(u,h,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var jA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Cj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ij=[],Rj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Aw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var a=e[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Yt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Cw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Yt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function $A(t){Cw(t.WBProps,jA),Cw(t.CalcPr,Rj),Aw(t.WBView,Cj),Aw(t.Sheets,Ij),Xl.date1904=Yt(t.WBProps.date1904)}var Pj="][*?/\\".split("");function Fj(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Pj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var bj=/<\w+:workbook/;function Oj(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(t.replace(mn,function(u,h){var d=tt(u);switch(ga(d[0])){case"<?xml":break;case"<workbook":u.match(bj)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jA.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Yt(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Ut(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=St(Ut(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ut(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Yt(d.hidden||"0")&&(a.Hidden=!0),o=h+u.length;break;case"</definedName>":a.Ref=St(Ut(t.slice(o,h))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Q8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return $A(r),r}function Dj(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=yg(t),r.name=hn(t),r}function Nj(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?hn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Lj(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Mj(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=m5(t),o=yU(t,0,r),c=rv(t);t.l=n;var u={Name:a,Ptg:o};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function Vj(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],K0[16]={n:"BrtFRTArchID$",f:Lj},ts(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=ln(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),$A(r),r.Names=a,r.supbooks=o,r}function Bj(t,e,r){return e.slice(-4)===".bin"?Vj(t,r):Oj(t,r)}function Uj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Ej(t,n,r,i,a,o,c):DU(t,n,r,i,a,o,c)}function jj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Aj(t,n,r,i,a):Sj(t,n,r,i,a)}function $j(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?YB():QB()}function Hj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?qB():XB()}function zj(t,e,r,n){return e.slice(-4)===".bin"?fB(t,r,n):aB(t,r,n)}function Wj(t,e,r){return IA(t,r)}function Gj(t,e,r){return e.slice(-4)===".bin"?C9(t,r):k9(t,r)}function Kj(t,e,r){return e.slice(-4)===".bin"?WB(t,r):UB(t,r)}function qj(t,e,r){return e.slice(-4)===".bin"?MB(t):NB(t)}function Xj(t,e,r,n){return r.slice(-4)===".bin"?VB(t,e,r,n):void 0}function Yj(t,e,r){return e.slice(-4)===".bin"?OB(t,e,r):DB(t,e,r)}var HA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Di(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(HA),a,o,c,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(zA),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),n[c]=a[2].slice(1,a[2].length-1));return n}function Qj(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(HA),i,a,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(zA),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Cu;function Jj(t,e){var r=Cu[t]||St(t);return r==="General"?Bo(e):vi(r,e)}function Zj(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Yt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Br(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[St(e)]=i}function e$(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Zo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bu(t.v):t.w=Bo(t.v):t.w=Jj(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Cu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&yc(n)){var i=Po(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function t$(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Z9[n.Pattern]||n.Pattern)}t[e.ID]=e}function r$(t,e,r,n,i,a,o,c,u,h){var d="General",g=n.StyleID,v={};h=h||{};var y=[],E=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);a[g]!==void 0&&(a[g].nf&&(d=a[g].nf),a[g].Interior&&y.push(a[g].Interior),!!a[g].Parent);)g=a[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Yt(t);break;case"String":n.t="s",n.r=XE(St(t)),n.v=t.indexOf("<")>-1?St(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Br(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=St(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sA[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=XE(e||t));break}if(e$(n,d,h),h.cellFormula!==!1)if(n.Formula){var _=St(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=ql(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ql("RC:RC",i):n.ArrayRange&&(n.F=ql(n.ArrayRange,i),u.push([ar(n.F),n.F]))}else for(E=0;E<u.length;++E)i.r>=u[E][0].s.r&&i.r<=u[E][0].e.r&&i.c>=u[E][0].s.c&&i.c<=u[E][0].e.c&&(n.F=u[E][1]);h.cellStyles&&(y.forEach(function(w){!v.patternType&&w.patternType&&(v.patternType=w.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function n$(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Nm(t,e){var r=e||{};bk();var n=uu(Q1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ut(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Xr(r);return o.type="string",$u.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Vt){i.indexOf("<"+Vt)>=0&&(a=!0)}),a)return h$(n,r);Cu={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},g=[],v=r.dense?[]:{},y="",E={},_={},w=Di('<Data ss:Type="String">'),k=0,F=0,C=0,B={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},z={},A="",R=0,P=[],L={},M={},N=0,U=[],be=[],Ee={},Ce=[],Te,ye=!1,ie=[],ve=[],te={},O=0,re=0,ee={Sheets:[],WBProps:{date1904:!1}},Z={};ju.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";c=ju.exec(n);)switch(c[3]=(ce=c[3]).toLowerCase()){case"data":if(ce=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?r$(n.slice(k,c.index),A,w,u[u.length-1][0]=="comment"?Ee:E,{c:F,r:C},V,Ce[F],_,ie,r):(A="",w=Di(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(be.length>0&&(E.c=be),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(v[C]||(v[C]=[]),v[C][F]=E):v[Ir(F)+Yr(C)]=E),E.HRef&&(E.l={Target:St(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(O=F+(parseInt(E.MergeAcross,10)|0),re=C+(parseInt(E.MergeDown,10)|0),P.push({s:{c:F,r:C},e:{c:O,r:re}})),!r.sheetStubs)E.MergeAcross?F=O+1:++F;else if(E.MergeAcross||E.MergeDown){for(var _e=F;_e<=O;++_e)for(var Se=C;Se<=re;++Se)(_e>F||Se>C)&&(r.dense?(v[Se]||(v[Se]=[]),v[Se][_e]={t:"z"}):v[Ir(_e)+Yr(Se)]={t:"z"});F=O+1}else++F;else E=Qj(c[0]),E.Index&&(F=+E.Index-1),F<B.s.c&&(B.s.c=F),F>B.e.c&&(B.e.c=F),c[0].slice(-2)==="/>"&&++F,be=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<B.s.r&&(B.s.r=C),C>B.e.r&&(B.e.r=C),c[0].slice(-2)==="/>"&&(_=Di(c[0]),_.Index&&(C=+_.Index-1)),F=0,++C):(_=Di(c[0]),_.Index&&(C=+_.Index-1),te={},(_.AutoFitHeight=="0"||_.Height)&&(te.hpx=parseInt(_.Height,10),te.hpt=CA(te.hpx),ve[C]=te),_.Hidden=="1"&&(te.hidden=!0,ve[C]=te));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(y),B.s.r<=B.e.r&&B.s.c<=B.e.c&&(v["!ref"]=wt(B),r.sheetRows&&r.sheetRows<=B.e.r&&(v["!fullref"]=v["!ref"],B.e.r=r.sheetRows-1,v["!ref"]=wt(B))),P.length&&(v["!merges"]=P),Ce.length>0&&(v["!cols"]=Ce),ve.length>0&&(v["!rows"]=ve),d[y]=v}else B={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=F=0,u.push([c[3],!1]),h=Di(c[0]),y=St(h.Name),v=r.dense?[]:{},P=[],ie=[],ve=[],Z={name:y,Hidden:0},ee.Sheets.push(Z);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Ce=[],ye=!1}break;case"style":c[1]==="/"?t$(V,z,r):z=Di(c[0]);break;case"numberformat":z.nf=St(Di(c[0]).Format||"General"),Cu[z.nf]&&(z.nf=Cu[z.nf]);for(var we=0;we!=392&&ft[we]!=z.nf;++we);if(we==392){for(we=57;we!=392;++we)if(ft[we]==null){bo(z.nf,we);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Te=Di(c[0]),Te.Hidden&&(Te.hidden=!0,delete Te.Hidden),Te.Width&&(Te.wpx=parseInt(Te.Width,10)),!ye&&Te.wpx>10){ye=!0,Tn=kA;for(var xe=0;xe<Ce.length;++xe)Ce[xe]&&cc(Ce[xe])}ye&&cc(Te),Ce[Te.Index-1||Ce.length]=Te;for(var Je=0;Je<+Te.Span;++Je)Ce[Ce.length]=Xr(Te);break;case"namedrange":if(c[1]==="/")break;ee.Names||(ee.Names=[]);var Y=tt(c[0]),kt={Name:Y.Name,Ref:ql(Y.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(kt.Sheet=ee.Sheets.length-1),ee.Names.push(kt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(R,c.index):R=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Di(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?U5(L,ce,n.slice(N,c.index)):N=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));n$(Ee),be.push(Ee)}else u.push([c[3],!1]),h=Di(c[0]),Ee={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ct=Di(c[0]);v["!autofilter"]={ref:ql(ct.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return Ow(n,r);var dt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(N,c.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else N=c.index+c[0].length;break;case"header":v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+tt(c[0]).Margin)||(v["!margins"].header=+tt(c[0]).Margin);break;case"footer":v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+tt(c[0]).Margin)||(v["!margins"].footer=+tt(c[0]).Margin);break;case"pagemargins":var ut=tt(c[0]);v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+ut.Top)||(v["!margins"].top=+ut.Top),isNaN(+ut.Left)||(v["!margins"].left=+ut.Left),isNaN(+ut.Right)||(v["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(v["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?Zj(M,ce,U,n.slice(N,c.index)):(U=c,N=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Ve={};return!r.bookSheets&&!r.bookProps&&(Ve.Sheets=d),Ve.SheetNames=g,Ve.Workbook=ee,Ve.SSF=Xr(ft),Ve.Props=L,Ve.Custprops=M,Ve}function Sg(t,e){switch(hv(e=e||{}),e.type||"base64"){case"base64":return Nm(ti(t),e);case"binary":case"buffer":case"file":return Nm(t,e);case"array":return Nm(Yo(t),e)}}function i$(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=x5(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=_5(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var a$=[60,1084,2066,2165,2175];function s$(t,e,r,n,i){var a=n,o=[],c=r.slice(r.l,r.l+a);if(i.enc&&i.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),r.l+=a;for(var u=Ua(r,r.l),h=kg[u],d=0;h!=null&&a$.indexOf(u)>-1;)a=Ua(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+a),o.push(c),r.l+=4+a,h=kg[u=Ua(r,r.l)];var g=Os(o);Kr(g,0);var v=0;g.lens=[];for(var y=0;y<o.length;++y)g.lens.push(v),v+=o[y].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,i)}function na(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ft[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Zo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Bu(t.v):t.w=Bo(t.v):t.w=vi(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&yc(ft[n]||String(n))){var i=Po(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function qh(t,e,r){return{v:t,ixfe:e,t:r}}function o$(t,e){var r={opts:{}},n={},i=e.dense?[]:{},a={},o={},c=null,u=[],h="",d={},g,v="",y,E,_,w,k={},F=[],C,B,V=[],z=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},P=function(rt){return rt<8?Oo[rt]:rt<64&&z[rt-8]||Oo[rt]},L=function(rt,Ot,hr){var Ht=Ot.XF.data;if(!(!Ht||!Ht.patternType||!hr||!hr.cellStyles)){Ot.s={},Ot.s.patternType=Ht.patternType;var $n;($n=Hu(P(Ht.icvFore)))&&(Ot.s.fgColor={rgb:$n}),($n=Hu(P(Ht.icvBack)))&&(Ot.s.bgColor={rgb:$n})}},M=function(rt,Ot,hr){if(!(te>1)&&!(hr.sheetRows&&rt.r>=hr.sheetRows)){if(hr.cellStyles&&Ot.XF&&Ot.XF.data&&L(rt,Ot,hr),delete Ot.ixfe,delete Ot.XF,g=rt,v=ot(rt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<o.s.r&&(o.s.r=rt.r),rt.c<o.s.c&&(o.s.c=rt.c),rt.r+1>o.e.r&&(o.e.r=rt.r+1),rt.c+1>o.e.c&&(o.e.c=rt.c+1),hr.cellFormula&&Ot.f){for(var Ht=0;Ht<F.length;++Ht)if(!(F[Ht][0].s.c>rt.c||F[Ht][0].s.r>rt.r)&&!(F[Ht][0].e.c<rt.c||F[Ht][0].e.r<rt.r)){Ot.F=wt(F[Ht][0]),(F[Ht][0].s.c!=rt.c||F[Ht][0].s.r!=rt.r)&&delete Ot.f,Ot.f&&(Ot.f=""+ln(F[Ht][1],o,rt,ie,N));break}}hr.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=Ot):i[v]=Ot}},N={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var U,be=[],Ee=[],Ce=[],Te=[],ye=!1,ie=[];ie.SheetNames=N.snames,ie.sharedf=N.sharedf,ie.arrayf=N.arrayf,ie.names=[],ie.XTI=[];var ve=0,te=0,O=0,re=[],ee=[],Z;N.codepage=1200,Mi(1200);for(var ce=!1;t.l<t.length-1;){var _e=t.l,Se=t.read_shift(2);if(Se===0&&ve===10)break;var we=t.l===t.length?0:t.read_shift(2),xe=kg[Se];if(xe&&xe.f){if(e.bookSheets&&ve===133&&Se!==133)break;if(ve=Se,xe.r===2||xe.r==12){var Je=t.read_shift(2);if(we-=2,!N.enc&&Je!==Se&&((Je&255)<<8|Je>>8)!==Se)throw new Error("rt mismatch: "+Je+"!="+Se);xe.r==12&&(t.l+=10,we-=10)}var Y={};if(Se===10?Y=xe.f(t,we,N):Y=s$(Se,xe,t,we,N),te==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(Se){case 34:r.opts.Date1904=A.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=Y,!e.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=Y;break;case 66:var kt=Number(Y);switch(kt){case 21010:kt=1200;break;case 32768:kt=1e4;break;case 32769:kt=1252;break}Mi(N.codepage=kt),ce=!0;break;case 317:N.rrtabid=Y;break;case 25:N.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:N.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(i["!type"]="dialog"),Y.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),Y.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(Y);break;case 430:ie.push([Y]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(Y);break;case 24:case 536:Z={Name:Y.Name,Ref:ln(Y.rgce,o,null,ie,N)},Y.itab>0&&(Z.Sheet=Y.itab-1),ie.names.push(Z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(ee[Y.itab-1]={ref:wt(Y.rgce[0][0][1][2])});break;case 22:N.ExternCount=Y;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(Y),ie.XTI=ie.XTI.concat(Y);break;case 2196:if(N.biff<8)break;Z!=null&&(Z.Comment=Y[1]);break;case 18:i["!protect"]=Y;break;case 19:Y!==0&&N.WTF&&console.error("Password verifier: "+Y);break;case 133:a[Y.pos]=Y,N.snames.push(Y.name);break;case 10:{if(--te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=wt(o),e.sheetRows&&e.sheetRows<=o.e.r){var ct=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=wt(o),o.e.r=ct}o.e.r++,o.e.c++}be.length>0&&(i["!merges"]=be),Ee.length>0&&(i["!objects"]=Ee),Ce.length>0&&(i["!cols"]=Ce),Te.length>0&&(i["!rows"]=Te),A.Sheets.push(R)}h===""?d=i:n[h]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[Se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),N.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(N.biff=5,ce=!0,Mi(N.codepage=28591)),N.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(N.biff=2),te++)break;if(i=e.dense?[]:{},N.biff<8&&!ce&&(ce=!0,Mi(N.codepage=e.codepage||1252)),N.biff<5||Y.BIFFVer==0&&Y.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:t.l-we,name:h};a[dt.pos]=dt,N.snames.push(h)}else h=(a[_e]||{name:""}).name;Y.dt==32&&(i["!type"]="chart"),Y.dt==64&&(i["!type"]="macro"),be=[],Ee=[],N.arrayf=F=[],Ce=[],Te=[],ye=!1,R={Hidden:(a[_e]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[Y.r]||[])[Y.c]:i[ot({c:Y.c,r:Y.r})])&&++Y.c,C={ixfe:Y.ixfe,XF:V[Y.ixfe]||{},v:Y.val,t:"n"},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e);break;case 5:case 517:C={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.val,t:Y.t},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e);break;case 638:C={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.rknum,t:"n"},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e);break;case 189:for(var ut=Y.c;ut<=Y.C;++ut){var Ve=Y.rkrec[ut-Y.c][0];C={ixfe:Ve,XF:V[Ve],v:Y.rkrec[ut-Y.c][1],t:"n"},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:ut,r:Y.r},C,e)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(C=qh(Y.val,Y.cell.ixfe,Y.tt),C.XF=V[C.ixfe],e.cellFormula){var Vt=Y.formula;if(Vt&&Vt[0]&&Vt[0][0]&&Vt[0][0][0]=="PtgExp"){var wr=Vt[0][0][1][0],ur=Vt[0][0][1][1],Tr=ot({r:wr,c:ur});k[Tr]?C.f=""+ln(Y.formula,o,Y.cell,ie,N):C.F=((e.dense?(i[wr]||[])[ur]:i[Tr])||{}).F}else C.f=""+ln(Y.formula,o,Y.cell,ie,N)}O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M(Y.cell,C,e),c=Y}break;case 7:case 519:if(c)c.val=Y,C=qh(Y,c.cell.ixfe,"s"),C.XF=V[C.ixfe],e.cellFormula&&(C.f=""+ln(c.formula,o,c.cell,ie,N)),O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(Y);var _i=ot(Y[0].s);if(y=e.dense?(i[Y[0].s.r]||[])[Y[0].s.c]:i[_i],e.cellFormula&&y){if(!c||!_i||!y)break;y.f=""+ln(Y[1],o,Y[0],ie,N),y.F=wt(Y[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!c)break;k[ot(c.cell)]=Y[0],y=e.dense?(i[c.cell.r]||[])[c.cell.c]:i[ot(c.cell)],(y||{}).f=""+ln(Y[0],o,g,ie,N)}}break;case 253:C=qh(u[Y.isst].t,Y.ixfe,"s"),u[Y.isst].h&&(C.h=u[Y.isst].h),C.XF=V[C.ixfe],O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Y.ixfe,XF:V[Y.ixfe],t:"z"},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e));break;case 190:if(e.sheetStubs)for(var gn=Y.c;gn<=Y.C;++gn){var fr=Y.ixfe[gn-Y.c];C={ixfe:fr,XF:V[fr],t:"z"},O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:gn,r:Y.r},C,e)}break;case 214:case 516:case 4:C=qh(Y.val,Y.ixfe,"s"),C.XF=V[C.ixfe],O>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),M({c:Y.c,r:Y.r},C,e);break;case 0:case 512:te===1&&(o=Y);break;case 252:u=Y;break;case 1054:if(N.biff==4){re[O++]=Y[1];for(var vn=0;vn<O+163&&ft[vn]!=Y[1];++vn);vn>=163&&bo(Y[1],O+163)}else bo(Y[1],Y[0]);break;case 30:{re[O++]=Y;for(var Lt=0;Lt<O+163&&ft[Lt]!=Y;++Lt);Lt>=163&&bo(Y,O+163)}break;case 229:be=be.concat(Y);break;case 93:Ee[Y.cmo[0]]=N.lastobj=Y;break;case 438:N.lastobj.TxO=Y;break;case 127:N.lastobj.ImData=Y;break;case 440:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(_=Y[0].s.c;_<=Y[0].e.c;++_)y=e.dense?(i[w]||[])[_]:i[ot({c:_,r:w})],y&&(y.l=Y[1]);break;case 2048:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(_=Y[0].s.c;_<=Y[0].e.c;++_)y=e.dense?(i[w]||[])[_]:i[ot({c:_,r:w})],y&&y.l&&(y.l.Tooltip=Y[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;y=e.dense?(i[Y[0].r]||[])[Y[0].c]:i[ot(Y[0])];var jt=Ee[Y[2]];y||(e.dense?(i[Y[0].r]||(i[Y[0].r]=[]),y=i[Y[0].r][Y[0].c]={t:"z"}):y=i[ot(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),y.c||(y.c=[]),E={a:Y[1],t:jt.TxO.t},y.c.push(E)}break;case 2173:RB(V[Y.ixfe],Y.ext);break;case 125:{if(!N.cellStyles)break;for(;Y.e>=Y.s;)Ce[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},ye||(ye=!0,ov(Y.w/256)),cc(Ce[Y.e+1])}break;case 520:{var $t={};Y.level!=null&&(Te[Y.r]=$t,$t.level=Y.level),Y.hidden&&(Te[Y.r]=$t,$t.hidden=!0),Y.hpt&&(Te[Y.r]=$t,$t.hpt=Y.hpt,$t.hpx=zu(Y.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Au(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Se]]=Y;break;case 161:i["!margins"]||Au(i["!margins"]={}),i["!margins"].header=Y.header,i["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(A.Views[0].RTL=!0);break;case 146:z=Y;break;case 2198:U=Y;break;case 140:B=Y;break;case 442:h?R.CodeName=Y||R.name:A.WBProps.CodeName=Y||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+Se.toString(16)),t.l+=we}return r.SheetNames=pa(a).sort(function(Jr,rt){return Number(Jr)-Number(rt)}).map(function(Jr){return a[Jr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&ee.forEach(function(Jr,rt){r.Sheets[r.SheetNames[rt]]["!autofilter"]=Jr}),r.Strings=u,r.SSF=Xr(ft),N.enc&&(r.Encryption=N.enc),U&&(r.Themes=U),r.Metadata={},B!==void 0&&(r.Metadata.Country=B),ie.names.length>0&&(A.Names=ie.names),r.Workbook=A,r}var Iw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l$(t,e,r){var n=Et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=fw(n,k5,Iw.DSI);for(var a in i)e[a]=i[a]}catch(h){if(r.WTF)throw h}var o=Et.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=fw(o,A5,Iw.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(lA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function WA(t,e){e||(e={}),hv(e),yk(),e.codepage&&z1(e.codepage);var r,n;if(t.FullPaths){if(Et.find(t,"/encryption"))throw new Error("File is password-protected");r=Et.find(t,"!CompObj"),n=Et.find(t,"/Workbook")||Et.find(t,"/Book")}else{switch(e.type){case"base64":t=Li(ti(t));break;case"binary":t=Li(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Kr(t,0),n={content:t}}var i,a;if(r&&i$(r),e.bookProps&&!e.bookSheets)i={};else{var o=xt?"buffer":"array";if(n&&n.content)i=o$(n.content,e);else if((a=Et.find(t,"PerfectOffice_MAIN"))&&a.content)i=Su.to_workbook(a.content,(e.type=o,e));else if((a=Et.find(t,"NativeContent_MAIN"))&&a.content)i=Su.to_workbook(a.content,(e.type=o,e));else throw(a=Et.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=KB(t))}var c={};return t.FullPaths&&l$(t,c,e),i.Props=i.Custprops=c,e.bookFiles&&(i.cfb=t),i}var K0={0:{f:HU},1:{f:KU},2:{f:rj},3:{f:QU},4:{f:XU},5:{f:tj},6:{f:aj},7:{f:ZU},8:{f:uj},9:{f:cj},10:{f:oj},11:{f:lj},12:{f:qU},13:{f:nj},14:{f:JU},15:{f:YU},16:{f:UA},17:{f:sj},18:{f:ej},19:{f:tv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Mj},40:{},42:{},43:{f:oB},44:{f:sB},45:{f:lB},46:{f:uB},47:{f:cB},48:{},49:{f:f5},50:{},51:{f:FB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yA},62:{f:ij},63:{f:LB},64:{f:_j},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GU},148:{f:zU,p:16},151:{f:dj},152:{},153:{f:Nj},154:{},155:{},156:{f:Dj},157:{},158:{},159:{T:1,f:A9},160:{T:-1},161:{T:1,f:Jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PB},336:{T:-1},337:{f:bB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_A},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pj},427:{f:mj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zB},633:{T:1},634:{T:-1},635:{T:1,f:HB},636:{T:-1},637:{f:d5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kg={6:{f:Om},10:{f:Rs},12:{f:xr},13:{f:xr},14:{f:lr},15:{f:lr},16:{f:un},17:{f:lr},18:{f:lr},19:{f:xr},20:{f:mw},21:{f:mw},23:{f:_A},24:{f:vw},25:{f:lr},26:{},27:{},28:{f:jV},29:{},34:{f:lr},35:{f:gw},38:{f:un},39:{f:un},40:{f:un},41:{f:un},42:{f:lr},43:{f:lr},47:{f:W9},49:{f:wV},51:{f:xr},60:{},61:{f:_V},64:{f:lr},65:{f:EV},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:fV},93:{f:HV},94:{},95:{f:lr},96:{},97:{},99:{f:lr},125:{f:yA},128:{f:bV},129:{f:hV},130:{f:xr},131:{f:lr},132:{f:lr},133:{f:dV},134:{},140:{f:XV},141:{f:xr},144:{},146:{f:QV},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:r9},161:{f:ZV},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:IV},190:{f:RV},193:{f:Rs},197:{},198:{},199:{},200:{},201:{},202:{f:lr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:lr},222:{},224:{f:FV},225:{f:uV},226:{f:Rs},227:{},229:{f:$V},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pV},253:{f:TV},255:{f:mV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:lr},353:{f:Rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:DV},431:{f:lr},432:{},433:{},434:{},437:{},438:{f:GV},439:{f:lr},440:{f:KV},441:{},442:{f:mf},443:{},444:{f:xr},445:{},446:{},448:{f:Rs},449:{f:xV,r:2},450:{f:Rs},512:{f:dw},513:{f:t9},515:{f:OV},516:{f:SV},517:{f:pw},519:{f:n9},520:{f:gV},523:{},545:{f:xw},549:{f:hw},566:{},574:{f:yV},638:{f:CV},659:{},1048:{},1054:{f:kV},1084:{},1212:{f:VV},2048:{f:qV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JV,r:12},2173:{f:IB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:lr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:MV,r:12},2197:{},2198:{f:wB,r:12},2199:{},2200:{},2201:{},2202:{f:BV,r:12},2203:{f:Rs},2204:{},2205:{},2206:{},2207:{},2211:{f:vV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:e9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:YV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:dw},1:{},2:{f:o9},3:{f:s9},4:{f:a9},5:{f:pw},7:{f:l9},8:{},9:{f:Wh},11:{},22:{f:xr},30:{f:AV},31:{},32:{},33:{f:xw},36:{},37:{f:hw},50:{f:c9},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:i9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:u9},223:{},234:{},354:{},421:{},518:{f:Om},521:{f:Wh},536:{f:vw},547:{f:gw},561:{},579:{},1030:{f:Om},1033:{f:Wh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ni(t,e,r,n){var i=e;if(!isNaN(i)){var a=(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&eA(r)&&t.push(r)}}function Rw(t,e){var r=e,n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=i.index,c=a&&a.index||t.length,u=O8(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<u.length;++o){var _=u[o].trim(),w=_.slice(0,3).toLowerCase();if(w=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var k=_.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var F=k[c].trim();if(F.match(/<t[dh]/i)){for(var C=F,B=0;C.charAt(0)=="<"&&(B=C.indexOf(">"))>-1;)C=C.slice(B+1);for(var V=0;V<E.length;++V){var z=E[V];z.s.c==d&&z.s.r<h&&h<=z.e.r&&(d=z.e.c+1,V=-1)}var A=tt(F.slice(0,F.indexOf(">")));v=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||v>1)&&E.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+v-1}});var R=A.t||A["data-t"]||"";if(!C.length){d+=v;continue}if(C=jk(C),y.s.r>h&&(y.s.r=h),y.e.r<h&&(y.e.r=h),y.s.c>d&&(y.s.c=d),y.e.c<d&&(y.e.c=d),!C.length){d+=v;continue}var P={t:"s",v:C};r.raw||!C.trim().length||R=="s"||(C==="TRUE"?P={t:"b",v:!0}:C==="FALSE"?P={t:"b",v:!1}:isNaN(Ui(C))?isNaN(lc(C).getDate())||(P={t:"d",v:Br(C)},r.cellDates||(P={t:"n",v:In(P.v)}),P.z=r.dateNF||ft[14]):P={t:"n",v:Ui(C)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=P):n[ot({r:h,c:d})]=P,d+=v}}}}return n["!ref"]=wt(y),E.length&&(n["!merges"]=E),n}function c$(t,e,r,n){for(var i=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o)&&!(i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){c=-1;break}c=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(c<0)){var d=ot({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],v=g&&g.v!=null&&(g.h||Y1(g.w||(Qa(g),g.w)||""))||"",y={};c>1&&(y.rowspan=c),u>1&&(y.colspan=u),n.editable?v='<span contenteditable="true">'+v+"</span>":g&&(y["data-t"]=g&&g.t||"z",g.v!=null&&(y["data-v"]=g.v),g.z!=null&&(y["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),y.id=(n.id||"sjs")+"-"+d,a.push(X8("td",v,y))}}var E="<tr>";return E+a.join("")+"</tr>"}var u$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',f$="</body></html>";function h$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return to(Rw(r[0],e),e);var n=pv();return r.forEach(function(i,a){mv(n,Rw(i,e),"Sheet"+(a+1))}),n}function d$(t,e,r){var n=[];return n.join("")+"<table"+(r.id?' id="'+r.id+'"':"")+">"}function p$(t,e){var r=e||{},n=r.header!=null?r.header:u$,i=r.footer!=null?r.footer:f$,a=[n],o=Ec(t["!ref"]);r.dense=Array.isArray(t),a.push(d$(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)a.push(c$(t,o,c,r));return a.push("</table>"+i),a.join("")}function GA(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Sn(n.origin):n.origin;i=o.r,a=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var d=Ec(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),i==-1&&(h.e.r=i=d.e.r+1)}var g=[],v=0,y=t["!rows"]||(t["!rows"]=[]),E=0,_=0,w=0,k=0,F=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&_<u;++E){var B=c[E];if(Pw(B)){if(n.display)continue;y[_]={hidden:!0}}var V=B.children;for(w=k=0;w<V.length;++w){var z=V[w];if(!(n.display&&Pw(z))){var A=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):jk(z.innerHTML),R=z.getAttribute("data-z")||z.getAttribute("z");for(v=0;v<g.length;++v){var P=g[v];P.s.c==k+a&&P.s.r<_+i&&_+i<=P.e.r&&(k=P.e.c+1-a,v=-1)}C=+z.getAttribute("colspan")||1,((F=+z.getAttribute("rowspan")||1)>1||C>1)&&g.push({s:{r:_+i,c:k+a},e:{r:_+i+(F||1)-1,c:k+a+(C||1)-1}});var L={t:"s",v:A},M=z.getAttribute("data-t")||z.getAttribute("t")||"";A!=null&&(A.length==0?L.t=M||"z":n.raw||A.trim().length==0||M=="s"||(A==="TRUE"?L={t:"b",v:!0}:A==="FALSE"?L={t:"b",v:!1}:isNaN(Ui(A))?isNaN(lc(A).getDate())||(L={t:"d",v:Br(A)},n.cellDates||(L={t:"n",v:In(L.v)}),L.z=n.dateNF||ft[14]):L={t:"n",v:Ui(A)})),L.z===void 0&&R!=null&&(L.z=R);var N="",U=z.getElementsByTagName("A");if(U&&U.length)for(var be=0;be<U.length&&!(U[be].hasAttribute("href")&&(N=U[be].getAttribute("href"),N.charAt(0)!="#"));++be);N&&N.charAt(0)!="#"&&(L.l={Target:N}),n.dense?(t[_+i]||(t[_+i]=[]),t[_+i][k+a]=L):t[ot({c:k+a,r:_+i})]=L,h.e.c<k+a&&(h.e.c=k+a),k+=C}}++_}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,_-1+i),t["!ref"]=wt(h),_>=u&&(t["!fullref"]=wt((h.e.r=c.length-E+_-1+i,h))),t}function KA(t,e){var r=e||{},n=r.dense?[]:{};return GA(n,t,e)}function m$(t,e){return to(KA(t,e),e)}function Pw(t){var e="",r=g$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function g$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function v$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=St(e.replace(/<[^>]*>/g,""));return[r]}var Fw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function qA(t,e){var r=e||{},n=Q1(t),i=[],a,o,c={name:""},u="",h=0,d,g,v={},y=[],E=r.dense?[]:{},_,w,k={value:""},F="",C=0,B=[],V=-1,z=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,P={},L=[],M={},N=0,U=0,be=[],Ee=1,Ce=1,Te=[],ye={Names:[]},ie={},ve=["",""],te=[],O={},re="",ee=0,Z=!1,ce=!1,_e=0;for(ju.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=ju.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?E["!ref"]=wt(A):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(E["!fullref"]=E["!ref"],A.e.r=r.sheetRows-1,E["!ref"]=wt(A)),L.length&&(E["!merges"]=L),be.length&&(E["!rows"]=be),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),y.push(d.name),v[d.name]=E,ce=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=tt(_[0],!1),V=z=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,E=r.dense?[]:{},L=[],be=[],ce=!0);break;case"table-row-group":_[1]==="/"?--R:++R;break;case"table-row":case"":if(_[1]==="/"){V+=Ee,Ee=1;break}if(g=tt(_[0],!1),g.?V=g.-1:V==-1&&(V=0),Ee=+g["number-rows-repeated"]||1,Ee<10)for(_e=0;_e<Ee;++_e)R>0&&(be[V+_e]={level:R});z=-1;break;case"covered-table-cell":_[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(E[V]||(E[V]=[]),E[V][z]={t:"z"}):E[ot({r:V,c:z})]={t:"z"}),F="",B=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++z,k=tt(_[0],!1),Ce=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=kw(St(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=St(k["string-value"]||""),r.dense?(E[V]||(E[V]=[]),E[V][z]=w):E[ot({r:V,c:z})]=w),z+=Ce-1;else if(_[1]!=="/"){++z,F="",C=0,B=[],Ce=1;var Se=Ee?V+Ee-1:V;if(z>A.e.c&&(A.e.c=z),z<A.s.c&&(A.s.c=z),V<A.s.r&&(A.s.r=V),Se>A.e.r&&(A.e.r=Se),k=tt(_[0],!1),te=[],O={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=St(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(N=parseInt(k["number-matrix-rows-spanned"],10)||0,U=parseInt(k["number-matrix-columns-spanned"],10)||0,M={s:{r:V,c:z},e:{r:V+N-1,c:z+U-1}},w.F=wt(M),Te.push([M,w.F])),k.formula)w.f=kw(k.formula);else for(_e=0;_e<Te.length;++_e)V>=Te[_e][0].s.r&&V<=Te[_e][0].e.r&&z>=Te[_e][0].s.c&&z<=Te[_e][0].e.c&&(w.F=Te[_e][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(N=parseInt(k["number-rows-spanned"],10)||0,U=parseInt(k["number-columns-spanned"],10)||0,M={s:{r:V,c:z},e:{r:V+N-1,c:z+U-1}},L.push(M)),k["number-columns-repeated"]&&(Ce=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Yt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=Br(k["date-value"]),r.cellDates||(w.t="n",w.v=In(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=P8(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Ad(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(F=St(k["string-value"]),B=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Z=!1,w.t==="s"&&(w.v=F||"",B.length&&(w.R=B),Z=C==0),ie.Target&&(w.l=ie),te.length>0&&(w.c=te,te=[]),F&&r.cellText!==!1&&(w.w=F),Z&&(w.t="z",delete w.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=V))for(var we=0;we<Ee;++we){if(Ce=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(E[V+we]||(E[V+we]=[]),E[V+we][z]=we==0?w:Xr(w);--Ce>0;)E[V+we][z+Ce]=Xr(w);else for(E[ot({r:V+we,c:z})]=w;--Ce>0;)E[ot({r:V+we,c:z+Ce})]=Xr(w);A.e.c<=z&&(A.e.c=z)}Ce=parseInt(k["number-columns-repeated"]||"1",10),z+=Ce-1,Ce=0,w={},F="",B=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a;O.t=F,B.length&&(O.R=B),O.a=re,te.push(O)}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);re="",ee=0,F="",C=0,B=[];break;case"creator":_[1]==="/"?re=n.slice(ee,_.index):ee=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&i.push([_[3],!1]);F="",C=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(P[c.name]=u,(a=i.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&(u="",c=tt(_[0],!1),i.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=tt(_[0],!1),u+=Fw[_[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=tt(_[0],!1),u+=Fw[_[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,_.index);break}else h=_.index+_[0].length;break;case"named-range":o=tt(_[0],!1),ve=Dm(o["cell-range-address"]);var xe={Name:o.name,Ref:ve[0]+"!"+ve[1]};ce&&(xe.Sheet=y.length),ye.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(_[1]==="/"&&(!k||!k["string-value"])){var Je=v$(n.slice(C,_.index));F=(F.length>0?F+`
`:"")+Je[0]}else tt(_[0],!1),C=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{ve=Dm(tt(_[0])["target-range-address"]),v[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(ie=tt(_[0],!1),!ie.href)break;ie.Target=St(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(ve=Dm(ie.Target.slice(1)),ie.Target="#"+ve[0]+"!"+ve[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(_)}}var Y={Sheets:v,SheetNames:y,Workbook:ye};return r.bookSheets&&delete Y.Sheets,Y}function bw(t,e){e=e||{},pi(t,"META-INF/manifest.xml")&&O5(vr(t,"META-INF/manifest.xml"),e);var r=Jn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=qA(Ut(r),e);return pi(t,"meta.xml")&&(n.Props=oA(vr(t,"meta.xml"))),n}function Ow(t,e){return qA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ag(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ut(Yo(t))}function Cg(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Dw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function x$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Wu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function fn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Wu(t,r),a=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(a){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Wu(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var h={data:c,type:a};e[i]==null?e[i]=[h]:e[i].push(h)}return e}function fv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function _$(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Wu(t,n),a=fn(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:Fr(a[1][0].data),messages:[]};a[2].forEach(function(c){var u=fn(c.data),h=Fr(u[3][0].data);o.messages.push({meta:u,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=a[3])!=null&&e[0]&&(o.merge=Fr(a[3][0].data)>>>0>0),r.push(o)}return r}function y$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Wu(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(a==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,a==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Cg(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(i.push(i[0].slice(-u)),h-=u;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-u,-u+h))}}var d=Cg(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function E$(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(y$(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Cg(e)}function w$(t,e,r,n){var i=uv(t),a=i.getUint32(4,!0),o=(n>1?12:8)+Dw(a&(n>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);a&512&&(c=i.getUint32(o,!0),o+=4),o+=Dw(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(o,!0),o+=4),a&32&&(h=i.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function T$(t,e,r){var n=uv(t),i=n.getUint32(8,!0),a=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);i&1&&(u=x$(t,a),a+=16),i&2&&(h=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(c=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return g}function S$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return w$(t,e,r,t[0]);case 5:return T$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Hs(t){var e=fn(t);return Wu(e[1][0].data)}function Nw(t,e){var r=fn(e.data),n=Fr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var c=fn(o.data),u=Fr(c[1][0].data)>>>0;switch(n){case 1:a[u]=Ag(c[3][0].data);break;case 8:{var h=t[Hs(c[9][0].data)][0],d=fn(h.data),g=t[Hs(d[1][0].data)][0],v=Fr(g.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var y=fn(g.data);a[u]=y[3].map(function(E){return Ag(E.data)}).join("")}break}}),a}function k$(t,e){var r,n,i,a,o,c,u,h,d,g,v,y,E,_,w=fn(t),k=Fr(w[1][0].data)>>>0,F=Fr(w[2][0].data)>>>0,C=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(w[8][0].data)>0||!1,B,V;if((a=(i=w[7])==null?void 0:i[0])!=null&&a.data&&e!=0)B=(c=(o=w[7])==null?void 0:o[0])==null?void 0:c.data,V=(h=(u=w[6])==null?void 0:u[0])==null?void 0:h.data;else if((g=(d=w[4])==null?void 0:d[0])!=null&&g.data&&e!=1)B=(y=(v=w[4])==null?void 0:v[0])==null?void 0:y.data,V=(_=(E=w[3])==null?void 0:E[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var z=C?4:1,A=uv(B),R=[],P=0;P<B.length/2;++P){var L=A.getUint16(P*2,!0);L<65535&&R.push([P,L])}if(R.length!=F)throw"Expected ".concat(F," cells, found ").concat(R.length);var M=[];for(P=0;P<R.length-1;++P)M[R[P][0]]=V.subarray(R[P][1]*z,R[P+1][1]*z);return R.length>=1&&(M[R[R.length-1][0]]=V.subarray(R[R.length-1][1]*z)),{R:k,cells:M}}function A$(t,e){var r,n=fn(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,a=fv(n[5],function(o){return k$(o,i)});return{nrows:Fr(n[4][0].data)>>>0,data:a.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function C$(t,e,r){var n,i=fn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Fr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Fr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=wt(a);var o=fn(i[4][0].data),c=Nw(t,t[Hs(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Nw(t,t[Hs(o[17][0].data)][0]):[],h=fn(o[3][0].data),d=0;h[1].forEach(function(g){var v=fn(g.data),y=t[Hs(v[2][0].data)][0],E=Fr(y.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var _=A$(t,y);_.data.forEach(function(w,k){w.forEach(function(F,C){var B=ot({r:d+k,c:C}),V=S$(F,c,u);V&&(r[B]=V)})}),d+=_.nrows})}function I$(t,e){var r=fn(e.data),n={"!ref":"A1"},i=t[Hs(r[2][0].data)],a=Fr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return C$(t,i[0],n),n}function R$(t,e){var r,n=fn(e.data),i={name:(r=n[1])!=null&&r[0]?Ag(n[1][0].data):"",sheets:[]},a=fv(n[2],Hs);return a.forEach(function(o){t[o].forEach(function(c){var u=Fr(c.meta[1][0].data);u==6e3&&i.sheets.push(I$(t,c))})}),i}function P$(t,e){var r=pv(),n=fn(e.data),i=fv(n[1],Hs);if(i.forEach(function(a){t[a].forEach(function(o){var c=Fr(o.meta[1][0].data);if(c==2){var u=R$(t,o);u.sheets.forEach(function(h,d){mv(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Lm(t){var e,r,n,i,a={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=E$(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=_$(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){a[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Fr(a[1][0].meta[1][0].data)==1&&a[1][0];if(c||o.forEach(function(u){a[u].forEach(function(h){var d=Fr(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return P$(a,c)}function F$(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function hv(t){F$([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function b$(t){return jl.WS.indexOf(t)>-1?"sheet":t==jl.CS?"chart":t==jl.DS?"dialog":t==jl.MS?"macro":t&&t.length?t:"sheet"}function O$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,b$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function D$(t,e,r,n,i,a,o,c,u,h,d,g){try{a[n]=wu(Jn(t,r,!0),e);var v=vr(t,e),y;switch(c){case"sheet":y=Uj(v,e,i,u,a[n],h,d,g);break;case"chart":if(y=jj(v,e,i,u,a[n],h,d,g),!y||!y["!drawel"])break;var E=hu(y["!drawel"].Target,e),_=Eg(E),w=BB(Jn(t,E,!0),wu(Jn(t,_,!0),E)),k=hu(w,E),F=Eg(k);y=Tj(Jn(t,k,!0),k,u,wu(Jn(t,F,!0),k),h,y);break;case"macro":y=$j(v,e,i,u,a[n],h,d,g);break;case"dialog":y=Hj(v,e,i,u,a[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=y;var C=[];a&&a[n]&&pa(a[n]).forEach(function(B){var V="";if(a[n][B].Type==jl.CMNT){V=hu(a[n][B].Target,e);var z=Kj(vr(t,V,!0),V,u);if(!z||!z.length)return;yw(y,z,!1)}a[n][B].Type==jl.TCMNT&&(V=hu(a[n][B].Target,e),C=C.concat(jB(vr(t,V,!0),u)))}),C&&C.length&&yw(y,C,!0,u.people||[])}catch(B){if(u.WTF)throw B}}function hi(t){return t.charAt(0)=="/"?t.slice(1):t}function N$(t,e){if(bk(),e=e||{},hv(e),pi(t,"META-INF/manifest.xml")||pi(t,"objectdata.xml"))return bw(t,e);if(pi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lm<"u"){if(t.FileIndex)return Lm(t);var r=Et.utils.cfb_new();return KE(t).forEach(function(be){L8(r,be,N8(t,be))}),Lm(r)}throw new Error("Unsupported NUMBERS file")}if(!pi(t,"[Content_Types].xml"))throw pi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):pi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=KE(t),i=F5(Jn(t,"[Content_Types].xml")),a=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",vr(t,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!vr(t,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(ku=[],i.sst)try{ku=Gj(vr(t,hi(i.sst)),i.sst,e)}catch(be){if(e.WTF)throw be}e.cellStyles&&i.themes.length&&(u=Wj(Jn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(h=zj(vr(t,hi(i.style)),i.style,u,e))}i.links.map(function(be){try{var Ee=wu(Jn(t,Eg(hi(be))),be);return Xj(vr(t,hi(be)),Ee,be,e)}catch{}});var d=Bj(vr(t,hi(i.workbooks[0])),i.workbooks[0],e),g={},v="";i.coreprops.length&&(v=vr(t,hi(i.coreprops[0]),!0),v&&(g=oA(v)),i.extprops.length!==0&&(v=vr(t,hi(i.extprops[0]),!0),v&&L5(v,g,e)));var y={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(v=Jn(t,hi(i.custprops[0]),!0),v&&(y=V5(v,e)));var E={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Ee){return Ee.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(E.Props=g,E.Custprops=y),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var _={};e.bookDeps&&i.calcchain&&(_=qj(vr(t,hi(i.calcchain)),i.calcchain));var w=0,k={},F,C;{var B=d.Sheets;g.Worksheets=B.length,g.SheetNames=[];for(var V=0;V!=B.length;++V)g.SheetNames[V]=B[V].name}var z=a?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");pi(t,R)||(R="xl/_rels/workbook."+z+".rels");var P=wu(Jn(t,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=Yj(vr(t,hi(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=$B(vr(t,hi(i.people[0])),e)),P&&(P=O$(P,d.Sheets));var L=vr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var M="sheet";if(P&&P[w]?(F="xl/"+P[w][1].replace(/[\/]?xl\//,""),pi(t,F)||(F=P[w][1]),pi(t,F)||(F=R.replace(/_rels\/.*$/,"")+P[w][1]),M=P[w][2]):(F="xl/worksheets/sheet"+(w+1-L)+"."+z,F=F.replace(/sheet0\./,"sheet.")),C=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,U=0;U!=e.sheets.length;++U)typeof e.sheets[U]=="number"&&e.sheets[U]==w&&(N=1),typeof e.sheets[U]=="string"&&e.sheets[U].toLowerCase()==g.SheetNames[w].toLowerCase()&&(N=1);if(!N)continue e}}D$(t,F,C,g.SheetNames[w],w,k,o,M,e,d,u,h)}return E={Directory:i,Workbook:d,Props:g,Custprops:y,Deps:_,Sheets:o,SheetNames:g.SheetNames,Strings:ku,Styles:h,Themes:u,SSF:Xr(ft)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(be,Ee){be=be.replace(/^Root Entry[\/]/,""),E.keys.push(be),E.files[be]=t.FileIndex[Ee]}))),e&&e.bookVBA&&(i.vba.length>0?E.vbaraw=vr(t,hi(i.vba[0]),!0):i.defaults&&i.defaults.bin===GB&&(E.vbaraw=vr(t,"xl/vbaProject.bin",!0))),E}function L$(t,e){var r=e||{},n="Workbook",i=Et.find(t,n);try{if(n="/!DataSpaces/Version",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(I9(i.content),n="/!DataSpaces/DataSpaceMap",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=P9(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=F9(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);O9(i.content)}catch{}if(n="/EncryptionInfo",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=D9(i.content);if(n="/EncryptedPackage",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function dv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ti(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function M$(t,e){return Et.find(t,"EncryptedPackage")?L$(t,e):WA(t,e)}function V$(t,e){var r,n=t,i=e||{};return i.type||(i.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r=Vk(n,i),N$(r,i)}function XA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sg(t.slice(r),e);default:break e}return $u.to_workbook(t,e)}function B$(t,e){var r="",n=dv(t,e);switch(e.type){case"base64":r=ti(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Uo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ut(r)),e.type="binary",XA(r,e)}function U$(t,e){var r=t;return e.type=="base64"&&(r=ti(r)),r=Vu.utils.decode(1200,r.slice(2),"str"),e.type="binary",XA(r,e)}function j$(t){return t.match(/[^\x00-\x7F]/)?du(t):t}function Mm(t,e,r,n){return n?(r.type="string",$u.to_workbook(t,r)):$u.to_workbook(e,r)}function Ig(t,e){yk();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ig(new Uint8Array(t),(r=Xr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xl={},r.dateNF&&(Xl.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=I8(t),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=j$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Xr(r),r.type="array",Ig(W1(n),r)}switch((i=dv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return M$(Et.read(n,r),r);break;case 9:if(i[1]<=8)return WA(n,r);break;case 60:return Sg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return m9(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return d9.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?V$(n,r):Mm(t,n,r,a);case 239:return i[3]===60?Sg(n,r):Mm(t,n,r,a);case 255:if(i[1]===254)return U$(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Su.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Su.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _w.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return G9.to_workbook(n,r);break;case 10:case 13:case 32:return B$(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return f9.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?_w.to_workbook(n,r):Mm(t,n,r,a)}function $$(t,e,r,n,i,a,o,c){var u=Yr(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||t[r])for(var y=e.s.c;y<=e.e.c;++y){var E=o?t[r][y]:t[n[y]+u];if(E===void 0||E.t===void 0){if(h===void 0)continue;a[y]!=null&&(v[a[y]]=h);continue}var _=E.v;switch(E.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(a[y]!=null){if(_==null)if(E.t=="e"&&_===null)v[a[y]]=null;else if(h!==void 0)v[a[y]]=h;else if(d&&_===null)v[a[y]]=null;else continue;else v[a[y]]=d&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?_:Qa(E,_,c);_!=null&&(g=!1)}}return{row:v,isempty:g}}function Rg(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":u=ar(d);break;case"number":u=ar(t["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var g=Yr(u.s.r),v=[],y=[],E=0,_=0,w=Array.isArray(t),k=u.s.r,F=0,C={};w&&!t[k]&&(t[k]=[]);var B=h.skipHidden&&t["!cols"]||[],V=h.skipHidden&&t["!rows"]||[];for(F=u.s.c;F<=u.e.c;++F)if(!(B[F]||{}).hidden)switch(v[F]=Ir(F),r=w?t[k][F]:t[v[F]+g],n){case 1:a[F]=F-u.s.c;break;case 2:a[F]=v[F];break;case 3:a[F]=h.header[F-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Qa(r,null,h),_=C[o]||0,!_)C[o]=1;else{do c=o+"_"+_++;while(C[c]);C[o]=_,C[c]=1}a[F]=c}for(k=u.s.r+i;k<=u.e.r;++k)if(!(V[k]||{}).hidden){var z=$$(t,u,k,v,n,a,w,h);(z.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(y[E++]=z.row)}return y.length=E,y}var Lw=/"/g;function H$(t,e,r,n,i,a,o,c){for(var u=!0,h=[],d="",g=Yr(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var y=c.dense?(t[r]||[])[v]:t[n[v]+g];if(y==null)d="";else if(y.v!=null){u=!1,d=""+(c.rawNumbers&&y.t=="n"?y.v:Qa(y,null,c));for(var E=0,_=0;E!==d.length;++E)if((_=d.charCodeAt(E))===i||_===a||_===34||c.forceQuotes){d='"'+d.replace(Lw,'""')+'"';break}d=="ID"&&(d='"ID"')}else y.f!=null&&!y.F?(u=!1,d="="+y.f,d.indexOf(",")>=0&&(d='"'+d.replace(Lw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function YA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ar(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),h=new RegExp((a=="|"?"\\|":a)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(g[E]=Ir(E));for(var _=0,w=i.s.r;w<=i.e.r;++w)(y[w]||{}).hidden||(d=H$(t,i,w,g,o,u,a,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((_++?c:"")+d)));return delete n.dense,r.join("")}function z$(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=YA(t,e);return r}function W$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ar(t["!ref"]),a="",o=[],c,u=[],h=Array.isArray(t);for(c=i.s.c;c<=i.e.c;++c)o[c]=Ir(c);for(var d=i.s.r;d<=i.e.r;++d)for(a=Yr(d),c=i.s.c;c<=i.e.c;++c)if(e=o[c]+a,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function QA(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},o=0,c=0;if(n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Sn(n.origin):n.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+i}};if(a["!ref"]){var g=ar(a["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+i)}else o==-1&&(o=0,d.e.r=e.length-1+i);var v=n.header||[],y=0;e.forEach(function(_,w){pa(_).forEach(function(k){(y=v.indexOf(k))==-1&&(v[y=v.length]=k);var F=_[k],C="z",B="",V=ot({c:c+y,r:o+w+i});h=Gu(a,V),F&&typeof F=="object"&&!(F instanceof Date)?a[V]=F:(typeof F=="number"?C="n":typeof F=="boolean"?C="b":typeof F=="string"?C="s":F instanceof Date?(C="d",n.cellDates||(C="n",F=In(F)),B=n.dateNF||ft[14]):F===null&&n.nullError&&(C="e",F=0),h?(h.t=C,h.v=F,delete h.w,delete h.R,B&&(h.z=B)):a[V]=h={t:C,v:F},B&&(h.z=B))})}),d.e.c=Math.max(d.e.c,c+v.length-1);var E=Yr(o);if(i)for(y=0;y<v.length;++y)a[Ir(y+c)+E]={t:"s",v:v[y]};return a["!ref"]=wt(d),a}function G$(t,e){return QA(null,t,e)}function Gu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Gu(t,ot(e)):Gu(t,ot({r:e,c:r||0}))}function K$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function pv(){return{SheetNames:[],Sheets:{}}}function mv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(Fj(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function q$(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=K$(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function X$(t,e){return t.z=e,t}function JA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Y$(t,e,r){return JA(t,"#"+e,r)}function Q$(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function J$(t,e,r,n){for(var i=typeof e!="string"?e:ar(e),a=typeof e=="string"?e:wt(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var u=Gu(t,o,c);u.t="n",u.F=a,delete u.v,o==i.s.r&&c==i.s.c&&(u.f=r,n&&(u.D=!0))}return t}var Z$={encode_col:Ir,encode_row:Yr,encode_cell:ot,encode_range:wt,decode_col:ev,decode_row:Z1,split_cell:u5,decode_cell:Sn,decode_range:Ec,format_cell:Qa,sheet_add_aoa:rA,sheet_add_json:QA,sheet_add_dom:GA,aoa_to_sheet:wc,json_to_sheet:G$,table_to_sheet:KA,table_to_book:m$,sheet_to_csv:YA,sheet_to_txt:z$,sheet_to_json:Rg,sheet_to_html:p$,sheet_to_formulae:W$,sheet_to_row_object_array:Rg,sheet_get_cell:Gu,book_new:pv,book_append_sheet:mv,book_set_sheet_visibility:q$,cell_set_number_format:X$,cell_set_hyperlink:JA,cell_set_internal_link:Y$,cell_add_comment:Q$,sheet_set_array_formula:J$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const eH=({onFileUpload:t,columnNames:e})=>{const[r,n]=G.useState(null),[i,a]=G.useState(null),o=u=>{var d;const h=(d=u.target.files)==null?void 0:d[0];if(h){if(h.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){a("Please upload a valid Excel file (.xlsx)");return}n(h),a(null)}},c=async u=>{if(u.preventDefault(),r){const h=new FileReader;h.onload=d=>{var v;const g=(v=d.target)==null?void 0:v.result;try{const y=Ig(g,{type:"binary"}),E=y.SheetNames[0],_=y.Sheets[E];let w=Z$.sheet_to_json(_,{header:1});const k=w.shift();console.log("Headers:",k);const F=e.filter(B=>!k.includes(B));if(F.length>0){a(`Missing headers: ${F.join(", ")}`);return}const C=w.map(B=>k.reduce((V,z,A)=>(V[z]=B[A],V),{}));t(C)}catch(y){console.error("Error processing file:",y),a("Error processing file")}},h.readAsBinaryString(r)}};return Q.jsxs("form",{onSubmit:c,children:[Q.jsx("input",{type:"file",accept:".xlsx",onChange:o,required:!0,"aria-label":"Upload Excel file"}),i&&Q.jsx("div",{className:"error",children:i})," ",Q.jsx("button",{type:"submit",children:"Load Data"})," "]})},Mw=({label:t,checked:e=!1,onChange:r})=>{const[n,i]=G.useState(e);G.useEffect(()=>{i(e)},[e]);const a=o=>{const c=o.target.checked;i(c),r&&r(c)};return Q.jsxs("label",{className:"container",children:[Q.jsx("input",{type:"checkbox",checked:n,onChange:a}),Q.jsx("svg",{viewBox:"0 0 64 64",height:"1.25em",width:"1.25em",children:Q.jsx("path",{d:"M 0 16 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 16 L 32 48 L 64 16 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 16",pathLength:"575.0541381835938",className:"path"})}),t&&Q.jsx("span",{children:t})]})};var ZA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vw=Ms.createContext&&Ms.createContext(ZA),tH=["attr","size","title"];function rH(t,e){if(t==null)return{};var r=nH(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function nH(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function q0(){return q0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},q0.apply(this,arguments)}function Bw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function X0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bw(Object(r),!0).forEach(function(n){iH(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iH(t,e,r){return e=aH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aH(t){var e=sH(t,"string");return typeof e=="symbol"?e:e+""}function sH(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eC(t){return t&&t.map((e,r)=>Ms.createElement(e.tag,X0({key:r},e.attr),eC(e.child)))}function tC(t){return e=>Ms.createElement(oH,q0({attr:X0({},t.attr)},e),eC(t.child))}function oH(t){var e=r=>{var{attr:n,size:i,title:a}=t,o=rH(t,tH),c=i||r.size||"1em",u;return r.className&&(u=r.className),t.className&&(u=(u?u+" ":"")+t.className),Ms.createElement("svg",q0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:u,style:X0(X0({color:t.color||r.color},r.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&Ms.createElement("title",null,a),t.children)};return Vw!==void 0?Ms.createElement(Vw.Consumer,null,r=>e(r)):e(ZA)}function lH(t){return tC({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(t)}function cH(t){return tC({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(t)}const uH=({title:t,message:e,onConfirm:r,onCancel:n})=>Q.jsx("div",{className:"modal-overlay",children:Q.jsxs("div",{className:"card",children:[Q.jsx("div",{className:"header",children:Q.jsx("div",{className:"image_v",children:Q.jsx("div",{className:"image",children:Q.jsx(cH,{})})})}),Q.jsxs("div",{className:"content",children:[Q.jsx("h2",{className:"title",children:t}),Q.jsx("p",{className:"message",children:e})]}),Q.jsxs("div",{className:"buttons-container flex",children:[Q.jsx("button",{className:"confirm-button",onClick:r,children:"S"}),Q.jsx("button",{className:"cancel-button",onClick:n,children:"No"})]})]})}),fH=({fields:t,data:e,onSelect:r,onImport:n,onImportMulti:i,titleModal:a,messageModal:o})=>{const[c,u]=G.useState(e||[]),[h,d]=G.useState(new Set),[g,v]=G.useState(!1);G.useEffect(()=>{u(e)},[e]);const y=B=>{const V=new Set(h);V.has(B)?V.delete(B):V.add(B),d(V)},E=()=>{h.size===c.length?d(new Set):d(new Set(c.map((B,V)=>V)))},_=B=>{d(new Set([B]));const V=c[B];r(V)},w=B=>{const V=c[B];n(V)},k=()=>{const B=c.filter((V,z)=>!h.has(z));u(B),d(new Set)},F=()=>{v(!1);const B=c.filter((V,z)=>h.has(z));if(console.log({dataToImport:B,selectedRows:h}),B.length===0){console.log("No changes to save!");return}i&&i(B)},C=()=>{console.log("Cancelled!"),v(!1)};return c&&c.length>0&&Q.jsxs(Q.Fragment,{children:[Q.jsxs("div",{className:"actions buttons-container",children:[Q.jsx("button",{className:"delete-button",onClick:k,"aria-label":"Delete selected rows",children:"Delete Selected Rows"}),i&&Q.jsx("button",{className:"edit-button",onClick:()=>v(!0),"aria-label":"Confirm and save changes",children:"Confirm and Save"})]}),Q.jsxs("div",{className:"table-container",children:[Q.jsx("table",{className:"list-base-table header-table","aria-label":"table data to import",children:Q.jsx("thead",{children:Q.jsxs("tr",{children:[Q.jsx("th",{children:Q.jsx(Mw,{checked:h.size===c.length,onChange:E,"aria-label":"Select all students"})}),t.map(({name:B,placeholder:V})=>Q.jsx("th",{children:V},`up-th-${B}`)),Q.jsx("th",{children:"Action"})]})})}),Q.jsx("div",{className:"table-body-container",children:Q.jsx("table",{className:"upload-table list-base-table body-table","aria-label":"List data to import",children:Q.jsx("tbody",{children:c.map((B,V)=>Q.jsxs("tr",{"aria-selected":h.has(V),onClick:()=>y(V),children:[Q.jsx("td",{children:Q.jsxs("div",{onClick:z=>z.stopPropagation(),"aria-hidden":"true",children:[" ",Q.jsx(Mw,{checked:h.has(V),onChange:()=>y(V),"aria-label":`Select ${B[0]}`})]})}),t.map(({name:z})=>Q.jsx("td",{children:B[z]},`${z}-${V}`)),Q.jsxs("td",{className:"actions",onClick:z=>z.stopPropagation(),"aria-hidden":"true",children:[Q.jsx("button",{className:"save-button",onClick:()=>_(V),"aria-label":`Select ${B.id}`,children:"Select"}),Q.jsx("button",{className:"view-button",onClick:()=>w(V),"aria-label":`Import ${B.id}`,children:"Import"})]})]},`up-row-${V}`))})})})]}),g&&Q.jsx(uH,{title:a||"Confirm Import",message:o||"Are you sure you want to proceed import?",onConfirm:F,onCancel:C})]})},hH=({showForm:t=!1,clearFormAfterAdd:e=!1,ableImport:r=!1,ableFilter:n=!1,ableForm:i=!0,...a})=>{const{title:o,fields:c,items:u,fetchItems:h,initialFormData:d,loading:g,onView:v,viewLinks:y,onSelect:E,onItemAdded:_,onItemsAdded:w,onItemUpdated:k,onItemsUpdated:F,onItemDeleted:C}=a,{showNotification:B}=F1(),V=(u==null?void 0:u.length)===0,[z,A]=G.useState(d||null),[R,P]=G.useState(null),[L,M]=G.useState(t),[N,U]=G.useState(!1),[be,Ee]=G.useState(!1),[Ce,Te]=G.useState(null),[ye,ie]=G.useState([]),[ve,te]=G.useState(!1),[O,re]=G.useState({}),ee=async()=>{h&&await h()},Z=async Y=>{_&&await _(Y),ee(),P(null),e&&we()},ce=async Y=>{Ce&&k?(await k(Ce.id,Y),B("Item updated","success"),e&&we()):B("Error updating item","error")},_e=async Y=>{Ee(!!Y),Te(Y),E&&E(Y),Y||(Te(null),A(null),we())},Se=async Y=>{C&&(await C(Y),ee(),B("Item deleted","success"))},we=()=>{Ee(!1),Te(null),M(t)},xe=Y=>{ie(Y),te(!0),B("File uploaded successfully!","success")},Je=async()=>{try{F&&(console.log("BaseModule",O),F&&F(O)),re({})}catch(Y){console.error("Error saving changes:",Y),B("Error saving changes","error")}};return G.useEffect(()=>{V&&!g?(M(!0),U(!0)):M(t)},[u]),G.useEffect(()=>{R&&Z(R),ee()},[R]),G.useEffect(()=>{_&&Ee(!0),ee()},[be]),c.filter(Y=>Y.view===!0).length===0&&c.forEach(Y=>Y.view=!0),Q.jsxs(Q.Fragment,{children:[o&&Q.jsx("h1",{className:"title",children:o}),Q.jsxs("div",{className:"module-container",children:[!g&&i&&L&&Q.jsx(Q.Fragment,{children:Q.jsxs("div",{className:"form-container",children:[Q.jsx(HM,{onItemAdded:Z,onItemUpdated:ce,fields:c,isEditing:be,onCancelEdit:we,initialData:z||Ce,clearFormAfterAdd:e}),r&&Q.jsx(Q.Fragment,{children:N&&Q.jsx(eH,{onFileUpload:xe,columnNames:c.map(Y=>Y.name)})})]})}),Q.jsxs("div",{className:"list-container",children:[r&&ve&&Q.jsx("div",{className:"upload-container",children:Q.jsx(fH,{fields:c,data:ye,onSelect:Te,onImport:P,onImportMulti:w})}),(u==null?void 0:u.length)>0&&Q.jsx(QM,{items:u,selectedItem:d||Ce,fields:c,removeable:!!C,editable:!!k,seeable:!!v,ableFilter:n,ableForm:i,ableImport:r,showForm:L,showImportForm:N,tempChanges:O,setTempChanges:re,onAdd:M,onImport:U,onSelect:_e,onItemDeleted:Se,onItemsUpdated:Je,viewLinks:y,loading:g||!1})]})]})]})},dH=async(t,e)=>{const r=Za(Er,`periods/${t}/courses/${e}/assignments`);return(await uf(r)).docs.map(a=>({id:a.id,...a.data()}))},pH=async(t,e,r)=>{const n=Za(Er,`periods/${t}/courses/${e}/assignments`),i=await P1(n,{...r});console.log("Assignment added with ID: ",i.id);const a=gi(Er,`periods/${t}/courses/${e}`);await qo(a,{assignmentsIds:TS(i.id)})},mH=async(t,e,r)=>{const n=L3(Er),i=Za(Er,`periods/${e}/courses/${r}/assignments`);t.forEach(a=>{const o=gi(i);n.set(o,{title:a.title,contributionPercentage:a.contributionPercentage})});try{await n.commit()}catch(a){throw console.error("Error committing batch:",a),new Error("Error adding assignments")}},gH=async(t,e,r,n,i)=>{const a=gi(Er,`periods/${t}/courses/${e}/assignments/${r}`),{id:o,...c}=n;await qo(a,c)},vH=async(t,e,r)=>{const n=gi(Er,`periods/${t}/courses/${e}/assignments/${r}`);await R1(n);const i=gi(Er,`periods/${t}`);await qo(i,{assignmentsIds:SS(e)})},xH=async(t,e)=>{const r=Za(Er,`periods/${t}/courses/${e}/assignments`),i=(await uf(r)).docs.map(o=>o.id);console.log({ids:i,periodId:t,courseId:e});const a=gi(Er,`periods/${t}/courses/${e}`);await qo(a,{assignmentsIds:i})},_H=t=>{const{courseId:e,periodId:r}=t,[n,i]=G.useState([]),[a,o]=G.useState(!1),[c,u]=G.useState(null),{showNotification:h}=F1(),d=G.useCallback(async()=>{o(!0);try{const k=await dH(r,e);i(k)}catch(k){u(k instanceof Error?k.message:"Error al cargar las calificaciones")}finally{o(!1)}},[r,e,o]);G.useEffect(()=>{let k=!0;return(async()=>{k&&await d()})(),()=>{k=!1}},[e,d]);const g=G.useCallback(async k=>{o(!0);try{const{id:F,...C}=k;await pH(r,e,C),await d()}catch(F){u(F instanceof Error?F.message:"Error adding assignment")}finally{o(!1)}},[r,e,d,o]),v=async k=>{try{const F=k.filter(B=>!n.some(V=>V.title===B.title));if(F.length===0){h("All assignments already exist","error");return}if(F.filter(B=>!y(B)).length>0){h("Some assignments have invalid data","error");return}await mH(F,r,e),h(`${F.length} assignments added`,"success"),d()}catch(F){console.error("Error adding assignments:",F),u("Error adding assignments")}},y=k=>n.some(C=>C.title===k.title)?(h("The assignment already exists","error"),!1):!k.title||typeof k.contributionPercentage!="number"||k.contributionPercentage<0||k.contributionPercentage>100?(h("Invalid assignment data","error"),!1):!0,E=G.useCallback(async(k,F)=>{o(!0);try{await gH(r,e,k,F),await d()}catch(C){u(C instanceof Error?C.message:"Error updating assignment")}finally{o(!1)}},[r,e,d,o]),_=G.useCallback(async k=>{o(!0);try{await vH(r,e,k),await d()}catch(F){u(F instanceof Error?F.message:"Error deleting assignment")}finally{o(!1)}},[r,e,d,o]);return{assignments:n,loadAssignments:d,loading:a,setLoading:o,error:c,handleAddAssignment:g,handleAddAssignments:v,handleUpdateAssignment:E,handleDeleteAssignment:_,handleSyncAssignments:async()=>{try{if(console.log("Syncing assignments for period:",r,"course:",e),!r||!e){u("Invalid period or course ID");return}o(!0),await xH(r,e),await d()}catch{u("Error syncing assignments")}finally{o(!1)}}}},yH=({periodId:t,courseId:e})=>{const{assignments:r,loading:n,error:i,handleAddAssignment:a,handleAddAssignments:o,handleDeleteAssignment:c,handleUpdateAssignment:u,handleSyncAssignments:h}=_H({periodId:t,courseId:e}),d=G.useMemo(()=>r.reduce((v,y)=>v+(Number(y.contributionPercentage)||0),0),[r]),g=[{name:"title",placeholder:"Title of the assignment"},{name:"contributionPercentage",placeholder:"Contribution percentage to final grade",type:"number"}];return n?Q.jsx(yd,{text:"Loading assignments",className:"h30vh"}):i?Q.jsxs("div",{children:["Error: ",i]}):Q.jsxs("div",{className:"assignments-manager",children:[Q.jsx("div",{className:"button-container",children:Q.jsx("button",{className:"save-button",onClick:h,children:"Sync"})}),Q.jsxs("p",{children:[Q.jsx("b",{children:"Total Percentage: "}),"(",d,")%"]}),d<100&&Q.jsxs("p",{children:[Q.jsx("b",{children:"Pending Percentage: "}),"(",100-d,")%"]}),Q.jsx(hH,{fields:g,items:r,onItemAdded:a,onItemsAdded:o,onItemUpdated:u,onItemDeleted:c,loading:n,clearFormAfterAdd:!1,showForm:!0,ableForm:!0,ableImport:!0})]})},EH=({titleName:t,fields:e,data:r,onItemUpdated:n,onDelete:i,ableDelete:a,viewLink:o})=>{const c=(u,h)=>{switch(u){case"date":return new Date(h).toLocaleDateString();case"array":return h.length;case"number":return Number(h).toLocaleString();default:return h}};return Q.jsxs("div",{className:"module-card",children:[Q.jsx("h3",{children:r?r[t]:""}),e.map(({name:u,placeholder:h,type:d})=>r&&r[u]?Q.jsxs("p",{children:[Q.jsxs("strong",{className:"capitalize",children:[h,":"]})," ",c(d,r[u])]},u):null),Q.jsxs("div",{className:"module-card-actions",children:[n&&Q.jsx("button",{onClick:()=>n&&r&&n(r),className:"edit-button",children:"Edit"}),a&&r&&r.id&&Q.jsx("button",{onClick:()=>i&&r&&i(r.id),className:"delete-button",children:"Delete"}),o&&Q.jsx($o,{to:o,className:"button view-button","aria-label":"View selected item",children:"View"})]})]})},wH=[{name:"name",placeholder:"name"},{name:"description",placeholder:"description"},{name:"duration",placeholder:"duration"},{name:"hours",placeholder:"hours"},{name:"status",placeholder:"status"},{name:"assignmentsIds",placeholder:"assignments",type:"array"},{name:"teacherName",placeholder:"teacherName"}],TH=({data:t,viewLink:e,onDelete:r})=>Q.jsx(Q.Fragment,{children:Q.jsx(EH,{titleName:"name",fields:wH,data:t,viewLink:e,onDelete:r})}),SH=({periodId:t})=>{const e=Dg(),{courses:r,availableCourses:n,handleAddCourse:i,handleDeleteCourse:a,handleUpdateCourse:o}=X3(t),{teachers:c}=$M(),[u,h]=G.useState(null),[d,g]=G.useState(null),[v]=ug("selectPeriod",null),y=()=>{e(-1)},E=async k=>{if(d){const{id:F,...C}=k,B={...C,teacherId:d};await o(F,B),g(null)}},_=async()=>{const{id:k,...F}=n.filter(C=>C.id===u)[0];if(u){const C={...F,periodId:t,courseId:k,status:"Not Started",assignmentsIds:[]};await i(C),h(null)}},w=(k,F)=>k&&F&&String(k)===String(F);return Q.jsxs("div",{className:"periods-manager card",children:[Q.jsxs("div",{className:"container",children:[Q.jsx("h3",{children:v==null?void 0:v.name}),Q.jsx("button",{onClick:y,children:"Volver"})]}),Q.jsxs("div",{className:"container",children:[t&&Q.jsxs("div",{className:"item",children:[Q.jsx("h3",{children:"Available Courses"}),Q.jsx("div",{className:"buttons-container flex",children:n.map((k,F)=>Q.jsx("button",{className:`button ${w(u,k.id)?"active":""}`,onClick:()=>h(k.id),children:k.name},`ac-${F}`))}),n.length===0&&Q.jsx("div",{className:"empty",children:"No courses available for this period"})]}),t&&u&&Q.jsx("button",{className:"edit-button",onClick:_,children:"Assign course"})]}),Q.jsx("div",{className:"periods-list",children:Q.jsx("ul",{children:r.map(k=>Q.jsxs("li",{children:[Q.jsxs("div",{className:"buttons-container actions",children:[Q.jsx("button",{className:"save-button",onClick:()=>E(k),children:"Save"}),k.assignmentsIds&&k.assignmentsIds.length==0&&Q.jsx("button",{className:"delete-button",onClick:()=>a(k.id),children:"Delete"})]}),Q.jsx(TH,{data:k,viewLink:`/period/${t}/course/${k.id}`}),!k.teacherId&&Q.jsx(xk,{label:"Teacher",options:c.map(F=>({value:F.id,label:F.name})),value:"",onChange:F=>g(F.value),placeholder:"Select Teacher"},"teacherId"),k.id&&t&&Q.jsx(yH,{courseId:k.id,periodId:t})]},k.id))})})]})},kH=()=>{const{id:t}=WI();return Q.jsx("div",{children:t&&Q.jsx(SH,{periodId:t})})},AH=G.lazy(()=>Wi(()=>import("./Login-dAiqCpP8.js"),[])),CH=G.lazy(()=>Wi(()=>import("./Register-Bf4L78v0.js"),__vite__mapDeps([0,1]))),IH=G.lazy(()=>Wi(()=>import("./Courses-D82GeWOK.js"),__vite__mapDeps([2,3]))),RH=G.lazy(()=>Wi(()=>import("./Grades-CU6pEuTF.js"),[])),Uw=G.lazy(()=>Wi(()=>import("./Periods-CQwhUu4M.js"),__vite__mapDeps([4,5]))),PH=G.lazy(()=>Wi(()=>import("./Dashboard-DiO9mUqD.js"),__vite__mapDeps([6,7]))),FH=G.lazy(()=>Wi(()=>import("./Students-Db6j1aZv.js"),__vite__mapDeps([8,9,10,5,11,12]))),bH=G.lazy(()=>Wi(()=>import("./Teachers-DKKmZ8Ea.js"),[])),jw=G.lazy(()=>Wi(()=>import("./StudentsCourses-CXaF5WNZ.js"),__vite__mapDeps([13,9,10,5,11]))),$w=G.lazy(()=>Wi(()=>import("./CourseStudents-B27gEFke.js"),__vite__mapDeps([14,3,10,5,15]))),OH=G.lazy(()=>Wi(()=>import("./PeriodStudents-BmdHmFzK.js"),[])),DH=()=>{const{loading:t}=AS(),{setIsLoading:e}=RS(),[r,n]=G.useState(!1),[i,a]=G.useState(!1);if(G.useEffect(()=>{let c;return t?e(!0):c=setTimeout(()=>{e(!1),n(!0),a(!0)},2e3),()=>{c&&clearTimeout(c)}},[t,e]),!r)return null;const o=Q.jsxs(sR,{children:[Q.jsx(zr,{path:"/",element:Q.jsx(AH,{})}),Q.jsx(zr,{path:"/register",element:Q.jsx(CH,{})}),Q.jsx(zr,{path:"/dashboard",element:Q.jsx(Yn,{element:Q.jsx(PH,{})})}),Q.jsx(zr,{path:"/students",element:Q.jsx(Yn,{element:Q.jsx(FH,{})})}),Q.jsx(zr,{path:"/students/:id/periods",element:Q.jsx(Yn,{element:Q.jsx(jw,{})})}),Q.jsx(zr,{path:"/students/:id/courses",element:Q.jsx(Yn,{element:Q.jsx(jw,{})})}),Q.jsx(zr,{path:"/teachers",element:Q.jsx(Yn,{element:Q.jsx(bH,{})})}),Q.jsx(zr,{path:"/courses",element:Q.jsx(Yn,{element:Q.jsx(IH,{})})}),Q.jsx(zr,{path:"/grades",element:Q.jsx(Yn,{element:Q.jsx(RH,{})})}),Q.jsx(zr,{path:"/periods",element:Q.jsx(Yn,{element:Q.jsx(Uw,{})})}),Q.jsx(zr,{path:"/periods/courses",element:Q.jsx(Yn,{element:Q.jsx(Uw,{})})}),Q.jsx(zr,{path:"/period/:id/courses",element:Q.jsx(Yn,{element:Q.jsx(kH,{})})}),Q.jsx(zr,{path:"/period/:id/students",element:Q.jsx(Yn,{element:Q.jsx(OH,{})})}),Q.jsx(zr,{path:"/period/:periodId/course/:courseId",element:Q.jsx(Yn,{element:Q.jsx($w,{})})}),Q.jsx(zr,{path:"/course/:id/students",element:Q.jsx(Yn,{element:Q.jsx($w,{})})}),Q.jsx(zr,{path:"*",element:Q.jsx(eT,{to:"/"})})," "]});return Q.jsx(G.Suspense,{fallback:Q.jsx(yd,{text:"Cargando componente..."}),children:i?o:null})},rC=G.createContext(void 0),NH=({children:t})=>{const[e,r]=G.useState(null);return Q.jsx(rC.Provider,{value:{openDropdown:e,setOpenDropdown:r},children:t})},LH=()=>{const t=G.useContext(rC);if(t===void 0)throw new Error("useDropdown must be used within a DropdownProvider");return t},nC=({id:t,title:e,items:r})=>{const{openDropdown:n,setOpenDropdown:i}=LH(),a=ma(),o=()=>{i(n===t?null:t)},c=n===t,u=r.some(h=>a.pathname===h.to);return Q.jsxs("div",{className:"dropdown",children:[Q.jsxs("button",{onClick:o,className:`dropdown-button ${u?"active":""}`,children:[e," ",Q.jsx("span",{className:"dropdown-icon",children:""})]}),c&&Q.jsx("ul",{className:"dropdown-menu",children:r.map((h,d)=>Q.jsx("li",{className:a.pathname===h.to?"active":"",onClick:()=>i(null),children:Q.jsxs($o,{to:h.to,style:{display:"flex",alignItems:"center"},children:[h.icon&&Q.jsx("span",{className:"item-icon",children:h.icon}),h.label]})},d))})]})},MH=({items:t})=>{const e=ma(),r=t.some(n=>e.pathname===n.to);return Q.jsx("header",{className:"navbar",children:Q.jsx("ul",{children:t.map(n=>Q.jsx("li",{className:e.pathname===n.to?"active":"",children:n.children?Q.jsx(nC,{id:`${n.label.toLowerCase()}-dropdown-desktop`,title:n.label,items:n.children}):Q.jsx("button",{className:`${r?"active":""}`,children:Q.jsx($o,{to:n.to,children:n.label})})},n.label))})})},VH=({items:t,isOpen:e,onClose:r})=>Q.jsxs("div",{className:`sidebar ${e?"open":""}`,children:[Q.jsx("button",{className:"close-button",onClick:r,children:" "}),Q.jsx("ul",{children:t.map(n=>Q.jsx("li",{children:n.children?Q.jsx(nC,{id:`${n.label.toLowerCase()}-dropdown`,title:n.label,items:n.children}):Q.jsx($o,{to:n.to,onClick:r,children:n.label})},n.label))})]}),Hw=[{label:"Dashboard",to:"/dashboard"},{label:"Students",to:"",children:[{label:"Estudiantes",to:"/students"},{label:"Calificaciones",to:"/grades"}]},{label:"Params",to:"",children:[{label:"Periods",to:"/periods"},{label:"Courses",to:"/courses"},{label:"Profesores",to:"/teachers"}]},{label:"User",to:"",children:[{label:"Login",to:"/login"},{label:"Register",to:"/register"}]}],BH=()=>{const[t,e]=G.useState(!1),r=()=>{e(!t)};return Q.jsxs("div",{children:[Q.jsxs("button",{className:"toggle-button",onClick:r,children:[Q.jsx(lH,{})," "]}),Q.jsx(VH,{items:Hw,isOpen:t,onClose:()=>e(!1)}),Q.jsx(MH,{items:Hw})]})},UH=({children:t})=>Q.jsxs("div",{className:"grid",children:[Q.jsx("div",{className:"header",children:Q.jsx(BH,{})}),Q.jsx("div",{className:"main",children:t})," "]}),jH=()=>Q.jsx(PR,{basename:"/learntrackcenter",children:Q.jsx(U3,{children:Q.jsx(G3,{children:Q.jsx(NH,{children:Q.jsx(UH,{children:Q.jsx(DH,{})})})})})});mI.createRoot(document.getElementById("root")).render(Q.jsx(G.StrictMode,{children:Q.jsx(jH,{})}));export{yH as A,hH as B,EH as C,QH as D,TS as E,SS as F,$3 as G,yd as L,SH as P,V3 as a,HH as b,Dg as c,F1 as d,$H as e,RS as f,JH as g,Za as h,P1 as i,Q as j,gi as k,R1 as l,Er as m,uf as n,ug as o,$M as p,WI as q,G as r,zH as s,dH as t,AS as u,qo as v,L3 as w,YH as x,qH as y,XH as z};
