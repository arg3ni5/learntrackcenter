const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Register-Db3fhZJ3.js","assets/vendor-react-BWjxQFbR.js","assets/vendor-firebase-CpkMzyVB.js","assets/vendor-ui-CZ9GI7ht.js","assets/vendor-ui-BaVkx4tQ.css","assets/vendor-utils-BDfVuDdi.js","assets/Register-Duh75M7k.css","assets/Home-BPTMV86g.js","assets/UserProfile-iCSg3qXj.js","assets/UserProfile-BREJmAyz.css","assets/Courses-GZVv-HpM.js","assets/courseService-CXf6yShE.js","assets/Grades-CDwhQgH9.js","assets/useStudents-BqIwBj2u.js","assets/studentService-BDxH82um.js","assets/Periods-KtQo2Wvu.js","assets/periodService-B8qW6QfF.js","assets/Dashboard-B1yXbL4p.js","assets/Students-COeRfAva.js","assets/StudentPeriodsManager-Pk-7KVdy.js","assets/useStudentCourses-CkeTLfEg.js","assets/StudentPeriodsManager-CMo5nZd1.css","assets/Students-WaJLWye5.css","assets/Teachers-DSZwJA-V.js","assets/StudentsCourses-C35jJyaj.js","assets/CourseStudents-DEj6iJfI.js","assets/CourseStudents-ispZDE6Z.css","assets/PeriodStudents-CQSU45DP.js"])))=>i.map(i=>d[i]);
import{d as Je,e as We,r as l,N as Fe,L as J,u as Qe,f as Ke,g as Xe,h as _,i as Le,B as Ye}from"./vendor-react-BWjxQFbR.js";import{i as Ze,g as et,a as tt,G as st,o as nt,c as L,b as W,d as be,e as k,u as P,f as je,h as $e,j as Pe,w as at}from"./vendor-firebase-CpkMzyVB.js";import{S as ot,G as Q,C as re}from"./vendor-ui-CZ9GI7ht.js";import{r as rt,u as ct}from"./vendor-utils-BDfVuDdi.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();var fe={exports:{}},q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var we;function it(){if(we)return q;we=1;var t=Je(),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function r(i,m,d){var u,h={},f=null,j=null;d!==void 0&&(f=""+d),m.key!==void 0&&(f=""+m.key),m.ref!==void 0&&(j=m.ref);for(u in m)o.call(m,u)&&!c.hasOwnProperty(u)&&(h[u]=m[u]);if(i&&i.defaultProps)for(u in m=i.defaultProps,m)h[u]===void 0&&(h[u]=m[u]);return{$$typeof:n,type:i,key:f,ref:j,props:h,_owner:a.current}}return q.Fragment=s,q.jsx=r,q.jsxs=r,q}var Se;function lt(){return Se||(Se=1,fe.exports=it()),fe.exports}var e=lt(),oe={},Ce;function dt(){if(Ce)return oe;Ce=1;var t=We();return oe.createRoot=t.createRoot,oe.hydrateRoot=t.hydrateRoot,oe}var ut=dt();const mt="modulepreload",ht=function(t){return"/learntrackcenter/"+t},Ne={},R=function(n,s,o){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));a=Promise.allSettled(s.map(m=>{if(m=ht(m),m in Ne)return;Ne[m]=!0;const d=m.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":mt,d||(h.as="script"),h.crossOrigin="",h.href=m,i&&h.setAttribute("nonce",i),document.head.appendChild(h),d)return new Promise((f,j)=>{h.addEventListener("load",f),h.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return a.then(r=>{for(const i of r||[])i.status==="rejected"&&c(i.reason);return n().catch(c)})},pt={apiKey:"AIzaSyAxlL6dXgQ2JOjkwUNeWTdpretOWzf55tk",authDomain:"learn-track-center.firebaseapp.com",projectId:"learn-track-center",storageBucket:"learn-track-center.firebasestorage.app",messagingSenderId:'"651698569013",',appId:"1:651698569013:web:d8a9a0d97fef19f23bd67c",measurementId:"G-SHQ8L381Z5"},Te=Ze(pt),E=et(Te),gt=tt(Te),Ss=new st,Oe=()=>{const[t,n]=l.useState(null),[s,o]=l.useState(!0);return l.useEffect(()=>{const a=nt(gt,c=>{n(c),o(!1)});return()=>a()},[]),{user:t,loading:s}},ce=({type:t="loader",children:n,text:s,className:o})=>e.jsx("div",{className:`loading-container ${o}`,children:t==="spinner"||n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner"}),s&&e.jsx("p",{children:s}),e.jsx("p",{children:n})]}):e.jsxs(e.Fragment,{children:[s&&e.jsx("div",{className:"loading-text",children:e.jsx("p",{children:s})}),e.jsx("div",{className:"loader",children:n})]})}),D=({element:t})=>{const{user:n,loading:s}=Oe();return s?e.jsx(ce,{}):n?e.jsx(e.Fragment,{children:t}):e.jsx(Fe,{to:"/",replace:!0})};function G(t,n){const[s,o]=l.useState(()=>{try{const a=window.localStorage.getItem(t);return a?JSON.parse(a):n}catch(a){return console.error(a),n}});return l.useEffect(()=>{try{window.localStorage.setItem(t,JSON.stringify(s))}catch(a){console.error(a)}},[t,s]),[s,o]}const ft=async()=>{const t=L(E,"teachers");return(await W(t)).docs.map(o=>({id:o.id,...o.data()}))},Cs=async t=>{const n=L(E,"teachers");await be(n,t)},Ns=async(t,n)=>{const s=k(E,`teachers/${t}`),{id:o,...a}=n;await P(s,a)},As=async t=>{const n=k(E,"teachers",t);await je(n)},xt=async()=>{const t=L(E,"courses");return(await W(t)).docs.map(s=>({id:s.id,...s.data()}))},bt=async t=>{const n=L(E,`periods/${t}/courses`);return(await W(n)).docs.map(o=>({id:o.id,...o.data()}))},jt=async(t,n)=>{const s=L(E,`periods/${t}/courses`),o=await be(s,{...n});console.log("Course added with ID: ",o.id);const a=k(E,`periods/${t}`);await P(a,{coursesIds:$e(o.id)})},vt=async(t,n)=>{const s=k(E,`periods/${t}/courses`,n);await je(s);const o=k(E,`periods/${t}`);await P(o,{coursesIds:Pe(n)})},yt=async(t,n,s)=>{const o=k(E,`periods/${t}/courses`,n),{id:a,...c}=s;await P(o,c),console.log("Course updated with ID: ",n)},ze=l.createContext(void 0),wt=({children:t})=>{const[n,s]=l.useState(!1),[o,a]=l.useState("");return e.jsxs(ze.Provider,{value:{isLoading:n,loadingText:o,setIsLoading:s,setLoadingText:a},children:[n&&e.jsx(ce,{text:o}),t]})},Ve=()=>{const t=l.useContext(ze);if(t===void 0)throw new Error("useLoading must be used within a LoadingProvider");return t},St=({message:t,type:n,timeout:s=5e3,onClose:o})=>(l.useEffect(()=>{if(s===0)return;const a=setTimeout(()=>{o()},s);return()=>clearTimeout(a)},[o,s]),e.jsxs("div",{className:`notification ${n}`,children:[e.jsx("span",{children:t}),e.jsx("button",{className:"close-button",onClick:o,children:"✖"})]})),He=l.createContext(void 0),ve=()=>{const t=l.useContext(He);if(!t)throw new Error("useNotification must be used within a NotificationProvider");return t},Ct=({children:t})=>{const[n,s]=l.useState([]),o=(c,r,i)=>{const m=Date.now();s(d=>{const u=[...d,{id:m,message:c,type:r,timeout:i}];return u.length>5?u.slice(-5):u}),i&&i>0&&setTimeout(()=>{a(m)},i)},a=c=>{s(r=>r.filter(i=>i.id!==c))};return e.jsxs(He.Provider,{value:{showNotification:o},children:[e.jsx("div",{className:"notification-container",children:n.map(c=>e.jsx(St,{message:c.message,type:c.type,onClose:()=>a(c.id),timeout:c.timeout},c.id))}),t]})},Nt=10*60*1e3,At=t=>{const[n,s]=l.useState([]),[o,a]=l.useState(!0),[c,r]=G("availableTeachers",[]),[i,m]=G("availableCourses",[]),{showNotification:d}=ve(),{setIsLoading:u}=Ve();l.useEffect(()=>{u(o)},[o,u]);const h=async()=>{try{a(!0);const p=(await bt(t)).map(x=>{const S=c.find(I=>I.id===x.teacherId);return{...x,teacherName:S?S.name:"Unassigned Teacher"}});s(p)}catch(b){console.error("Error loading period courses:",b),d("Error loading period courses","error")}finally{a(!1)}},C={teachers:async(b=!1)=>{try{if(!b&&c.length>0){console.log("Teachers data already loaded. Skipping fetch.");return}b&&a(!0);const p=await ft();r(p),localStorage.setItem("availableTeachers",JSON.stringify(p)),console.log("Teachers data updated.")}catch(p){console.error("Error loading teachers:",p),d("Error loading teachers","error")}finally{b&&a(!1)}},courses:async(b=!1)=>{try{if(!b&&i.length>0){console.log("Courses data already loaded. Skipping fetch.");return}b&&a(!0);const p=await xt();m(p),localStorage.setItem("availableCourses",JSON.stringify(p)),console.log("Courses data updated.")}catch(p){console.error("Error loading courses:",p),d("Error loading courses","error")}finally{b&&a(!1)}}},g=async(b,p=!1)=>{let x=["teachers","courses"];typeof b=="boolean"?p=b:Array.isArray(b)&&(x=b);const S=x.map(I=>C[I](p));S.length>0?(await Promise.all(S),console.log("Selected global data loaded.")):console.log("No valid data type selected for loading.")};return l.useEffect(()=>{h()},[t]),l.useEffect(()=>{g();const b=setInterval(()=>g(["courses"],!0),Nt);return()=>clearInterval(b)},[]),{courses:n,availableCourses:i,availableTeachers:c,loading:o,handleAddCourse:async b=>{try{if(n.some(p=>p.courseId===b.courseId)){d("Course already added","error");return}a(!0),await jt(t,b),h()}catch{d("Error adding course","error")}finally{a(!1)}},handleDeleteCourse:async b=>{try{if(!b)return;a(!0),await vt(t,b),h()}catch(p){d("Error deleting course","error"),console.error("Error deleting course:",p)}finally{a(!1)}},handleUpdateCourse:async(b,p)=>{try{if(!t)return;a(!0),await yt(t,b,p),h()}catch(x){d("Error updating course","error"),console.error("Error updating course:",x)}finally{a(!1)}},loadGlobalData:()=>g(!0),loadAvailableCourses:()=>g(["courses"],!0),loadAvailableTeachers:()=>g(["teachers"],!0)}},Ue=({options:t,onChange:n,placeholder:s,isMulti:o=!1,defaultValue:a,label:c,value:r})=>e.jsxs("div",{className:"select-input",children:[c&&e.jsx("label",{children:c}),e.jsx(ot,{value:t.find(i=>i.value===r),options:t,onChange:n,placeholder:s,isMulti:o,defaultValue:a,className:"select-input",classNamePrefix:"react-select"})]}),Et=({isEditing:t,fields:n,initialData:s,onItemAdded:o,onItemUpdated:a,onCancelEdit:c,clearFormAfterAdd:r=!1})=>{const[i,m]=l.useState({});l.useEffect(()=>{s&&m(s)},[s]);const d=g=>{const{name:w,value:v}=g.target;m({...i,[w]:v})},u=({name:g,value:w})=>{m({...i,[g]:w})},h=()=>m({}),f=async g=>{g.preventDefault(),s&&t?await(a==null?void 0:a(i)):await o(i),r&&h()},j=()=>{h(),c&&c()},C=g=>{const w={key:g.name,name:g.name,placeholder:g.placeholder,value:i[g.name]||"",required:g.required!==void 0?g.required:!0,onChange:v=>{const y=v.target.value;d(v),g.onChange&&g.onChange(y)}};switch(g.type){case"select":return g.options&&e.jsx(Ue,{options:g.options,label:g.label,...w,onChange:v=>{const y=v.value;g.onChange?g.onChange(y):u({name:g.name,value:y})}});case"number":case"number-view":return l.createElement("input",{type:"number",min:"0",max:i[`${g.name}Max`]||100,...w,key:w.key});case"date":return l.createElement("input",{type:"date",...w,key:w.key});case"input":default:return l.createElement("input",{type:"text",...w,key:w.key})}};return e.jsxs("form",{onSubmit:f,className:t?"editing":"",children:[n.map(C),e.jsxs("div",{className:"buttons-container",children:[e.jsx("button",{className:"save-button",type:"submit",children:t?"Save":"Add"}),t&&e.jsx("button",{className:"cancel-button",type:"button",onClick:j,children:"Cancel"})]})]})},_t=({fields:t,sortConfig:n,handleSort:s,setColumnWidths:o,showActions:a})=>{const c=l.useRef(null);return l.useEffect(()=>{c.current&&o(Array.from(c.current.children).map(r=>r.offsetWidth))},[]),e.jsx("table",{className:`list-base-table header-table ${a?"with-actions":""}`,"aria-label":"List header",children:e.jsx("thead",{children:e.jsx("tr",{ref:c,children:t.map(r=>r.visible&&e.jsxs("th",{onClick:()=>s(r.name),style:{width:r.size?`${r.size}${r.unit||"em"}`:"auto"},children:[r.label||r.placeholder||r.name,(n==null?void 0:n.key)===r.name&&e.jsx("span",{children:n.direction==="ascending"?" ▲":" ▼"})]},r.name))})})})},It=({fields:t,items:n,selectedItem:s,tempChanges:o,columnWidths:a,handlers:c})=>{const{handleRowClick:r,setTempChanges:i}=c||{},m=(h,f,j)=>{const C=parseFloat(j);isNaN(C)||i(g=>({...g,[h]:{...g[h],[f]:C}}))},d=(h,f)=>{var C;const j=(C=o[h])==null?void 0:C[f];j!==void 0&&!isNaN(j)&&console.log(`Validated value for ${h}.${f}: ${j}`)},u=(h,f)=>{var C,g;if(!f.visible)return null;const j=h[f.name];switch(f.type){case"link":return j&&e.jsx("a",{href:j,target:"_blank",children:"Link"});case"select":const w=(C=f.options)==null?void 0:C.find(v=>v.value===j);return w?w.label:"Unknown";case"number":return e.jsx("input",{type:"number",name:f.name,min:0,step:.5,max:h[`${f.name}Max`],value:((g=o[h.id])==null?void 0:g[f.name])??j,onChange:v=>m(h.id,f.name,v.target.value),onBlur:()=>d(h.id,f.name),onClick:v=>v.stopPropagation()});default:return j!==void 0?j:"N/A"}};return e.jsx("div",{className:"table-body-container",children:e.jsx("table",{className:"list-base-table body-table","aria-label":"List of items",children:e.jsx("tbody",{children:n.length>0?n.map(h=>e.jsx("tr",{onClick:()=>r==null?void 0:r(h),className:(s==null?void 0:s.id)===h.id?"selected-row":"","aria-selected":(s==null?void 0:s.id)===h.id,children:t.map((f,j)=>e.jsx("td",{style:{width:a[j]||"auto"},children:u(h,f)},f.name))},h.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,className:"empty-state",children:"No data available"})})})})})},Dt=({hasPendingChanges:t,config:n,handlers:s})=>{const{ableForm:o,ableImport:a,seeable:c,removeable:r,showForm:i,showImportForm:m,selectedItem:d,viewLinks:u,tempChanges:h}=n,{handleShowForm:f,handleShowImportForm:j,onItemDeleted:C,onSaveAllChanges:g,onReload:w,onAssign:v}=s,y=(b,p)=>{g&&g(b,p)};return e.jsxs("div",{className:"actions buttons-container compact",children:[o&&e.jsx("button",{className:i?"add-button":"edit-button",onClick:()=>f(i),"aria-expanded":i,"aria-label":i?"Hide the form":"Show the form",children:i?"Hide Form":"Add"}),o&&a&&!m&&e.jsx("button",{onClick:()=>j(m),"aria-expanded":m,"aria-label":m?"Add a new item":"Hide the form",children:"Import"}),c&&u&&u.map((b,p)=>e.jsx(J,{to:d?b.format.replace(":id",d.id):"#",className:`button view-button ${b.class||""} ${d?"":"disabled-link"}`,"aria-label":`View ${b.label}`,onClick:x=>!d&&x.preventDefault(),children:b.label},p)),r&&C&&e.jsx("button",{disabled:!d,className:"delete-button",onClick:()=>(d==null?void 0:d.id)&&C(d.id),"aria-label":"Delete selected item",children:"Delete"}),t&&e.jsx("button",{onClick:b=>y(b,h),className:"add-button","aria-label":"Save all changes",children:"Save All Changes"}),w&&e.jsx("button",{onClick:()=>w(),className:"add-button","aria-label":"Save all changes",children:"Reload"}),v&&e.jsx("button",{disabled:!d,onClick:()=>v(),className:"edit-button","aria-label":"Save all changes",children:"Assign"})]})},kt=({currentPage:t,totalPages:n,onPageChange:s})=>n<=1?null:e.jsx("div",{className:"pagination",children:Array.from({length:n},(o,a)=>a+1).map(o=>e.jsx("button",{onClick:()=>s(o),className:t===o?"active":"",children:o},o))}),Ae=t=>{const[n,s]=l.useState(t);return l.useEffect(()=>{s(t)},[t]),[n,s]},Rt=(t,n)=>{const[s,o]=n?G(`${n}-sortConfig`,null):l.useState(null),a=r=>{let i="ascending";s&&s.key===r&&s.direction==="ascending"&&(i="descending"),o({key:r,direction:i})},c=l.useMemo(()=>s===null?t:[...t].sort((r,i)=>r[s.key]<i[s.key]?s.direction==="ascending"?-1:1:r[s.key]>i[s.key]?s.direction==="ascending"?1:-1:0),[t,s]);return{sortConfig:s,handleSort:a,sortedItems:c}},Ft=(t,n)=>{const[s,o]=n?G(`${n}-filterText`,""):l.useState(""),a=l.useMemo(()=>s?t.filter(c=>Object.values(c).some(r=>r.toString().toLowerCase().includes(s.toLowerCase()))):t,[t,s]);return{filterText:s,setFilterText:o,filteredItems:a}},Lt=(t,n)=>{const[s,o]=l.useState(1),a=l.useMemo(()=>{const i=(s-1)*n;return t.slice(i,i+n)},[t,s,n]),c=Math.ceil(t.length/n);return{currentPage:s,paginatedItems:a,totalPages:c,handlePageChange:i=>{o(i)}}},$t=({config:t,handlers:n})=>{const{useFlexTable:s=!1,alias:o,fields:a,items:c,ableFilter:r=!1,ableForm:i,ableImport:m,removeable:d,seeable:u,viewLinks:h,tempChanges:f,setTempChanges:j,selectedItem:C,showForm:g=!1,showImportForm:w=!1,loading:v=!1}=t,{onAdd:y,onImport:b,onSelect:p,onItemDeleted:x,onItemsUpdated:S,onReload:I,onAssign:T}=n,[K,z]=Ae(g),[X,V]=Ae(w),[F,Y]=l.useState(C),[Z,ee]=l.useState([]),{sortConfig:H,handleSort:U,sortedItems:O}=Rt(c,o),{filterText:te,setFilterText:ie,filteredItems:le}=Ft(O,o),{currentPage:de,paginatedItems:se,totalPages:ne,handlePageChange:M}=Lt(le,20),ae=A=>{const B=(F==null?void 0:F.id)===A.id?null:A;Y(B),p==null||p(B)},ue=A=>{z(!A),y&&y(!A)},me=A=>{y&&y(!0),V(!A),b&&b(!A)},he=async()=>{S&&await S(f)};l.useEffect(()=>{z(g)},[g]),l.useEffect(()=>{V(w)},[w]);const $=d||u||!!I||!!T,pe=c?c.length:0,ge=O.length,N={setTempChanges:j,handleRowClick:ae};return!v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"item container p-0 list-base",children:[r&&e.jsx("div",{className:"filter-container  m-0",children:e.jsx("input",{className:"m-0",type:"text",placeholder:"Filter items...",value:te,onChange:A=>ie(A.target.value)})}),e.jsxs("div",{className:"item-count",children:["Total items: ",pe,te&&` (showing ${ge} filtered)`]})]}),$&&e.jsx(Dt,{config:{ableForm:i,ableImport:m,seeable:u,removeable:d,showForm:K,showImportForm:X,selectedItem:F,viewLinks:h,tempChanges:f,setTempChanges:j},handlers:{handleShowForm:ue,handleShowImportForm:me,onItemDeleted:x,onSaveAllChanges:he,onReload:I,onAssign:T},hasPendingChanges:Object.keys(f).length>0}),e.jsxs("div",{className:`table-container ${$?"with-actions":""}`,children:[e.jsx(_t,{fields:a,setColumnWidths:ee,sortConfig:H,handleSort:U,showActions:$,useFlexTable:s}),e.jsx(It,{fields:a,items:se,columnWidths:Z,selectedItem:F,tempChanges:f,handlers:N,useFlexTable:s})]}),e.jsx(kt,{currentPage:de,totalPages:ne,onPageChange:M})]})},Pt=({onFileUpload:t,columnNames:n})=>{const[s,o]=l.useState(null),[a,c]=l.useState(null),r=m=>{var u;const d=(u=m.target.files)==null?void 0:u[0];if(d){if(d.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){c("Please upload a valid Excel file (.xlsx)");return}o(d),c(null)}},i=async m=>{if(m.preventDefault(),s){const d=new FileReader;d.onload=u=>{var f;const h=(f=u.target)==null?void 0:f.result;try{const j=rt(h,{type:"binary"}),C=j.SheetNames[0],g=j.Sheets[C];let w=ct.sheet_to_json(g,{header:1});const v=w.shift();console.log("Headers:",v);const y=n.filter(p=>!v.includes(p));if(y.length>0){c(`Missing headers: ${y.join(", ")}`);return}const b=w.map(p=>v.reduce((x,S,I)=>(x[S]=p[I],x),{}));t(b)}catch(j){console.error("Error processing file:",j),c("Error processing file")}},d.readAsBinaryString(s)}};return e.jsxs("form",{onSubmit:i,children:[e.jsx("input",{type:"file",accept:".xlsx",onChange:r,required:!0,"aria-label":"Upload Excel file"}),a&&e.jsx("div",{className:"error",children:a})," ",e.jsx("button",{type:"submit",children:"Load Data"})," "]})},Ee=({label:t,checked:n=!1,onChange:s})=>{const[o,a]=l.useState(n);l.useEffect(()=>{a(n)},[n]);const c=r=>{const i=r.target.checked;a(i),s&&s(i)};return e.jsxs("label",{className:"container",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:c}),e.jsx("svg",{viewBox:"0 0 64 64",height:"1.25em",width:"1.25em",children:e.jsx("path",{d:"M 0 16 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 16 L 32 48 L 64 16 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 16",pathLength:"575.0541381835938",className:"path"})}),t&&e.jsx("span",{children:t})]})};function Tt(t){return Q({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(t)}function Ot(t){return Q({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(t)}function zt(t){return Q({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z"},child:[]}]})(t)}function Vt(t){return Q({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M139.61 35.5a12 12 0 0 0-17 0L58.93 98.81l-22.7-22.12a12 12 0 0 0-17 0L3.53 92.41a12 12 0 0 0 0 17l47.59 47.4a12.78 12.78 0 0 0 17.61 0l15.59-15.62L156.52 69a12.09 12.09 0 0 0 .09-17zm0 159.19a12 12 0 0 0-17 0l-63.68 63.72-22.7-22.1a12 12 0 0 0-17 0L3.53 252a12 12 0 0 0 0 17L51 316.5a12.77 12.77 0 0 0 17.6 0l15.7-15.69 72.2-72.22a12 12 0 0 0 .09-16.9zM64 368c-26.49 0-48.59 21.5-48.59 48S37.53 464 64 464a48 48 0 0 0 0-96zm432 16H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(t)}function Ht(t){return Q({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"},child:[]}]})(t)}const Ut=({title:t,message:n,onConfirm:s,onCancel:o})=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"header",children:e.jsx("div",{className:"image_v",children:e.jsx("div",{className:"image",children:e.jsx(Ot,{})})})}),e.jsxs("div",{className:"content",children:[e.jsx("h2",{className:"title",children:t}),e.jsx("p",{className:"message",children:n})]}),e.jsxs("div",{className:"buttons-container flex",children:[e.jsx("button",{className:"confirm-button",onClick:s,children:"Sí"}),e.jsx("button",{className:"cancel-button",onClick:o,children:"No"})]})]})}),Mt=({fields:t,data:n,onSelect:s,onImport:o,onImportMulti:a,titleModal:c,messageModal:r})=>{const[i,m]=l.useState(n||[]),[d,u]=l.useState(new Set),[h,f]=l.useState(!1);l.useEffect(()=>{m(n)},[n]);const j=p=>{const x=new Set(d);x.has(p)?x.delete(p):x.add(p),u(x)},C=()=>{d.size===i.length?u(new Set):u(new Set(i.map((p,x)=>x)))},g=p=>{u(new Set([p]));const x=i[p];s(x)},w=p=>{const x=i[p];o(x)},v=()=>{const p=i.filter((x,S)=>!d.has(S));m(p),u(new Set)},y=()=>{f(!1);const p=i.filter((x,S)=>d.has(S));if(console.log({dataToImport:p,selectedRows:d}),p.length===0){console.log("No changes to save!");return}a&&a(p)},b=()=>{console.log("Cancelled!"),f(!1)};return i&&i.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"actions buttons-container",children:[e.jsx("button",{className:"delete-button",onClick:v,"aria-label":"Delete selected rows",children:"Delete Selected Rows"}),a&&e.jsx("button",{className:"edit-button",onClick:()=>f(!0),"aria-label":"Confirm and save changes",children:"Confirm and Save"})]}),e.jsxs("div",{className:"table-container",children:[e.jsx("table",{className:"list-base-table header-table","aria-label":"table data to import",children:e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx(Ee,{checked:d.size===i.length,onChange:C,"aria-label":"Select all students"})}),t.map(({name:p,placeholder:x})=>e.jsx("th",{children:x},`up-th-${p}`)),e.jsx("th",{children:"Action"})]})})}),e.jsx("div",{className:"table-body-container",children:e.jsx("table",{className:"upload-table list-base-table body-table","aria-label":"List data to import",children:e.jsx("tbody",{children:i.map((p,x)=>e.jsxs("tr",{"aria-selected":d.has(x),onClick:()=>j(x),children:[e.jsx("td",{children:e.jsxs("div",{onClick:S=>S.stopPropagation(),"aria-hidden":"true",children:[" ",e.jsx(Ee,{checked:d.has(x),onChange:()=>j(x),"aria-label":`Select ${p[0]}`})]})}),t.map(({name:S})=>e.jsx("td",{children:p[S]},`${S}-${x}`)),e.jsxs("td",{className:"actions",onClick:S=>S.stopPropagation(),"aria-hidden":"true",children:[e.jsx("button",{className:"save-button",onClick:()=>g(x),"aria-label":`Select ${p.id}`,children:"Select"}),e.jsx("button",{className:"view-button",onClick:()=>w(x),"aria-label":`Import ${p.id}`,children:"Import"})]})]},`up-row-${x}`))})})})]}),h&&e.jsx(Ut,{title:c||"Confirm Import",message:r||"Are you sure you want to proceed import?",onConfirm:y,onCancel:b})]})},ye=({handlers:t,fetchItems:n,...s})=>{const{children:o,className:a,showForm:c=!1,clearFormAfterAdd:r=!1,ableImport:i=!1,ableFilter:m=!1,ableForm:d=!0,alias:u,title:h,fields:f,items:j,initialFormData:C,loading:g,viewLinks:w,uploadFields:v}=s,{showNotification:y}=ve(),b=(j==null?void 0:j.length)===0,[p,x]=l.useState(C||null),[S,I]=l.useState(f),T=l.useRef(null),K=l.useRef(null),[z,X]=l.useState(null),[V,F]=l.useState(c),[Y,Z]=l.useState(!1),[ee,H]=l.useState(!1),[U,O]=l.useState(null),[te,ie]=l.useState([]),[le,de]=l.useState(!1),[se,ne]=l.useState({}),M=async()=>{n&&await n()},ae=async N=>{var A;await((A=t==null?void 0:t.onItemAdded)==null?void 0:A.call(t,N)),M(),X(null),r&&$()},ue=async N=>{var A;U?(await((A=t==null?void 0:t.onItemUpdated)==null?void 0:A.call(t,U.id,N)),y("Item updated","success"),r&&$()):y("Error updating item","error")},me=async N=>{var A;H(!!N),O(N),(A=t==null?void 0:t.onSelect)==null||A.call(t,N),N||(O(null),x(null),$())},he=async N=>{t!=null&&t.onItemDeleted&&(await(t==null?void 0:t.onItemDeleted(N)),M(),y("Item deleted","success"))},$=()=>{H(!1),O(null),F(c)},pe=N=>{ie(N),de(!0),y("File uploaded successfully!","success")},ge=async()=>{var N;try{(N=t==null?void 0:t.onItemsUpdated)==null||N.call(t,se),ne({})}catch(A){console.error("Error saving changes:",A),y("Error saving changes","error")}};return l.useEffect(()=>{b&&!g?(F(!0),Z(!0)):F(c)},[j]),l.useEffect(()=>{z&&ae(z),M()},[z]),l.useEffect(()=>{t!=null&&t.onItemAdded&&H(!0),(j==null?void 0:j.length)==0&&H(!1),M()},[ee]),l.useEffect(()=>{I(N=>N.some(B=>B.visible)?N:N.map(B=>({...B,visible:!0})))},[f]),e.jsxs(e.Fragment,{children:[h&&e.jsx("h1",{className:"title",children:h}),o,e.jsxs("div",{className:`module-container ${a||""}`,children:[e.jsx(re,{in:!g&&d&&V,timeout:500,classNames:{enter:"animate__animated animate__fast animate__slideInLeft",exit:"animate__animated animate__fast animate__slideOutLeft"},unmountOnExit:!0,nodeRef:T,children:e.jsxs("div",{className:"form-container",ref:T,children:[e.jsx(Et,{onItemAdded:ae,onItemUpdated:ue,fields:S,isEditing:ee,onCancelEdit:$,initialData:p||U,clearFormAfterAdd:r}),i&&e.jsx(e.Fragment,{children:Y&&e.jsx(Pt,{onFileUpload:pe,columnNames:f.map(N=>N.name)})})]})}),e.jsx(re,{in:!V,timeout:500,classNames:{enter:"animate__animated animate__slow animate__heartBeat",exit:"animate__animated animate__slow stretch-shrink"},nodeRef:K,children:e.jsxs("div",{className:"list-container",ref:K,children:[i&&le&&e.jsx("div",{className:"upload-container",children:e.jsx(Mt,{fields:v||f,data:te,onSelect:O,onImport:X,onImportMulti:t==null?void 0:t.onItemsAdded})}),j&&e.jsx($t,{config:{viewLinks:w,loading:g||!1,alias:u,items:j,selectedItem:C||U,fields:S,removeable:!!(t!=null&&t.onItemDeleted),editable:!!(t!=null&&t.onItemUpdated),seeable:!!(t!=null&&t.onView),ableFilter:m,ableForm:d,ableImport:i,showForm:V,showImportForm:Y,useFlexTable:!1,tempChanges:se,setTempChanges:ne},handlers:{onAdd:F,onImport:Z,onSelect:me,onItemDeleted:he,onItemsUpdated:ge,onReload:t==null?void 0:t.onReload,onAssign:t==null?void 0:t.onAssign}})]})})]})]})},Bt=async(t,n)=>{const s=L(E,`periods/${t}/courses/${n}/assignments`);return(await W(s)).docs.map(c=>({id:c.id,...c.data()}))},qt=async(t,n,s)=>{const o=L(E,`periods/${t}/courses/${n}/assignments`),a=await be(o,{...s});console.log("Assignment added with ID: ",a.id);const c=k(E,`periods/${t}/courses/${n}`);await P(c,{assignmentsIds:$e(a.id)})},Gt=async(t,n,s)=>{const o=at(E),a=L(E,`periods/${n}/courses/${s}/assignments`);t.forEach(c=>{const r=k(a);o.set(r,{title:c.title,contributionPercentage:c.contributionPercentage})});try{await o.commit()}catch(c){throw console.error("Error committing batch:",c),new Error("Error adding assignments")}},Jt=async(t,n,s,o,a)=>{const c=k(E,`periods/${t}/courses/${n}/assignments/${s}`),{id:r,...i}=o;await P(c,i)},Wt=async(t,n,s)=>{const o=k(E,`periods/${t}/courses/${n}/assignments/${s}`);await je(o);const a=k(E,`periods/${t}`);await P(a,{assignmentsIds:Pe(n)})},Qt=async(t,n)=>{const s=L(E,`periods/${t}/courses/${n}/assignments`),a=(await W(s)).docs.map(r=>r.id);console.log({ids:a,periodId:t,courseId:n});const c=k(E,`periods/${t}/courses/${n}`);await P(c,{assignmentsIds:a})},Kt=t=>{const{courseId:n,periodId:s}=t,[o,a]=l.useState([]),[c,r]=l.useState(!1),[i,m]=l.useState(null),{showNotification:d}=ve(),u=l.useCallback(async()=>{r(!0);try{const v=await Bt(s,n);a(v)}catch(v){m(v instanceof Error?v.message:"Error al cargar las calificaciones")}finally{r(!1)}},[s,n,r]);l.useEffect(()=>{let v=!0;return(async()=>{v&&await u()})(),()=>{v=!1}},[n,u]);const h=l.useCallback(async v=>{r(!0);try{const{id:y,...b}=v;await qt(s,n,b),await u()}catch(y){m(y instanceof Error?y.message:"Error adding assignment")}finally{r(!1)}},[s,n,u,r]),f=async v=>{try{const y=v.filter(p=>!o.some(x=>x.title===p.title));if(y.length===0){d("All assignments already exist","error");return}if(y.filter(p=>!j(p)).length>0){d("Some assignments have invalid data","error");return}await Gt(y,s,n),d(`${y.length} assignments added`,"success"),u()}catch(y){console.error("Error adding assignments:",y),m("Error adding assignments")}},j=v=>o.some(b=>b.title===v.title)?(d("The assignment already exists","error"),!1):!v.title||typeof v.contributionPercentage!="number"||v.contributionPercentage<0||v.contributionPercentage>100?(d("Invalid assignment data","error"),!1):!0,C=l.useCallback(async(v,y)=>{r(!0);try{await Jt(s,n,v,y),await u()}catch(b){m(b instanceof Error?b.message:"Error updating assignment")}finally{r(!1)}},[s,n,u,r]),g=l.useCallback(async v=>{r(!0);try{await Wt(s,n,v),await u()}catch(y){m(y instanceof Error?y.message:"Error deleting assignment")}finally{r(!1)}},[s,n,u,r]);return{assignments:o,loadAssignments:u,loading:c,setLoading:r,error:i,handleAddAssignment:h,handleAddAssignments:f,handleUpdateAssignment:C,handleDeleteAssignment:g,handleSyncAssignments:async()=>{try{if(console.log("Syncing assignments for period:",s,"course:",n),!s||!n){m("Invalid period or course ID");return}r(!0),await Qt(s,n),await u()}catch{m("Error syncing assignments")}finally{r(!1)}}}},Me=({periodId:t,courseId:n})=>{const{assignments:s,loading:o,error:a,handleAddAssignment:c,handleAddAssignments:r,handleDeleteAssignment:i,handleUpdateAssignment:m}=Kt({periodId:t,courseId:n}),d=l.useMemo(()=>s.reduce((h,f)=>h+(Number(f.contributionPercentage)||0),0),[s]),u=[{name:"title",placeholder:"Title of the assignment"},{name:"contributionPercentage",placeholder:"percentage",type:"number-view"},{name:"link",placeholder:"URL",type:"link",required:!1}];return o?e.jsx(ce,{text:"Loading assignments",className:"h30vh"}):a?e.jsxs("div",{children:["Error: ",a]}):e.jsx("div",{className:"assignments-manager",children:e.jsx(ye,{title:"Assignments",alias:n,fields:u,items:s,handlers:{onItemAdded:c,onItemUpdated:m,onItemDeleted:i,onItemsAdded:r},loading:o,clearFormAfterAdd:!1,showForm:!1,ableForm:!0,ableImport:!0,children:e.jsxs("div",{className:"container",children:[e.jsxs("p",{children:[e.jsx("b",{children:"Total Percentage: "}),"(",d,")%"]}),d<100&&e.jsxs("p",{children:[e.jsx("b",{children:"Pending Percentage: "}),"(",100-d,")%"]})]})})})},Xt=({children:t,titleName:n,fields:s,data:o,handlers:a,ableDelete:c,viewLink:r,customButtons:i})=>{const m=(u,h)=>{switch(u){case"date":return new Date(h).toLocaleDateString();case"array":return h.length;case"number":return Number(h).toLocaleString();default:return h}},d=!!(a!=null&&a.onItemUpdated)||c||r;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"actions buttons-container compact",children:[(a==null?void 0:a.onItemUpdated)&&e.jsx("button",{onClick:()=>a.onItemUpdated&&o&&a.onItemUpdated(o),className:"edit-button",children:"Save"}),c&&o&&o.id&&e.jsx("button",{onClick:()=>(a==null?void 0:a.onDelete)&&o&&a.onDelete(o.id),className:"delete-button",children:"Delete"}),r&&e.jsx(J,{to:r,className:"button view-button","aria-label":"View selected item",children:"View"}),i&&i.map((u,h)=>e.jsx("button",{onClick:u.onClick,className:`button ${u.className||""}`,"aria-label":u.ariaLabel||u.label,children:u.label},h))]}),e.jsxs("div",{className:`module-card ${d?"with-actions":""}`,children:[t,e.jsx("h3",{children:o?o[n]:""}),s.map(({name:u,placeholder:h,type:f})=>o&&o[u]?e.jsxs("p",{children:[e.jsxs("strong",{className:"capitalize",children:[h,":"]})," ",m(f,o[u])]},u):null)]})]})},Yt=[{name:"name",placeholder:"name"},{name:"description",placeholder:"description"},{name:"duration",placeholder:"duration"},{name:"hours",placeholder:"hours"},{name:"status",placeholder:"status"},{name:"assignmentsIds",placeholder:"assignments",type:"array"},{name:"enrolledStudents",placeholder:"Enrolled Students",type:"array"},{name:"teacherName",placeholder:"teacherName"}],Be=({children:t,childrenVisible:n,course:s,teachers:o,setSelectedTeacher:a,viewLink:c,handlers:r})=>{var g;const[i,m]=l.useState(n),d=l.useRef(null),u=l.useRef(null),{onDelete:h,onItemAdded:f,onItemUpdated:j}=r,C=()=>{m(!i)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"item m-0 px-0",children:[!s.teacherId&&e.jsx(e.Fragment,{children:e.jsx(Ue,{label:"Teacher",options:o.map(w=>({value:w.id,label:w.name})),value:"",onChange:w=>a(w.value),placeholder:"Select Teacher"},"teacherId")}),e.jsx(re,{in:i,timeout:500,classNames:"fade",unmountOnExit:!0,nodeRef:d,children:e.jsx("div",{ref:w=>d.current=w,className:"fade-container",children:t})}),e.jsx(re,{in:!i,timeout:500,classNames:{enter:"animate__animated animate__bounceInUp"},nodeRef:u,children:e.jsx("div",{ref:u,children:e.jsx(Xt,{titleName:"name",fields:Yt,data:s,viewLink:c,handlers:{onDelete:h,onItemAdded:f,onItemUpdated:j},ableDelete:s.assignmentsIds.length===0&&(((g=s.enrolledStudents)==null?void 0:g.length)??0)===0,customButtons:[{label:i?"Hide Assignments":"Assignments",onClick:C,className:"save-button",ariaLabel:"Toggle Details Button"}]})})})]})})},xe=[{name:"name",placeholder:"name",size:10,visible:!0},{name:"description",placeholder:"description",visible:!0},{name:"teacherName",placeholder:"teacher",visible:!1}],Zt=({type:t,courses:n,setSelectedCourseId:s,loading:o,load:a,assign:c})=>{const r=d=>{d&&s&&s(d.id??null)},[i,m]=l.useState(xe);return l.useEffect(()=>{m(t==="assign"?xe.map(d=>d.name==="teacherName"?{...d,visible:!0}:d):xe)},[t]),e.jsx(ye,{className:"p-0",alias:`${t}Courses`.toUpperCase(),fields:i,items:n,handlers:{onSelect:r,onReload:a,onAssign:c},ableForm:!1,showForm:!1,loading:o})},es=[{name:"name",placeholder:"name",size:10},{name:"description",placeholder:"description"},{name:"teacherName",placeholder:"teacher"}],ts=({periodId:t,courses:n,teachers:s,loading:o,load:a,assign:c,handlers:r})=>{const[i,m]=l.useState(null),[,d]=l.useState(null);return e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"p-0",alias:"assignCourses",fields:es,items:n,handlers:{onSelect:m,onReload:a,onAssign:c},ableForm:!1,showForm:!1,loading:o}),i&&e.jsx(Be,{course:i,teachers:s,handlers:r,setSelectedTeacher:d,viewLink:`/period/${t}/course/${i.id}`,children:i.id&&t&&e.jsx(Me,{courseId:i.id,periodId:t})})]})},ss=({periodId:t})=>{const n=Qe(),{loading:s,courses:o,availableCourses:a,availableTeachers:c,handleAddCourse:r,handleDeleteCourse:i,handleUpdateCourse:m,loadAvailableCourses:d}=At(t),[u,h]=l.useState(null),[f,j]=l.useState(null),[C]=G("selectPeriod",null),[g,w]=l.useState("table"),v=()=>{n(-1)},y=async x=>{if(f){const{id:S,...I}=x,T={...I,teacherId:f};await m(S,T),j(null)}},b=async()=>{const{id:x,...S}=a.filter(I=>I.id===u)[0];if(u){const I={...S,periodId:t,courseId:x,status:"Not Started",assignmentsIds:[],enrolledStudents:[]};await r(I),h(null)}},p={onDelete:i,onItemUpdated:y};return e.jsxs("div",{className:"periods-manager",children:[e.jsxs("div",{className:"container px-0",children:[e.jsx("h2",{children:C==null?void 0:C.name}),e.jsx("button",{onClick:v,children:"Go Back"})]}),e.jsxs("div",{className:"container p-0",children:[e.jsxs("div",{className:"view-toggle",children:[e.jsxs("button",{onClick:()=>w("cards"),className:g==="cards"?"active":"",children:[e.jsx(Ht,{})," Cards"]}),e.jsxs("button",{onClick:()=>w("table"),className:g==="table"?"active":"",children:[e.jsx(zt,{})," Table"]})]}),e.jsx("div",{className:"view-toggle",children:e.jsxs("button",{onClick:()=>w("assign"),className:g==="assign"?"active":"",children:[e.jsx(Vt,{})," assign"]})})]}),e.jsx("h1",{className:"title bt",children:g==="assign"?"COURSES TO ASSIGN":"ASSIGNED COURSES"}),e.jsx(e.Fragment,{children:g==="assign"&&t&&e.jsxs("div",{className:"item m-0 p-0",children:[e.jsx(Zt,{type:"available",courses:a.filter(x=>!o.some(S=>S.courseId===x.id)),setSelectedCourseId:h,assign:b,loading:s,load:d}),a.length===0&&e.jsx("div",{className:"empty",children:"No courses available for this period"}),a.filter(x=>!o.some(S=>S.courseId===x.id)).length===0&&e.jsx("div",{className:"empty",children:"All available courses have already been assigned to this period."})]})}),g==="table"&&e.jsx("div",{className:"item m-0 p-0",children:e.jsx(ts,{type:"assign",courses:o,loading:s,teachers:c,periodId:t,handlers:p})}),g==="cards"&&e.jsx(e.Fragment,{children:o.map((x,S)=>e.jsx(Be,{course:x,teachers:c,handlers:p,setSelectedTeacher:j,childrenVisible:!1,viewLink:`/period/${t}/course/${x.id}`,children:x.id&&t&&e.jsx(Me,{courseId:x.id,periodId:t})},S))})]})},ns=()=>{const{id:t}=Ke();return e.jsx("div",{children:t&&e.jsx(ss,{periodId:t})})},as=l.lazy(()=>R(()=>import("./Register-Db3fhZJ3.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),os=l.lazy(()=>R(()=>import("./Home-BPTMV86g.js"),__vite__mapDeps([7,1,2,8,9,3,4,5]))),rs=l.lazy(()=>R(()=>import("./Courses-GZVv-HpM.js"),__vite__mapDeps([10,1,11,2,3,4,5]))),_e=l.lazy(()=>R(()=>import("./Grades-CDwhQgH9.js"),__vite__mapDeps([12,1,2,13,14,3,4,5]))),Ie=l.lazy(()=>R(()=>import("./Periods-KtQo2Wvu.js"),__vite__mapDeps([15,1,16,2,3,4,5]))),cs=l.lazy(()=>R(()=>import("./Dashboard-B1yXbL4p.js"),__vite__mapDeps([17,1,2,8,9,3,4,5]))),is=l.lazy(()=>R(()=>import("./Students-COeRfAva.js"),__vite__mapDeps([18,1,13,14,2,19,20,16,21,3,4,5,22]))),ls=l.lazy(()=>R(()=>import("./Teachers-DSZwJA-V.js"),__vite__mapDeps([23,1,2,3,4,5]))),De=l.lazy(()=>R(()=>import("./StudentsCourses-C35jJyaj.js"),__vite__mapDeps([24,1,13,14,2,19,20,16,21,3,4,5]))),ke=l.lazy(()=>R(()=>import("./CourseStudents-DEj6iJfI.js"),__vite__mapDeps([25,1,11,2,14,20,16,3,4,5,26]))),ds=l.lazy(()=>R(()=>import("./PeriodStudents-CQSU45DP.js"),__vite__mapDeps([27,1,2,3,4,5]))),us=()=>{const{loading:t}=Oe(),{setIsLoading:n}=Ve(),[s,o]=l.useState(!1),[a,c]=l.useState(!1);if(l.useEffect(()=>{let i;return t?n(!0):i=setTimeout(()=>{n(!1),o(!0),c(!0)},2e3),()=>{i&&clearTimeout(i)}},[t,n]),!s)return null;const r=e.jsxs(Xe,{children:[e.jsx(_,{path:"/",element:e.jsx(os,{})}),e.jsx(_,{path:"/register",element:e.jsx(as,{})}),e.jsx(_,{path:"/dashboard",element:e.jsx(D,{element:e.jsx(cs,{})})}),e.jsx(_,{path:"/students",element:e.jsx(D,{element:e.jsx(is,{})})}),e.jsx(_,{path:"/students/:id/periods",element:e.jsx(D,{element:e.jsx(De,{})})}),e.jsx(_,{path:"/students/:id/courses",element:e.jsx(D,{element:e.jsx(De,{})})}),e.jsx(_,{path:"/teachers",element:e.jsx(D,{element:e.jsx(ls,{})})}),e.jsx(_,{path:"/courses",element:e.jsx(D,{element:e.jsx(rs,{})})}),e.jsx(_,{path:"/grades",element:e.jsx(D,{element:e.jsx(_e,{})})}),e.jsx(_,{path:"/periods",element:e.jsx(D,{element:e.jsx(Ie,{})})}),e.jsx(_,{path:"/periods/courses",element:e.jsx(D,{element:e.jsx(Ie,{})})}),e.jsx(_,{path:"/period/:id/courses",element:e.jsx(D,{element:e.jsx(ns,{})})}),e.jsx(_,{path:"/period/:id/students",element:e.jsx(D,{element:e.jsx(ds,{})})}),e.jsx(_,{path:"/period/:periodId/course/:courseId",element:e.jsx(D,{element:e.jsx(ke,{})})}),e.jsx(_,{path:"grades/period/:periodId/course/:courseId",element:e.jsx(D,{element:e.jsx(_e,{})})}),e.jsx(_,{path:"/course/:id/students",element:e.jsx(D,{element:e.jsx(ke,{})})}),e.jsx(_,{path:"*",element:e.jsx(Fe,{to:"/"})})," "]});return e.jsx(l.Suspense,{fallback:e.jsx(ce,{text:"Cargando componente..."}),children:a?r:null})},qe=l.createContext(void 0),ms=({children:t})=>{const[n,s]=l.useState(null);return e.jsx(qe.Provider,{value:{openDropdown:n,setOpenDropdown:s},children:t})},hs=()=>{const t=l.useContext(qe);if(t===void 0)throw new Error("useDropdown must be used within a DropdownProvider");return t},Ge=({id:t,title:n,items:s})=>{const{openDropdown:o,setOpenDropdown:a}=hs(),c=Le(),r=()=>{a(o===t?null:t)},i=o===t,m=s.some(d=>c.pathname===d.to);return e.jsxs("div",{className:"dropdown",children:[e.jsxs("button",{onClick:r,className:`dropdown-button${m?" active":""} ${i?" open":""}`,children:[n," ",e.jsx("span",{className:"dropdown-icon",children:"▼"})]}),i&&e.jsx("ul",{className:"dropdown-menu",children:s.map((d,u)=>e.jsx("li",{className:c.pathname===d.to?"active":"",onClick:()=>a(null),children:e.jsxs(J,{to:d.to,style:{display:"flex",alignItems:"center"},children:[d.icon&&e.jsx("span",{className:"item-icon",children:d.icon}),d.label]})},u))})]})},ps=({items:t})=>{const n=Le();return e.jsx("header",{className:"navbar",children:e.jsx("ul",{children:t.map(s=>e.jsx("li",{children:s.children?e.jsx(Ge,{id:`${s.label.toLowerCase()}-dropdown-desktop`,title:s.label,items:s.children}):e.jsx("button",{className:`dropdown-button ${n.pathname===s.to?"active":""}`,children:e.jsx(J,{to:s.to,children:s.label})})},s.label))})})},gs=({items:t,isOpen:n,onClose:s})=>e.jsxs("div",{className:`sidebar ${n?"open":""}`,children:[e.jsx("button",{className:"close-button",onClick:s,children:"× "}),e.jsx("ul",{children:t.map(o=>e.jsx("li",{children:o.children?e.jsx(Ge,{id:`${o.label.toLowerCase()}-dropdown`,title:o.label,items:o.children}):e.jsx("button",{className:`dropdown-button ${location.pathname===o.to?"active":""}`,children:e.jsx(J,{to:o.to,onClick:s,children:o.label})})},o.label))})]}),Re=[{label:"Dashboard",to:"/dashboard"},{label:"Students",to:"",children:[{label:"Estudiantes",to:"/students"},{label:"Calificaciones",to:"/grades"}]},{label:"Params",to:"",children:[{label:"Periods",to:"/periods"},{label:"Courses",to:"/courses"},{label:"Profesores",to:"/teachers"}]},{label:"User",to:"",children:[{label:"Login",to:"/login"},{label:"Register",to:"/register"}]}],fs=()=>{const[t,n]=l.useState(!1),s=()=>{n(!t)};return e.jsxs("div",{children:[e.jsxs("button",{className:"toggle-button",onClick:s,children:[e.jsx(Tt,{})," "]}),e.jsx(gs,{items:Re,isOpen:t,onClose:()=>n(!1)}),e.jsx(ps,{items:Re})]})},xs=({children:t})=>e.jsxs("div",{className:"grid",children:[e.jsx("div",{className:"header",children:e.jsx(fs,{})}),e.jsx("div",{className:"main",children:t})]}),bs=()=>e.jsx(Ye,{basename:"/learntrackcenter",children:e.jsx(Ct,{children:e.jsx(wt,{children:e.jsx(ms,{children:e.jsx(xs,{children:e.jsx(us,{})})})})})});ut.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(bs,{})}));export{Me as A,Xt as C,ye as D,ce as L,ss as P,gt as a,Oe as b,Ve as c,E as d,G as e,ft as f,Ss as g,Cs as h,As as i,e as j,Ns as k,Bt as l,bt as m,ve as u};
