import{f as P,r as f,d as w,j as e,o as E,C as D}from"./index-BozJdoqh.js";import{f as A,a as L,b as k,c as $,d as T,u as q,e as B}from"./useStudentCourses-D2S5OMls.js";const G=()=>{const{setIsLoading:n,setLoadingText:r}=P(),[i,o]=f.useState([]),[x,N]=f.useState(),[u,h]=f.useState(!0),[v,l]=f.useState(null),{showNotification:d}=w();f.useEffect(()=>{r("Loading Student"),n(u)},[u,n]);const c=async()=>{try{h(!0);const s=await A();o(s)}catch{l("Error loading students")}finally{h(!1)}},p=async s=>{try{if(!s){console.error("Student ID is null or undefined");return}h(!0);const a=await L(s);console.log("studentData",a),N(a)}catch{l("Error loading student"),d("Error loading student","error"),console.error(`Error loading student ${s}`)}finally{h(!1)}};f.useEffect(()=>{c()},[]);const y=async s=>{try{if(!m(s))return;await k(s),d("Element added","success"),c()}catch{l("Error adding the student")}},j=async s=>{try{const a=s.filter(g=>!i.some(I=>I.fullName===g.fullName));if(a.length===0){d("All students already exist","error");return}if(a.filter(g=>!m(g)).length>0){d("Some students have invalid data","error");return}await $(a),d(`${a.length} elements added`,"success"),c()}catch(a){console.error("Error adding students:",a),l("Error adding students")}},C=async s=>{try{await T(s),c()}catch{l("Error deleting the student")}},b=async(s,a)=>{try{await q(s,a),c()}catch{l("Error updating the student")}},t=s=>typeof s>"u"||s.trim()===""?!1:/\S+@\S+\.\S+/.test(s),m=s=>i.some(S=>S.fullName===s.fullName)?(d("The student already exists","error"),!1):!s.fullName||!t(s.email)?(d("Invalid student data","error"),!1):!0;return{students:i,student:x,loadStudents:c,loadStudent:p,loading:u,error:v,handleAddStudent:y,handleAddStudents:j,handleRemoveStudent:C,handleUpdateStudent:b}},M=({student:n,onEdit:r,onDelete:i})=>e.jsxs("div",{className:"student-card",children:[e.jsx("h3",{children:n.fullName}),n.identificationNumber&&e.jsxs("p",{children:[e.jsx("strong",{children:"ID:"})," ",n.identificationNumber]}),n.email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",n.email]}),e.jsxs("div",{className:"student-card-actions",children:[r&&e.jsx("button",{onClick:()=>r(n),className:"edit-button",children:"Edit"}),i&&n.id&&e.jsx("button",{onClick:()=>i(n.id),className:"delete-button",children:"Delete"})]})]}),O=({student:n})=>{const[r,i]=E("selectedPeriodId",null),[o,x]=E("selectedCourseId",null),{error:N,availableCourses:u,availablePeriods:h,studentCourses:v,handleAddCourse:l,handleDeleteCourse:d,setPeriodId:c}=B(n.id),p=async()=>{if(r&&o){const{id:t,duration:m,hours:s,...a}=u.filter(g=>g.id===o)[0],S={...a,periodId:r,periodCourseId:o,courseId:o,status:"Not Started",finalGrade:0,assignmentsIds:[]};await l(n.id,S)}},y=t=>{i(t),c(t),x(null)},j=(t,m)=>t&&m&&String(t)===String(m),C=[{name:"name",placeholder:"name"},{name:"description",placeholder:"description"},{name:"duration",placeholder:"duration"},{name:"hours",placeholder:"hours"},{name:"status",placeholder:"status"},{name:"teacherName",placeholder:"teacherName"},{name:"assignmentsIds",placeholder:"Assignments",type:"array"}],b=async t=>{await d(n.id,t)};return N?e.jsx("div",{className:"error",children:N}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"item",children:[e.jsx("h3",{children:"Periods"}),e.jsx("div",{className:"buttons-container",children:h.map(t=>e.jsx("button",{className:`button ${j(r,t.id)?"active":""}`,onClick:()=>y(t.id),children:t.code},t.id))})]}),r&&e.jsxs("div",{className:"item",children:[e.jsx("h3",{children:"Available Courses"}),e.jsx("div",{className:"buttons-container",children:u.map(t=>e.jsx("button",{className:`button ${j(o,t.id)?"active":""}`,onClick:()=>x(t.id),children:t.name},t.id))}),u.length===0&&e.jsx("div",{className:"empty",children:"No courses available for this period"})]}),r&&o&&e.jsx("button",{className:"edit-button",onClick:p,children:"Assign course"})]}),e.jsx("div",{className:"container",children:v.map(t=>e.jsx("div",{children:e.jsx(D,{titleName:"name",fields:C,data:t,onDelete:b,ableDelete:t.assignmentsIds.length===0})},`div-${t.id}`))})]})};export{O as P,M as S,G as u};
