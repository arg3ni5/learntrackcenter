const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Register-bowjnG0_.js","assets/Register-Duh75M7k.css","assets/Home-CMXl9aMT.js","assets/UserProfile-D2suqR0P.js","assets/UserProfile-BREJmAyz.css","assets/Courses-CBfsy0Rs.js","assets/courseService-D0fa1hNt.js","assets/Grades-CFufRhY8.js","assets/useStudents-BEuFtvXr.js","assets/studentService-DdMT3nti.js","assets/Periods-ue_t-bD9.js","assets/periodService-B9GLDZYZ.js","assets/Dashboard-Bzi2hLAY.js","assets/Students-BAHQ8X_3.js","assets/PeriodsManager-b9FjHQ0R.js","assets/useStudentCourses-CvS9slwc.js","assets/PeriodsManager-jNovB0yZ.css","assets/Students-WaJLWye5.css","assets/StudentsCourses-DsqqlxHv.js","assets/CourseStudents-nBi6jYH6.js","assets/CourseStudents-ispZDE6Z.css"])))=>i.map(i=>d[i]);
function oI(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function lI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tm={exports:{}},eu={},rm={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w_;function cI(){if(w_)return ht;w_=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function v(te){return te===null||typeof te!="object"?null:(te=g&&te[g]||te["@@iterator"],typeof te=="function"?te:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,y={};function w(te,D,re){this.props=te,this.context=D,this.refs=y,this.updater=re||_}w.prototype.isReactComponent={},w.prototype.setState=function(te,D){if(typeof te!="object"&&typeof te!="function"&&te!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,te,D,"setState")},w.prototype.forceUpdate=function(te){this.updater.enqueueForceUpdate(this,te,"forceUpdate")};function k(){}k.prototype=w.prototype;function F(te,D,re){this.props=te,this.context=D,this.refs=y,this.updater=re||_}var C=F.prototype=new k;C.constructor=F,E(C,w.prototype),C.isPureReactComponent=!0;var U=Array.isArray,V=Object.prototype.hasOwnProperty,z={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function P(te,D,re){var ee,Z={},ce=null,_e=null;if(D!=null)for(ee in D.ref!==void 0&&(_e=D.ref),D.key!==void 0&&(ce=""+D.key),D)V.call(D,ee)&&!A.hasOwnProperty(ee)&&(Z[ee]=D[ee]);var ve=arguments.length-2;if(ve===1)Z.children=re;else if(1<ve){for(var ye=Array(ve),Te=0;Te<ve;Te++)ye[Te]=arguments[Te+2];Z.children=ye}if(te&&te.defaultProps)for(ee in ve=te.defaultProps,ve)Z[ee]===void 0&&(Z[ee]=ve[ee]);return{$$typeof:t,type:te,key:ce,ref:_e,props:Z,_owner:z.current}}function R(te,D){return{$$typeof:t,type:te.type,key:D,ref:te.ref,props:te.props,_owner:te._owner}}function M(te){return typeof te=="object"&&te!==null&&te.$$typeof===t}function L(te){var D={"=":"=0",":":"=2"};return"$"+te.replace(/[=:]/g,function(re){return D[re]})}var N=/\/+/g;function B(te,D){return typeof te=="object"&&te!==null&&te.key!=null?L(""+te.key):D.toString(36)}function Oe(te,D,re,ee,Z){var ce=typeof te;(ce==="undefined"||ce==="boolean")&&(te=null);var _e=!1;if(te===null)_e=!0;else switch(ce){case"string":case"number":_e=!0;break;case"object":switch(te.$$typeof){case t:case e:_e=!0}}if(_e)return _e=te,Z=Z(_e),te=ee===""?"."+B(_e,0):ee,U(Z)?(re="",te!=null&&(re=te.replace(N,"$&/")+"/"),Oe(Z,D,re,"",function(Te){return Te})):Z!=null&&(M(Z)&&(Z=R(Z,re+(!Z.key||_e&&_e.key===Z.key?"":(""+Z.key).replace(N,"$&/")+"/")+te)),D.push(Z)),1;if(_e=0,ee=ee===""?".":ee+":",U(te))for(var ve=0;ve<te.length;ve++){ce=te[ve];var ye=ee+B(ce,ve);_e+=Oe(ce,D,re,ye,Z)}else if(ye=v(te),typeof ye=="function")for(te=ye.call(te),ve=0;!(ce=te.next()).done;)ce=ce.value,ye=ee+B(ce,ve++),_e+=Oe(ce,D,re,ye,Z);else if(ce==="object")throw D=String(te),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(te).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.");return _e}function we(te,D,re){if(te==null)return te;var ee=[],Z=0;return Oe(te,ee,"","",function(ce){return D.call(re,ce,Z++)}),ee}function Ce(te){if(te._status===-1){var D=te._result;D=D(),D.then(function(re){(te._status===0||te._status===-1)&&(te._status=1,te._result=re)},function(re){(te._status===0||te._status===-1)&&(te._status=2,te._result=re)}),te._status===-1&&(te._status=0,te._result=D)}if(te._status===1)return te._result.default;throw te._result}var Ae={current:null},Ee={transition:null},ie={ReactCurrentDispatcher:Ae,ReactCurrentBatchConfig:Ee,ReactCurrentOwner:z};function xe(){throw Error("act(...) is not supported in production builds of React.")}return ht.Children={map:we,forEach:function(te,D,re){we(te,function(){D.apply(this,arguments)},re)},count:function(te){var D=0;return we(te,function(){D++}),D},toArray:function(te){return we(te,function(D){return D})||[]},only:function(te){if(!M(te))throw Error("React.Children.only expected to receive a single React element child.");return te}},ht.Component=w,ht.Fragment=r,ht.Profiler=i,ht.PureComponent=F,ht.StrictMode=n,ht.Suspense=u,ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,ht.act=xe,ht.cloneElement=function(te,D,re){if(te==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+te+".");var ee=E({},te.props),Z=te.key,ce=te.ref,_e=te._owner;if(D!=null){if(D.ref!==void 0&&(ce=D.ref,_e=z.current),D.key!==void 0&&(Z=""+D.key),te.type&&te.type.defaultProps)var ve=te.type.defaultProps;for(ye in D)V.call(D,ye)&&!A.hasOwnProperty(ye)&&(ee[ye]=D[ye]===void 0&&ve!==void 0?ve[ye]:D[ye])}var ye=arguments.length-2;if(ye===1)ee.children=re;else if(1<ye){ve=Array(ye);for(var Te=0;Te<ye;Te++)ve[Te]=arguments[Te+2];ee.children=ve}return{$$typeof:t,type:te.type,key:Z,ref:ce,props:ee,_owner:_e}},ht.createContext=function(te){return te={$$typeof:o,_currentValue:te,_currentValue2:te,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},te.Provider={$$typeof:a,_context:te},te.Consumer=te},ht.createElement=P,ht.createFactory=function(te){var D=P.bind(null,te);return D.type=te,D},ht.createRef=function(){return{current:null}},ht.forwardRef=function(te){return{$$typeof:c,render:te}},ht.isValidElement=M,ht.lazy=function(te){return{$$typeof:d,_payload:{_status:-1,_result:te},_init:Ce}},ht.memo=function(te,D){return{$$typeof:h,type:te,compare:D===void 0?null:D}},ht.startTransition=function(te){var D=Ee.transition;Ee.transition={};try{te()}finally{Ee.transition=D}},ht.unstable_act=xe,ht.useCallback=function(te,D){return Ae.current.useCallback(te,D)},ht.useContext=function(te){return Ae.current.useContext(te)},ht.useDebugValue=function(){},ht.useDeferredValue=function(te){return Ae.current.useDeferredValue(te)},ht.useEffect=function(te,D){return Ae.current.useEffect(te,D)},ht.useId=function(){return Ae.current.useId()},ht.useImperativeHandle=function(te,D,re){return Ae.current.useImperativeHandle(te,D,re)},ht.useInsertionEffect=function(te,D){return Ae.current.useInsertionEffect(te,D)},ht.useLayoutEffect=function(te,D){return Ae.current.useLayoutEffect(te,D)},ht.useMemo=function(te,D){return Ae.current.useMemo(te,D)},ht.useReducer=function(te,D,re){return Ae.current.useReducer(te,D,re)},ht.useRef=function(te){return Ae.current.useRef(te)},ht.useState=function(te){return Ae.current.useState(te)},ht.useSyncExternalStore=function(te,D,re){return Ae.current.useSyncExternalStore(te,D,re)},ht.useTransition=function(){return Ae.current.useTransition()},ht.version="18.3.1",ht}var T_;function Pg(){return T_||(T_=1,rm.exports=cI()),rm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function uI(){if(S_)return eu;S_=1;var t=Pg(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,h){var d,g={},v=null,_=null;h!==void 0&&(v=""+h),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(_=u.ref);for(d in u)n.call(u,d)&&!a.hasOwnProperty(d)&&(g[d]=u[d]);if(c&&c.defaultProps)for(d in u=c.defaultProps,u)g[d]===void 0&&(g[d]=u[d]);return{$$typeof:e,type:c,key:v,ref:_,props:g,_owner:i.current}}return eu.Fragment=r,eu.jsx=o,eu.jsxs=o,eu}var k_;function fI(){return k_||(k_=1,tm.exports=uI()),tm.exports}var Y=fI(),G=Pg();const Ms=lI(G),A_=oI({__proto__:null,default:Ms},[G]);var Ih={},nm={exports:{}},Mn={},im={exports:{}},am={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C_;function hI(){return C_||(C_=1,function(t){function e(Ee,ie){var xe=Ee.length;Ee.push(ie);e:for(;0<xe;){var te=xe-1>>>1,D=Ee[te];if(0<i(D,ie))Ee[te]=ie,Ee[xe]=D,xe=te;else break e}}function r(Ee){return Ee.length===0?null:Ee[0]}function n(Ee){if(Ee.length===0)return null;var ie=Ee[0],xe=Ee.pop();if(xe!==ie){Ee[0]=xe;e:for(var te=0,D=Ee.length,re=D>>>1;te<re;){var ee=2*(te+1)-1,Z=Ee[ee],ce=ee+1,_e=Ee[ce];if(0>i(Z,xe))ce<D&&0>i(_e,Z)?(Ee[te]=_e,Ee[ce]=xe,te=ce):(Ee[te]=Z,Ee[ee]=xe,te=ee);else if(ce<D&&0>i(_e,xe))Ee[te]=_e,Ee[ce]=xe,te=ce;else break e}}return ie}function i(Ee,ie){var xe=Ee.sortIndex-ie.sortIndex;return xe!==0?xe:Ee.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,g=null,v=3,_=!1,E=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Ee){for(var ie=r(h);ie!==null;){if(ie.callback===null)n(h);else if(ie.startTime<=Ee)n(h),ie.sortIndex=ie.expirationTime,e(u,ie);else break;ie=r(h)}}function U(Ee){if(y=!1,C(Ee),!E)if(r(u)!==null)E=!0,Ce(V);else{var ie=r(h);ie!==null&&Ae(U,ie.startTime-Ee)}}function V(Ee,ie){E=!1,y&&(y=!1,k(P),P=-1),_=!0;var xe=v;try{for(C(ie),g=r(u);g!==null&&(!(g.expirationTime>ie)||Ee&&!L());){var te=g.callback;if(typeof te=="function"){g.callback=null,v=g.priorityLevel;var D=te(g.expirationTime<=ie);ie=t.unstable_now(),typeof D=="function"?g.callback=D:g===r(u)&&n(u),C(ie)}else n(u);g=r(u)}if(g!==null)var re=!0;else{var ee=r(h);ee!==null&&Ae(U,ee.startTime-ie),re=!1}return re}finally{g=null,v=xe,_=!1}}var z=!1,A=null,P=-1,R=5,M=-1;function L(){return!(t.unstable_now()-M<R)}function N(){if(A!==null){var Ee=t.unstable_now();M=Ee;var ie=!0;try{ie=A(!0,Ee)}finally{ie?B():(z=!1,A=null)}}else z=!1}var B;if(typeof F=="function")B=function(){F(N)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,we=Oe.port2;Oe.port1.onmessage=N,B=function(){we.postMessage(null)}}else B=function(){w(N,0)};function Ce(Ee){A=Ee,z||(z=!0,B())}function Ae(Ee,ie){P=w(function(){Ee(t.unstable_now())},ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ee){Ee.callback=null},t.unstable_continueExecution=function(){E||_||(E=!0,Ce(V))},t.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Ee?Math.floor(1e3/Ee):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(Ee){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var xe=v;v=ie;try{return Ee()}finally{v=xe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ee,ie){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var xe=v;v=Ee;try{return ie()}finally{v=xe}},t.unstable_scheduleCallback=function(Ee,ie,xe){var te=t.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?te+xe:te):xe=te,Ee){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=xe+D,Ee={id:d++,callback:ie,priorityLevel:Ee,startTime:xe,expirationTime:D,sortIndex:-1},xe>te?(Ee.sortIndex=xe,e(h,Ee),r(u)===null&&Ee===r(h)&&(y?(k(P),P=-1):y=!0,Ae(U,xe-te))):(Ee.sortIndex=D,e(u,Ee),E||_||(E=!0,Ce(V))),Ee},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(Ee){var ie=v;return function(){var xe=v;v=ie;try{return Ee.apply(this,arguments)}finally{v=xe}}}}(am)),am}var I_;function dI(){return I_||(I_=1,im.exports=hI()),im.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function pI(){if(R_)return Mn;R_=1;var t=Pg(),e=dI();function r(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,l){o(s,l),o(s+"Capture",l)}function o(s,l){for(i[s]=l,s=0;s<l.length;s++)n.add(l[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},g={};function v(s){return u.call(g,s)?!0:u.call(d,s)?!1:h.test(s)?g[s]=!0:(d[s]=!0,!1)}function _(s,l,f,m){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return m?!1:f!==null?!f.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function E(s,l,f,m){if(l===null||typeof l>"u"||_(s,l,f,m))return!0;if(m)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function y(s,l,f,m,x,S,b){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=f,this.propertyName=s,this.type=l,this.sanitizeURL=S,this.removeEmptyString=b}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){w[s]=new y(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];w[l]=new y(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){w[s]=new y(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){w[s]=new y(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){w[s]=new y(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){w[s]=new y(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){w[s]=new y(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){w[s]=new y(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){w[s]=new y(s,5,!1,s.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function F(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(k,F);w[l]=new y(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(k,F);w[l]=new y(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(k,F);w[l]=new y(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){w[s]=new y(s,1,!1,s.toLowerCase(),null,!1,!1)}),w.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){w[s]=new y(s,1,!1,s.toLowerCase(),null,!0,!0)});function C(s,l,f,m){var x=w.hasOwnProperty(l)?w[l]:null;(x!==null?x.type!==0:m||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(E(l,f,x,m)&&(f=null),m||x===null?v(l)&&(f===null?s.removeAttribute(l):s.setAttribute(l,""+f)):x.mustUseProperty?s[x.propertyName]=f===null?x.type===3?!1:"":f:(l=x.attributeName,m=x.attributeNamespace,f===null?s.removeAttribute(l):(x=x.type,f=x===3||x===4&&f===!0?"":""+f,m?s.setAttributeNS(m,l,f):s.setAttribute(l,f))))}var U=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),z=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),L=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),Oe=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Ae=Symbol.for("react.offscreen"),Ee=Symbol.iterator;function ie(s){return s===null||typeof s!="object"?null:(s=Ee&&s[Ee]||s["@@iterator"],typeof s=="function"?s:null)}var xe=Object.assign,te;function D(s){if(te===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);te=l&&l[1]||""}return`
`+te+s}var re=!1;function ee(s,l){if(!s||re)return"";re=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(pe){var m=pe}Reflect.construct(s,[],l)}else{try{l.call()}catch(pe){m=pe}s.call(l.prototype)}else{try{throw Error()}catch(pe){m=pe}s()}}catch(pe){if(pe&&m&&typeof pe.stack=="string"){for(var x=pe.stack.split(`
`),S=m.stack.split(`
`),b=x.length-1,Q=S.length-1;1<=b&&0<=Q&&x[b]!==S[Q];)Q--;for(;1<=b&&0<=Q;b--,Q--)if(x[b]!==S[Q]){if(b!==1||Q!==1)do if(b--,Q--,0>Q||x[b]!==S[Q]){var ne=`
`+x[b].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=b&&0<=Q);break}}}finally{re=!1,Error.prepareStackTrace=f}return(s=s?s.displayName||s.name:"")?D(s):""}function Z(s){switch(s.tag){case 5:return D(s.type);case 16:return D("Lazy");case 13:return D("Suspense");case 19:return D("SuspenseList");case 0:case 2:case 15:return s=ee(s.type,!1),s;case 11:return s=ee(s.type.render,!1),s;case 1:return s=ee(s.type,!0),s;default:return""}}function ce(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case A:return"Fragment";case z:return"Portal";case R:return"Profiler";case P:return"StrictMode";case B:return"Suspense";case Oe:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case L:return(s.displayName||"Context")+".Consumer";case M:return(s._context.displayName||"Context")+".Provider";case N:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case we:return l=s.displayName||null,l!==null?l:ce(s.type)||"Memo";case Ce:l=s._payload,s=s._init;try{return ce(s(l))}catch{}}return null}function _e(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(l);case 8:return l===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ye(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Te(s){var l=ye(s)?"checked":"value",f=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),m=""+s[l];if(!s.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,S=f.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(b){m=""+b,S.call(this,b)}}),Object.defineProperty(s,l,{enumerable:f.enumerable}),{getValue:function(){return m},setValue:function(b){m=""+b},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Ke(s){s._valueTracker||(s._valueTracker=Te(s))}function J(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),m="";return s&&(m=ye(s)?s.checked?"true":"false":s.value),s=m,s!==f?(l.setValue(s),!0):!1}function kt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function ct(s,l){var f=l.checked;return xe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??s._wrapperState.initialChecked})}function dt(s,l){var f=l.defaultValue==null?"":l.defaultValue,m=l.checked!=null?l.checked:l.defaultChecked;f=ve(l.value!=null?l.value:f),s._wrapperState={initialChecked:m,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ut(s,l){l=l.checked,l!=null&&C(s,"checked",l,!1)}function Ve(s,l){ut(s,l);var f=ve(l.value),m=l.type;if(f!=null)m==="number"?(f===0&&s.value===""||s.value!=f)&&(s.value=""+f):s.value!==""+f&&(s.value=""+f);else if(m==="submit"||m==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?wr(s,l.type,f):l.hasOwnProperty("defaultValue")&&wr(s,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function Vt(s,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var m=l.type;if(!(m!=="submit"&&m!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,f||l===s.value||(s.value=l),s.defaultValue=l}f=s.name,f!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,f!==""&&(s.name=f)}function wr(s,l,f){(l!=="number"||kt(s.ownerDocument)!==s)&&(f==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+f&&(s.defaultValue=""+f))}var fr=Array.isArray;function Tr(s,l,f,m){if(s=s.options,l){l={};for(var x=0;x<f.length;x++)l["$"+f[x]]=!0;for(f=0;f<s.length;f++)x=l.hasOwnProperty("$"+s[f].value),s[f].selected!==x&&(s[f].selected=x),x&&m&&(s[f].defaultSelected=!0)}else{for(f=""+ve(f),l=null,x=0;x<s.length;x++){if(s[x].value===f){s[x].selected=!0,m&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function _i(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(r(91));return xe({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function gn(s,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(r(92));if(fr(f)){if(1<f.length)throw Error(r(93));f=f[0]}l=f}l==null&&(l=""),f=l}s._wrapperState={initialValue:ve(f)}}function hr(s,l){var f=ve(l.value),m=ve(l.defaultValue);f!=null&&(f=""+f,f!==s.value&&(s.value=f),l.defaultValue==null&&s.defaultValue!==f&&(s.defaultValue=f)),m!=null&&(s.defaultValue=""+m)}function vn(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function Lt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jt(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?Lt(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var $t,Jr=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,m,x){MSApp.execUnsafeLocalFunction(function(){return s(l,f,m,x)})}:s}(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for($t=$t||document.createElement("div"),$t.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=$t.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function rt(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var Ot={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dr=["Webkit","ms","Moz","O"];Object.keys(Ot).forEach(function(s){dr.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),Ot[l]=Ot[s]})});function Ht(s,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||Ot.hasOwnProperty(s)&&Ot[s]?(""+l).trim():l+"px"}function Hn(s,l){s=s.style;for(var f in l)if(l.hasOwnProperty(f)){var m=f.indexOf("--")===0,x=Ht(f,l[f],m);f==="float"&&(f="cssFloat"),m?s.setProperty(f,x):s[f]=x}}var rs=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function no(s,l){if(l){if(rs[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(r(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(r(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(r(61))}if(l.style!=null&&typeof l.style!="object")throw Error(r(62))}}function io(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gi=null;function xa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var _a=null,Rn=null,ni=null;function yi(s){if(s=Bc(s)){if(typeof _a!="function")throw Error(r(280));var l=s.stateNode;l&&(l=Hf(l),_a(s.stateNode,s.type,l))}}function ii(s){Rn?ni?ni.push(s):ni=[s]:Rn=s}function ao(){if(Rn){var s=Rn,l=ni;if(ni=Rn=null,yi(s),l)for(s=0;s<l.length;s++)yi(l[s])}}function ya(s,l){return s(l)}function so(){}var Ei=!1;function oo(s,l,f){if(Ei)return s(l,f);Ei=!0;try{return ya(s,l,f)}finally{Ei=!1,(Rn!==null||ni!==null)&&(so(),ao())}}function Jt(s,l){var f=s.stateNode;if(f===null)return null;var m=Hf(f);if(m===null)return null;f=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(s=s.type,m=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!m;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(r(231,l,typeof f));return f}var ns=!1;if(c)try{var xn={};Object.defineProperty(xn,"passive",{get:function(){ns=!0}}),window.addEventListener("test",xn,xn),window.removeEventListener("test",xn,xn)}catch{ns=!1}function Ea(s,l,f,m,x,S,b,Q,ne){var pe=Array.prototype.slice.call(arguments,3);try{l.apply(f,pe)}catch(Re){this.onError(Re)}}var wa=!1,is=null,O=!1,K=null,H={onError:function(s){wa=!0,is=s}};function W(s,l,f,m,x,S,b,Q,ne){wa=!1,is=null,Ea.apply(H,arguments)}function q(s,l,f,m,x,S,b,Q,ne){if(W.apply(this,arguments),wa){if(wa){var pe=is;wa=!1,is=null}else throw Error(r(198));O||(O=!0,K=pe)}}function X(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,l.flags&4098&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function le(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function ge(s){if(X(s)!==s)throw Error(r(188))}function ue(s){var l=s.alternate;if(!l){if(l=X(s),l===null)throw Error(r(188));return l!==s?null:s}for(var f=s,m=l;;){var x=f.return;if(x===null)break;var S=x.alternate;if(S===null){if(m=x.return,m!==null){f=m;continue}break}if(x.child===S.child){for(S=x.child;S;){if(S===f)return ge(x),s;if(S===m)return ge(x),l;S=S.sibling}throw Error(r(188))}if(f.return!==m.return)f=x,m=S;else{for(var b=!1,Q=x.child;Q;){if(Q===f){b=!0,f=x,m=S;break}if(Q===m){b=!0,m=x,f=S;break}Q=Q.sibling}if(!b){for(Q=S.child;Q;){if(Q===f){b=!0,f=S,m=x;break}if(Q===m){b=!0,m=S,f=x;break}Q=Q.sibling}if(!b)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?s:l}function he(s){return s=ue(s),s!==null?de(s):null}function de(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=de(s);if(l!==null)return l;s=s.sibling}return null}var Pe=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,Be=e.unstable_shouldYield,De=e.unstable_requestPaint,Fe=e.unstable_now,et=e.unstable_getCurrentPriorityLevel,It=e.unstable_ImmediatePriority,At=e.unstable_UserBlockingPriority,Dt=e.unstable_NormalPriority,wi=e.unstable_LowPriority,Ki=e.unstable_IdlePriority,zn=null,sr=null;function as(s){if(sr&&typeof sr.onCommitFiberRoot=="function")try{sr.onCommitFiberRoot(zn,s,void 0,(s.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:Ef,Tc=Math.log,yf=Math.LN2;function Ef(s){return s>>>=0,s===0?32:31-(Tc(s)/yf|0)|0}var tl=64,rl=4194304;function ss(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function lo(s,l){var f=s.pendingLanes;if(f===0)return 0;var m=0,x=s.suspendedLanes,S=s.pingedLanes,b=f&268435455;if(b!==0){var Q=b&~x;Q!==0?m=ss(Q):(S&=b,S!==0&&(m=ss(S)))}else b=f&~x,b!==0?m=ss(b):S!==0&&(m=ss(S));if(m===0)return 0;if(l!==0&&l!==m&&!(l&x)&&(x=m&-m,S=l&-l,x>=S||x===16&&(S&4194240)!==0))return l;if(m&4&&(m|=f&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=m;0<l;)f=31-zt(l),x=1<<f,m|=s[f],l&=~x;return m}function Fd(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ta(s,l){for(var f=s.suspendedLanes,m=s.pingedLanes,x=s.expirationTimes,S=s.pendingLanes;0<S;){var b=31-zt(S),Q=1<<b,ne=x[b];ne===-1?(!(Q&f)||Q&m)&&(x[b]=Fd(Q,l)):ne<=l&&(s.expiredLanes|=Q),S&=~Q}}function Wn(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function co(){var s=tl;return tl<<=1,!(tl&4194240)&&(tl=64),s}function os(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function ls(s,l,f){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-zt(l),s[l]=f}function Mt(s,l){var f=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var m=s.eventTimes;for(s=s.expirationTimes;0<f;){var x=31-zt(f),S=1<<x;l[x]=0,m[x]=-1,s[x]=-1,f&=~S}}function cs(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var m=31-zt(f),x=1<<m;x&l|s[m]&l&&(s[m]|=l),f&=~x}}var gt=0;function us(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var wf,nl,Tf,Sf,kf,Sc=!1,qi=[],jr=null,Ti=null,Si=null,fs=new Map,ai=new Map,Xi=[],bd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Af(s,l){switch(s){case"focusin":case"focusout":jr=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Si=null;break;case"pointerover":case"pointerout":fs.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ai.delete(l.pointerId)}}function Pn(s,l,f,m,x,S){return s===null||s.nativeEvent!==S?(s={blockedOn:l,domEventName:f,eventSystemFlags:m,nativeEvent:S,targetContainers:[x]},l!==null&&(l=Bc(l),l!==null&&nl(l)),s):(s.eventSystemFlags|=m,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function Od(s,l,f,m,x){switch(l){case"focusin":return jr=Pn(jr,s,l,f,m,x),!0;case"dragenter":return Ti=Pn(Ti,s,l,f,m,x),!0;case"mouseover":return Si=Pn(Si,s,l,f,m,x),!0;case"pointerover":var S=x.pointerId;return fs.set(S,Pn(fs.get(S)||null,s,l,f,m,x)),!0;case"gotpointercapture":return S=x.pointerId,ai.set(S,Pn(ai.get(S)||null,s,l,f,m,x)),!0}return!1}function Cf(s){var l=mo(s.target);if(l!==null){var f=X(l);if(f!==null){if(l=f.tag,l===13){if(l=le(f),l!==null){s.blockedOn=l,kf(s.priority,function(){Tf(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Sa(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=il(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(f===null){f=s.nativeEvent;var m=new f.constructor(f.type,f);Gi=m,f.target.dispatchEvent(m),Gi=null}else return l=Bc(f),l!==null&&nl(l),s.blockedOn=f,!1;l.shift()}return!0}function uo(s,l,f){Sa(s)&&f.delete(l)}function If(){Sc=!1,jr!==null&&Sa(jr)&&(jr=null),Ti!==null&&Sa(Ti)&&(Ti=null),Si!==null&&Sa(Si)&&(Si=null),fs.forEach(uo),ai.forEach(uo)}function ki(s,l){s.blockedOn===l&&(s.blockedOn=null,Sc||(Sc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,If)))}function Ai(s){function l(x){return ki(x,s)}if(0<qi.length){ki(qi[0],s);for(var f=1;f<qi.length;f++){var m=qi[f];m.blockedOn===s&&(m.blockedOn=null)}}for(jr!==null&&ki(jr,s),Ti!==null&&ki(Ti,s),Si!==null&&ki(Si,s),fs.forEach(l),ai.forEach(l),f=0;f<Xi.length;f++)m=Xi[f],m.blockedOn===s&&(m.blockedOn=null);for(;0<Xi.length&&(f=Xi[0],f.blockedOn===null);)Cf(f),f.blockedOn===null&&Xi.shift()}var ka=U.ReactCurrentBatchConfig,hs=!0;function qt(s,l,f,m){var x=gt,S=ka.transition;ka.transition=null;try{gt=1,kc(s,l,f,m)}finally{gt=x,ka.transition=S}}function Dd(s,l,f,m){var x=gt,S=ka.transition;ka.transition=null;try{gt=4,kc(s,l,f,m)}finally{gt=x,ka.transition=S}}function kc(s,l,f,m){if(hs){var x=il(s,l,f,m);if(x===null)Wd(s,l,m,fo,f),Af(s,m);else if(Od(x,s,l,f,m))m.stopPropagation();else if(Af(s,m),l&4&&-1<bd.indexOf(s)){for(;x!==null;){var S=Bc(x);if(S!==null&&wf(S),S=il(s,l,f,m),S===null&&Wd(s,l,m,fo,f),S===x)break;x=S}x!==null&&m.stopPropagation()}else Wd(s,l,m,null,f)}}var fo=null;function il(s,l,f,m){if(fo=null,s=xa(m),s=mo(s),s!==null)if(l=X(s),l===null)s=null;else if(f=l.tag,f===13){if(s=le(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return fo=s,null}function Ac(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(et()){case It:return 1;case At:return 4;case Dt:case wi:return 16;case Ki:return 536870912;default:return 16}default:return 16}}var Gn=null,al=null,Fn=null;function Cc(){if(Fn)return Fn;var s,l=al,f=l.length,m,x="value"in Gn?Gn.value:Gn.textContent,S=x.length;for(s=0;s<f&&l[s]===x[s];s++);var b=f-s;for(m=1;m<=b&&l[f-m]===x[S-m];m++);return Fn=x.slice(s,1<m?1-m:void 0)}function sl(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Yi(){return!0}function Ic(){return!1}function $r(s){function l(f,m,x,S,b){this._reactName=f,this._targetInst=x,this.type=m,this.nativeEvent=S,this.target=b,this.currentTarget=null;for(var Q in s)s.hasOwnProperty(Q)&&(f=s[Q],this[Q]=f?f(S):S[Q]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Yi:Ic,this.isPropagationStopped=Ic,this}return xe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Yi)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Yi)},persist:function(){},isPersistent:Yi}),l}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=$r(Ci),Qi=xe({},Ci,{view:0,detail:0}),Nd=$r(Qi),ll,Aa,ds,ho=xe({},Qi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ji,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ds&&(ds&&s.type==="mousemove"?(ll=s.screenX-ds.screenX,Aa=s.screenY-ds.screenY):Aa=ll=0,ds=s),ll)},movementY:function(s){return"movementY"in s?s.movementY:Aa}}),cl=$r(ho),Rc=xe({},ho,{dataTransfer:0}),Rf=$r(Rc),ul=xe({},Qi,{relatedTarget:0}),fl=$r(ul),Pf=xe({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),Ca=$r(Pf),Ff=xe({},Ci,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),bf=$r(Ff),Of=xe({},Ci,{data:0}),Pc=$r(Of),hl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Df={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nf(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Df[s])?!!l[s]:!1}function Ji(){return Nf}var p=xe({},Qi,{key:function(s){if(s.key){var l=hl[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=sl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?_n[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ji,charCode:function(s){return s.type==="keypress"?sl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?sl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),T=$r(p),I=xe({},ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j=$r(I),se=xe({},Qi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ji}),me=$r(se),Me=xe({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nt=$r(Me),Sr=xe({},ho,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),_t=$r(Sr),Or=[9,13,27,32],pr=c&&"CompositionEvent"in window,si=null;c&&"documentMode"in document&&(si=document.documentMode);var Kn=c&&"TextEvent"in window&&!si,po=c&&(!pr||si&&8<si&&11>=si),dl=" ",gv=!1;function vv(s,l){switch(s){case"keyup":return Or.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xv(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var pl=!1;function aC(s,l){switch(s){case"compositionend":return xv(l);case"keypress":return l.which!==32?null:(gv=!0,dl);case"textInput":return s=l.data,s===dl&&gv?null:s;default:return null}}function sC(s,l){if(pl)return s==="compositionend"||!pr&&vv(s,l)?(s=Cc(),Fn=al=Gn=null,pl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return po&&l.locale!=="ko"?null:l.data;default:return null}}var oC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _v(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!oC[s.type]:l==="textarea"}function yv(s,l,f,m){ii(m),l=Uf(l,"onChange"),0<l.length&&(f=new ol("onChange","change",null,f,m),s.push({event:f,listeners:l}))}var Fc=null,bc=null;function lC(s){Vv(s,0)}function Lf(s){var l=_l(s);if(J(l))return s}function cC(s,l){if(s==="change")return l}var Ev=!1;if(c){var Ld;if(c){var Md="oninput"in document;if(!Md){var wv=document.createElement("div");wv.setAttribute("oninput","return;"),Md=typeof wv.oninput=="function"}Ld=Md}else Ld=!1;Ev=Ld&&(!document.documentMode||9<document.documentMode)}function Tv(){Fc&&(Fc.detachEvent("onpropertychange",Sv),bc=Fc=null)}function Sv(s){if(s.propertyName==="value"&&Lf(bc)){var l=[];yv(l,bc,s,xa(s)),oo(lC,l)}}function uC(s,l,f){s==="focusin"?(Tv(),Fc=l,bc=f,Fc.attachEvent("onpropertychange",Sv)):s==="focusout"&&Tv()}function fC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Lf(bc)}function hC(s,l){if(s==="click")return Lf(l)}function dC(s,l){if(s==="input"||s==="change")return Lf(l)}function pC(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Ii=typeof Object.is=="function"?Object.is:pC;function Oc(s,l){if(Ii(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),m=Object.keys(l);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var x=f[m];if(!u.call(l,x)||!Ii(s[x],l[x]))return!1}return!0}function kv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Av(s,l){var f=kv(s);s=0;for(var m;f;){if(f.nodeType===3){if(m=s+f.textContent.length,s<=l&&m>=l)return{node:f,offset:l-s};s=m}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=kv(f)}}function Cv(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Cv(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Iv(){for(var s=window,l=kt();l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=kt(s.document)}return l}function Vd(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function mC(s){var l=Iv(),f=s.focusedElem,m=s.selectionRange;if(l!==f&&f&&f.ownerDocument&&Cv(f.ownerDocument.documentElement,f)){if(m!==null&&Vd(f)){if(l=m.start,s=m.end,s===void 0&&(s=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(s,f.value.length);else if(s=(l=f.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var x=f.textContent.length,S=Math.min(m.start,x);m=m.end===void 0?S:Math.min(m.end,x),!s.extend&&S>m&&(x=m,m=S,S=x),x=Av(f,S);var b=Av(f,m);x&&b&&(s.rangeCount!==1||s.anchorNode!==x.node||s.anchorOffset!==x.offset||s.focusNode!==b.node||s.focusOffset!==b.offset)&&(l=l.createRange(),l.setStart(x.node,x.offset),s.removeAllRanges(),S>m?(s.addRange(l),s.extend(b.node,b.offset)):(l.setEnd(b.node,b.offset),s.addRange(l)))}}for(l=[],s=f;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)s=l[f],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var gC=c&&"documentMode"in document&&11>=document.documentMode,ml=null,Bd=null,Dc=null,Ud=!1;function Rv(s,l,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Ud||ml==null||ml!==kt(m)||(m=ml,"selectionStart"in m&&Vd(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Dc&&Oc(Dc,m)||(Dc=m,m=Uf(Bd,"onSelect"),0<m.length&&(l=new ol("onSelect","select",null,l,f),s.push({event:l,listeners:m}),l.target=ml)))}function Mf(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var gl={animationend:Mf("Animation","AnimationEnd"),animationiteration:Mf("Animation","AnimationIteration"),animationstart:Mf("Animation","AnimationStart"),transitionend:Mf("Transition","TransitionEnd")},jd={},Pv={};c&&(Pv=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Vf(s){if(jd[s])return jd[s];if(!gl[s])return s;var l=gl[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in Pv)return jd[s]=l[f];return s}var Fv=Vf("animationend"),bv=Vf("animationiteration"),Ov=Vf("animationstart"),Dv=Vf("transitionend"),Nv=new Map,Lv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ps(s,l){Nv.set(s,l),a(l,[s])}for(var $d=0;$d<Lv.length;$d++){var Hd=Lv[$d],vC=Hd.toLowerCase(),xC=Hd[0].toUpperCase()+Hd.slice(1);ps(vC,"on"+xC)}ps(Fv,"onAnimationEnd"),ps(bv,"onAnimationIteration"),ps(Ov,"onAnimationStart"),ps("dblclick","onDoubleClick"),ps("focusin","onFocus"),ps("focusout","onBlur"),ps(Dv,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_C=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nc));function Mv(s,l,f){var m=s.type||"unknown-event";s.currentTarget=f,q(m,l,void 0,s),s.currentTarget=null}function Vv(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var m=s[f],x=m.event;m=m.listeners;e:{var S=void 0;if(l)for(var b=m.length-1;0<=b;b--){var Q=m[b],ne=Q.instance,pe=Q.currentTarget;if(Q=Q.listener,ne!==S&&x.isPropagationStopped())break e;Mv(x,Q,pe),S=ne}else for(b=0;b<m.length;b++){if(Q=m[b],ne=Q.instance,pe=Q.currentTarget,Q=Q.listener,ne!==S&&x.isPropagationStopped())break e;Mv(x,Q,pe),S=ne}}}if(O)throw s=K,O=!1,K=null,s}function Wt(s,l){var f=l[Qd];f===void 0&&(f=l[Qd]=new Set);var m=s+"__bubble";f.has(m)||(Bv(l,s,2,!1),f.add(m))}function zd(s,l,f){var m=0;l&&(m|=4),Bv(f,s,m,l)}var Bf="_reactListening"+Math.random().toString(36).slice(2);function Lc(s){if(!s[Bf]){s[Bf]=!0,n.forEach(function(f){f!=="selectionchange"&&(_C.has(f)||zd(f,!1,s),zd(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Bf]||(l[Bf]=!0,zd("selectionchange",!1,l))}}function Bv(s,l,f,m){switch(Ac(l)){case 1:var x=qt;break;case 4:x=Dd;break;default:x=kc}f=x.bind(null,l,f,s),x=void 0,!ns||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),m?x!==void 0?s.addEventListener(l,f,{capture:!0,passive:x}):s.addEventListener(l,f,!0):x!==void 0?s.addEventListener(l,f,{passive:x}):s.addEventListener(l,f,!1)}function Wd(s,l,f,m,x){var S=m;if(!(l&1)&&!(l&2)&&m!==null)e:for(;;){if(m===null)return;var b=m.tag;if(b===3||b===4){var Q=m.stateNode.containerInfo;if(Q===x||Q.nodeType===8&&Q.parentNode===x)break;if(b===4)for(b=m.return;b!==null;){var ne=b.tag;if((ne===3||ne===4)&&(ne=b.stateNode.containerInfo,ne===x||ne.nodeType===8&&ne.parentNode===x))return;b=b.return}for(;Q!==null;){if(b=mo(Q),b===null)return;if(ne=b.tag,ne===5||ne===6){m=S=b;continue e}Q=Q.parentNode}}m=m.return}oo(function(){var pe=S,Re=xa(f),be=[];e:{var Ie=Nv.get(s);if(Ie!==void 0){var Ue=ol,ze=s;switch(s){case"keypress":if(sl(f)===0)break e;case"keydown":case"keyup":Ue=T;break;case"focusin":ze="focus",Ue=fl;break;case"focusout":ze="blur",Ue=fl;break;case"beforeblur":case"afterblur":Ue=fl;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=Rf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=me;break;case Fv:case bv:case Ov:Ue=Ca;break;case Dv:Ue=Nt;break;case"scroll":Ue=Nd;break;case"wheel":Ue=_t;break;case"copy":case"cut":case"paste":Ue=bf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=j}var We=(l&4)!==0,or=!We&&s==="scroll",oe=We?Ie!==null?Ie+"Capture":null:Ie;We=[];for(var ae=pe,fe;ae!==null;){fe=ae;var Ne=fe.stateNode;if(fe.tag===5&&Ne!==null&&(fe=Ne,oe!==null&&(Ne=Jt(ae,oe),Ne!=null&&We.push(Mc(ae,Ne,fe)))),or)break;ae=ae.return}0<We.length&&(Ie=new Ue(Ie,ze,null,f,Re),be.push({event:Ie,listeners:We}))}}if(!(l&7)){e:{if(Ie=s==="mouseover"||s==="pointerover",Ue=s==="mouseout"||s==="pointerout",Ie&&f!==Gi&&(ze=f.relatedTarget||f.fromElement)&&(mo(ze)||ze[Ia]))break e;if((Ue||Ie)&&(Ie=Re.window===Re?Re:(Ie=Re.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Ue?(ze=f.relatedTarget||f.toElement,Ue=pe,ze=ze?mo(ze):null,ze!==null&&(or=X(ze),ze!==or||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Ue=null,ze=pe),Ue!==ze)){if(We=cl,Ne="onMouseLeave",oe="onMouseEnter",ae="mouse",(s==="pointerout"||s==="pointerover")&&(We=j,Ne="onPointerLeave",oe="onPointerEnter",ae="pointer"),or=Ue==null?Ie:_l(Ue),fe=ze==null?Ie:_l(ze),Ie=new We(Ne,ae+"leave",Ue,f,Re),Ie.target=or,Ie.relatedTarget=fe,Ne=null,mo(Re)===pe&&(We=new We(oe,ae+"enter",ze,f,Re),We.target=fe,We.relatedTarget=or,Ne=We),or=Ne,Ue&&ze)t:{for(We=Ue,oe=ze,ae=0,fe=We;fe;fe=vl(fe))ae++;for(fe=0,Ne=oe;Ne;Ne=vl(Ne))fe++;for(;0<ae-fe;)We=vl(We),ae--;for(;0<fe-ae;)oe=vl(oe),fe--;for(;ae--;){if(We===oe||oe!==null&&We===oe.alternate)break t;We=vl(We),oe=vl(oe)}We=null}else We=null;Ue!==null&&Uv(be,Ie,Ue,We,!1),ze!==null&&or!==null&&Uv(be,or,ze,We,!0)}}e:{if(Ie=pe?_l(pe):window,Ue=Ie.nodeName&&Ie.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Ie.type==="file")var Ge=cC;else if(_v(Ie))if(Ev)Ge=dC;else{Ge=fC;var Ye=uC}else(Ue=Ie.nodeName)&&Ue.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(Ge=hC);if(Ge&&(Ge=Ge(s,pe))){yv(be,Ge,f,Re);break e}Ye&&Ye(s,Ie,pe),s==="focusout"&&(Ye=Ie._wrapperState)&&Ye.controlled&&Ie.type==="number"&&wr(Ie,"number",Ie.value)}switch(Ye=pe?_l(pe):window,s){case"focusin":(_v(Ye)||Ye.contentEditable==="true")&&(ml=Ye,Bd=pe,Dc=null);break;case"focusout":Dc=Bd=ml=null;break;case"mousedown":Ud=!0;break;case"contextmenu":case"mouseup":case"dragend":Ud=!1,Rv(be,f,Re);break;case"selectionchange":if(gC)break;case"keydown":case"keyup":Rv(be,f,Re)}var Qe;if(pr)e:{switch(s){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else pl?vv(s,f)&&(nt="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(nt="onCompositionStart");nt&&(po&&f.locale!=="ko"&&(pl||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&pl&&(Qe=Cc()):(Gn=Re,al="value"in Gn?Gn.value:Gn.textContent,pl=!0)),Ye=Uf(pe,nt),0<Ye.length&&(nt=new Pc(nt,s,null,f,Re),be.push({event:nt,listeners:Ye}),Qe?nt.data=Qe:(Qe=xv(f),Qe!==null&&(nt.data=Qe)))),(Qe=Kn?aC(s,f):sC(s,f))&&(pe=Uf(pe,"onBeforeInput"),0<pe.length&&(Re=new Pc("onBeforeInput","beforeinput",null,f,Re),be.push({event:Re,listeners:pe}),Re.data=Qe))}Vv(be,l)})}function Mc(s,l,f){return{instance:s,listener:l,currentTarget:f}}function Uf(s,l){for(var f=l+"Capture",m=[];s!==null;){var x=s,S=x.stateNode;x.tag===5&&S!==null&&(x=S,S=Jt(s,f),S!=null&&m.unshift(Mc(s,S,x)),S=Jt(s,l),S!=null&&m.push(Mc(s,S,x))),s=s.return}return m}function vl(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Uv(s,l,f,m,x){for(var S=l._reactName,b=[];f!==null&&f!==m;){var Q=f,ne=Q.alternate,pe=Q.stateNode;if(ne!==null&&ne===m)break;Q.tag===5&&pe!==null&&(Q=pe,x?(ne=Jt(f,S),ne!=null&&b.unshift(Mc(f,ne,Q))):x||(ne=Jt(f,S),ne!=null&&b.push(Mc(f,ne,Q)))),f=f.return}b.length!==0&&s.push({event:l,listeners:b})}var yC=/\r\n?/g,EC=/\u0000|\uFFFD/g;function jv(s){return(typeof s=="string"?s:""+s).replace(yC,`
`).replace(EC,"")}function jf(s,l,f){if(l=jv(l),jv(s)!==l&&f)throw Error(r(425))}function $f(){}var Gd=null,Kd=null;function qd(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Xd=typeof setTimeout=="function"?setTimeout:void 0,wC=typeof clearTimeout=="function"?clearTimeout:void 0,$v=typeof Promise=="function"?Promise:void 0,TC=typeof queueMicrotask=="function"?queueMicrotask:typeof $v<"u"?function(s){return $v.resolve(null).then(s).catch(SC)}:Xd;function SC(s){setTimeout(function(){throw s})}function Yd(s,l){var f=l,m=0;do{var x=f.nextSibling;if(s.removeChild(f),x&&x.nodeType===8)if(f=x.data,f==="/$"){if(m===0){s.removeChild(x),Ai(l);return}m--}else f!=="$"&&f!=="$?"&&f!=="$!"||m++;f=x}while(f);Ai(l)}function ms(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function Hv(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return s;l--}else f==="/$"&&l++}s=s.previousSibling}return null}var xl=Math.random().toString(36).slice(2),Zi="__reactFiber$"+xl,Vc="__reactProps$"+xl,Ia="__reactContainer$"+xl,Qd="__reactEvents$"+xl,kC="__reactListeners$"+xl,AC="__reactHandles$"+xl;function mo(s){var l=s[Zi];if(l)return l;for(var f=s.parentNode;f;){if(l=f[Ia]||f[Zi]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=Hv(s);s!==null;){if(f=s[Zi])return f;s=Hv(s)}return l}s=f,f=s.parentNode}return null}function Bc(s){return s=s[Zi]||s[Ia],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function _l(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(r(33))}function Hf(s){return s[Vc]||null}var Jd=[],yl=-1;function gs(s){return{current:s}}function Gt(s){0>yl||(s.current=Jd[yl],Jd[yl]=null,yl--)}function Bt(s,l){yl++,Jd[yl]=s.current,s.current=l}var vs={},Zr=gs(vs),bn=gs(!1),go=vs;function El(s,l){var f=s.type.contextTypes;if(!f)return vs;var m=s.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===l)return m.__reactInternalMemoizedMaskedChildContext;var x={},S;for(S in f)x[S]=l[S];return m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=x),x}function On(s){return s=s.childContextTypes,s!=null}function zf(){Gt(bn),Gt(Zr)}function zv(s,l,f){if(Zr.current!==vs)throw Error(r(168));Bt(Zr,l),Bt(bn,f)}function Wv(s,l,f){var m=s.stateNode;if(l=l.childContextTypes,typeof m.getChildContext!="function")return f;m=m.getChildContext();for(var x in m)if(!(x in l))throw Error(r(108,_e(s)||"Unknown",x));return xe({},f,m)}function Wf(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||vs,go=Zr.current,Bt(Zr,s),Bt(bn,bn.current),!0}function Gv(s,l,f){var m=s.stateNode;if(!m)throw Error(r(169));f?(s=Wv(s,l,go),m.__reactInternalMemoizedMergedChildContext=s,Gt(bn),Gt(Zr),Bt(Zr,s)):Gt(bn),Bt(bn,f)}var Ra=null,Gf=!1,Zd=!1;function Kv(s){Ra===null?Ra=[s]:Ra.push(s)}function CC(s){Gf=!0,Kv(s)}function xs(){if(!Zd&&Ra!==null){Zd=!0;var s=0,l=gt;try{var f=Ra;for(gt=1;s<f.length;s++){var m=f[s];do m=m(!0);while(m!==null)}Ra=null,Gf=!1}catch(x){throw Ra!==null&&(Ra=Ra.slice(s+1)),Pe(It,xs),x}finally{gt=l,Zd=!1}}return null}var wl=[],Tl=0,Kf=null,qf=0,oi=[],li=0,vo=null,Pa=1,Fa="";function xo(s,l){wl[Tl++]=qf,wl[Tl++]=Kf,Kf=s,qf=l}function qv(s,l,f){oi[li++]=Pa,oi[li++]=Fa,oi[li++]=vo,vo=s;var m=Pa;s=Fa;var x=32-zt(m)-1;m&=~(1<<x),f+=1;var S=32-zt(l)+x;if(30<S){var b=x-x%5;S=(m&(1<<b)-1).toString(32),m>>=b,x-=b,Pa=1<<32-zt(l)+x|f<<x|m,Fa=S+s}else Pa=1<<S|f<<x|m,Fa=s}function ep(s){s.return!==null&&(xo(s,1),qv(s,1,0))}function tp(s){for(;s===Kf;)Kf=wl[--Tl],wl[Tl]=null,qf=wl[--Tl],wl[Tl]=null;for(;s===vo;)vo=oi[--li],oi[li]=null,Fa=oi[--li],oi[li]=null,Pa=oi[--li],oi[li]=null}var qn=null,Xn=null,Xt=!1,Ri=null;function Xv(s,l){var f=hi(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=s,l=s.deletions,l===null?(s.deletions=[f],s.flags|=16):l.push(f)}function Yv(s,l){switch(s.tag){case 5:var f=s.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,qn=s,Xn=ms(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,qn=s,Xn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=vo!==null?{id:Pa,overflow:Fa}:null,s.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=hi(18,null,null,0),f.stateNode=l,f.return=s,s.child=f,qn=s,Xn=null,!0):!1;default:return!1}}function rp(s){return(s.mode&1)!==0&&(s.flags&128)===0}function np(s){if(Xt){var l=Xn;if(l){var f=l;if(!Yv(s,l)){if(rp(s))throw Error(r(418));l=ms(f.nextSibling);var m=qn;l&&Yv(s,l)?Xv(m,f):(s.flags=s.flags&-4097|2,Xt=!1,qn=s)}}else{if(rp(s))throw Error(r(418));s.flags=s.flags&-4097|2,Xt=!1,qn=s}}}function Qv(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;qn=s}function Xf(s){if(s!==qn)return!1;if(!Xt)return Qv(s),Xt=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!qd(s.type,s.memoizedProps)),l&&(l=Xn)){if(rp(s))throw Jv(),Error(r(418));for(;l;)Xv(s,l),l=ms(l.nextSibling)}if(Qv(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="/$"){if(l===0){Xn=ms(s.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}s=s.nextSibling}Xn=null}}else Xn=qn?ms(s.stateNode.nextSibling):null;return!0}function Jv(){for(var s=Xn;s;)s=ms(s.nextSibling)}function Sl(){Xn=qn=null,Xt=!1}function ip(s){Ri===null?Ri=[s]:Ri.push(s)}var IC=U.ReactCurrentBatchConfig;function Uc(s,l,f){if(s=f.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(r(309));var m=f.stateNode}if(!m)throw Error(r(147,s));var x=m,S=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===S?l.ref:(l=function(b){var Q=x.refs;b===null?delete Q[S]:Q[S]=b},l._stringRef=S,l)}if(typeof s!="string")throw Error(r(284));if(!f._owner)throw Error(r(290,s))}return s}function Yf(s,l){throw s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function Zv(s){var l=s._init;return l(s._payload)}function ex(s){function l(oe,ae){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[ae],oe.flags|=16):fe.push(ae)}}function f(oe,ae){if(!s)return null;for(;ae!==null;)l(oe,ae),ae=ae.sibling;return null}function m(oe,ae){for(oe=new Map;ae!==null;)ae.key!==null?oe.set(ae.key,ae):oe.set(ae.index,ae),ae=ae.sibling;return oe}function x(oe,ae){return oe=As(oe,ae),oe.index=0,oe.sibling=null,oe}function S(oe,ae,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<ae?(oe.flags|=2,ae):fe):(oe.flags|=2,ae)):(oe.flags|=1048576,ae)}function b(oe){return s&&oe.alternate===null&&(oe.flags|=2),oe}function Q(oe,ae,fe,Ne){return ae===null||ae.tag!==6?(ae=Xp(fe,oe.mode,Ne),ae.return=oe,ae):(ae=x(ae,fe),ae.return=oe,ae)}function ne(oe,ae,fe,Ne){var Ge=fe.type;return Ge===A?Re(oe,ae,fe.props.children,Ne,fe.key):ae!==null&&(ae.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ce&&Zv(Ge)===ae.type)?(Ne=x(ae,fe.props),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,Ne):(Ne=yh(fe.type,fe.key,fe.props,null,oe.mode,Ne),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,Ne)}function pe(oe,ae,fe,Ne){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==fe.containerInfo||ae.stateNode.implementation!==fe.implementation?(ae=Yp(fe,oe.mode,Ne),ae.return=oe,ae):(ae=x(ae,fe.children||[]),ae.return=oe,ae)}function Re(oe,ae,fe,Ne,Ge){return ae===null||ae.tag!==7?(ae=Ao(fe,oe.mode,Ne,Ge),ae.return=oe,ae):(ae=x(ae,fe),ae.return=oe,ae)}function be(oe,ae,fe){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return ae=Xp(""+ae,oe.mode,fe),ae.return=oe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:return fe=yh(ae.type,ae.key,ae.props,null,oe.mode,fe),fe.ref=Uc(oe,null,ae),fe.return=oe,fe;case z:return ae=Yp(ae,oe.mode,fe),ae.return=oe,ae;case Ce:var Ne=ae._init;return be(oe,Ne(ae._payload),fe)}if(fr(ae)||ie(ae))return ae=Ao(ae,oe.mode,fe,null),ae.return=oe,ae;Yf(oe,ae)}return null}function Ie(oe,ae,fe,Ne){var Ge=ae!==null?ae.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number")return Ge!==null?null:Q(oe,ae,""+fe,Ne);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case V:return fe.key===Ge?ne(oe,ae,fe,Ne):null;case z:return fe.key===Ge?pe(oe,ae,fe,Ne):null;case Ce:return Ge=fe._init,Ie(oe,ae,Ge(fe._payload),Ne)}if(fr(fe)||ie(fe))return Ge!==null?null:Re(oe,ae,fe,Ne,null);Yf(oe,fe)}return null}function Ue(oe,ae,fe,Ne,Ge){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return oe=oe.get(fe)||null,Q(ae,oe,""+Ne,Ge);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case V:return oe=oe.get(Ne.key===null?fe:Ne.key)||null,ne(ae,oe,Ne,Ge);case z:return oe=oe.get(Ne.key===null?fe:Ne.key)||null,pe(ae,oe,Ne,Ge);case Ce:var Ye=Ne._init;return Ue(oe,ae,fe,Ye(Ne._payload),Ge)}if(fr(Ne)||ie(Ne))return oe=oe.get(fe)||null,Re(ae,oe,Ne,Ge,null);Yf(ae,Ne)}return null}function ze(oe,ae,fe,Ne){for(var Ge=null,Ye=null,Qe=ae,nt=ae=0,Lr=null;Qe!==null&&nt<fe.length;nt++){Qe.index>nt?(Lr=Qe,Qe=null):Lr=Qe.sibling;var Ct=Ie(oe,Qe,fe[nt],Ne);if(Ct===null){Qe===null&&(Qe=Lr);break}s&&Qe&&Ct.alternate===null&&l(oe,Qe),ae=S(Ct,ae,nt),Ye===null?Ge=Ct:Ye.sibling=Ct,Ye=Ct,Qe=Lr}if(nt===fe.length)return f(oe,Qe),Xt&&xo(oe,nt),Ge;if(Qe===null){for(;nt<fe.length;nt++)Qe=be(oe,fe[nt],Ne),Qe!==null&&(ae=S(Qe,ae,nt),Ye===null?Ge=Qe:Ye.sibling=Qe,Ye=Qe);return Xt&&xo(oe,nt),Ge}for(Qe=m(oe,Qe);nt<fe.length;nt++)Lr=Ue(Qe,oe,nt,fe[nt],Ne),Lr!==null&&(s&&Lr.alternate!==null&&Qe.delete(Lr.key===null?nt:Lr.key),ae=S(Lr,ae,nt),Ye===null?Ge=Lr:Ye.sibling=Lr,Ye=Lr);return s&&Qe.forEach(function(Cs){return l(oe,Cs)}),Xt&&xo(oe,nt),Ge}function We(oe,ae,fe,Ne){var Ge=ie(fe);if(typeof Ge!="function")throw Error(r(150));if(fe=Ge.call(fe),fe==null)throw Error(r(151));for(var Ye=Ge=null,Qe=ae,nt=ae=0,Lr=null,Ct=fe.next();Qe!==null&&!Ct.done;nt++,Ct=fe.next()){Qe.index>nt?(Lr=Qe,Qe=null):Lr=Qe.sibling;var Cs=Ie(oe,Qe,Ct.value,Ne);if(Cs===null){Qe===null&&(Qe=Lr);break}s&&Qe&&Cs.alternate===null&&l(oe,Qe),ae=S(Cs,ae,nt),Ye===null?Ge=Cs:Ye.sibling=Cs,Ye=Cs,Qe=Lr}if(Ct.done)return f(oe,Qe),Xt&&xo(oe,nt),Ge;if(Qe===null){for(;!Ct.done;nt++,Ct=fe.next())Ct=be(oe,Ct.value,Ne),Ct!==null&&(ae=S(Ct,ae,nt),Ye===null?Ge=Ct:Ye.sibling=Ct,Ye=Ct);return Xt&&xo(oe,nt),Ge}for(Qe=m(oe,Qe);!Ct.done;nt++,Ct=fe.next())Ct=Ue(Qe,oe,nt,Ct.value,Ne),Ct!==null&&(s&&Ct.alternate!==null&&Qe.delete(Ct.key===null?nt:Ct.key),ae=S(Ct,ae,nt),Ye===null?Ge=Ct:Ye.sibling=Ct,Ye=Ct);return s&&Qe.forEach(function(sI){return l(oe,sI)}),Xt&&xo(oe,nt),Ge}function or(oe,ae,fe,Ne){if(typeof fe=="object"&&fe!==null&&fe.type===A&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case V:e:{for(var Ge=fe.key,Ye=ae;Ye!==null;){if(Ye.key===Ge){if(Ge=fe.type,Ge===A){if(Ye.tag===7){f(oe,Ye.sibling),ae=x(Ye,fe.props.children),ae.return=oe,oe=ae;break e}}else if(Ye.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ce&&Zv(Ge)===Ye.type){f(oe,Ye.sibling),ae=x(Ye,fe.props),ae.ref=Uc(oe,Ye,fe),ae.return=oe,oe=ae;break e}f(oe,Ye);break}else l(oe,Ye);Ye=Ye.sibling}fe.type===A?(ae=Ao(fe.props.children,oe.mode,Ne,fe.key),ae.return=oe,oe=ae):(Ne=yh(fe.type,fe.key,fe.props,null,oe.mode,Ne),Ne.ref=Uc(oe,ae,fe),Ne.return=oe,oe=Ne)}return b(oe);case z:e:{for(Ye=fe.key;ae!==null;){if(ae.key===Ye)if(ae.tag===4&&ae.stateNode.containerInfo===fe.containerInfo&&ae.stateNode.implementation===fe.implementation){f(oe,ae.sibling),ae=x(ae,fe.children||[]),ae.return=oe,oe=ae;break e}else{f(oe,ae);break}else l(oe,ae);ae=ae.sibling}ae=Yp(fe,oe.mode,Ne),ae.return=oe,oe=ae}return b(oe);case Ce:return Ye=fe._init,or(oe,ae,Ye(fe._payload),Ne)}if(fr(fe))return ze(oe,ae,fe,Ne);if(ie(fe))return We(oe,ae,fe,Ne);Yf(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"?(fe=""+fe,ae!==null&&ae.tag===6?(f(oe,ae.sibling),ae=x(ae,fe),ae.return=oe,oe=ae):(f(oe,ae),ae=Xp(fe,oe.mode,Ne),ae.return=oe,oe=ae),b(oe)):f(oe,ae)}return or}var kl=ex(!0),tx=ex(!1),Qf=gs(null),Jf=null,Al=null,ap=null;function sp(){ap=Al=Jf=null}function op(s){var l=Qf.current;Gt(Qf),s._currentValue=l}function lp(s,l,f){for(;s!==null;){var m=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),s===f)break;s=s.return}}function Cl(s,l){Jf=s,ap=Al=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&l&&(Dn=!0),s.firstContext=null)}function ci(s){var l=s._currentValue;if(ap!==s)if(s={context:s,memoizedValue:l,next:null},Al===null){if(Jf===null)throw Error(r(308));Al=s,Jf.dependencies={lanes:0,firstContext:s}}else Al=Al.next=s;return l}var _o=null;function cp(s){_o===null?_o=[s]:_o.push(s)}function rx(s,l,f,m){var x=l.interleaved;return x===null?(f.next=f,cp(l)):(f.next=x.next,x.next=f),l.interleaved=f,ba(s,m)}function ba(s,l){s.lanes|=l;var f=s.alternate;for(f!==null&&(f.lanes|=l),f=s,s=s.return;s!==null;)s.childLanes|=l,f=s.alternate,f!==null&&(f.childLanes|=l),f=s,s=s.return;return f.tag===3?f.stateNode:null}var _s=!1;function up(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nx(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Oa(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function ys(s,l,f){var m=s.updateQueue;if(m===null)return null;if(m=m.shared,Tt&2){var x=m.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),m.pending=l,ba(s,f)}return x=m.interleaved,x===null?(l.next=l,cp(m)):(l.next=x.next,x.next=l),m.interleaved=l,ba(s,f)}function Zf(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,cs(s,f)}}function ix(s,l){var f=s.updateQueue,m=s.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var x=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var b={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};S===null?x=S=b:S=S.next=b,f=f.next}while(f!==null);S===null?x=S=l:S=S.next=l}else x=S=l;f={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:S,shared:m.shared,effects:m.effects},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}function eh(s,l,f,m){var x=s.updateQueue;_s=!1;var S=x.firstBaseUpdate,b=x.lastBaseUpdate,Q=x.shared.pending;if(Q!==null){x.shared.pending=null;var ne=Q,pe=ne.next;ne.next=null,b===null?S=pe:b.next=pe,b=ne;var Re=s.alternate;Re!==null&&(Re=Re.updateQueue,Q=Re.lastBaseUpdate,Q!==b&&(Q===null?Re.firstBaseUpdate=pe:Q.next=pe,Re.lastBaseUpdate=ne))}if(S!==null){var be=x.baseState;b=0,Re=pe=ne=null,Q=S;do{var Ie=Q.lane,Ue=Q.eventTime;if((m&Ie)===Ie){Re!==null&&(Re=Re.next={eventTime:Ue,lane:0,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null});e:{var ze=s,We=Q;switch(Ie=l,Ue=f,We.tag){case 1:if(ze=We.payload,typeof ze=="function"){be=ze.call(Ue,be,Ie);break e}be=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=We.payload,Ie=typeof ze=="function"?ze.call(Ue,be,Ie):ze,Ie==null)break e;be=xe({},be,Ie);break e;case 2:_s=!0}}Q.callback!==null&&Q.lane!==0&&(s.flags|=64,Ie=x.effects,Ie===null?x.effects=[Q]:Ie.push(Q))}else Ue={eventTime:Ue,lane:Ie,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Re===null?(pe=Re=Ue,ne=be):Re=Re.next=Ue,b|=Ie;if(Q=Q.next,Q===null){if(Q=x.shared.pending,Q===null)break;Ie=Q,Q=Ie.next,Ie.next=null,x.lastBaseUpdate=Ie,x.shared.pending=null}}while(!0);if(Re===null&&(ne=be),x.baseState=ne,x.firstBaseUpdate=pe,x.lastBaseUpdate=Re,l=x.shared.interleaved,l!==null){x=l;do b|=x.lane,x=x.next;while(x!==l)}else S===null&&(x.shared.lanes=0);wo|=b,s.lanes=b,s.memoizedState=be}}function ax(s,l,f){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var m=s[l],x=m.callback;if(x!==null){if(m.callback=null,m=f,typeof x!="function")throw Error(r(191,x));x.call(m)}}}var jc={},ea=gs(jc),$c=gs(jc),Hc=gs(jc);function yo(s){if(s===jc)throw Error(r(174));return s}function fp(s,l){switch(Bt(Hc,l),Bt($c,s),Bt(ea,jc),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:jt(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=jt(l,s)}Gt(ea),Bt(ea,l)}function Il(){Gt(ea),Gt($c),Gt(Hc)}function sx(s){yo(Hc.current);var l=yo(ea.current),f=jt(l,s.type);l!==f&&(Bt($c,s),Bt(ea,f))}function hp(s){$c.current===s&&(Gt(ea),Gt($c))}var Zt=gs(0);function th(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var dp=[];function pp(){for(var s=0;s<dp.length;s++)dp[s]._workInProgressVersionPrimary=null;dp.length=0}var rh=U.ReactCurrentDispatcher,mp=U.ReactCurrentBatchConfig,Eo=0,er=null,kr=null,Dr=null,nh=!1,zc=!1,Wc=0,RC=0;function en(){throw Error(r(321))}function gp(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Ii(s[f],l[f]))return!1;return!0}function vp(s,l,f,m,x,S){if(Eo=S,er=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,rh.current=s===null||s.memoizedState===null?OC:DC,s=f(m,x),zc){S=0;do{if(zc=!1,Wc=0,25<=S)throw Error(r(301));S+=1,Dr=kr=null,l.updateQueue=null,rh.current=NC,s=f(m,x)}while(zc)}if(rh.current=sh,l=kr!==null&&kr.next!==null,Eo=0,Dr=kr=er=null,nh=!1,l)throw Error(r(300));return s}function xp(){var s=Wc!==0;return Wc=0,s}function ta(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?er.memoizedState=Dr=s:Dr=Dr.next=s,Dr}function ui(){if(kr===null){var s=er.alternate;s=s!==null?s.memoizedState:null}else s=kr.next;var l=Dr===null?er.memoizedState:Dr.next;if(l!==null)Dr=l,kr=s;else{if(s===null)throw Error(r(310));kr=s,s={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Dr===null?er.memoizedState=Dr=s:Dr=Dr.next=s}return Dr}function Gc(s,l){return typeof l=="function"?l(s):l}function _p(s){var l=ui(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var m=kr,x=m.baseQueue,S=f.pending;if(S!==null){if(x!==null){var b=x.next;x.next=S.next,S.next=b}m.baseQueue=x=S,f.pending=null}if(x!==null){S=x.next,m=m.baseState;var Q=b=null,ne=null,pe=S;do{var Re=pe.lane;if((Eo&Re)===Re)ne!==null&&(ne=ne.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),m=pe.hasEagerState?pe.eagerState:s(m,pe.action);else{var be={lane:Re,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};ne===null?(Q=ne=be,b=m):ne=ne.next=be,er.lanes|=Re,wo|=Re}pe=pe.next}while(pe!==null&&pe!==S);ne===null?b=m:ne.next=Q,Ii(m,l.memoizedState)||(Dn=!0),l.memoizedState=m,l.baseState=b,l.baseQueue=ne,f.lastRenderedState=m}if(s=f.interleaved,s!==null){x=s;do S=x.lane,er.lanes|=S,wo|=S,x=x.next;while(x!==s)}else x===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function yp(s){var l=ui(),f=l.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=s;var m=f.dispatch,x=f.pending,S=l.memoizedState;if(x!==null){f.pending=null;var b=x=x.next;do S=s(S,b.action),b=b.next;while(b!==x);Ii(S,l.memoizedState)||(Dn=!0),l.memoizedState=S,l.baseQueue===null&&(l.baseState=S),f.lastRenderedState=S}return[S,m]}function ox(){}function lx(s,l){var f=er,m=ui(),x=l(),S=!Ii(m.memoizedState,x);if(S&&(m.memoizedState=x,Dn=!0),m=m.queue,Ep(fx.bind(null,f,m,s),[s]),m.getSnapshot!==l||S||Dr!==null&&Dr.memoizedState.tag&1){if(f.flags|=2048,Kc(9,ux.bind(null,f,m,x,l),void 0,null),Nr===null)throw Error(r(349));Eo&30||cx(f,l,x)}return x}function cx(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=er.updateQueue,l===null?(l={lastEffect:null,stores:null},er.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function ux(s,l,f,m){l.value=f,l.getSnapshot=m,hx(l)&&dx(s)}function fx(s,l,f){return f(function(){hx(l)&&dx(s)})}function hx(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Ii(s,f)}catch{return!0}}function dx(s){var l=ba(s,1);l!==null&&Oi(l,s,1,-1)}function px(s){var l=ta();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gc,lastRenderedState:s},l.queue=s,s=s.dispatch=bC.bind(null,er,s),[l.memoizedState,s]}function Kc(s,l,f,m){return s={tag:s,create:l,destroy:f,deps:m,next:null},l=er.updateQueue,l===null?(l={lastEffect:null,stores:null},er.updateQueue=l,l.lastEffect=s.next=s):(f=l.lastEffect,f===null?l.lastEffect=s.next=s:(m=f.next,f.next=s,s.next=m,l.lastEffect=s)),s}function mx(){return ui().memoizedState}function ih(s,l,f,m){var x=ta();er.flags|=s,x.memoizedState=Kc(1|l,f,void 0,m===void 0?null:m)}function ah(s,l,f,m){var x=ui();m=m===void 0?null:m;var S=void 0;if(kr!==null){var b=kr.memoizedState;if(S=b.destroy,m!==null&&gp(m,b.deps)){x.memoizedState=Kc(l,f,S,m);return}}er.flags|=s,x.memoizedState=Kc(1|l,f,S,m)}function gx(s,l){return ih(8390656,8,s,l)}function Ep(s,l){return ah(2048,8,s,l)}function vx(s,l){return ah(4,2,s,l)}function xx(s,l){return ah(4,4,s,l)}function _x(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function yx(s,l,f){return f=f!=null?f.concat([s]):null,ah(4,4,_x.bind(null,l,s),f)}function wp(){}function Ex(s,l){var f=ui();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&gp(l,m[1])?m[0]:(f.memoizedState=[s,l],s)}function wx(s,l){var f=ui();l=l===void 0?null:l;var m=f.memoizedState;return m!==null&&l!==null&&gp(l,m[1])?m[0]:(s=s(),f.memoizedState=[s,l],s)}function Tx(s,l,f){return Eo&21?(Ii(f,l)||(f=co(),er.lanes|=f,wo|=f,s.baseState=!0),l):(s.baseState&&(s.baseState=!1,Dn=!0),s.memoizedState=f)}function PC(s,l){var f=gt;gt=f!==0&&4>f?f:4,s(!0);var m=mp.transition;mp.transition={};try{s(!1),l()}finally{gt=f,mp.transition=m}}function Sx(){return ui().memoizedState}function FC(s,l,f){var m=Ss(s);if(f={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null},kx(s))Ax(l,f);else if(f=rx(s,l,f,m),f!==null){var x=En();Oi(f,s,m,x),Cx(f,l,m)}}function bC(s,l,f){var m=Ss(s),x={lane:m,action:f,hasEagerState:!1,eagerState:null,next:null};if(kx(s))Ax(l,x);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=l.lastRenderedReducer,S!==null))try{var b=l.lastRenderedState,Q=S(b,f);if(x.hasEagerState=!0,x.eagerState=Q,Ii(Q,b)){var ne=l.interleaved;ne===null?(x.next=x,cp(l)):(x.next=ne.next,ne.next=x),l.interleaved=x;return}}catch{}finally{}f=rx(s,l,x,m),f!==null&&(x=En(),Oi(f,s,m,x),Cx(f,l,m))}}function kx(s){var l=s.alternate;return s===er||l!==null&&l===er}function Ax(s,l){zc=nh=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function Cx(s,l,f){if(f&4194240){var m=l.lanes;m&=s.pendingLanes,f|=m,l.lanes=f,cs(s,f)}}var sh={readContext:ci,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},OC={readContext:ci,useCallback:function(s,l){return ta().memoizedState=[s,l===void 0?null:l],s},useContext:ci,useEffect:gx,useImperativeHandle:function(s,l,f){return f=f!=null?f.concat([s]):null,ih(4194308,4,_x.bind(null,l,s),f)},useLayoutEffect:function(s,l){return ih(4194308,4,s,l)},useInsertionEffect:function(s,l){return ih(4,2,s,l)},useMemo:function(s,l){var f=ta();return l=l===void 0?null:l,s=s(),f.memoizedState=[s,l],s},useReducer:function(s,l,f){var m=ta();return l=f!==void 0?f(l):l,m.memoizedState=m.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},m.queue=s,s=s.dispatch=FC.bind(null,er,s),[m.memoizedState,s]},useRef:function(s){var l=ta();return s={current:s},l.memoizedState=s},useState:px,useDebugValue:wp,useDeferredValue:function(s){return ta().memoizedState=s},useTransition:function(){var s=px(!1),l=s[0];return s=PC.bind(null,s[1]),ta().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,f){var m=er,x=ta();if(Xt){if(f===void 0)throw Error(r(407));f=f()}else{if(f=l(),Nr===null)throw Error(r(349));Eo&30||cx(m,l,f)}x.memoizedState=f;var S={value:f,getSnapshot:l};return x.queue=S,gx(fx.bind(null,m,S,s),[s]),m.flags|=2048,Kc(9,ux.bind(null,m,S,f,l),void 0,null),f},useId:function(){var s=ta(),l=Nr.identifierPrefix;if(Xt){var f=Fa,m=Pa;f=(m&~(1<<32-zt(m)-1)).toString(32)+f,l=":"+l+"R"+f,f=Wc++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=RC++,l=":"+l+"r"+f.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},DC={readContext:ci,useCallback:Ex,useContext:ci,useEffect:Ep,useImperativeHandle:yx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:wx,useReducer:_p,useRef:mx,useState:function(){return _p(Gc)},useDebugValue:wp,useDeferredValue:function(s){var l=ui();return Tx(l,kr.memoizedState,s)},useTransition:function(){var s=_p(Gc)[0],l=ui().memoizedState;return[s,l]},useMutableSource:ox,useSyncExternalStore:lx,useId:Sx,unstable_isNewReconciler:!1},NC={readContext:ci,useCallback:Ex,useContext:ci,useEffect:Ep,useImperativeHandle:yx,useInsertionEffect:vx,useLayoutEffect:xx,useMemo:wx,useReducer:yp,useRef:mx,useState:function(){return yp(Gc)},useDebugValue:wp,useDeferredValue:function(s){var l=ui();return kr===null?l.memoizedState=s:Tx(l,kr.memoizedState,s)},useTransition:function(){var s=yp(Gc)[0],l=ui().memoizedState;return[s,l]},useMutableSource:ox,useSyncExternalStore:lx,useId:Sx,unstable_isNewReconciler:!1};function Pi(s,l){if(s&&s.defaultProps){l=xe({},l),s=s.defaultProps;for(var f in s)l[f]===void 0&&(l[f]=s[f]);return l}return l}function Tp(s,l,f,m){l=s.memoizedState,f=f(m,l),f=f==null?l:xe({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var oh={isMounted:function(s){return(s=s._reactInternals)?X(s)===s:!1},enqueueSetState:function(s,l,f){s=s._reactInternals;var m=En(),x=Ss(s),S=Oa(m,x);S.payload=l,f!=null&&(S.callback=f),l=ys(s,S,x),l!==null&&(Oi(l,s,x,m),Zf(l,s,x))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var m=En(),x=Ss(s),S=Oa(m,x);S.tag=1,S.payload=l,f!=null&&(S.callback=f),l=ys(s,S,x),l!==null&&(Oi(l,s,x,m),Zf(l,s,x))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=En(),m=Ss(s),x=Oa(f,m);x.tag=2,l!=null&&(x.callback=l),l=ys(s,x,m),l!==null&&(Oi(l,s,m,f),Zf(l,s,m))}};function Ix(s,l,f,m,x,S,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(m,S,b):l.prototype&&l.prototype.isPureReactComponent?!Oc(f,m)||!Oc(x,S):!0}function Rx(s,l,f){var m=!1,x=vs,S=l.contextType;return typeof S=="object"&&S!==null?S=ci(S):(x=On(l)?go:Zr.current,m=l.contextTypes,S=(m=m!=null)?El(s,x):vs),l=new l(f,S),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=oh,s.stateNode=l,l._reactInternals=s,m&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=x,s.__reactInternalMemoizedMaskedChildContext=S),l}function Px(s,l,f,m){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,m),l.state!==s&&oh.enqueueReplaceState(l,l.state,null)}function Sp(s,l,f,m){var x=s.stateNode;x.props=f,x.state=s.memoizedState,x.refs={},up(s);var S=l.contextType;typeof S=="object"&&S!==null?x.context=ci(S):(S=On(l)?go:Zr.current,x.context=El(s,S)),x.state=s.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(Tp(s,l,S,f),x.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(l=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),l!==x.state&&oh.enqueueReplaceState(x,x.state,null),eh(s,f,x,m),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308)}function Rl(s,l){try{var f="",m=l;do f+=Z(m),m=m.return;while(m);var x=f}catch(S){x=`
Error generating stack: `+S.message+`
`+S.stack}return{value:s,source:l,stack:x,digest:null}}function kp(s,l,f){return{value:s,source:null,stack:f??null,digest:l??null}}function Ap(s,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var LC=typeof WeakMap=="function"?WeakMap:Map;function Fx(s,l,f){f=Oa(-1,f),f.tag=3,f.payload={element:null};var m=l.value;return f.callback=function(){ph||(ph=!0,jp=m),Ap(s,l)},f}function bx(s,l,f){f=Oa(-1,f),f.tag=3;var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var x=l.value;f.payload=function(){return m(x)},f.callback=function(){Ap(s,l)}}var S=s.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(f.callback=function(){Ap(s,l),typeof m!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var b=l.stack;this.componentDidCatch(l.value,{componentStack:b!==null?b:""})}),f}function Ox(s,l,f){var m=s.pingCache;if(m===null){m=s.pingCache=new LC;var x=new Set;m.set(l,x)}else x=m.get(l),x===void 0&&(x=new Set,m.set(l,x));x.has(f)||(x.add(f),s=YC.bind(null,s,l,f),l.then(s,s))}function Dx(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function Nx(s,l,f,m,x){return s.mode&1?(s.flags|=65536,s.lanes=x,s):(s===l?s.flags|=65536:(s.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=Oa(-1,1),l.tag=2,ys(f,l,1))),f.lanes|=1),s)}var MC=U.ReactCurrentOwner,Dn=!1;function yn(s,l,f,m){l.child=s===null?tx(l,null,f,m):kl(l,s.child,f,m)}function Lx(s,l,f,m,x){f=f.render;var S=l.ref;return Cl(l,x),m=vp(s,l,f,m,S,x),f=xp(),s!==null&&!Dn?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Da(s,l,x)):(Xt&&f&&ep(l),l.flags|=1,yn(s,l,m,x),l.child)}function Mx(s,l,f,m,x){if(s===null){var S=f.type;return typeof S=="function"&&!qp(S)&&S.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=S,Vx(s,l,S,m,x)):(s=yh(f.type,null,m,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(S=s.child,!(s.lanes&x)){var b=S.memoizedProps;if(f=f.compare,f=f!==null?f:Oc,f(b,m)&&s.ref===l.ref)return Da(s,l,x)}return l.flags|=1,s=As(S,m),s.ref=l.ref,s.return=l,l.child=s}function Vx(s,l,f,m,x){if(s!==null){var S=s.memoizedProps;if(Oc(S,m)&&s.ref===l.ref)if(Dn=!1,l.pendingProps=m=S,(s.lanes&x)!==0)s.flags&131072&&(Dn=!0);else return l.lanes=s.lanes,Da(s,l,x)}return Cp(s,l,f,m,x)}function Bx(s,l,f){var m=l.pendingProps,x=m.children,S=s!==null?s.memoizedState:null;if(m.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt(Fl,Yn),Yn|=f;else{if(!(f&1073741824))return s=S!==null?S.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Bt(Fl,Yn),Yn|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=S!==null?S.baseLanes:f,Bt(Fl,Yn),Yn|=m}else S!==null?(m=S.baseLanes|f,l.memoizedState=null):m=f,Bt(Fl,Yn),Yn|=m;return yn(s,l,x,f),l.child}function Ux(s,l){var f=l.ref;(s===null&&f!==null||s!==null&&s.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function Cp(s,l,f,m,x){var S=On(f)?go:Zr.current;return S=El(l,S),Cl(l,x),f=vp(s,l,f,m,S,x),m=xp(),s!==null&&!Dn?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~x,Da(s,l,x)):(Xt&&m&&ep(l),l.flags|=1,yn(s,l,f,x),l.child)}function jx(s,l,f,m,x){if(On(f)){var S=!0;Wf(l)}else S=!1;if(Cl(l,x),l.stateNode===null)ch(s,l),Rx(l,f,m),Sp(l,f,m,x),m=!0;else if(s===null){var b=l.stateNode,Q=l.memoizedProps;b.props=Q;var ne=b.context,pe=f.contextType;typeof pe=="object"&&pe!==null?pe=ci(pe):(pe=On(f)?go:Zr.current,pe=El(l,pe));var Re=f.getDerivedStateFromProps,be=typeof Re=="function"||typeof b.getSnapshotBeforeUpdate=="function";be||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Q!==m||ne!==pe)&&Px(l,b,m,pe),_s=!1;var Ie=l.memoizedState;b.state=Ie,eh(l,m,b,x),ne=l.memoizedState,Q!==m||Ie!==ne||bn.current||_s?(typeof Re=="function"&&(Tp(l,f,Re,m),ne=l.memoizedState),(Q=_s||Ix(l,f,Q,m,Ie,ne,pe))?(be||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(l.flags|=4194308)):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=ne),b.props=m,b.state=ne,b.context=pe,m=Q):(typeof b.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{b=l.stateNode,nx(s,l),Q=l.memoizedProps,pe=l.type===l.elementType?Q:Pi(l.type,Q),b.props=pe,be=l.pendingProps,Ie=b.context,ne=f.contextType,typeof ne=="object"&&ne!==null?ne=ci(ne):(ne=On(f)?go:Zr.current,ne=El(l,ne));var Ue=f.getDerivedStateFromProps;(Re=typeof Ue=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Q!==be||Ie!==ne)&&Px(l,b,m,ne),_s=!1,Ie=l.memoizedState,b.state=Ie,eh(l,m,b,x);var ze=l.memoizedState;Q!==be||Ie!==ze||bn.current||_s?(typeof Ue=="function"&&(Tp(l,f,Ue,m),ze=l.memoizedState),(pe=_s||Ix(l,f,pe,m,Ie,ze,ne)||!1)?(Re||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(m,ze,ne),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(m,ze,ne)),typeof b.componentDidUpdate=="function"&&(l.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof b.componentDidUpdate!="function"||Q===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=ze),b.props=m,b.state=ze,b.context=ne,m=pe):(typeof b.componentDidUpdate!="function"||Q===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||Q===s.memoizedProps&&Ie===s.memoizedState||(l.flags|=1024),m=!1)}return Ip(s,l,f,m,S,x)}function Ip(s,l,f,m,x,S){Ux(s,l);var b=(l.flags&128)!==0;if(!m&&!b)return x&&Gv(l,f,!1),Da(s,l,S);m=l.stateNode,MC.current=l;var Q=b&&typeof f.getDerivedStateFromError!="function"?null:m.render();return l.flags|=1,s!==null&&b?(l.child=kl(l,s.child,null,S),l.child=kl(l,null,Q,S)):yn(s,l,Q,S),l.memoizedState=m.state,x&&Gv(l,f,!0),l.child}function $x(s){var l=s.stateNode;l.pendingContext?zv(s,l.pendingContext,l.pendingContext!==l.context):l.context&&zv(s,l.context,!1),fp(s,l.containerInfo)}function Hx(s,l,f,m,x){return Sl(),ip(x),l.flags|=256,yn(s,l,f,m),l.child}var Rp={dehydrated:null,treeContext:null,retryLane:0};function Pp(s){return{baseLanes:s,cachePool:null,transitions:null}}function zx(s,l,f){var m=l.pendingProps,x=Zt.current,S=!1,b=(l.flags&128)!==0,Q;if((Q=b)||(Q=s!==null&&s.memoizedState===null?!1:(x&2)!==0),Q?(S=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(x|=1),Bt(Zt,x&1),s===null)return np(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(l.mode&1?s.data==="$!"?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(b=m.children,s=m.fallback,S?(m=l.mode,S=l.child,b={mode:"hidden",children:b},!(m&1)&&S!==null?(S.childLanes=0,S.pendingProps=b):S=Eh(b,m,0,null),s=Ao(s,m,f,null),S.return=l,s.return=l,S.sibling=s,l.child=S,l.child.memoizedState=Pp(f),l.memoizedState=Rp,s):Fp(l,b));if(x=s.memoizedState,x!==null&&(Q=x.dehydrated,Q!==null))return VC(s,l,b,m,Q,x,f);if(S){S=m.fallback,b=l.mode,x=s.child,Q=x.sibling;var ne={mode:"hidden",children:m.children};return!(b&1)&&l.child!==x?(m=l.child,m.childLanes=0,m.pendingProps=ne,l.deletions=null):(m=As(x,ne),m.subtreeFlags=x.subtreeFlags&14680064),Q!==null?S=As(Q,S):(S=Ao(S,b,f,null),S.flags|=2),S.return=l,m.return=l,m.sibling=S,l.child=m,m=S,S=l.child,b=s.child.memoizedState,b=b===null?Pp(f):{baseLanes:b.baseLanes|f,cachePool:null,transitions:b.transitions},S.memoizedState=b,S.childLanes=s.childLanes&~f,l.memoizedState=Rp,m}return S=s.child,s=S.sibling,m=As(S,{mode:"visible",children:m.children}),!(l.mode&1)&&(m.lanes=f),m.return=l,m.sibling=null,s!==null&&(f=l.deletions,f===null?(l.deletions=[s],l.flags|=16):f.push(s)),l.child=m,l.memoizedState=null,m}function Fp(s,l){return l=Eh({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function lh(s,l,f,m){return m!==null&&ip(m),kl(l,s.child,null,f),s=Fp(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function VC(s,l,f,m,x,S,b){if(f)return l.flags&256?(l.flags&=-257,m=kp(Error(r(422))),lh(s,l,b,m)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(S=m.fallback,x=l.mode,m=Eh({mode:"visible",children:m.children},x,0,null),S=Ao(S,x,b,null),S.flags|=2,m.return=l,S.return=l,m.sibling=S,l.child=m,l.mode&1&&kl(l,s.child,null,b),l.child.memoizedState=Pp(b),l.memoizedState=Rp,S);if(!(l.mode&1))return lh(s,l,b,null);if(x.data==="$!"){if(m=x.nextSibling&&x.nextSibling.dataset,m)var Q=m.dgst;return m=Q,S=Error(r(419)),m=kp(S,m,void 0),lh(s,l,b,m)}if(Q=(b&s.childLanes)!==0,Dn||Q){if(m=Nr,m!==null){switch(b&-b){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=x&(m.suspendedLanes|b)?0:x,x!==0&&x!==S.retryLane&&(S.retryLane=x,ba(s,x),Oi(m,s,x,-1))}return Kp(),m=kp(Error(r(421))),lh(s,l,b,m)}return x.data==="$?"?(l.flags|=128,l.child=s.child,l=QC.bind(null,s),x._reactRetry=l,null):(s=S.treeContext,Xn=ms(x.nextSibling),qn=l,Xt=!0,Ri=null,s!==null&&(oi[li++]=Pa,oi[li++]=Fa,oi[li++]=vo,Pa=s.id,Fa=s.overflow,vo=l),l=Fp(l,m.children),l.flags|=4096,l)}function Wx(s,l,f){s.lanes|=l;var m=s.alternate;m!==null&&(m.lanes|=l),lp(s.return,l,f)}function bp(s,l,f,m,x){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:x}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=m,S.tail=f,S.tailMode=x)}function Gx(s,l,f){var m=l.pendingProps,x=m.revealOrder,S=m.tail;if(yn(s,l,m.children,f),m=Zt.current,m&2)m=m&1|2,l.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wx(s,f,l);else if(s.tag===19)Wx(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}m&=1}if(Bt(Zt,m),!(l.mode&1))l.memoizedState=null;else switch(x){case"forwards":for(f=l.child,x=null;f!==null;)s=f.alternate,s!==null&&th(s)===null&&(x=f),f=f.sibling;f=x,f===null?(x=l.child,l.child=null):(x=f.sibling,f.sibling=null),bp(l,!1,x,f,S);break;case"backwards":for(f=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&th(s)===null){l.child=x;break}s=x.sibling,x.sibling=f,f=x,x=s}bp(l,!0,f,null,S);break;case"together":bp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function ch(s,l){!(l.mode&1)&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function Da(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),wo|=l.lanes,!(f&l.childLanes))return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,f=As(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=As(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function BC(s,l,f){switch(l.tag){case 3:$x(l),Sl();break;case 5:sx(l);break;case 1:On(l.type)&&Wf(l);break;case 4:fp(l,l.stateNode.containerInfo);break;case 10:var m=l.type._context,x=l.memoizedProps.value;Bt(Qf,m._currentValue),m._currentValue=x;break;case 13:if(m=l.memoizedState,m!==null)return m.dehydrated!==null?(Bt(Zt,Zt.current&1),l.flags|=128,null):f&l.child.childLanes?zx(s,l,f):(Bt(Zt,Zt.current&1),s=Da(s,l,f),s!==null?s.sibling:null);Bt(Zt,Zt.current&1);break;case 19:if(m=(f&l.childLanes)!==0,s.flags&128){if(m)return Gx(s,l,f);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Bt(Zt,Zt.current),m)break;return null;case 22:case 23:return l.lanes=0,Bx(s,l,f)}return Da(s,l,f)}var Kx,Op,qx,Xx;Kx=function(s,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)s.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Op=function(){},qx=function(s,l,f,m){var x=s.memoizedProps;if(x!==m){s=l.stateNode,yo(ea.current);var S=null;switch(f){case"input":x=ct(s,x),m=ct(s,m),S=[];break;case"select":x=xe({},x,{value:void 0}),m=xe({},m,{value:void 0}),S=[];break;case"textarea":x=_i(s,x),m=_i(s,m),S=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(s.onclick=$f)}no(f,m);var b;f=null;for(pe in x)if(!m.hasOwnProperty(pe)&&x.hasOwnProperty(pe)&&x[pe]!=null)if(pe==="style"){var Q=x[pe];for(b in Q)Q.hasOwnProperty(b)&&(f||(f={}),f[b]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(i.hasOwnProperty(pe)?S||(S=[]):(S=S||[]).push(pe,null));for(pe in m){var ne=m[pe];if(Q=x!=null?x[pe]:void 0,m.hasOwnProperty(pe)&&ne!==Q&&(ne!=null||Q!=null))if(pe==="style")if(Q){for(b in Q)!Q.hasOwnProperty(b)||ne&&ne.hasOwnProperty(b)||(f||(f={}),f[b]="");for(b in ne)ne.hasOwnProperty(b)&&Q[b]!==ne[b]&&(f||(f={}),f[b]=ne[b])}else f||(S||(S=[]),S.push(pe,f)),f=ne;else pe==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,Q=Q?Q.__html:void 0,ne!=null&&Q!==ne&&(S=S||[]).push(pe,ne)):pe==="children"?typeof ne!="string"&&typeof ne!="number"||(S=S||[]).push(pe,""+ne):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(i.hasOwnProperty(pe)?(ne!=null&&pe==="onScroll"&&Wt("scroll",s),S||Q===ne||(S=[])):(S=S||[]).push(pe,ne))}f&&(S=S||[]).push("style",f);var pe=S;(l.updateQueue=pe)&&(l.flags|=4)}},Xx=function(s,l,f,m){f!==m&&(l.flags|=4)};function qc(s,l){if(!Xt)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:m.sibling=null}}function tn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,m=0;if(l)for(var x=s.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags&14680064,m|=x.flags&14680064,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=m,s.childLanes=f,l}function UC(s,l,f){var m=l.pendingProps;switch(tp(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(l),null;case 1:return On(l.type)&&zf(),tn(l),null;case 3:return m=l.stateNode,Il(),Gt(bn),Gt(Zr),pp(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(s===null||s.child===null)&&(Xf(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,Ri!==null&&(zp(Ri),Ri=null))),Op(s,l),tn(l),null;case 5:hp(l);var x=yo(Hc.current);if(f=l.type,s!==null&&l.stateNode!=null)qx(s,l,f,m,x),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!m){if(l.stateNode===null)throw Error(r(166));return tn(l),null}if(s=yo(ea.current),Xf(l)){m=l.stateNode,f=l.type;var S=l.memoizedProps;switch(m[Zi]=l,m[Vc]=S,s=(l.mode&1)!==0,f){case"dialog":Wt("cancel",m),Wt("close",m);break;case"iframe":case"object":case"embed":Wt("load",m);break;case"video":case"audio":for(x=0;x<Nc.length;x++)Wt(Nc[x],m);break;case"source":Wt("error",m);break;case"img":case"image":case"link":Wt("error",m),Wt("load",m);break;case"details":Wt("toggle",m);break;case"input":dt(m,S),Wt("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!S.multiple},Wt("invalid",m);break;case"textarea":gn(m,S),Wt("invalid",m)}no(f,S),x=null;for(var b in S)if(S.hasOwnProperty(b)){var Q=S[b];b==="children"?typeof Q=="string"?m.textContent!==Q&&(S.suppressHydrationWarning!==!0&&jf(m.textContent,Q,s),x=["children",Q]):typeof Q=="number"&&m.textContent!==""+Q&&(S.suppressHydrationWarning!==!0&&jf(m.textContent,Q,s),x=["children",""+Q]):i.hasOwnProperty(b)&&Q!=null&&b==="onScroll"&&Wt("scroll",m)}switch(f){case"input":Ke(m),Vt(m,S,!0);break;case"textarea":Ke(m),vn(m);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(m.onclick=$f)}m=x,l.updateQueue=m,m!==null&&(l.flags|=4)}else{b=x.nodeType===9?x:x.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Lt(f)),s==="http://www.w3.org/1999/xhtml"?f==="script"?(s=b.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof m.is=="string"?s=b.createElement(f,{is:m.is}):(s=b.createElement(f),f==="select"&&(b=s,m.multiple?b.multiple=!0:m.size&&(b.size=m.size))):s=b.createElementNS(s,f),s[Zi]=l,s[Vc]=m,Kx(s,l,!1,!1),l.stateNode=s;e:{switch(b=io(f,m),f){case"dialog":Wt("cancel",s),Wt("close",s),x=m;break;case"iframe":case"object":case"embed":Wt("load",s),x=m;break;case"video":case"audio":for(x=0;x<Nc.length;x++)Wt(Nc[x],s);x=m;break;case"source":Wt("error",s),x=m;break;case"img":case"image":case"link":Wt("error",s),Wt("load",s),x=m;break;case"details":Wt("toggle",s),x=m;break;case"input":dt(s,m),x=ct(s,m),Wt("invalid",s);break;case"option":x=m;break;case"select":s._wrapperState={wasMultiple:!!m.multiple},x=xe({},m,{value:void 0}),Wt("invalid",s);break;case"textarea":gn(s,m),x=_i(s,m),Wt("invalid",s);break;default:x=m}no(f,x),Q=x;for(S in Q)if(Q.hasOwnProperty(S)){var ne=Q[S];S==="style"?Hn(s,ne):S==="dangerouslySetInnerHTML"?(ne=ne?ne.__html:void 0,ne!=null&&Jr(s,ne)):S==="children"?typeof ne=="string"?(f!=="textarea"||ne!=="")&&rt(s,ne):typeof ne=="number"&&rt(s,""+ne):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(i.hasOwnProperty(S)?ne!=null&&S==="onScroll"&&Wt("scroll",s):ne!=null&&C(s,S,ne,b))}switch(f){case"input":Ke(s),Vt(s,m,!1);break;case"textarea":Ke(s),vn(s);break;case"option":m.value!=null&&s.setAttribute("value",""+ve(m.value));break;case"select":s.multiple=!!m.multiple,S=m.value,S!=null?Tr(s,!!m.multiple,S,!1):m.defaultValue!=null&&Tr(s,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(s.onclick=$f)}switch(f){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return tn(l),null;case 6:if(s&&l.stateNode!=null)Xx(s,l,s.memoizedProps,m);else{if(typeof m!="string"&&l.stateNode===null)throw Error(r(166));if(f=yo(Hc.current),yo(ea.current),Xf(l)){if(m=l.stateNode,f=l.memoizedProps,m[Zi]=l,(S=m.nodeValue!==f)&&(s=qn,s!==null))switch(s.tag){case 3:jf(m.nodeValue,f,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&jf(m.nodeValue,f,(s.mode&1)!==0)}S&&(l.flags|=4)}else m=(f.nodeType===9?f:f.ownerDocument).createTextNode(m),m[Zi]=l,l.stateNode=m}return tn(l),null;case 13:if(Gt(Zt),m=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Xt&&Xn!==null&&l.mode&1&&!(l.flags&128))Jv(),Sl(),l.flags|=98560,S=!1;else if(S=Xf(l),m!==null&&m.dehydrated!==null){if(s===null){if(!S)throw Error(r(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(r(317));S[Zi]=l}else Sl(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;tn(l),S=!1}else Ri!==null&&(zp(Ri),Ri=null),S=!0;if(!S)return l.flags&65536?l:null}return l.flags&128?(l.lanes=f,l):(m=m!==null,m!==(s!==null&&s.memoizedState!==null)&&m&&(l.child.flags|=8192,l.mode&1&&(s===null||Zt.current&1?Ar===0&&(Ar=3):Kp())),l.updateQueue!==null&&(l.flags|=4),tn(l),null);case 4:return Il(),Op(s,l),s===null&&Lc(l.stateNode.containerInfo),tn(l),null;case 10:return op(l.type._context),tn(l),null;case 17:return On(l.type)&&zf(),tn(l),null;case 19:if(Gt(Zt),S=l.memoizedState,S===null)return tn(l),null;if(m=(l.flags&128)!==0,b=S.rendering,b===null)if(m)qc(S,!1);else{if(Ar!==0||s!==null&&s.flags&128)for(s=l.child;s!==null;){if(b=th(s),b!==null){for(l.flags|=128,qc(S,!1),m=b.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),l.subtreeFlags=0,m=f,f=l.child;f!==null;)S=f,s=m,S.flags&=14680066,b=S.alternate,b===null?(S.childLanes=0,S.lanes=s,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=b.childLanes,S.lanes=b.lanes,S.child=b.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=b.memoizedProps,S.memoizedState=b.memoizedState,S.updateQueue=b.updateQueue,S.type=b.type,s=b.dependencies,S.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),f=f.sibling;return Bt(Zt,Zt.current&1|2),l.child}s=s.sibling}S.tail!==null&&Fe()>bl&&(l.flags|=128,m=!0,qc(S,!1),l.lanes=4194304)}else{if(!m)if(s=th(b),s!==null){if(l.flags|=128,m=!0,f=s.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),qc(S,!0),S.tail===null&&S.tailMode==="hidden"&&!b.alternate&&!Xt)return tn(l),null}else 2*Fe()-S.renderingStartTime>bl&&f!==1073741824&&(l.flags|=128,m=!0,qc(S,!1),l.lanes=4194304);S.isBackwards?(b.sibling=l.child,l.child=b):(f=S.last,f!==null?f.sibling=b:l.child=b,S.last=b)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=Fe(),l.sibling=null,f=Zt.current,Bt(Zt,m?f&1|2:f&1),l):(tn(l),null);case 22:case 23:return Gp(),m=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==m&&(l.flags|=8192),m&&l.mode&1?Yn&1073741824&&(tn(l),l.subtreeFlags&6&&(l.flags|=8192)):tn(l),null;case 24:return null;case 25:return null}throw Error(r(156,l.tag))}function jC(s,l){switch(tp(l),l.tag){case 1:return On(l.type)&&zf(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Il(),Gt(bn),Gt(Zr),pp(),s=l.flags,s&65536&&!(s&128)?(l.flags=s&-65537|128,l):null;case 5:return hp(l),null;case 13:if(Gt(Zt),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Sl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Gt(Zt),null;case 4:return Il(),null;case 10:return op(l.type._context),null;case 22:case 23:return Gp(),null;case 24:return null;default:return null}}var uh=!1,rn=!1,$C=typeof WeakSet=="function"?WeakSet:Set,He=null;function Pl(s,l){var f=s.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(m){rr(s,l,m)}else f.current=null}function Dp(s,l,f){try{f()}catch(m){rr(s,l,m)}}var Yx=!1;function HC(s,l){if(Gd=hs,s=Iv(),Vd(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var x=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var b=0,Q=-1,ne=-1,pe=0,Re=0,be=s,Ie=null;t:for(;;){for(var Ue;be!==f||x!==0&&be.nodeType!==3||(Q=b+x),be!==S||m!==0&&be.nodeType!==3||(ne=b+m),be.nodeType===3&&(b+=be.nodeValue.length),(Ue=be.firstChild)!==null;)Ie=be,be=Ue;for(;;){if(be===s)break t;if(Ie===f&&++pe===x&&(Q=b),Ie===S&&++Re===m&&(ne=b),(Ue=be.nextSibling)!==null)break;be=Ie,Ie=be.parentNode}be=Ue}f=Q===-1||ne===-1?null:{start:Q,end:ne}}else f=null}f=f||{start:0,end:0}}else f=null;for(Kd={focusedElem:s,selectionRange:f},hs=!1,He=l;He!==null;)if(l=He,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,He=s;else for(;He!==null;){l=He;try{var ze=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var We=ze.memoizedProps,or=ze.memoizedState,oe=l.stateNode,ae=oe.getSnapshotBeforeUpdate(l.elementType===l.type?We:Pi(l.type,We),or);oe.__reactInternalSnapshotBeforeUpdate=ae}break;case 3:var fe=l.stateNode.containerInfo;fe.nodeType===1?fe.textContent="":fe.nodeType===9&&fe.documentElement&&fe.removeChild(fe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ne){rr(l,l.return,Ne)}if(s=l.sibling,s!==null){s.return=l.return,He=s;break}He=l.return}return ze=Yx,Yx=!1,ze}function Xc(s,l,f){var m=l.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var x=m=m.next;do{if((x.tag&s)===s){var S=x.destroy;x.destroy=void 0,S!==void 0&&Dp(l,f,S)}x=x.next}while(x!==m)}}function fh(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&s)===s){var m=f.create;f.destroy=m()}f=f.next}while(f!==l)}}function Np(s){var l=s.ref;if(l!==null){var f=s.stateNode;switch(s.tag){case 5:s=f;break;default:s=f}typeof l=="function"?l(s):l.current=s}}function Qx(s){var l=s.alternate;l!==null&&(s.alternate=null,Qx(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[Zi],delete l[Vc],delete l[Qd],delete l[kC],delete l[AC])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Jx(s){return s.tag===5||s.tag===3||s.tag===4}function Zx(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Jx(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lp(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(s,l):f.insertBefore(s,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(s,f)):(l=f,l.appendChild(s)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=$f));else if(m!==4&&(s=s.child,s!==null))for(Lp(s,l,f),s=s.sibling;s!==null;)Lp(s,l,f),s=s.sibling}function Mp(s,l,f){var m=s.tag;if(m===5||m===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(m!==4&&(s=s.child,s!==null))for(Mp(s,l,f),s=s.sibling;s!==null;)Mp(s,l,f),s=s.sibling}var Hr=null,Fi=!1;function Es(s,l,f){for(f=f.child;f!==null;)e_(s,l,f),f=f.sibling}function e_(s,l,f){if(sr&&typeof sr.onCommitFiberUnmount=="function")try{sr.onCommitFiberUnmount(zn,f)}catch{}switch(f.tag){case 5:rn||Pl(f,l);case 6:var m=Hr,x=Fi;Hr=null,Es(s,l,f),Hr=m,Fi=x,Hr!==null&&(Fi?(s=Hr,f=f.stateNode,s.nodeType===8?s.parentNode.removeChild(f):s.removeChild(f)):Hr.removeChild(f.stateNode));break;case 18:Hr!==null&&(Fi?(s=Hr,f=f.stateNode,s.nodeType===8?Yd(s.parentNode,f):s.nodeType===1&&Yd(s,f),Ai(s)):Yd(Hr,f.stateNode));break;case 4:m=Hr,x=Fi,Hr=f.stateNode.containerInfo,Fi=!0,Es(s,l,f),Hr=m,Fi=x;break;case 0:case 11:case 14:case 15:if(!rn&&(m=f.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){x=m=m.next;do{var S=x,b=S.destroy;S=S.tag,b!==void 0&&(S&2||S&4)&&Dp(f,l,b),x=x.next}while(x!==m)}Es(s,l,f);break;case 1:if(!rn&&(Pl(f,l),m=f.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=f.memoizedProps,m.state=f.memoizedState,m.componentWillUnmount()}catch(Q){rr(f,l,Q)}Es(s,l,f);break;case 21:Es(s,l,f);break;case 22:f.mode&1?(rn=(m=rn)||f.memoizedState!==null,Es(s,l,f),rn=m):Es(s,l,f);break;default:Es(s,l,f)}}function t_(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var f=s.stateNode;f===null&&(f=s.stateNode=new $C),l.forEach(function(m){var x=JC.bind(null,s,m);f.has(m)||(f.add(m),m.then(x,x))})}}function bi(s,l){var f=l.deletions;if(f!==null)for(var m=0;m<f.length;m++){var x=f[m];try{var S=s,b=l,Q=b;e:for(;Q!==null;){switch(Q.tag){case 5:Hr=Q.stateNode,Fi=!1;break e;case 3:Hr=Q.stateNode.containerInfo,Fi=!0;break e;case 4:Hr=Q.stateNode.containerInfo,Fi=!0;break e}Q=Q.return}if(Hr===null)throw Error(r(160));e_(S,b,x),Hr=null,Fi=!1;var ne=x.alternate;ne!==null&&(ne.return=null),x.return=null}catch(pe){rr(x,l,pe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)r_(l,s),l=l.sibling}function r_(s,l){var f=s.alternate,m=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(bi(l,s),ra(s),m&4){try{Xc(3,s,s.return),fh(3,s)}catch(We){rr(s,s.return,We)}try{Xc(5,s,s.return)}catch(We){rr(s,s.return,We)}}break;case 1:bi(l,s),ra(s),m&512&&f!==null&&Pl(f,f.return);break;case 5:if(bi(l,s),ra(s),m&512&&f!==null&&Pl(f,f.return),s.flags&32){var x=s.stateNode;try{rt(x,"")}catch(We){rr(s,s.return,We)}}if(m&4&&(x=s.stateNode,x!=null)){var S=s.memoizedProps,b=f!==null?f.memoizedProps:S,Q=s.type,ne=s.updateQueue;if(s.updateQueue=null,ne!==null)try{Q==="input"&&S.type==="radio"&&S.name!=null&&ut(x,S),io(Q,b);var pe=io(Q,S);for(b=0;b<ne.length;b+=2){var Re=ne[b],be=ne[b+1];Re==="style"?Hn(x,be):Re==="dangerouslySetInnerHTML"?Jr(x,be):Re==="children"?rt(x,be):C(x,Re,be,pe)}switch(Q){case"input":Ve(x,S);break;case"textarea":hr(x,S);break;case"select":var Ie=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!S.multiple;var Ue=S.value;Ue!=null?Tr(x,!!S.multiple,Ue,!1):Ie!==!!S.multiple&&(S.defaultValue!=null?Tr(x,!!S.multiple,S.defaultValue,!0):Tr(x,!!S.multiple,S.multiple?[]:"",!1))}x[Vc]=S}catch(We){rr(s,s.return,We)}}break;case 6:if(bi(l,s),ra(s),m&4){if(s.stateNode===null)throw Error(r(162));x=s.stateNode,S=s.memoizedProps;try{x.nodeValue=S}catch(We){rr(s,s.return,We)}}break;case 3:if(bi(l,s),ra(s),m&4&&f!==null&&f.memoizedState.isDehydrated)try{Ai(l.containerInfo)}catch(We){rr(s,s.return,We)}break;case 4:bi(l,s),ra(s);break;case 13:bi(l,s),ra(s),x=s.child,x.flags&8192&&(S=x.memoizedState!==null,x.stateNode.isHidden=S,!S||x.alternate!==null&&x.alternate.memoizedState!==null||(Up=Fe())),m&4&&t_(s);break;case 22:if(Re=f!==null&&f.memoizedState!==null,s.mode&1?(rn=(pe=rn)||Re,bi(l,s),rn=pe):bi(l,s),ra(s),m&8192){if(pe=s.memoizedState!==null,(s.stateNode.isHidden=pe)&&!Re&&s.mode&1)for(He=s,Re=s.child;Re!==null;){for(be=He=Re;He!==null;){switch(Ie=He,Ue=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Xc(4,Ie,Ie.return);break;case 1:Pl(Ie,Ie.return);var ze=Ie.stateNode;if(typeof ze.componentWillUnmount=="function"){m=Ie,f=Ie.return;try{l=m,ze.props=l.memoizedProps,ze.state=l.memoizedState,ze.componentWillUnmount()}catch(We){rr(m,f,We)}}break;case 5:Pl(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){a_(be);continue}}Ue!==null?(Ue.return=Ie,He=Ue):a_(be)}Re=Re.sibling}e:for(Re=null,be=s;;){if(be.tag===5){if(Re===null){Re=be;try{x=be.stateNode,pe?(S=x.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(Q=be.stateNode,ne=be.memoizedProps.style,b=ne!=null&&ne.hasOwnProperty("display")?ne.display:null,Q.style.display=Ht("display",b))}catch(We){rr(s,s.return,We)}}}else if(be.tag===6){if(Re===null)try{be.stateNode.nodeValue=pe?"":be.memoizedProps}catch(We){rr(s,s.return,We)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===s)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===s)break e;for(;be.sibling===null;){if(be.return===null||be.return===s)break e;Re===be&&(Re=null),be=be.return}Re===be&&(Re=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:bi(l,s),ra(s),m&4&&t_(s);break;case 21:break;default:bi(l,s),ra(s)}}function ra(s){var l=s.flags;if(l&2){try{e:{for(var f=s.return;f!==null;){if(Jx(f)){var m=f;break e}f=f.return}throw Error(r(160))}switch(m.tag){case 5:var x=m.stateNode;m.flags&32&&(rt(x,""),m.flags&=-33);var S=Zx(s);Mp(s,S,x);break;case 3:case 4:var b=m.stateNode.containerInfo,Q=Zx(s);Lp(s,Q,b);break;default:throw Error(r(161))}}catch(ne){rr(s,s.return,ne)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function zC(s,l,f){He=s,n_(s)}function n_(s,l,f){for(var m=(s.mode&1)!==0;He!==null;){var x=He,S=x.child;if(x.tag===22&&m){var b=x.memoizedState!==null||uh;if(!b){var Q=x.alternate,ne=Q!==null&&Q.memoizedState!==null||rn;Q=uh;var pe=rn;if(uh=b,(rn=ne)&&!pe)for(He=x;He!==null;)b=He,ne=b.child,b.tag===22&&b.memoizedState!==null?s_(x):ne!==null?(ne.return=b,He=ne):s_(x);for(;S!==null;)He=S,n_(S),S=S.sibling;He=x,uh=Q,rn=pe}i_(s)}else x.subtreeFlags&8772&&S!==null?(S.return=x,He=S):i_(s)}}function i_(s){for(;He!==null;){var l=He;if(l.flags&8772){var f=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:rn||fh(5,l);break;case 1:var m=l.stateNode;if(l.flags&4&&!rn)if(f===null)m.componentDidMount();else{var x=l.elementType===l.type?f.memoizedProps:Pi(l.type,f.memoizedProps);m.componentDidUpdate(x,f.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var S=l.updateQueue;S!==null&&ax(l,S,m);break;case 3:var b=l.updateQueue;if(b!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}ax(l,b,f)}break;case 5:var Q=l.stateNode;if(f===null&&l.flags&4){f=Q;var ne=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ne.autoFocus&&f.focus();break;case"img":ne.src&&(f.src=ne.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var pe=l.alternate;if(pe!==null){var Re=pe.memoizedState;if(Re!==null){var be=Re.dehydrated;be!==null&&Ai(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}rn||l.flags&512&&Np(l)}catch(Ie){rr(l,l.return,Ie)}}if(l===s){He=null;break}if(f=l.sibling,f!==null){f.return=l.return,He=f;break}He=l.return}}function a_(s){for(;He!==null;){var l=He;if(l===s){He=null;break}var f=l.sibling;if(f!==null){f.return=l.return,He=f;break}He=l.return}}function s_(s){for(;He!==null;){var l=He;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{fh(4,l)}catch(ne){rr(l,f,ne)}break;case 1:var m=l.stateNode;if(typeof m.componentDidMount=="function"){var x=l.return;try{m.componentDidMount()}catch(ne){rr(l,x,ne)}}var S=l.return;try{Np(l)}catch(ne){rr(l,S,ne)}break;case 5:var b=l.return;try{Np(l)}catch(ne){rr(l,b,ne)}}}catch(ne){rr(l,l.return,ne)}if(l===s){He=null;break}var Q=l.sibling;if(Q!==null){Q.return=l.return,He=Q;break}He=l.return}}var WC=Math.ceil,hh=U.ReactCurrentDispatcher,Vp=U.ReactCurrentOwner,fi=U.ReactCurrentBatchConfig,Tt=0,Nr=null,mr=null,zr=0,Yn=0,Fl=gs(0),Ar=0,Yc=null,wo=0,dh=0,Bp=0,Qc=null,Nn=null,Up=0,bl=1/0,Na=null,ph=!1,jp=null,ws=null,mh=!1,Ts=null,gh=0,Jc=0,$p=null,vh=-1,xh=0;function En(){return Tt&6?Fe():vh!==-1?vh:vh=Fe()}function Ss(s){return s.mode&1?Tt&2&&zr!==0?zr&-zr:IC.transition!==null?(xh===0&&(xh=co()),xh):(s=gt,s!==0||(s=window.event,s=s===void 0?16:Ac(s.type)),s):1}function Oi(s,l,f,m){if(50<Jc)throw Jc=0,$p=null,Error(r(185));ls(s,f,m),(!(Tt&2)||s!==Nr)&&(s===Nr&&(!(Tt&2)&&(dh|=f),Ar===4&&ks(s,zr)),Ln(s,m),f===1&&Tt===0&&!(l.mode&1)&&(bl=Fe()+500,Gf&&xs()))}function Ln(s,l){var f=s.callbackNode;Ta(s,l);var m=lo(s,s===Nr?zr:0);if(m===0)f!==null&&Le(f),s.callbackNode=null,s.callbackPriority=0;else if(l=m&-m,s.callbackPriority!==l){if(f!=null&&Le(f),l===1)s.tag===0?CC(l_.bind(null,s)):Kv(l_.bind(null,s)),TC(function(){!(Tt&6)&&xs()}),f=null;else{switch(us(m)){case 1:f=It;break;case 4:f=At;break;case 16:f=Dt;break;case 536870912:f=Ki;break;default:f=Dt}f=g_(f,o_.bind(null,s))}s.callbackPriority=l,s.callbackNode=f}}function o_(s,l){if(vh=-1,xh=0,Tt&6)throw Error(r(327));var f=s.callbackNode;if(Ol()&&s.callbackNode!==f)return null;var m=lo(s,s===Nr?zr:0);if(m===0)return null;if(m&30||m&s.expiredLanes||l)l=_h(s,m);else{l=m;var x=Tt;Tt|=2;var S=u_();(Nr!==s||zr!==l)&&(Na=null,bl=Fe()+500,So(s,l));do try{qC();break}catch(Q){c_(s,Q)}while(!0);sp(),hh.current=S,Tt=x,mr!==null?l=0:(Nr=null,zr=0,l=Ar)}if(l!==0){if(l===2&&(x=Wn(s),x!==0&&(m=x,l=Hp(s,x))),l===1)throw f=Yc,So(s,0),ks(s,m),Ln(s,Fe()),f;if(l===6)ks(s,m);else{if(x=s.current.alternate,!(m&30)&&!GC(x)&&(l=_h(s,m),l===2&&(S=Wn(s),S!==0&&(m=S,l=Hp(s,S))),l===1))throw f=Yc,So(s,0),ks(s,m),Ln(s,Fe()),f;switch(s.finishedWork=x,s.finishedLanes=m,l){case 0:case 1:throw Error(r(345));case 2:ko(s,Nn,Na);break;case 3:if(ks(s,m),(m&130023424)===m&&(l=Up+500-Fe(),10<l)){if(lo(s,0)!==0)break;if(x=s.suspendedLanes,(x&m)!==m){En(),s.pingedLanes|=s.suspendedLanes&x;break}s.timeoutHandle=Xd(ko.bind(null,s,Nn,Na),l);break}ko(s,Nn,Na);break;case 4:if(ks(s,m),(m&4194240)===m)break;for(l=s.eventTimes,x=-1;0<m;){var b=31-zt(m);S=1<<b,b=l[b],b>x&&(x=b),m&=~S}if(m=x,m=Fe()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*WC(m/1960))-m,10<m){s.timeoutHandle=Xd(ko.bind(null,s,Nn,Na),m);break}ko(s,Nn,Na);break;case 5:ko(s,Nn,Na);break;default:throw Error(r(329))}}}return Ln(s,Fe()),s.callbackNode===f?o_.bind(null,s):null}function Hp(s,l){var f=Qc;return s.current.memoizedState.isDehydrated&&(So(s,l).flags|=256),s=_h(s,l),s!==2&&(l=Nn,Nn=f,l!==null&&zp(l)),s}function zp(s){Nn===null?Nn=s:Nn.push.apply(Nn,s)}function GC(s){for(var l=s;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var m=0;m<f.length;m++){var x=f[m],S=x.getSnapshot;x=x.value;try{if(!Ii(S(),x))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ks(s,l){for(l&=~Bp,l&=~dh,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var f=31-zt(l),m=1<<f;s[f]=-1,l&=~m}}function l_(s){if(Tt&6)throw Error(r(327));Ol();var l=lo(s,0);if(!(l&1))return Ln(s,Fe()),null;var f=_h(s,l);if(s.tag!==0&&f===2){var m=Wn(s);m!==0&&(l=m,f=Hp(s,m))}if(f===1)throw f=Yc,So(s,0),ks(s,l),Ln(s,Fe()),f;if(f===6)throw Error(r(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,ko(s,Nn,Na),Ln(s,Fe()),null}function Wp(s,l){var f=Tt;Tt|=1;try{return s(l)}finally{Tt=f,Tt===0&&(bl=Fe()+500,Gf&&xs())}}function To(s){Ts!==null&&Ts.tag===0&&!(Tt&6)&&Ol();var l=Tt;Tt|=1;var f=fi.transition,m=gt;try{if(fi.transition=null,gt=1,s)return s()}finally{gt=m,fi.transition=f,Tt=l,!(Tt&6)&&xs()}}function Gp(){Yn=Fl.current,Gt(Fl)}function So(s,l){s.finishedWork=null,s.finishedLanes=0;var f=s.timeoutHandle;if(f!==-1&&(s.timeoutHandle=-1,wC(f)),mr!==null)for(f=mr.return;f!==null;){var m=f;switch(tp(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&zf();break;case 3:Il(),Gt(bn),Gt(Zr),pp();break;case 5:hp(m);break;case 4:Il();break;case 13:Gt(Zt);break;case 19:Gt(Zt);break;case 10:op(m.type._context);break;case 22:case 23:Gp()}f=f.return}if(Nr=s,mr=s=As(s.current,null),zr=Yn=l,Ar=0,Yc=null,Bp=dh=wo=0,Nn=Qc=null,_o!==null){for(l=0;l<_o.length;l++)if(f=_o[l],m=f.interleaved,m!==null){f.interleaved=null;var x=m.next,S=f.pending;if(S!==null){var b=S.next;S.next=x,m.next=b}f.pending=m}_o=null}return s}function c_(s,l){do{var f=mr;try{if(sp(),rh.current=sh,nh){for(var m=er.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}nh=!1}if(Eo=0,Dr=kr=er=null,zc=!1,Wc=0,Vp.current=null,f===null||f.return===null){Ar=1,Yc=l,mr=null;break}e:{var S=s,b=f.return,Q=f,ne=l;if(l=zr,Q.flags|=32768,ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var pe=ne,Re=Q,be=Re.tag;if(!(Re.mode&1)&&(be===0||be===11||be===15)){var Ie=Re.alternate;Ie?(Re.updateQueue=Ie.updateQueue,Re.memoizedState=Ie.memoizedState,Re.lanes=Ie.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var Ue=Dx(b);if(Ue!==null){Ue.flags&=-257,Nx(Ue,b,Q,S,l),Ue.mode&1&&Ox(S,pe,l),l=Ue,ne=pe;var ze=l.updateQueue;if(ze===null){var We=new Set;We.add(ne),l.updateQueue=We}else ze.add(ne);break e}else{if(!(l&1)){Ox(S,pe,l),Kp();break e}ne=Error(r(426))}}else if(Xt&&Q.mode&1){var or=Dx(b);if(or!==null){!(or.flags&65536)&&(or.flags|=256),Nx(or,b,Q,S,l),ip(Rl(ne,Q));break e}}S=ne=Rl(ne,Q),Ar!==4&&(Ar=2),Qc===null?Qc=[S]:Qc.push(S),S=b;do{switch(S.tag){case 3:S.flags|=65536,l&=-l,S.lanes|=l;var oe=Fx(S,ne,l);ix(S,oe);break e;case 1:Q=ne;var ae=S.type,fe=S.stateNode;if(!(S.flags&128)&&(typeof ae.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(ws===null||!ws.has(fe)))){S.flags|=65536,l&=-l,S.lanes|=l;var Ne=bx(S,Q,l);ix(S,Ne);break e}}S=S.return}while(S!==null)}h_(f)}catch(Ge){l=Ge,mr===f&&f!==null&&(mr=f=f.return);continue}break}while(!0)}function u_(){var s=hh.current;return hh.current=sh,s===null?sh:s}function Kp(){(Ar===0||Ar===3||Ar===2)&&(Ar=4),Nr===null||!(wo&268435455)&&!(dh&268435455)||ks(Nr,zr)}function _h(s,l){var f=Tt;Tt|=2;var m=u_();(Nr!==s||zr!==l)&&(Na=null,So(s,l));do try{KC();break}catch(x){c_(s,x)}while(!0);if(sp(),Tt=f,hh.current=m,mr!==null)throw Error(r(261));return Nr=null,zr=0,Ar}function KC(){for(;mr!==null;)f_(mr)}function qC(){for(;mr!==null&&!Be();)f_(mr)}function f_(s){var l=m_(s.alternate,s,Yn);s.memoizedProps=s.pendingProps,l===null?h_(s):mr=l,Vp.current=null}function h_(s){var l=s;do{var f=l.alternate;if(s=l.return,l.flags&32768){if(f=jC(f,l),f!==null){f.flags&=32767,mr=f;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Ar=6,mr=null;return}}else if(f=UC(f,l,Yn),f!==null){mr=f;return}if(l=l.sibling,l!==null){mr=l;return}mr=l=s}while(l!==null);Ar===0&&(Ar=5)}function ko(s,l,f){var m=gt,x=fi.transition;try{fi.transition=null,gt=1,XC(s,l,f,m)}finally{fi.transition=x,gt=m}return null}function XC(s,l,f,m){do Ol();while(Ts!==null);if(Tt&6)throw Error(r(327));f=s.finishedWork;var x=s.finishedLanes;if(f===null)return null;if(s.finishedWork=null,s.finishedLanes=0,f===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0;var S=f.lanes|f.childLanes;if(Mt(s,S),s===Nr&&(mr=Nr=null,zr=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||mh||(mh=!0,g_(Dt,function(){return Ol(),null})),S=(f.flags&15990)!==0,f.subtreeFlags&15990||S){S=fi.transition,fi.transition=null;var b=gt;gt=1;var Q=Tt;Tt|=4,Vp.current=null,HC(s,f),r_(f,s),mC(Kd),hs=!!Gd,Kd=Gd=null,s.current=f,zC(f),De(),Tt=Q,gt=b,fi.transition=S}else s.current=f;if(mh&&(mh=!1,Ts=s,gh=x),S=s.pendingLanes,S===0&&(ws=null),as(f.stateNode),Ln(s,Fe()),l!==null)for(m=s.onRecoverableError,f=0;f<l.length;f++)x=l[f],m(x.value,{componentStack:x.stack,digest:x.digest});if(ph)throw ph=!1,s=jp,jp=null,s;return gh&1&&s.tag!==0&&Ol(),S=s.pendingLanes,S&1?s===$p?Jc++:(Jc=0,$p=s):Jc=0,xs(),null}function Ol(){if(Ts!==null){var s=us(gh),l=fi.transition,f=gt;try{if(fi.transition=null,gt=16>s?16:s,Ts===null)var m=!1;else{if(s=Ts,Ts=null,gh=0,Tt&6)throw Error(r(331));var x=Tt;for(Tt|=4,He=s.current;He!==null;){var S=He,b=S.child;if(He.flags&16){var Q=S.deletions;if(Q!==null){for(var ne=0;ne<Q.length;ne++){var pe=Q[ne];for(He=pe;He!==null;){var Re=He;switch(Re.tag){case 0:case 11:case 15:Xc(8,Re,S)}var be=Re.child;if(be!==null)be.return=Re,He=be;else for(;He!==null;){Re=He;var Ie=Re.sibling,Ue=Re.return;if(Qx(Re),Re===pe){He=null;break}if(Ie!==null){Ie.return=Ue,He=Ie;break}He=Ue}}}var ze=S.alternate;if(ze!==null){var We=ze.child;if(We!==null){ze.child=null;do{var or=We.sibling;We.sibling=null,We=or}while(We!==null)}}He=S}}if(S.subtreeFlags&2064&&b!==null)b.return=S,He=b;else e:for(;He!==null;){if(S=He,S.flags&2048)switch(S.tag){case 0:case 11:case 15:Xc(9,S,S.return)}var oe=S.sibling;if(oe!==null){oe.return=S.return,He=oe;break e}He=S.return}}var ae=s.current;for(He=ae;He!==null;){b=He;var fe=b.child;if(b.subtreeFlags&2064&&fe!==null)fe.return=b,He=fe;else e:for(b=ae;He!==null;){if(Q=He,Q.flags&2048)try{switch(Q.tag){case 0:case 11:case 15:fh(9,Q)}}catch(Ge){rr(Q,Q.return,Ge)}if(Q===b){He=null;break e}var Ne=Q.sibling;if(Ne!==null){Ne.return=Q.return,He=Ne;break e}He=Q.return}}if(Tt=x,xs(),sr&&typeof sr.onPostCommitFiberRoot=="function")try{sr.onPostCommitFiberRoot(zn,s)}catch{}m=!0}return m}finally{gt=f,fi.transition=l}}return!1}function d_(s,l,f){l=Rl(f,l),l=Fx(s,l,1),s=ys(s,l,1),l=En(),s!==null&&(ls(s,1,l),Ln(s,l))}function rr(s,l,f){if(s.tag===3)d_(s,s,f);else for(;l!==null;){if(l.tag===3){d_(l,s,f);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ws===null||!ws.has(m))){s=Rl(f,s),s=bx(l,s,1),l=ys(l,s,1),s=En(),l!==null&&(ls(l,1,s),Ln(l,s));break}}l=l.return}}function YC(s,l,f){var m=s.pingCache;m!==null&&m.delete(l),l=En(),s.pingedLanes|=s.suspendedLanes&f,Nr===s&&(zr&f)===f&&(Ar===4||Ar===3&&(zr&130023424)===zr&&500>Fe()-Up?So(s,0):Bp|=f),Ln(s,l)}function p_(s,l){l===0&&(s.mode&1?(l=rl,rl<<=1,!(rl&130023424)&&(rl=4194304)):l=1);var f=En();s=ba(s,l),s!==null&&(ls(s,l,f),Ln(s,f))}function QC(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),p_(s,f)}function JC(s,l){var f=0;switch(s.tag){case 13:var m=s.stateNode,x=s.memoizedState;x!==null&&(f=x.retryLane);break;case 19:m=s.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(l),p_(s,f)}var m_;m_=function(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps||bn.current)Dn=!0;else{if(!(s.lanes&f)&&!(l.flags&128))return Dn=!1,BC(s,l,f);Dn=!!(s.flags&131072)}else Dn=!1,Xt&&l.flags&1048576&&qv(l,qf,l.index);switch(l.lanes=0,l.tag){case 2:var m=l.type;ch(s,l),s=l.pendingProps;var x=El(l,Zr.current);Cl(l,f),x=vp(null,l,m,s,x,f);var S=xp();return l.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,On(m)?(S=!0,Wf(l)):S=!1,l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,up(l),x.updater=oh,l.stateNode=x,x._reactInternals=l,Sp(l,m,s,f),l=Ip(null,l,m,!0,S,f)):(l.tag=0,Xt&&S&&ep(l),yn(null,l,x,f),l=l.child),l;case 16:m=l.elementType;e:{switch(ch(s,l),s=l.pendingProps,x=m._init,m=x(m._payload),l.type=m,x=l.tag=eI(m),s=Pi(m,s),x){case 0:l=Cp(null,l,m,s,f);break e;case 1:l=jx(null,l,m,s,f);break e;case 11:l=Lx(null,l,m,s,f);break e;case 14:l=Mx(null,l,m,Pi(m.type,s),f);break e}throw Error(r(306,m,""))}return l;case 0:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),Cp(s,l,m,x,f);case 1:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),jx(s,l,m,x,f);case 3:e:{if($x(l),s===null)throw Error(r(387));m=l.pendingProps,S=l.memoizedState,x=S.element,nx(s,l),eh(l,m,null,f);var b=l.memoizedState;if(m=b.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){x=Rl(Error(r(423)),l),l=Hx(s,l,m,f,x);break e}else if(m!==x){x=Rl(Error(r(424)),l),l=Hx(s,l,m,f,x);break e}else for(Xn=ms(l.stateNode.containerInfo.firstChild),qn=l,Xt=!0,Ri=null,f=tx(l,null,m,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Sl(),m===x){l=Da(s,l,f);break e}yn(s,l,m,f)}l=l.child}return l;case 5:return sx(l),s===null&&np(l),m=l.type,x=l.pendingProps,S=s!==null?s.memoizedProps:null,b=x.children,qd(m,x)?b=null:S!==null&&qd(m,S)&&(l.flags|=32),Ux(s,l),yn(s,l,b,f),l.child;case 6:return s===null&&np(l),null;case 13:return zx(s,l,f);case 4:return fp(l,l.stateNode.containerInfo),m=l.pendingProps,s===null?l.child=kl(l,null,m,f):yn(s,l,m,f),l.child;case 11:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),Lx(s,l,m,x,f);case 7:return yn(s,l,l.pendingProps,f),l.child;case 8:return yn(s,l,l.pendingProps.children,f),l.child;case 12:return yn(s,l,l.pendingProps.children,f),l.child;case 10:e:{if(m=l.type._context,x=l.pendingProps,S=l.memoizedProps,b=x.value,Bt(Qf,m._currentValue),m._currentValue=b,S!==null)if(Ii(S.value,b)){if(S.children===x.children&&!bn.current){l=Da(s,l,f);break e}}else for(S=l.child,S!==null&&(S.return=l);S!==null;){var Q=S.dependencies;if(Q!==null){b=S.child;for(var ne=Q.firstContext;ne!==null;){if(ne.context===m){if(S.tag===1){ne=Oa(-1,f&-f),ne.tag=2;var pe=S.updateQueue;if(pe!==null){pe=pe.shared;var Re=pe.pending;Re===null?ne.next=ne:(ne.next=Re.next,Re.next=ne),pe.pending=ne}}S.lanes|=f,ne=S.alternate,ne!==null&&(ne.lanes|=f),lp(S.return,f,l),Q.lanes|=f;break}ne=ne.next}}else if(S.tag===10)b=S.type===l.type?null:S.child;else if(S.tag===18){if(b=S.return,b===null)throw Error(r(341));b.lanes|=f,Q=b.alternate,Q!==null&&(Q.lanes|=f),lp(b,f,l),b=S.sibling}else b=S.child;if(b!==null)b.return=S;else for(b=S;b!==null;){if(b===l){b=null;break}if(S=b.sibling,S!==null){S.return=b.return,b=S;break}b=b.return}S=b}yn(s,l,x.children,f),l=l.child}return l;case 9:return x=l.type,m=l.pendingProps.children,Cl(l,f),x=ci(x),m=m(x),l.flags|=1,yn(s,l,m,f),l.child;case 14:return m=l.type,x=Pi(m,l.pendingProps),x=Pi(m.type,x),Mx(s,l,m,x,f);case 15:return Vx(s,l,l.type,l.pendingProps,f);case 17:return m=l.type,x=l.pendingProps,x=l.elementType===m?x:Pi(m,x),ch(s,l),l.tag=1,On(m)?(s=!0,Wf(l)):s=!1,Cl(l,f),Rx(l,m,x),Sp(l,m,x,f),Ip(null,l,m,!0,s,f);case 19:return Gx(s,l,f);case 22:return Bx(s,l,f)}throw Error(r(156,l.tag))};function g_(s,l){return Pe(s,l)}function ZC(s,l,f,m){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(s,l,f,m){return new ZC(s,l,f,m)}function qp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function eI(s){if(typeof s=="function")return qp(s)?1:0;if(s!=null){if(s=s.$$typeof,s===N)return 11;if(s===we)return 14}return 2}function As(s,l){var f=s.alternate;return f===null?(f=hi(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&14680064,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f}function yh(s,l,f,m,x,S){var b=2;if(m=s,typeof s=="function")qp(s)&&(b=1);else if(typeof s=="string")b=5;else e:switch(s){case A:return Ao(f.children,x,S,l);case P:b=8,x|=8;break;case R:return s=hi(12,f,l,x|2),s.elementType=R,s.lanes=S,s;case B:return s=hi(13,f,l,x),s.elementType=B,s.lanes=S,s;case Oe:return s=hi(19,f,l,x),s.elementType=Oe,s.lanes=S,s;case Ae:return Eh(f,x,S,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case M:b=10;break e;case L:b=9;break e;case N:b=11;break e;case we:b=14;break e;case Ce:b=16,m=null;break e}throw Error(r(130,s==null?s:typeof s,""))}return l=hi(b,f,l,x),l.elementType=s,l.type=m,l.lanes=S,l}function Ao(s,l,f,m){return s=hi(7,s,m,l),s.lanes=f,s}function Eh(s,l,f,m){return s=hi(22,s,m,l),s.elementType=Ae,s.lanes=f,s.stateNode={isHidden:!1},s}function Xp(s,l,f){return s=hi(6,s,null,l),s.lanes=f,s}function Yp(s,l,f){return l=hi(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function tI(s,l,f,m,x){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=os(0),this.expirationTimes=os(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=os(0),this.identifierPrefix=m,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function Qp(s,l,f,m,x,S,b,Q,ne){return s=new tI(s,l,f,Q,ne),l===1?(l=1,S===!0&&(l|=8)):l=0,S=hi(3,null,null,l),s.current=S,S.stateNode=s,S.memoizedState={element:m,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},up(S),s}function rI(s,l,f){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:m==null?null:""+m,children:s,containerInfo:l,implementation:f}}function v_(s){if(!s)return vs;s=s._reactInternals;e:{if(X(s)!==s||s.tag!==1)throw Error(r(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(On(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(r(171))}if(s.tag===1){var f=s.type;if(On(f))return Wv(s,f,l)}return l}function x_(s,l,f,m,x,S,b,Q,ne){return s=Qp(f,m,!0,s,x,S,b,Q,ne),s.context=v_(null),f=s.current,m=En(),x=Ss(f),S=Oa(m,x),S.callback=l??null,ys(f,S,x),s.current.lanes=x,ls(s,x,m),Ln(s,m),s}function wh(s,l,f,m){var x=l.current,S=En(),b=Ss(x);return f=v_(f),l.context===null?l.context=f:l.pendingContext=f,l=Oa(S,b),l.payload={element:s},m=m===void 0?null:m,m!==null&&(l.callback=m),s=ys(x,l,b),s!==null&&(Oi(s,x,b,S),Zf(s,x,b)),b}function Th(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function __(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function Jp(s,l){__(s,l),(s=s.alternate)&&__(s,l)}var y_=typeof reportError=="function"?reportError:function(s){console.error(s)};function Zp(s){this._internalRoot=s}Sh.prototype.render=Zp.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));wh(s,l,null,null)},Sh.prototype.unmount=Zp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;To(function(){wh(null,s,null,null)}),l[Ia]=null}};function Sh(s){this._internalRoot=s}Sh.prototype.unstable_scheduleHydration=function(s){if(s){var l=Sf();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Xi.length&&l!==0&&l<Xi[f].priority;f++);Xi.splice(f,0,s),f===0&&Cf(s)}};function em(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function kh(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function E_(){}function nI(s,l,f,m,x){if(x){if(typeof m=="function"){var S=m;m=function(){var pe=Th(b);S.call(pe)}}var b=x_(l,m,s,0,null,!1,!1,"",E_);return s._reactRootContainer=b,s[Ia]=b.current,Lc(s.nodeType===8?s.parentNode:s),To(),b}for(;x=s.lastChild;)s.removeChild(x);if(typeof m=="function"){var Q=m;m=function(){var pe=Th(ne);Q.call(pe)}}var ne=Qp(s,0,!1,null,null,!1,!1,"",E_);return s._reactRootContainer=ne,s[Ia]=ne.current,Lc(s.nodeType===8?s.parentNode:s),To(function(){wh(l,ne,f,m)}),ne}function Ah(s,l,f,m,x){var S=f._reactRootContainer;if(S){var b=S;if(typeof x=="function"){var Q=x;x=function(){var ne=Th(b);Q.call(ne)}}wh(l,b,s,x)}else b=nI(f,l,s,x,m);return Th(b)}wf=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var f=ss(l.pendingLanes);f!==0&&(cs(l,f|1),Ln(l,Fe()),!(Tt&6)&&(bl=Fe()+500,xs()))}break;case 13:To(function(){var m=ba(s,1);if(m!==null){var x=En();Oi(m,s,1,x)}}),Jp(s,1)}},nl=function(s){if(s.tag===13){var l=ba(s,134217728);if(l!==null){var f=En();Oi(l,s,134217728,f)}Jp(s,134217728)}},Tf=function(s){if(s.tag===13){var l=Ss(s),f=ba(s,l);if(f!==null){var m=En();Oi(f,s,l,m)}Jp(s,l)}},Sf=function(){return gt},kf=function(s,l){var f=gt;try{return gt=s,l()}finally{gt=f}},_a=function(s,l,f){switch(l){case"input":if(Ve(s,f),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var m=f[l];if(m!==s&&m.form===s.form){var x=Hf(m);if(!x)throw Error(r(90));J(m),Ve(m,x)}}}break;case"textarea":hr(s,f);break;case"select":l=f.value,l!=null&&Tr(s,!!f.multiple,l,!1)}},ya=Wp,so=To;var iI={usingClientEntryPoint:!1,Events:[Bc,_l,Hf,ii,ao,Wp]},Zc={findFiberByHostInstance:mo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aI={bundleType:Zc.bundleType,version:Zc.version,rendererPackageName:Zc.rendererPackageName,rendererConfig:Zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:U.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=he(s),s===null?null:s.stateNode},findFiberByHostInstance:Zc.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ch=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ch.isDisabled&&Ch.supportsFiber)try{zn=Ch.inject(aI),sr=Ch}catch{}}return Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iI,Mn.createPortal=function(s,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!em(l))throw Error(r(200));return rI(s,l,null,f)},Mn.createRoot=function(s,l){if(!em(s))throw Error(r(299));var f=!1,m="",x=y_;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onRecoverableError!==void 0&&(x=l.onRecoverableError)),l=Qp(s,1,!1,null,null,f,!1,m,x),s[Ia]=l.current,Lc(s.nodeType===8?s.parentNode:s),new Zp(l)},Mn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=he(l),s=s===null?null:s.stateNode,s},Mn.flushSync=function(s){return To(s)},Mn.hydrate=function(s,l,f){if(!kh(l))throw Error(r(200));return Ah(null,s,l,!0,f)},Mn.hydrateRoot=function(s,l,f){if(!em(s))throw Error(r(405));var m=f!=null&&f.hydratedSources||null,x=!1,S="",b=y_;if(f!=null&&(f.unstable_strictMode===!0&&(x=!0),f.identifierPrefix!==void 0&&(S=f.identifierPrefix),f.onRecoverableError!==void 0&&(b=f.onRecoverableError)),l=x_(l,null,s,1,f??null,x,!1,S,b),s[Ia]=l.current,Lc(s),m)for(s=0;s<m.length;s++)f=m[s],x=f._getVersion,x=x(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,x]:l.mutableSourceEagerHydrationData.push(f,x);return new Sh(l)},Mn.render=function(s,l,f){if(!kh(l))throw Error(r(200));return Ah(null,s,l,!1,f)},Mn.unmountComponentAtNode=function(s){if(!kh(s))throw Error(r(40));return s._reactRootContainer?(To(function(){Ah(null,null,s,!1,function(){s._reactRootContainer=null,s[Ia]=null})}),!0):!1},Mn.unstable_batchedUpdates=Wp,Mn.unstable_renderSubtreeIntoContainer=function(s,l,f,m){if(!kh(f))throw Error(r(200));if(s==null||s._reactInternals===void 0)throw Error(r(38));return Ah(s,l,f,!1,m)},Mn.version="18.3.1-next-f1338f8080-20240426",Mn}var P_;function Ww(){if(P_)return nm.exports;P_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),nm.exports=pI(),nm.exports}var F_;function mI(){if(F_)return Ih;F_=1;var t=Ww();return Ih.createRoot=t.createRoot,Ih.hydrateRoot=t.hydrateRoot,Ih}var gI=mI(),tu={},b_;function vI(){if(b_)return tu;b_=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.parse=o,tu.serialize=h;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,a=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,_){const E=new a,y=v.length;if(y<2)return E;const w=(_==null?void 0:_.decode)||d;let k=0;do{const F=v.indexOf("=",k);if(F===-1)break;const C=v.indexOf(";",k),U=C===-1?y:C;if(F>U){k=v.lastIndexOf(";",F-1)+1;continue}const V=c(v,k,F),z=u(v,F,V),A=v.slice(V,z);if(E[A]===void 0){let P=c(v,F+1,U),R=u(v,U,P);const M=w(v.slice(P,R));E[A]=M}k=U+1}while(k<y);return E}function c(v,_,E){do{const y=v.charCodeAt(_);if(y!==32&&y!==9)return _}while(++_<E);return E}function u(v,_,E){for(;_>E;){const y=v.charCodeAt(--_);if(y!==32&&y!==9)return _+1}return E}function h(v,_,E){const y=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(v))throw new TypeError(`argument name is invalid: ${v}`);const w=y(_);if(!e.test(w))throw new TypeError(`argument val is invalid: ${_}`);let k=v+"="+w;if(!E)return k;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);k+="; Max-Age="+E.maxAge}if(E.domain){if(!r.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);k+="; Domain="+E.domain}if(E.path){if(!n.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);k+="; Path="+E.path}if(E.expires){if(!g(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);k+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(k+="; HttpOnly"),E.secure&&(k+="; Secure"),E.partitioned&&(k+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return k}function d(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function g(v){return i.call(v)==="[object Date]"}return tu}vI();/**
 * react-router v7.1.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var O_="popstate";function xI(t={}){function e(n,i){let{pathname:a,search:o,hash:c}=n.location;return Bm("",{pathname:a,search:o,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Iu(i)}return yI(e,r,null,t)}function Qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ji(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function _I(){return Math.random().toString(36).substring(2,10)}function D_(t,e){return{usr:t.state,key:t.key,idx:e}}function Bm(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?uc(e):e,state:r,key:e&&e.key||n||_I()}}function Iu({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function uc(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function yI(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,c="POP",u=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function g(){c="POP";let w=d(),k=w==null?null:w-h;h=w,u&&u({action:c,location:y.location,delta:k})}function v(w,k){c="PUSH";let F=Bm(y.location,w,k);h=d()+1;let C=D_(F,h),U=y.createHref(F);try{o.pushState(C,"",U)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;i.location.assign(U)}a&&u&&u({action:c,location:y.location,delta:1})}function _(w,k){c="REPLACE";let F=Bm(y.location,w,k);h=d();let C=D_(F,h),U=y.createHref(F);o.replaceState(C,"",U),a&&u&&u({action:c,location:y.location,delta:0})}function E(w){let k=i.location.origin!=="null"?i.location.origin:i.location.href,F=typeof w=="string"?w:Iu(w);return F=F.replace(/ $/,"%20"),Qt(k,`No window.location.(origin|href) available to create URL for href: ${F}`),new URL(F,k)}let y={get action(){return c},get location(){return t(i,o)},listen(w){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(O_,g),u=w,()=>{i.removeEventListener(O_,g),u=null}},createHref(w){return e(i,w)},createURL:E,encodeLocation(w){let k=E(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:v,replace:_,go(w){return o.go(w)}};return y}function Gw(t,e,r="/"){return EI(t,e,r,!1)}function EI(t,e,r,n){let i=typeof e=="string"?uc(e):e,a=zs(i.pathname||"/",r);if(a==null)return null;let o=Kw(t);wI(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let h=OI(a);c=FI(o[u],h,n)}return c}function Kw(t,e=[],r=[],n=""){let i=(a,o,c)=>{let u={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(Qt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let h=ja([n,u.relativePath]),d=r.concat(u);a.children&&a.children.length>0&&(Qt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Kw(a.children,e,d,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:RI(h,a.index),routesMeta:d})};return t.forEach((a,o)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,o);else for(let u of qw(a.path))i(a,o,u)}),e}function qw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=qw(n.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function wI(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:PI(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var TI=/^:[\w-]+$/,SI=3,kI=2,AI=1,CI=10,II=-2,N_=t=>t==="*";function RI(t,e){let r=t.split("/"),n=r.length;return r.some(N_)&&(n+=II),e&&(n+=kI),r.filter(i=>!N_(i)).reduce((i,a)=>i+(TI.test(a)?SI:a===""?AI:CI),n)}function PI(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function FI(t,e,r=!1){let{routesMeta:n}=t,i={},a="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],h=c===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",g=h0({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),v=u.route;if(!g&&h&&r&&!n[n.length-1].route.index&&(g=h0({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},d)),!g)return null;Object.assign(i,g.params),o.push({params:i,pathname:ja([a,g.pathname]),pathnameBase:MI(ja([a,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(a=ja([a,g.pathnameBase]))}return o}function h0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=bI(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((h,{paramName:d,isOptional:g},v)=>{if(d==="*"){let E=c[v]||"";o=a.slice(0,a.length-E.length).replace(/(.)\/+$/,"$1")}const _=c[v];return g&&!_?h[d]=void 0:h[d]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:o,pattern:t}}function bI(t,e=!1,r=!0){ji(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function OI(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ji(!1,`The URL path "${t}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function zs(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function DI(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?uc(t):t;return{pathname:r?r.startsWith("/")?r:NI(r,e):e,search:VI(n),hash:BI(i)}}function NI(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function sm(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function LI(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Fg(t){let e=LI(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function bg(t,e,r,n=!1){let i;typeof t=="string"?i=uc(t):(i={...t},Qt(!i.pathname||!i.pathname.includes("?"),sm("?","pathname","search",i)),Qt(!i.pathname||!i.pathname.includes("#"),sm("#","pathname","hash",i)),Qt(!i.search||!i.search.includes("#"),sm("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=r;else{let g=e.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),g-=1;i.pathname=v.join("/")}c=g>=0?e[g]:"/"}let u=DI(i,c),h=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||d)&&(u.pathname+="/"),u}var ja=t=>t.join("/").replace(/\/\/+/g,"/"),MI=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VI=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,BI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Xw=["POST","PUT","PATCH","DELETE"];new Set(Xw);var jI=["GET",...Xw];new Set(jI);var fc=G.createContext(null);fc.displayName="DataRouter";var Q0=G.createContext(null);Q0.displayName="DataRouterState";var Yw=G.createContext({isTransitioning:!1});Yw.displayName="ViewTransition";var $I=G.createContext(new Map);$I.displayName="Fetchers";var HI=G.createContext(null);HI.displayName="Await";var Hi=G.createContext(null);Hi.displayName="Navigation";var qu=G.createContext(null);qu.displayName="Location";var zi=G.createContext({outlet:null,matches:[],isDataRoute:!1});zi.displayName="Route";var Og=G.createContext(null);Og.displayName="RouteError";function zI(t,{relative:e}={}){Qt(hc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=G.useContext(Hi),{hash:i,pathname:a,search:o}=Xu(t,{relative:e}),c=a;return r!=="/"&&(c=a==="/"?r:ja([r,a])),n.createHref({pathname:c,search:o,hash:i})}function hc(){return G.useContext(qu)!=null}function ma(){return Qt(hc(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(qu).location}var Qw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Jw(t){G.useContext(Hi).static||G.useLayoutEffect(t)}function Dg(){let{isDataRoute:t}=G.useContext(zi);return t?iR():WI()}function WI(){Qt(hc(),"useNavigate() may be used only in the context of a <Router> component.");let t=G.useContext(fc),{basename:e,navigator:r}=G.useContext(Hi),{matches:n}=G.useContext(zi),{pathname:i}=ma(),a=JSON.stringify(Fg(n)),o=G.useRef(!1);return Jw(()=>{o.current=!0}),G.useCallback((u,h={})=>{if(ji(o.current,Qw),!o.current)return;if(typeof u=="number"){r.go(u);return}let d=bg(u,JSON.parse(a),i,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ja([e,d.pathname])),(h.replace?r.replace:r.push)(d,h.state,h)},[e,r,a,i,t])}G.createContext(null);function GI(){let{matches:t}=G.useContext(zi),e=t[t.length-1];return e?e.params:{}}function Xu(t,{relative:e}={}){let{matches:r}=G.useContext(zi),{pathname:n}=ma(),i=JSON.stringify(Fg(r));return G.useMemo(()=>bg(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function KI(t,e){return Zw(t,e)}function Zw(t,e,r,n){var k;Qt(hc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=G.useContext(Hi),{matches:a}=G.useContext(zi),o=a[a.length-1],c=o?o.params:{},u=o?o.pathname:"/",h=o?o.pathnameBase:"/",d=o&&o.route;{let F=d&&d.path||"";eT(u,!d||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let g=ma(),v;if(e){let F=typeof e=="string"?uc(e):e;Qt(h==="/"||((k=F.pathname)==null?void 0:k.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${F.pathname}" was given in the \`location\` prop.`),v=F}else v=g;let _=v.pathname||"/",E=_;if(h!=="/"){let F=h.replace(/^\//,"").split("/");E="/"+_.replace(/^\//,"").split("/").slice(F.length).join("/")}let y=Gw(t,{pathname:E});ji(d||y!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ji(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=JI(y&&y.map(F=>Object.assign({},F,{params:Object.assign({},c,F.params),pathname:ja([h,i.encodeLocation?i.encodeLocation(F.pathname).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?h:ja([h,i.encodeLocation?i.encodeLocation(F.pathnameBase).pathname:F.pathnameBase])})),a,r,n);return e&&w?G.createElement(qu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},w):w}function qI(){let t=nR(),e=UI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=G.createElement(G.Fragment,null,G.createElement("p",null," Hey developer "),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:a},"ErrorBoundary")," or"," ",G.createElement("code",{style:a},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),r?G.createElement("pre",{style:i},r):null,o)}var XI=G.createElement(qI,null),YI=class extends G.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?G.createElement(zi.Provider,{value:this.props.routeContext},G.createElement(Og.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function QI({routeContext:t,match:e,children:r}){let n=G.useContext(fc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),G.createElement(zi.Provider,{value:t},r)}function JI(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,a=r==null?void 0:r.errors;if(a!=null){let u=i.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);Qt(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let o=!1,c=-1;if(r)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:g}=r,v=h.route.loader&&!d.hasOwnProperty(h.route.id)&&(!g||g[h.route.id]===void 0);if(h.route.lazy||v){o=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,h,d)=>{let g,v=!1,_=null,E=null;r&&(g=a&&h.route.id?a[h.route.id]:void 0,_=h.route.errorElement||XI,o&&(c<0&&d===0?(eT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,E=null):c===d&&(v=!0,E=h.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,d+1)),w=()=>{let k;return g?k=_:v?k=E:h.route.Component?k=G.createElement(h.route.Component,null):h.route.element?k=h.route.element:k=u,G.createElement(QI,{match:h,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:k})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?G.createElement(YI,{location:r.location,revalidation:r.revalidation,component:_,error:g,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}function Ng(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZI(t){let e=G.useContext(fc);return Qt(e,Ng(t)),e}function eR(t){let e=G.useContext(Q0);return Qt(e,Ng(t)),e}function tR(t){let e=G.useContext(zi);return Qt(e,Ng(t)),e}function Lg(t){let e=tR(t),r=e.matches[e.matches.length-1];return Qt(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function rR(){return Lg("useRouteId")}function nR(){var n;let t=G.useContext(Og),e=eR("useRouteError"),r=Lg("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function iR(){let{router:t}=ZI("useNavigate"),e=Lg("useNavigate"),r=G.useRef(!1);return Jw(()=>{r.current=!0}),G.useCallback(async(i,a={})=>{ji(r.current,Qw),r.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...a}))},[t,e])}var L_={};function eT(t,e,r){!e&&!L_[t]&&(L_[t]=!0,ji(!1,r))}G.memo(aR);function aR({routes:t,future:e,state:r}){return Zw(t,void 0,r,e)}function tT({to:t,replace:e,state:r,relative:n}){Qt(hc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=G.useContext(Hi);ji(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=G.useContext(zi),{pathname:o}=ma(),c=Dg(),u=bg(t,Fg(a),o,n==="path"),h=JSON.stringify(u);return G.useEffect(()=>{c(JSON.parse(h),{replace:e,state:r,relative:n})},[c,h,n,e,r]),null}function Mr(t){Qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function sR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:a=!1}){Qt(!hc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),c=G.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof r=="string"&&(r=uc(r));let{pathname:u="/",search:h="",hash:d="",state:g=null,key:v="default"}=r,_=G.useMemo(()=>{let E=zs(u,o);return E==null?null:{location:{pathname:E,search:h,hash:d,state:g,key:v},navigationType:n}},[o,u,h,d,g,v,n]);return ji(_!=null,`<Router basename="${o}"> is not able to match the URL "${u}${h}${d}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:G.createElement(Hi.Provider,{value:c},G.createElement(qu.Provider,{children:e,value:_}))}function oR({children:t,location:e}){return KI(Um(t),e)}function Um(t,e=[]){let r=[];return G.Children.forEach(t,(n,i)=>{if(!G.isValidElement(n))return;let a=[...e,i];if(n.type===G.Fragment){r.push.apply(r,Um(n.props.children,a));return}Qt(n.type===Mr,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Um(n.props.children,a)),r.push(o)}),r}var Yh="get",Qh="application/x-www-form-urlencoded";function J0(t){return t!=null&&typeof t.tagName=="string"}function lR(t){return J0(t)&&t.tagName.toLowerCase()==="button"}function cR(t){return J0(t)&&t.tagName.toLowerCase()==="form"}function uR(t){return J0(t)&&t.tagName.toLowerCase()==="input"}function fR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hR(t,e){return t.button===0&&(!e||e==="_self")&&!fR(t)}var Rh=null;function dR(){if(Rh===null)try{new FormData(document.createElement("form"),0),Rh=!1}catch{Rh=!0}return Rh}var pR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function om(t){return t!=null&&!pR.has(t)?(ji(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qh}"`),null):t}function mR(t,e){let r,n,i,a,o;if(cR(t)){let c=t.getAttribute("action");n=c?zs(c,e):null,r=t.getAttribute("method")||Yh,i=om(t.getAttribute("enctype"))||Qh,a=new FormData(t)}else if(lR(t)||uR(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||c.getAttribute("action");if(n=u?zs(u,e):null,r=t.getAttribute("formmethod")||c.getAttribute("method")||Yh,i=om(t.getAttribute("formenctype"))||om(c.getAttribute("enctype"))||Qh,a=new FormData(c,t),!dR()){let{name:h,type:d,value:g}=t;if(d==="image"){let v=h?`${h}.`:"";a.append(`${v}x`,"0"),a.append(`${v}y`,"0")}else h&&a.append(h,g)}}else{if(J0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Yh,n=null,i=Qh,o=t}return a&&i==="text/plain"&&(o=a,a=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:a,body:o}}function Mg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function gR(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function xR(t,e,r){let n=await Promise.all(t.map(async i=>{let a=e.routes[i.route.id];if(a){let o=await gR(a,r);return o.links?o.links():[]}return[]}));return wR(n.flat(1).filter(vR).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function M_(t,e,r,n,i,a){let o=(u,h)=>r[h]?u.route.id!==r[h].route.id:!0,c=(u,h)=>{var d;return r[h].pathname!==u.pathname||((d=r[h].route.path)==null?void 0:d.endsWith("*"))&&r[h].params["*"]!==u.params["*"]};return a==="assets"?e.filter((u,h)=>o(u,h)||c(u,h)):a==="data"?e.filter((u,h)=>{var g;let d=n.routes[u.route.id];if(!d||!d.hasLoader)return!1;if(o(u,h)||c(u,h))return!0;if(u.route.shouldRevalidate){let v=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function _R(t,e){return yR(t.map(r=>{let n=e.routes[r.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function yR(t){return[...new Set(t)]}function ER(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function wR(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let a=JSON.stringify(ER(i));return r.has(a)||(r.add(a),n.push({key:a,link:i})),n},[])}function TR(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function SR(){let t=G.useContext(fc);return Mg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function kR(){let t=G.useContext(Q0);return Mg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Vg=G.createContext(void 0);Vg.displayName="FrameworkContext";function rT(){let t=G.useContext(Vg);return Mg(t,"You must render this element inside a <HydratedRouter> element"),t}function AR(t,e){let r=G.useContext(Vg),[n,i]=G.useState(!1),[a,o]=G.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:h,onMouseLeave:d,onTouchStart:g}=e,v=G.useRef(null);G.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let y=k=>{k.forEach(F=>{o(F.isIntersecting)})},w=new IntersectionObserver(y,{threshold:.5});return v.current&&w.observe(v.current),()=>{w.disconnect()}}},[t]),G.useEffect(()=>{if(n){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[n]);let _=()=>{i(!0)},E=()=>{i(!1),o(!1)};return r?t!=="intent"?[a,v,{}]:[a,v,{onFocus:ru(c,_),onBlur:ru(u,E),onMouseEnter:ru(h,_),onMouseLeave:ru(d,E),onTouchStart:ru(g,_)}]:[!1,v,{}]}function ru(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function CR({page:t,...e}){let{router:r}=SR(),n=G.useMemo(()=>Gw(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?G.createElement(RR,{page:t,matches:n,...e}):null}function IR(t){let{manifest:e,routeModules:r}=rT(),[n,i]=G.useState([]);return G.useEffect(()=>{let a=!1;return xR(t,e,r).then(o=>{a||i(o)}),()=>{a=!0}},[t,e,r]),n}function RR({page:t,matches:e,...r}){let n=ma(),{manifest:i,routeModules:a}=rT(),{loaderData:o,matches:c}=kR(),u=G.useMemo(()=>M_(t,e,c,i,n,"data"),[t,e,c,i,n]),h=G.useMemo(()=>M_(t,e,c,i,n,"assets"),[t,e,c,i,n]),d=G.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let _=new Set,E=!1;if(e.forEach(w=>{var F;let k=i.routes[w.route.id];!k||!k.hasLoader||(!u.some(C=>C.route.id===w.route.id)&&w.route.id in o&&((F=a[w.route.id])!=null&&F.shouldRevalidate)||k.hasClientLoader?E=!0:_.add(w.route.id))}),_.size===0)return[];let y=TR(t);return E&&_.size>0&&y.searchParams.set("_routes",e.filter(w=>_.has(w.route.id)).map(w=>w.route.id).join(",")),[y.pathname+y.search]},[o,n,i,u,e,t,a]),g=G.useMemo(()=>_R(h,i),[h,i]),v=IR(h);return G.createElement(G.Fragment,null,d.map(_=>G.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...r})),g.map(_=>G.createElement("link",{key:_,rel:"modulepreload",href:_,...r})),v.map(({key:_,link:E})=>G.createElement("link",{key:_,...E})))}function PR(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var nT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nT&&(window.__reactRouterVersion="7.1.1")}catch{}function FR({basename:t,children:e,window:r}){let n=G.useRef();n.current==null&&(n.current=xI({window:r,v5Compat:!0}));let i=n.current,[a,o]=G.useState({action:i.action,location:i.location}),c=G.useCallback(u=>{G.startTransition(()=>o(u))},[o]);return G.useLayoutEffect(()=>i.listen(c),[i,c]),G.createElement(sR,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:i})}var iT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ho=G.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:a,replace:o,state:c,target:u,to:h,preventScrollReset:d,viewTransition:g,...v},_){let{basename:E}=G.useContext(Hi),y=typeof h=="string"&&iT.test(h),w,k=!1;if(typeof h=="string"&&y&&(w=h,nT))try{let R=new URL(window.location.href),M=h.startsWith("//")?new URL(R.protocol+h):new URL(h),L=zs(M.pathname,E);M.origin===R.origin&&L!=null?h=L+M.search+M.hash:k=!0}catch{ji(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let F=zI(h,{relative:i}),[C,U,V]=AR(n,v),z=NR(h,{replace:o,state:c,target:u,preventScrollReset:d,relative:i,viewTransition:g});function A(R){e&&e(R),R.defaultPrevented||z(R)}let P=G.createElement("a",{...v,...V,href:w||F,onClick:k||a?e:A,ref:PR(_,U),target:u,"data-discover":!y&&r==="render"?"true":void 0});return C&&!y?G.createElement(G.Fragment,null,P,G.createElement(CR,{page:F})):P});Ho.displayName="Link";var bR=G.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:a,to:o,viewTransition:c,children:u,...h},d){let g=Xu(o,{relative:h.relative}),v=ma(),_=G.useContext(Q0),{navigator:E,basename:y}=G.useContext(Hi),w=_!=null&&UR(g)&&c===!0,k=E.encodeLocation?E.encodeLocation(g).pathname:g.pathname,F=v.pathname,C=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(F=F.toLowerCase(),C=C?C.toLowerCase():null,k=k.toLowerCase()),C&&y&&(C=zs(C,y)||C);const U=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let V=F===k||!i&&F.startsWith(k)&&F.charAt(U)==="/",z=C!=null&&(C===k||!i&&C.startsWith(k)&&C.charAt(k.length)==="/"),A={isActive:V,isPending:z,isTransitioning:w},P=V?e:void 0,R;typeof n=="function"?R=n(A):R=[n,V?"active":null,z?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let M=typeof a=="function"?a(A):a;return G.createElement(Ho,{...h,"aria-current":P,className:R,ref:d,style:M,to:o,viewTransition:c},typeof u=="function"?u(A):u)});bR.displayName="NavLink";var OR=G.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:a,method:o=Yh,action:c,onSubmit:u,relative:h,preventScrollReset:d,viewTransition:g,...v},_)=>{let E=VR(),y=BR(c,{relative:h}),w=o.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&iT.test(c),F=C=>{if(u&&u(C),C.defaultPrevented)return;C.preventDefault();let U=C.nativeEvent.submitter,V=(U==null?void 0:U.getAttribute("formmethod"))||o;E(U||C.currentTarget,{fetcherKey:e,method:V,navigate:r,replace:i,state:a,relative:h,preventScrollReset:d,viewTransition:g})};return G.createElement("form",{ref:_,method:w,action:y,onSubmit:n?u:F,...v,"data-discover":!k&&t==="render"?"true":void 0})});OR.displayName="Form";function DR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aT(t){let e=G.useContext(fc);return Qt(e,DR(t)),e}function NR(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:a,viewTransition:o}={}){let c=Dg(),u=ma(),h=Xu(t,{relative:a});return G.useCallback(d=>{if(hR(d,e)){d.preventDefault();let g=r!==void 0?r:Iu(u)===Iu(h);c(t,{replace:g,state:n,preventScrollReset:i,relative:a,viewTransition:o})}},[u,c,h,r,n,e,t,i,a,o])}var LR=0,MR=()=>`__${String(++LR)}__`;function VR(){let{router:t}=aT("useSubmit"),{basename:e}=G.useContext(Hi),r=rR();return G.useCallback(async(n,i={})=>{let{action:a,method:o,encType:c,formData:u,body:h}=mR(n,e);if(i.navigate===!1){let d=i.fetcherKey||MR();await t.fetch(d,r,i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:h,formMethod:i.method||o,formEncType:i.encType||c,flushSync:i.flushSync})}else await t.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:u,body:h,formMethod:i.method||o,formEncType:i.encType||c,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,r])}function BR(t,{relative:e}={}){let{basename:r}=G.useContext(Hi),n=G.useContext(zi);Qt(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...Xu(t||".",{relative:e})},o=ma();if(t==null){a.search=o.search;let c=new URLSearchParams(a.search),u=c.getAll("index");if(u.some(d=>d==="")){c.delete("index"),u.filter(g=>g).forEach(g=>c.append("index",g));let d=c.toString();a.search=d?`?${d}`:""}}return(!t||t===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(a.pathname=a.pathname==="/"?r:ja([r,a.pathname])),Iu(a)}function UR(t,e={}){let r=G.useContext(Yw);Qt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=aT("useViewTransitionState"),i=Xu(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=zs(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=zs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return h0(i.pathname,o)!=null||h0(i.pathname,a)!=null}new TextEncoder;var jR=Ww();const $R="modulepreload",HR=function(t){return"/learntrackcenter/"+t},V_={},Wi=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(u=>{if(u=HR(u),u in V_)return;V_[u]=!0;const h=u.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":$R,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((v,_)=>{g.addEventListener("load",v),g.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var B_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},zR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],c=t[r++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},oT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,d=a>>2,g=(a&3)<<4|c>>4;let v=(c&15)<<2|h>>6,_=h&63;u||(_=64,o||(v=64)),n.push(r[d],r[g],r[v],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(sT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const g=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||c==null||h==null||g==null)throw new WR;const v=a<<2|c>>4;if(n.push(v),h!==64){const _=c<<4&240|h>>2;if(n.push(_),g!==64){const E=h<<6&192|g;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GR=function(t){const e=sT(t);return oT.encodeByteArray(e,!0)},d0=function(t){return GR(t).replace(/\./g,"")},lT=function(t){try{return oT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=()=>KR().__FIREBASE_DEFAULTS__,XR=()=>{if(typeof process>"u"||typeof B_>"u")return;const t=B_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&lT(t[1]);return e&&JSON.parse(e)},Z0=()=>{try{return qR()||XR()||YR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cT=t=>{var e,r;return(r=(e=Z0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},QR=t=>{const e=cT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},uT=()=>{var t;return(t=Z0())===null||t===void 0?void 0:t.config},fT=t=>{var e;return(e=Z0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[d0(JSON.stringify(r)),d0(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function e4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dn())}function t4(){var t;const e=(t=Z0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function r4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function n4(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function i4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function a4(){const t=dn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function s4(){return!t4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function o4(){try{return typeof indexedDB=="object"}catch{return!1}}function l4(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4="FirebaseError";class Ja extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=c4,Object.setPrototypeOf(this,Ja.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yu.prototype.create)}}class Yu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?u4(a,n):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Ja(i,c,n)}}function u4(t,e){return t.replace(f4,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const f4=/\{\$([^}]+)}/g;function h4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Yl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(U_(a)&&U_(o)){if(!Yl(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function U_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function d4(t,e){const r=new p4(t,e);return r.subscribe.bind(r)}class p4{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");m4(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=lm),i.error===void 0&&(i.error=lm),i.complete===void 0&&(i.complete=lm);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function m4(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function lm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t){return t&&t._delegate?t._delegate:t}class No{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new JR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(x4(e))try{this.getOrInitializeService({instanceIdentifier:Co})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Co){return this.instances.has(e)}getOptions(e=Co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&o.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:v4(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Co){return this.component?this.component.multipleInstances?e:Co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v4(t){return t===Co?void 0:t}function x4(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new g4(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pt||(pt={}));const y4={debug:pt.DEBUG,verbose:pt.VERBOSE,info:pt.INFO,warn:pt.WARN,error:pt.ERROR,silent:pt.SILENT},E4=pt.INFO,w4={[pt.DEBUG]:"log",[pt.VERBOSE]:"log",[pt.INFO]:"info",[pt.WARN]:"warn",[pt.ERROR]:"error"},T4=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=w4[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bg{constructor(e){this.name=e,this._logLevel=E4,this._logHandler=T4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?y4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pt.DEBUG,...e),this._logHandler(this,pt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pt.VERBOSE,...e),this._logHandler(this,pt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pt.INFO,...e),this._logHandler(this,pt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pt.WARN,...e),this._logHandler(this,pt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pt.ERROR,...e),this._logHandler(this,pt.ERROR,...e)}}const S4=(t,e)=>e.some(r=>t instanceof r);let j_,$_;function k4(){return j_||(j_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function A4(){return $_||($_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hT=new WeakMap,jm=new WeakMap,dT=new WeakMap,cm=new WeakMap,Ug=new WeakMap;function C4(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(Vs(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&hT.set(r,t)}).catch(()=>{}),Ug.set(e,t),e}function I4(t){if(jm.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});jm.set(t,e)}let $m={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return jm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||dT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Vs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function R4(t){$m=t($m)}function P4(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(um(this),e,...r);return dT.set(n,e.sort?e.sort():[e]),Vs(n)}:A4().includes(t)?function(...e){return t.apply(um(this),e),Vs(hT.get(this))}:function(...e){return Vs(t.apply(um(this),e))}}function F4(t){return typeof t=="function"?P4(t):(t instanceof IDBTransaction&&I4(t),S4(t,k4())?new Proxy(t,$m):t)}function Vs(t){if(t instanceof IDBRequest)return C4(t);if(cm.has(t))return cm.get(t);const e=F4(t);return e!==t&&(cm.set(t,e),Ug.set(e,t)),e}const um=t=>Ug.get(t);function b4(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=Vs(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Vs(o.result),u.oldVersion,u.newVersion,Vs(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const O4=["get","getKey","getAll","getAllKeys","count"],D4=["put","add","delete","clear"],fm=new Map;function H_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fm.get(e))return fm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=D4.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||O4.includes(r)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return fm.set(e,a),a}R4(t=>({...t,get:(e,r,n)=>H_(e,r)||t.get(e,r,n),has:(e,r)=>!!H_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(L4(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function L4(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hm="@firebase/app",z_="0.10.17";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new Bg("@firebase/app"),M4="@firebase/app-compat",V4="@firebase/analytics-compat",B4="@firebase/analytics",U4="@firebase/app-check-compat",j4="@firebase/app-check",$4="@firebase/auth",H4="@firebase/auth-compat",z4="@firebase/database",W4="@firebase/data-connect",G4="@firebase/database-compat",K4="@firebase/functions",q4="@firebase/functions-compat",X4="@firebase/installations",Y4="@firebase/installations-compat",Q4="@firebase/messaging",J4="@firebase/messaging-compat",Z4="@firebase/performance",eP="@firebase/performance-compat",tP="@firebase/remote-config",rP="@firebase/remote-config-compat",nP="@firebase/storage",iP="@firebase/storage-compat",aP="@firebase/firestore",sP="@firebase/vertexai",oP="@firebase/firestore-compat",lP="firebase",cP="11.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm="[DEFAULT]",uP={[Hm]:"fire-core",[M4]:"fire-core-compat",[B4]:"fire-analytics",[V4]:"fire-analytics-compat",[j4]:"fire-app-check",[U4]:"fire-app-check-compat",[$4]:"fire-auth",[H4]:"fire-auth-compat",[z4]:"fire-rtdb",[W4]:"fire-data-connect",[G4]:"fire-rtdb-compat",[K4]:"fire-fn",[q4]:"fire-fn-compat",[X4]:"fire-iid",[Y4]:"fire-iid-compat",[Q4]:"fire-fcm",[J4]:"fire-fcm-compat",[Z4]:"fire-perf",[eP]:"fire-perf-compat",[tP]:"fire-rc",[rP]:"fire-rc-compat",[nP]:"fire-gcs",[iP]:"fire-gcs-compat",[aP]:"fire-fst",[oP]:"fire-fst-compat",[sP]:"fire-vertex","fire-js":"fire-js",[lP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0=new Map,fP=new Map,Wm=new Map;function W_(t,e){try{t.container.addComponent(e)}catch(r){Ga.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ql(t){const e=t.name;if(Wm.has(e))return Ga.debug(`There were multiple attempts to register component ${e}.`),!1;Wm.set(e,t);for(const r of p0.values())W_(r,t);for(const r of fP.values())W_(r,t);return!0}function jg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bs=new Yu("app","Firebase",hP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new No("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=cP;function pT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:zm,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Bs.create("bad-app-name",{appName:String(i)});if(r||(r=uT()),!r)throw Bs.create("no-options");const a=p0.get(i);if(a){if(Yl(r,a.options)&&Yl(n,a.config))return a;throw Bs.create("duplicate-app",{appName:i})}const o=new _4(i);for(const u of Wm.values())o.addComponent(u);const c=new dP(r,n,o);return p0.set(i,c),c}function mT(t=zm){const e=p0.get(t);if(!e&&t===zm&&uT())return pT();if(!e)throw Bs.create("no-app",{appName:t});return e}function Us(t,e,r){var n;let i=(n=uP[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ga.warn(c.join(" "));return}Ql(new No(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP="firebase-heartbeat-database",mP=1,Ru="firebase-heartbeat-store";let hm=null;function gT(){return hm||(hm=b4(pP,mP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ru)}catch(r){console.warn(r)}}}}).catch(t=>{throw Bs.create("idb-open",{originalErrorMessage:t.message})})),hm}async function gP(t){try{const r=(await gT()).transaction(Ru),n=await r.objectStore(Ru).get(vT(t));return await r.done,n}catch(e){if(e instanceof Ja)Ga.warn(e.message);else{const r=Bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ga.warn(r.message)}}}async function G_(t,e){try{const n=(await gT()).transaction(Ru,"readwrite");await n.objectStore(Ru).put(e,vT(t)),await n.done}catch(r){if(r instanceof Ja)Ga.warn(r.message);else{const n=Bs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Ga.warn(n.message)}}}function vT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP=1024,xP=30*24*60*60*1e3;class _P{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new EP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=K_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=xP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Ga.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=K_(),{heartbeatsToSend:n,unsentEntries:i}=yP(this._heartbeatsCache.heartbeats),a=d0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return Ga.warn(r),""}}}function K_(){return new Date().toISOString().substring(0,10)}function yP(t,e=vP){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),q_(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),q_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class EP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return o4()?l4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await gP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return G_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function q_(t){return d0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wP(t){Ql(new No("platform-logger",e=>new N4(e),"PRIVATE")),Ql(new No("heartbeat",e=>new _P(e),"PRIVATE")),Us(Hm,z_,t),Us(Hm,z_,"esm2017"),Us("fire-js","")}wP("");function $g(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function xT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TP=xT,_T=new Yu("auth","Firebase",xT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=new Bg("@firebase/auth");function SP(t,...e){m0.logLevel<=pt.WARN&&m0.warn(`Auth (${dc}): ${t}`,...e)}function Jh(t,...e){m0.logLevel<=pt.ERROR&&m0.error(`Auth (${dc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t,...e){throw zg(t,...e)}function Bi(t,...e){return zg(t,...e)}function Hg(t,e,r){const n=Object.assign(Object.assign({},TP()),{[e]:r});return new Yu("auth","Firebase",n).create(e,{appName:t.name})}function js(t){return Hg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kP(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ha(t,"argument-error"),Hg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function zg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _T.create(t,...e)}function at(t,e,...r){if(!t)throw zg(e,...r)}function Ma(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Jh(e),new Error(e)}function Ka(t,e){t||Ma(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gm(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function AP(){return X_()==="http:"||X_()==="https:"}function X_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AP()||n4()||"connection"in navigator)?navigator.onLine:!0}function IP(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ka(r>e,"Short delay should be less than long delay!"),this.isMobile=e4()||i4()}get(){return CP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(t,e){Ka(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ma("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ma("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ma("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP=new Ju(3e4,6e4);function Zu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zo(t,e,r,n,i={}){return ET(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const c=Qu(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},a);return r4()||(h.referrerPolicy="no-referrer"),yT.fetch()(TT(t,t.config.apiHost,r,c),h)})}async function ET(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},RP),e);try{const i=new bP(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw Ph(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ph(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Ph(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Ph(t,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw Hg(t,d,h);ha(t,d)}}catch(i){if(i instanceof Ja)throw i;ha(t,"network-request-failed",{message:String(i)})}}async function wT(t,e,r,n,i={}){const a=await zo(t,e,r,n,i);return"mfaPendingCredential"in a&&ha(t,"multi-factor-auth-required",{_serverResponse:a}),a}function TT(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Wg(t.config,i):`${t.config.apiScheme}://${i}`}function FP(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class bP{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Bi(this.auth,"network-request-failed")),PP.get())})}}function Ph(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Bi(t,e,n);return i.customData._tokenResponse=r,i}function Y_(t){return t!==void 0&&t.enterprise!==void 0}class OP{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return FP(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function DP(t,e){return zo(t,"GET","/v2/recaptchaConfig",Zu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(t,e){return zo(t,"POST","/v1/accounts:delete",e)}async function ST(t,e){return zo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LP(t,e=!1){const r=br(t),n=await r.getIdToken(e),i=Gg(n);at(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a==null?void 0:a.sign_in_provider;return{claims:i,token:n,authTime:pu(dm(i.auth_time)),issuedAtTime:pu(dm(i.iat)),expirationTime:pu(dm(i.exp)),signInProvider:o||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function dm(t){return Number(t)*1e3}function Gg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Jh("JWT malformed, contained fewer than 3 sections"),null;try{const i=lT(r);return i?JSON.parse(i):(Jh("Failed to decode base64 JWT payload"),null)}catch(i){return Jh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Q_(t){const e=Gg(t);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ja&&MP(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function MP({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=pu(this.lastLoginAt),this.creationTime=pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Pu(t,ST(r,{idToken:n}));at(i==null?void 0:i.users.length,r,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?kT(a.providerUserInfo):[],c=UP(t.providerData,o),u=t.isAnonymous,h=!(t.email&&a.passwordHash)&&!(c!=null&&c.length),d=u?h:!1,g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Km(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,g)}async function BP(t){const e=br(t);await g0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UP(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function kT(t){return t.map(e=>{var{providerId:r}=e,n=$g(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jP(t,e){const r=await ET(t,{},async()=>{const n=Qu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=TT(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",yT.fetch()(o,{method:"POST",headers:c,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function $P(t,e){return zo(t,"POST","/v2/accounts:revokeToken",Zu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){at(e.length!==0,"internal-error");const r=Q_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await jP(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new $l;return n&&(at(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(at(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(at(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(t,e){at(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Va{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,a=$g(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Km(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Pu(this,this.stsTokenManager.getToken(this.auth,e));return at(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return LP(this,e)}reload(){return BP(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Va(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await g0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oa(this.auth.app))return Promise.reject(js(this.auth));const e=await this.getIdToken();return await Pu(this,NP(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,a,o,c,u,h,d;const g=(n=r.displayName)!==null&&n!==void 0?n:void 0,v=(i=r.email)!==null&&i!==void 0?i:void 0,_=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,E=(o=r.photoURL)!==null&&o!==void 0?o:void 0,y=(c=r.tenantId)!==null&&c!==void 0?c:void 0,w=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,k=(h=r.createdAt)!==null&&h!==void 0?h:void 0,F=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:U,isAnonymous:V,providerData:z,stsTokenManager:A}=r;at(C&&A,e,"internal-error");const P=$l.fromJSON(this.name,A);at(typeof C=="string",e,"internal-error"),Is(g,e.name),Is(v,e.name),at(typeof U=="boolean",e,"internal-error"),at(typeof V=="boolean",e,"internal-error"),Is(_,e.name),Is(E,e.name),Is(y,e.name),Is(w,e.name),Is(k,e.name),Is(F,e.name);const R=new Va({uid:C,auth:e,email:v,emailVerified:U,displayName:g,isAnonymous:V,photoURL:E,phoneNumber:_,tenantId:y,stsTokenManager:P,createdAt:k,lastLoginAt:F});return z&&Array.isArray(z)&&(R.providerData=z.map(M=>Object.assign({},M))),w&&(R._redirectEventId=w),R}static async _fromIdTokenResponse(e,r,n=!1){const i=new $l;i.updateFromServerResponse(r);const a=new Va({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await g0(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];at(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?kT(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(a!=null&&a.length),c=new $l;c.updateFromIdToken(n);const u=new Va({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Km(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(a!=null&&a.length)};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_=new Map;function Ba(t){Ka(t instanceof Function,"Expected a class definition");let e=J_.get(t);return e?(Ka(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,J_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}AT.type="NONE";const Z_=AT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(t,e,r){return`firebase:${t}:${e}:${r}`}class Hl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Zh(this.userKey,i.apiKey,a),this.fullPersistenceKey=Zh("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Va._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Hl(Ba(Z_),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||Ba(Z_);const o=Zh(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){const g=Va._fromJSON(e,d);h!==a&&(c=g),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new Hl(a,e,n):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==a)try{await h._remove(o)}catch{}})),new Hl(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(PT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(CT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bT(e))return"Blackberry";if(OT(e))return"Webos";if(IT(e))return"Safari";if((e.includes("chrome/")||RT(e))&&!e.includes("edge/"))return"Chrome";if(FT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function CT(t=dn()){return/firefox\//i.test(t)}function IT(t=dn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function RT(t=dn()){return/crios\//i.test(t)}function PT(t=dn()){return/iemobile/i.test(t)}function FT(t=dn()){return/android/i.test(t)}function bT(t=dn()){return/blackberry/i.test(t)}function OT(t=dn()){return/webos/i.test(t)}function Kg(t=dn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function HP(t=dn()){var e;return Kg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function zP(){return a4()&&document.documentMode===10}function DT(t=dn()){return Kg(t)||FT(t)||OT(t)||bT(t)||/windows phone/i.test(t)||PT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t,e=[]){let r;switch(t){case"Browser":r=ey(dn());break;case"Worker":r=`${ey(dn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${dc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GP(t,e={}){return zo(t,"GET","/v2/passwordPolicy",Zu(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=6;class qP{constructor(e){var r,n,i,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:KP,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,a,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsUppercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ty(this),this.idTokenSubscription=new ty(this),this.beforeStateQueue=new WP(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_T,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ba(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Hl.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ST(this,{idToken:e}),n=await Va._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(oa(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,c=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(i=u.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await g0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=IP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oa(this.app))return Promise.reject(js(this));const r=e?br(e):null;return r&&at(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oa(this.app)?Promise.reject(js(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oa(this.app)?Promise.reject(js(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ba(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await GP(this),r=new qP(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await $P(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ba(e)||this._popupRedirectResolver;at(r,this,"argument-error"),this.redirectPersistenceManager=await Hl.create(this,[Ba(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&SP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Wo(t){return br(t)}class ty{constructor(e){this.auth=e,this.observer=null,this.addObserver=d4(r=>this.observer=r)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ed={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YP(t){ed=t}function LT(t){return ed.loadJS(t)}function QP(){return ed.recaptchaEnterpriseScript}function JP(){return ed.gapiScript}function ZP(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class eF{constructor(){this.enterprise=new tF}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class tF{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const rF="recaptcha-enterprise",MT="NO_RECAPTCHA";class nF{constructor(e){this.type=rF,this.auth=Wo(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{DP(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new OP(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;Y_(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{o(h)}).catch(()=>{o(MT)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eF().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(c=>{if(!r&&Y_(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=QP();u.length!==0&&(u+=c),LT(u).then(()=>{i(c,a,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function ry(t,e,r,n=!1,i=!1){const a=new nF(t);let o;if(i)o=MT;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const c=Object.assign({},e);return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function iF(t,e,r,n,i){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await ry(t,e,r,r==="getOobCode");return n(t,o)}else return n(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await ry(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aF(t,e){const r=jg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Yl(a,e??{}))return i;ha(i,"already-initialized")}return r.initialize({options:e})}function sF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ba);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function oF(t,e,r){const n=Wo(t);at(n._canInitEmulator,n,"emulator-config-failed"),at(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=VT(e),{host:o,port:c}=lF(e),u=c===null?"":`:${c}`;n.config.emulator={url:`${a}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),cF()}function VT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lF(t){const e=VT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:ny(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:ny(o)}}}function ny(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ma("not implemented")}_getIdTokenResponse(e){return Ma("not implemented")}_linkToIdToken(e,r){return Ma("not implemented")}_getReauthenticationResolver(e){return Ma("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zl(t,e){return wT(t,"POST","/v1/accounts:signInWithIdp",Zu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF="http://localhost";class Lo extends BT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Lo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ha("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,a=$g(r,["providerId","signInMethod"]);if(!n||!i)return null;const o=new Lo(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return zl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,zl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,zl(e,r)}buildRequest(){const e={requestUri:uF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Qu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends qg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends ef{constructor(){super("facebook.com")}static credential(e){return Lo._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ps.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends ef{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Lo._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return La.credential(r,n)}catch{return null}}}La.GOOGLE_SIGN_IN_METHOD="google.com";La.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends ef{constructor(){super("github.com")}static credential(e){return Lo._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.GITHUB_SIGN_IN_METHOD="github.com";Fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends ef{constructor(){super("twitter.com")}static credential(e,r){return Lo._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return bs.credential(r,n)}catch{return null}}}bs.TWITTER_SIGN_IN_METHOD="twitter.com";bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fF(t,e){return wT(t,"POST","/v1/accounts:signUp",Zu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Va._fromIdTokenResponse(e,n,i),o=iy(n);return new Mo({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=iy(n);return new Mo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function iy(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v0 extends Ja{constructor(e,r,n,i){var a;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,v0.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new v0(e,r,n,i)}}function UT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?v0._fromErrorAndOperation(t,a,e,n):a})}async function hF(t,e,r=!1){const n=await Pu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Mo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dF(t,e,r=!1){const{auth:n}=t;if(oa(n.app))return Promise.reject(js(n));const i="reauthenticate";try{const a=await Pu(t,UT(n,i,e,t),r);at(a.idToken,n,"internal-error");const o=Gg(a.idToken);at(o,n,"internal-error");const{sub:c}=o;return at(t.uid===c,n,"user-mismatch"),Mo._forOperation(t,i,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ha(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(t,e,r=!1){if(oa(t.app))return Promise.reject(js(t));const n="signIn",i=await UT(t,n,e),a=await Mo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(t){const e=Wo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function HH(t,e,r){if(oa(t.app))return Promise.reject(js(t));const n=Wo(t),o=await iF(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",fF).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&mF(t),u}),c=await Mo._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function gF(t,e,r,n){return br(t).onIdTokenChanged(e,r,n)}function vF(t,e,r){return br(t).beforeAuthStateChanged(e,r)}function xF(t,e,r,n){return br(t).onAuthStateChanged(e,r,n)}function zH(t){return br(t).signOut()}const x0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(x0,"1"),this.storage.removeItem(x0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F=1e3,yF=10;class $T extends jT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=DT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);zP()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,yF):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},_F)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}$T.type="LOCAL";const EF=$T;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT extends jT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}HT.type="SESSION";const zT=HT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new td(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(o).map(async h=>h(r.origin,a)),u=await wF(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const h=Xg("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(g){const v=g;if(v.data.eventId===h)switch(v.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(v.data.response);break;default:clearTimeout(d),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(){return window}function SF(t){la().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(){return typeof la().WorkerGlobalScope<"u"&&typeof la().importScripts=="function"}async function kF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function CF(){return WT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="firebaseLocalStorageDb",IF=1,_0="firebaseLocalStorage",KT="fbase_key";class tf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function rd(t,e){return t.transaction([_0],e?"readwrite":"readonly").objectStore(_0)}function RF(){const t=indexedDB.deleteDatabase(GT);return new tf(t).toPromise()}function qm(){const t=indexedDB.open(GT,IF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(_0,{keyPath:KT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(_0)?e(n):(n.close(),await RF(),e(await qm()))})})}async function ay(t,e,r){const n=rd(t,!0).put({[KT]:e,value:r});return new tf(n).toPromise()}async function PF(t,e){const r=rd(t,!1).get(e),n=await new tf(r).toPromise();return n===void 0?null:n.value}function sy(t,e){const r=rd(t,!0).delete(e);return new tf(r).toPromise()}const FF=800,bF=3;class qT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>bF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return WT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance(CF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await kF(),!this.activeServiceWorker)return;this.sender=new TF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qm();return await ay(e,x0,"1"),await sy(e,x0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>ay(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>PF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>sy(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=rd(i,!1).getAll();return new tf(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qT.type="LOCAL";const OF=qT;new Ju(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XT(t,e){return e?Ba(e):(at(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg extends BT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return zl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return zl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function DF(t){return pF(t.auth,new Yg(t),t.bypassAuthState)}function NF(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),dF(r,new Yg(t),t.bypassAuthState)}async function LF(t){const{auth:e,user:r}=t;return at(r,e,"internal-error"),hF(r,new Yg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return DF;case"linkViaPopup":case"linkViaRedirect":return LF;case"reauthViaPopup":case"reauthViaRedirect":return NF;default:ha(this.auth,"internal-error")}}resolve(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF=new Ju(2e3,1e4);async function WH(t,e,r){if(oa(t.app))return Promise.reject(Bi(t,"operation-not-supported-in-this-environment"));const n=Wo(t);kP(t,e,qg);const i=XT(n,r);return new Ro(n,"signInViaPopup",e,i).executeNotNull()}class Ro extends YT{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,Ro.currentPopupAction&&Ro.currentPopupAction.cancel(),Ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Ka(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Bi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Bi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,MF.get())};e()}}Ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF="pendingRedirect",e0=new Map;class BF extends YT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=e0.get(this.auth._key());if(!e){try{const n=await UF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}e0.set(this.auth._key(),e)}return this.bypassAuthState||e0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function UF(t,e){const r=HF(e),n=$F(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function jF(t,e){e0.set(t._key(),e)}function $F(t){return Ba(t._redirectPersistence)}function HF(t){return Zh(VF,t.config.apiKey,t.name)}async function zF(t,e,r=!1){if(oa(t.app))return Promise.reject(js(t));const n=Wo(t),i=XT(n,e),o=await new BF(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WF=10*60*1e3;class GF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!QT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Bi(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WF&&this.cachedEventUids.clear(),this.cachedEventUids.has(oy(e))}saveEventToCache(e){this.cachedEventUids.add(oy(e)),this.lastProcessedEventTime=Date.now()}}function oy(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function QT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return QT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(t,e={}){return zo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YF=/^https?/;async function QF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await qF(t);for(const r of e)try{if(JF(r))return}catch{}ha(t,"unauthorized-domain")}function JF(t){const e=Gm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!YF.test(r))return!1;if(XF.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=new Ju(3e4,6e4);function ly(){const t=la().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function eb(t){return new Promise((e,r)=>{var n,i,a;function o(){ly(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ly(),r(Bi(t,"network-request-failed"))},timeout:ZF.get()})}if(!((i=(n=la().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=la().gapi)===null||a===void 0)&&a.load)o();else{const c=ZP("iframefcb");return la()[c]=()=>{gapi.load?o():r(Bi(t,"network-request-failed"))},LT(`${JP()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw t0=null,e})}let t0=null;function tb(t){return t0=t0||eb(t),t0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb=new Ju(5e3,15e3),nb="__/auth/iframe",ib="emulator/auth/iframe",ab={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sb=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ob(t){const e=t.config;at(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Wg(e,ib):`https://${t.config.authDomain}/${nb}`,n={apiKey:e.apiKey,appName:t.name,v:dc},i=sb.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Qu(n).slice(1)}`}async function lb(t){const e=await tb(t),r=la().gapi;return at(r,t,"internal-error"),e.open({where:document.body,url:ob(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ab,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=Bi(t,"network-request-failed"),c=la().setTimeout(()=>{a(o)},rb.get());function u(){la().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ub=500,fb=600,hb="_blank",db="http://localhost";class cy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pb(t,e,r,n=ub,i=fb){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u=Object.assign(Object.assign({},cb),{width:n.toString(),height:i.toString(),top:a,left:o}),h=dn().toLowerCase();r&&(c=RT(h)?hb:r),CT(h)&&(e=e||db,u.scrollbars="yes");const d=Object.entries(u).reduce((v,[_,E])=>`${v}${_}=${E},`,"");if(HP(h)&&c!=="_self")return mb(e||"",c),new cy(null);const g=window.open(e||"",c,d);at(g,t,"popup-blocked");try{g.focus()}catch{}return new cy(g)}function mb(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="__/auth/handler",vb="emulator/auth/handler",xb=encodeURIComponent("fac");async function uy(t,e,r,n,i,a){at(t.config.authDomain,t,"auth-domain-config-required"),at(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:dc,eventId:i};if(e instanceof qg){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",h4(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof ef){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const u=await t._getAppCheckToken(),h=u?`#${xb}=${encodeURIComponent(u)}`:"";return`${_b(t)}?${Qu(c).slice(1)}${h}`}function _b({config:t}){return t.emulator?Wg(t,vb):`https://${t.authDomain}/${gb}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="webStorageSupport";class yb{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zT,this._completeRedirectFn=zF,this._overrideRedirectResult=jF}async _openPopup(e,r,n,i){var a;Ka((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await uy(e,r,n,Gm(),i);return pb(e,o,Xg())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await uy(e,r,n,Gm(),i);return SF(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Ka(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await lb(e),n=new GF(e);return r.register("authEvent",i=>(at(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(pm,{type:pm},i=>{var a;const o=(a=i==null?void 0:i[0])===null||a===void 0?void 0:a[pm];o!==void 0&&r(!!o),ha(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=QF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return DT()||IT()||Kg()}}const Eb=yb;var fy="@firebase/auth",hy="1.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tb(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sb(t){Ql(new No("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;at(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NT(t)},h=new XP(n,i,a,u);return sF(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ql(new No("auth-internal",e=>{const r=Wo(e.getProvider("auth").getImmediate());return(n=>new wb(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Us(fy,hy,Tb(t)),Us(fy,hy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=5*60,Ab=fT("authIdTokenMaxAge")||kb;let dy=null;const Cb=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>Ab)return;const i=r==null?void 0:r.token;dy!==i&&(dy=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Ib(t=mT()){const e=jg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=aF(t,{popupRedirectResolver:Eb,persistence:[OF,EF,zT]}),n=fT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=Cb(a.toString());vF(r,o,()=>o(r.currentUser)),gF(r,c=>o(c))}}const i=cT("auth");return i&&oF(r,`http://${i}`),r}function Rb(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YP({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=Bi("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",Rb().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sb("Browser");var Pb="firebase",Fb="11.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Us(Pb,Fb,"app");var py=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bo,JT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,P){function R(){}R.prototype=P.prototype,A.D=P.prototype,A.prototype=new R,A.prototype.constructor=A,A.C=function(M,L,N){for(var B=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)B[Oe-2]=arguments[Oe];return P.prototype[L].apply(M,B)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,P,R){R||(R=0);var M=Array(16);if(typeof P=="string")for(var L=0;16>L;++L)M[L]=P.charCodeAt(R++)|P.charCodeAt(R++)<<8|P.charCodeAt(R++)<<16|P.charCodeAt(R++)<<24;else for(L=0;16>L;++L)M[L]=P[R++]|P[R++]<<8|P[R++]<<16|P[R++]<<24;P=A.g[0],R=A.g[1],L=A.g[2];var N=A.g[3],B=P+(N^R&(L^N))+M[0]+3614090360&4294967295;P=R+(B<<7&4294967295|B>>>25),B=N+(L^P&(R^L))+M[1]+3905402710&4294967295,N=P+(B<<12&4294967295|B>>>20),B=L+(R^N&(P^R))+M[2]+606105819&4294967295,L=N+(B<<17&4294967295|B>>>15),B=R+(P^L&(N^P))+M[3]+3250441966&4294967295,R=L+(B<<22&4294967295|B>>>10),B=P+(N^R&(L^N))+M[4]+4118548399&4294967295,P=R+(B<<7&4294967295|B>>>25),B=N+(L^P&(R^L))+M[5]+1200080426&4294967295,N=P+(B<<12&4294967295|B>>>20),B=L+(R^N&(P^R))+M[6]+2821735955&4294967295,L=N+(B<<17&4294967295|B>>>15),B=R+(P^L&(N^P))+M[7]+4249261313&4294967295,R=L+(B<<22&4294967295|B>>>10),B=P+(N^R&(L^N))+M[8]+1770035416&4294967295,P=R+(B<<7&4294967295|B>>>25),B=N+(L^P&(R^L))+M[9]+2336552879&4294967295,N=P+(B<<12&4294967295|B>>>20),B=L+(R^N&(P^R))+M[10]+4294925233&4294967295,L=N+(B<<17&4294967295|B>>>15),B=R+(P^L&(N^P))+M[11]+2304563134&4294967295,R=L+(B<<22&4294967295|B>>>10),B=P+(N^R&(L^N))+M[12]+1804603682&4294967295,P=R+(B<<7&4294967295|B>>>25),B=N+(L^P&(R^L))+M[13]+4254626195&4294967295,N=P+(B<<12&4294967295|B>>>20),B=L+(R^N&(P^R))+M[14]+2792965006&4294967295,L=N+(B<<17&4294967295|B>>>15),B=R+(P^L&(N^P))+M[15]+1236535329&4294967295,R=L+(B<<22&4294967295|B>>>10),B=P+(L^N&(R^L))+M[1]+4129170786&4294967295,P=R+(B<<5&4294967295|B>>>27),B=N+(R^L&(P^R))+M[6]+3225465664&4294967295,N=P+(B<<9&4294967295|B>>>23),B=L+(P^R&(N^P))+M[11]+643717713&4294967295,L=N+(B<<14&4294967295|B>>>18),B=R+(N^P&(L^N))+M[0]+3921069994&4294967295,R=L+(B<<20&4294967295|B>>>12),B=P+(L^N&(R^L))+M[5]+3593408605&4294967295,P=R+(B<<5&4294967295|B>>>27),B=N+(R^L&(P^R))+M[10]+38016083&4294967295,N=P+(B<<9&4294967295|B>>>23),B=L+(P^R&(N^P))+M[15]+3634488961&4294967295,L=N+(B<<14&4294967295|B>>>18),B=R+(N^P&(L^N))+M[4]+3889429448&4294967295,R=L+(B<<20&4294967295|B>>>12),B=P+(L^N&(R^L))+M[9]+568446438&4294967295,P=R+(B<<5&4294967295|B>>>27),B=N+(R^L&(P^R))+M[14]+3275163606&4294967295,N=P+(B<<9&4294967295|B>>>23),B=L+(P^R&(N^P))+M[3]+4107603335&4294967295,L=N+(B<<14&4294967295|B>>>18),B=R+(N^P&(L^N))+M[8]+1163531501&4294967295,R=L+(B<<20&4294967295|B>>>12),B=P+(L^N&(R^L))+M[13]+2850285829&4294967295,P=R+(B<<5&4294967295|B>>>27),B=N+(R^L&(P^R))+M[2]+4243563512&4294967295,N=P+(B<<9&4294967295|B>>>23),B=L+(P^R&(N^P))+M[7]+1735328473&4294967295,L=N+(B<<14&4294967295|B>>>18),B=R+(N^P&(L^N))+M[12]+2368359562&4294967295,R=L+(B<<20&4294967295|B>>>12),B=P+(R^L^N)+M[5]+4294588738&4294967295,P=R+(B<<4&4294967295|B>>>28),B=N+(P^R^L)+M[8]+2272392833&4294967295,N=P+(B<<11&4294967295|B>>>21),B=L+(N^P^R)+M[11]+1839030562&4294967295,L=N+(B<<16&4294967295|B>>>16),B=R+(L^N^P)+M[14]+4259657740&4294967295,R=L+(B<<23&4294967295|B>>>9),B=P+(R^L^N)+M[1]+2763975236&4294967295,P=R+(B<<4&4294967295|B>>>28),B=N+(P^R^L)+M[4]+1272893353&4294967295,N=P+(B<<11&4294967295|B>>>21),B=L+(N^P^R)+M[7]+4139469664&4294967295,L=N+(B<<16&4294967295|B>>>16),B=R+(L^N^P)+M[10]+3200236656&4294967295,R=L+(B<<23&4294967295|B>>>9),B=P+(R^L^N)+M[13]+681279174&4294967295,P=R+(B<<4&4294967295|B>>>28),B=N+(P^R^L)+M[0]+3936430074&4294967295,N=P+(B<<11&4294967295|B>>>21),B=L+(N^P^R)+M[3]+3572445317&4294967295,L=N+(B<<16&4294967295|B>>>16),B=R+(L^N^P)+M[6]+76029189&4294967295,R=L+(B<<23&4294967295|B>>>9),B=P+(R^L^N)+M[9]+3654602809&4294967295,P=R+(B<<4&4294967295|B>>>28),B=N+(P^R^L)+M[12]+3873151461&4294967295,N=P+(B<<11&4294967295|B>>>21),B=L+(N^P^R)+M[15]+530742520&4294967295,L=N+(B<<16&4294967295|B>>>16),B=R+(L^N^P)+M[2]+3299628645&4294967295,R=L+(B<<23&4294967295|B>>>9),B=P+(L^(R|~N))+M[0]+4096336452&4294967295,P=R+(B<<6&4294967295|B>>>26),B=N+(R^(P|~L))+M[7]+1126891415&4294967295,N=P+(B<<10&4294967295|B>>>22),B=L+(P^(N|~R))+M[14]+2878612391&4294967295,L=N+(B<<15&4294967295|B>>>17),B=R+(N^(L|~P))+M[5]+4237533241&4294967295,R=L+(B<<21&4294967295|B>>>11),B=P+(L^(R|~N))+M[12]+1700485571&4294967295,P=R+(B<<6&4294967295|B>>>26),B=N+(R^(P|~L))+M[3]+2399980690&4294967295,N=P+(B<<10&4294967295|B>>>22),B=L+(P^(N|~R))+M[10]+4293915773&4294967295,L=N+(B<<15&4294967295|B>>>17),B=R+(N^(L|~P))+M[1]+2240044497&4294967295,R=L+(B<<21&4294967295|B>>>11),B=P+(L^(R|~N))+M[8]+1873313359&4294967295,P=R+(B<<6&4294967295|B>>>26),B=N+(R^(P|~L))+M[15]+4264355552&4294967295,N=P+(B<<10&4294967295|B>>>22),B=L+(P^(N|~R))+M[6]+2734768916&4294967295,L=N+(B<<15&4294967295|B>>>17),B=R+(N^(L|~P))+M[13]+1309151649&4294967295,R=L+(B<<21&4294967295|B>>>11),B=P+(L^(R|~N))+M[4]+4149444226&4294967295,P=R+(B<<6&4294967295|B>>>26),B=N+(R^(P|~L))+M[11]+3174756917&4294967295,N=P+(B<<10&4294967295|B>>>22),B=L+(P^(N|~R))+M[2]+718787259&4294967295,L=N+(B<<15&4294967295|B>>>17),B=R+(N^(L|~P))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+P&4294967295,A.g[1]=A.g[1]+(L+(B<<21&4294967295|B>>>11))&4294967295,A.g[2]=A.g[2]+L&4294967295,A.g[3]=A.g[3]+N&4294967295}n.prototype.u=function(A,P){P===void 0&&(P=A.length);for(var R=P-this.blockSize,M=this.B,L=this.h,N=0;N<P;){if(L==0)for(;N<=R;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<P;)if(M[L++]=A.charCodeAt(N++),L==this.blockSize){i(this,M),L=0;break}}else for(;N<P;)if(M[L++]=A[N++],L==this.blockSize){i(this,M),L=0;break}}this.h=L,this.o+=P},n.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var P=1;P<A.length-8;++P)A[P]=0;var R=8*this.o;for(P=A.length-8;P<A.length;++P)A[P]=R&255,R/=256;for(this.u(A),A=Array(16),P=R=0;4>P;++P)for(var M=0;32>M;M+=8)A[R++]=this.g[P]>>>M&255;return A};function a(A,P){var R=c;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=P(A)}function o(A,P){this.h=P;for(var R=[],M=!0,L=A.length-1;0<=L;L--){var N=A[L]|0;M&&N==P||(R[L]=N,M=!1)}this.g=R}var c={};function u(A){return-128<=A&&128>A?a(A,function(P){return new o([P|0],0>P?-1:0)}):new o([A|0],0>A?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return g;if(0>A)return w(h(-A));for(var P=[],R=1,M=0;A>=R;M++)P[M]=A/R|0,R*=4294967296;return new o(P,0)}function d(A,P){if(A.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(A.charAt(0)=="-")return w(d(A.substring(1),P));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=h(Math.pow(P,8)),M=g,L=0;L<A.length;L+=8){var N=Math.min(8,A.length-L),B=parseInt(A.substring(L,L+N),P);8>N?(N=h(Math.pow(P,N)),M=M.j(N).add(h(B))):(M=M.j(R),M=M.add(h(B)))}return M}var g=u(0),v=u(1),_=u(16777216);t=o.prototype,t.m=function(){if(y(this))return-w(this).m();for(var A=0,P=1,R=0;R<this.g.length;R++){var M=this.i(R);A+=(0<=M?M:4294967296+M)*P,P*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(E(this))return"0";if(y(this))return"-"+w(this).toString(A);for(var P=h(Math.pow(A,6)),R=this,M="";;){var L=U(R,P).g;R=k(R,L.j(P));var N=((0<R.g.length?R.g[0]:R.h)>>>0).toString(A);if(R=L,E(R))return N+M;for(;6>N.length;)N="0"+N;M=N+M}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function E(A){if(A.h!=0)return!1;for(var P=0;P<A.g.length;P++)if(A.g[P]!=0)return!1;return!0}function y(A){return A.h==-1}t.l=function(A){return A=k(this,A),y(A)?-1:E(A)?0:1};function w(A){for(var P=A.g.length,R=[],M=0;M<P;M++)R[M]=~A.g[M];return new o(R,~A.h).add(v)}t.abs=function(){return y(this)?w(this):this},t.add=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],M=0,L=0;L<=P;L++){var N=M+(this.i(L)&65535)+(A.i(L)&65535),B=(N>>>16)+(this.i(L)>>>16)+(A.i(L)>>>16);M=B>>>16,N&=65535,B&=65535,R[L]=B<<16|N}return new o(R,R[R.length-1]&-2147483648?-1:0)};function k(A,P){return A.add(w(P))}t.j=function(A){if(E(this)||E(A))return g;if(y(this))return y(A)?w(this).j(w(A)):w(w(this).j(A));if(y(A))return w(this.j(w(A)));if(0>this.l(_)&&0>A.l(_))return h(this.m()*A.m());for(var P=this.g.length+A.g.length,R=[],M=0;M<2*P;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(var L=0;L<A.g.length;L++){var N=this.i(M)>>>16,B=this.i(M)&65535,Oe=A.i(L)>>>16,we=A.i(L)&65535;R[2*M+2*L]+=B*we,F(R,2*M+2*L),R[2*M+2*L+1]+=N*we,F(R,2*M+2*L+1),R[2*M+2*L+1]+=B*Oe,F(R,2*M+2*L+1),R[2*M+2*L+2]+=N*Oe,F(R,2*M+2*L+2)}for(M=0;M<P;M++)R[M]=R[2*M+1]<<16|R[2*M];for(M=P;M<2*P;M++)R[M]=0;return new o(R,0)};function F(A,P){for(;(A[P]&65535)!=A[P];)A[P+1]+=A[P]>>>16,A[P]&=65535,P++}function C(A,P){this.g=A,this.h=P}function U(A,P){if(E(P))throw Error("division by zero");if(E(A))return new C(g,g);if(y(A))return P=U(w(A),P),new C(w(P.g),w(P.h));if(y(P))return P=U(A,w(P)),new C(w(P.g),P.h);if(30<A.g.length){if(y(A)||y(P))throw Error("slowDivide_ only works with positive integers.");for(var R=v,M=P;0>=M.l(A);)R=V(R),M=V(M);var L=z(R,1),N=z(M,1);for(M=z(M,2),R=z(R,2);!E(M);){var B=N.add(M);0>=B.l(A)&&(L=L.add(R),N=B),M=z(M,1),R=z(R,1)}return P=k(A,L.j(P)),new C(L,P)}for(L=g;0<=A.l(P);){for(R=Math.max(1,Math.floor(A.m()/P.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),N=h(R),B=N.j(P);y(B)||0<B.l(A);)R-=M,N=h(R),B=N.j(P);E(N)&&(N=v),L=L.add(N),A=k(A,B)}return new C(L,A)}t.A=function(A){return U(this,A).h},t.and=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)&A.i(M);return new o(R,this.h&A.h)},t.or=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)|A.i(M);return new o(R,this.h|A.h)},t.xor=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)^A.i(M);return new o(R,this.h^A.h)};function V(A){for(var P=A.g.length+1,R=[],M=0;M<P;M++)R[M]=A.i(M)<<1|A.i(M-1)>>>31;return new o(R,A.h)}function z(A,P){var R=P>>5;P%=32;for(var M=A.g.length-R,L=[],N=0;N<M;N++)L[N]=0<P?A.i(N+R)>>>P|A.i(N+R+1)<<32-P:A.i(N+R);return new o(L,A.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,JT=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,bo=o}).apply(typeof py<"u"?py:typeof self<"u"?self:typeof window<"u"?window:{});var Fh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ZT,au,e2,r0,Xm,t2,r2,n2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,T,I){return p==Array.prototype||p==Object.prototype||(p[T]=I.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fh=="object"&&Fh];for(var T=0;T<p.length;++T){var I=p[T];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var n=r(this);function i(p,T){if(T)e:{var I=n;p=p.split(".");for(var j=0;j<p.length-1;j++){var se=p[j];if(!(se in I))break e;I=I[se]}p=p[p.length-1],j=I[p],T=T(j),T!=j&&T!=null&&e(I,p,{configurable:!0,writable:!0,value:T})}}function a(p,T){p instanceof String&&(p+="");var I=0,j=!1,se={next:function(){if(!j&&I<p.length){var me=I++;return{value:T(me,p[me]),done:!1}}return j=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}i("Array.prototype.values",function(p){return p||function(){return a(this,function(T,I){return I})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(p){var T=typeof p;return T=T!="object"?T:p?Array.isArray(p)?"array":T:"null",T=="array"||T=="object"&&typeof p.length=="number"}function h(p){var T=typeof p;return T=="object"&&p!=null||T=="function"}function d(p,T,I){return p.call.apply(p.bind,arguments)}function g(p,T,I){if(!p)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,j),p.apply(T,se)}}return function(){return p.apply(T,arguments)}}function v(p,T,I){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:g,v.apply(null,arguments)}function _(p,T){var I=Array.prototype.slice.call(arguments,1);return function(){var j=I.slice();return j.push.apply(j,arguments),p.apply(this,j)}}function E(p,T){function I(){}I.prototype=T.prototype,p.aa=T.prototype,p.prototype=new I,p.prototype.constructor=p,p.Qb=function(j,se,me){for(var Me=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Me[Nt-2]=arguments[Nt];return T.prototype[se].apply(j,Me)}}function y(p){const T=p.length;if(0<T){const I=Array(T);for(let j=0;j<T;j++)I[j]=p[j];return I}return[]}function w(p,T){for(let I=1;I<arguments.length;I++){const j=arguments[I];if(u(j)){const se=p.length||0,me=j.length||0;p.length=se+me;for(let Me=0;Me<me;Me++)p[se+Me]=j[Me]}else p.push(j)}}class k{constructor(T,I){this.i=T,this.j=I,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function F(p){return/^[\s\xa0]*$/.test(p)}function C(){var p=c.navigator;return p&&(p=p.userAgent)?p:""}function U(p){return U[" "](p),p}U[" "]=function(){};var V=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function z(p,T,I){for(const j in p)T.call(I,p[j],j,p)}function A(p,T){for(const I in p)T.call(void 0,p[I],I,p)}function P(p){const T={};for(const I in p)T[I]=p[I];return T}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(p,T){let I,j;for(let se=1;se<arguments.length;se++){j=arguments[se];for(I in j)p[I]=j[I];for(let me=0;me<R.length;me++)I=R[me],Object.prototype.hasOwnProperty.call(j,I)&&(p[I]=j[I])}}function L(p){var T=1;p=p.split(":");const I=[];for(;0<T&&p.length;)I.push(p.shift()),T--;return p.length&&I.push(p.join(":")),I}function N(p){c.setTimeout(()=>{throw p},0)}function B(){var p=ie;let T=null;return p.g&&(T=p.g,p.g=p.g.next,p.g||(p.h=null),T.next=null),T}class Oe{constructor(){this.h=this.g=null}add(T,I){const j=we.get();j.set(T,I),this.h?this.h.next=j:this.g=j,this.h=j}}var we=new k(()=>new Ce,p=>p.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(T,I){this.h=T,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let Ae,Ee=!1,ie=new Oe,xe=()=>{const p=c.Promise.resolve(void 0);Ae=()=>{p.then(te)}};var te=()=>{for(var p;p=B();){try{p.h.call(p.g)}catch(I){N(I)}var T=we;T.j(p),100>T.h&&(T.h++,p.next=T.g,T.g=p)}Ee=!1};function D(){this.s=this.s,this.C=this.C}D.prototype.s=!1,D.prototype.ma=function(){this.s||(this.s=!0,this.N())},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(p,T){this.type=p,this.g=this.target=T,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var p=!1,T=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const I=()=>{};c.addEventListener("test",I,T),c.removeEventListener("test",I,T)}catch{}return p}();function Z(p,T){if(re.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var I=this.type=p.type,j=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=T,T=p.relatedTarget){if(V){e:{try{U(T.nodeName);var se=!0;break e}catch{}se=!1}se||(T=null)}}else I=="mouseover"?T=p.fromElement:I=="mouseout"&&(T=p.toElement);this.relatedTarget=T,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ce[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Z.aa.h.call(this)}}E(Z,re);var ce={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var _e="closure_listenable_"+(1e6*Math.random()|0),ve=0;function ye(p,T,I,j,se){this.listener=p,this.proxy=null,this.src=T,this.type=I,this.capture=!!j,this.ha=se,this.key=++ve,this.da=this.fa=!1}function Te(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Ke(p){this.src=p,this.g={},this.h=0}Ke.prototype.add=function(p,T,I,j,se){var me=p.toString();p=this.g[me],p||(p=this.g[me]=[],this.h++);var Me=kt(p,T,j,se);return-1<Me?(T=p[Me],I||(T.fa=!1)):(T=new ye(T,this.src,me,!!j,se),T.fa=I,p.push(T)),T};function J(p,T){var I=T.type;if(I in p.g){var j=p.g[I],se=Array.prototype.indexOf.call(j,T,void 0),me;(me=0<=se)&&Array.prototype.splice.call(j,se,1),me&&(Te(T),p.g[I].length==0&&(delete p.g[I],p.h--))}}function kt(p,T,I,j){for(var se=0;se<p.length;++se){var me=p[se];if(!me.da&&me.listener==T&&me.capture==!!I&&me.ha==j)return se}return-1}var ct="closure_lm_"+(1e6*Math.random()|0),dt={};function ut(p,T,I,j,se){if(Array.isArray(T)){for(var me=0;me<T.length;me++)ut(p,T[me],I,j,se);return null}return I=vn(I),p&&p[_e]?p.K(T,I,h(j)?!!j.capture:!!j,se):Ve(p,T,I,!1,j,se)}function Ve(p,T,I,j,se,me){if(!T)throw Error("Invalid event type");var Me=h(se)?!!se.capture:!!se,Nt=gn(p);if(Nt||(p[ct]=Nt=new Ke(p)),I=Nt.add(T,I,j,Me,me),I.proxy)return I;if(j=Vt(),I.proxy=j,j.src=p,j.listener=I,p.addEventListener)ee||(se=Me),se===void 0&&(se=!1),p.addEventListener(T.toString(),j,se);else if(p.attachEvent)p.attachEvent(Tr(T.toString()),j);else if(p.addListener&&p.removeListener)p.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Vt(){function p(I){return T.call(p.src,p.listener,I)}const T=_i;return p}function wr(p,T,I,j,se){if(Array.isArray(T))for(var me=0;me<T.length;me++)wr(p,T[me],I,j,se);else j=h(j)?!!j.capture:!!j,I=vn(I),p&&p[_e]?(p=p.i,T=String(T).toString(),T in p.g&&(me=p.g[T],I=kt(me,I,j,se),-1<I&&(Te(me[I]),Array.prototype.splice.call(me,I,1),me.length==0&&(delete p.g[T],p.h--)))):p&&(p=gn(p))&&(T=p.g[T.toString()],p=-1,T&&(p=kt(T,I,j,se)),(I=-1<p?T[p]:null)&&fr(I))}function fr(p){if(typeof p!="number"&&p&&!p.da){var T=p.src;if(T&&T[_e])J(T.i,p);else{var I=p.type,j=p.proxy;T.removeEventListener?T.removeEventListener(I,j,p.capture):T.detachEvent?T.detachEvent(Tr(I),j):T.addListener&&T.removeListener&&T.removeListener(j),(I=gn(T))?(J(I,p),I.h==0&&(I.src=null,T[ct]=null)):Te(p)}}}function Tr(p){return p in dt?dt[p]:dt[p]="on"+p}function _i(p,T){if(p.da)p=!0;else{T=new Z(T,this);var I=p.listener,j=p.ha||p.src;p.fa&&fr(p),p=I.call(j,T)}return p}function gn(p){return p=p[ct],p instanceof Ke?p:null}var hr="__closure_events_fn_"+(1e9*Math.random()>>>0);function vn(p){return typeof p=="function"?p:(p[hr]||(p[hr]=function(T){return p.handleEvent(T)}),p[hr])}function Lt(){D.call(this),this.i=new Ke(this),this.M=this,this.F=null}E(Lt,D),Lt.prototype[_e]=!0,Lt.prototype.removeEventListener=function(p,T,I,j){wr(this,p,T,I,j)};function jt(p,T){var I,j=p.F;if(j)for(I=[];j;j=j.F)I.push(j);if(p=p.M,j=T.type||T,typeof T=="string")T=new re(T,p);else if(T instanceof re)T.target=T.target||p;else{var se=T;T=new re(j,p),M(T,se)}if(se=!0,I)for(var me=I.length-1;0<=me;me--){var Me=T.g=I[me];se=$t(Me,j,!0,T)&&se}if(Me=T.g=p,se=$t(Me,j,!0,T)&&se,se=$t(Me,j,!1,T)&&se,I)for(me=0;me<I.length;me++)Me=T.g=I[me],se=$t(Me,j,!1,T)&&se}Lt.prototype.N=function(){if(Lt.aa.N.call(this),this.i){var p=this.i,T;for(T in p.g){for(var I=p.g[T],j=0;j<I.length;j++)Te(I[j]);delete p.g[T],p.h--}}this.F=null},Lt.prototype.K=function(p,T,I,j){return this.i.add(String(p),T,!1,I,j)},Lt.prototype.L=function(p,T,I,j){return this.i.add(String(p),T,!0,I,j)};function $t(p,T,I,j){if(T=p.i.g[String(T)],!T)return!0;T=T.concat();for(var se=!0,me=0;me<T.length;++me){var Me=T[me];if(Me&&!Me.da&&Me.capture==I){var Nt=Me.listener,Sr=Me.ha||Me.src;Me.fa&&J(p.i,Me),se=Nt.call(Sr,j)!==!1&&se}}return se&&!j.defaultPrevented}function Jr(p,T,I){if(typeof p=="function")I&&(p=v(p,I));else if(p&&typeof p.handleEvent=="function")p=v(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:c.setTimeout(p,T||0)}function rt(p){p.g=Jr(()=>{p.g=null,p.i&&(p.i=!1,rt(p))},p.l);const T=p.h;p.h=null,p.m.apply(null,T)}class Ot extends D{constructor(T,I){super(),this.m=T,this.l=I,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:rt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dr(p){D.call(this),this.h=p,this.g={}}E(dr,D);var Ht=[];function Hn(p){z(p.g,function(T,I){this.g.hasOwnProperty(I)&&fr(T)},p),p.g={}}dr.prototype.N=function(){dr.aa.N.call(this),Hn(this)},dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rs=c.JSON.stringify,no=c.JSON.parse,io=class{stringify(p){return c.JSON.stringify(p,void 0)}parse(p){return c.JSON.parse(p,void 0)}};function Gi(){}Gi.prototype.h=null;function xa(p){return p.h||(p.h=p.i())}function _a(){}var Rn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ni(){re.call(this,"d")}E(ni,re);function yi(){re.call(this,"c")}E(yi,re);var ii={},ao=null;function ya(){return ao=ao||new Lt}ii.La="serverreachability";function so(p){re.call(this,ii.La,p)}E(so,re);function Ei(p){const T=ya();jt(T,new so(T))}ii.STAT_EVENT="statevent";function oo(p,T){re.call(this,ii.STAT_EVENT,p),this.stat=T}E(oo,re);function Jt(p){const T=ya();jt(T,new oo(T,p))}ii.Ma="timingevent";function ns(p,T){re.call(this,ii.Ma,p),this.size=T}E(ns,re);function xn(p,T){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){p()},T)}function Ea(){this.g=!0}Ea.prototype.xa=function(){this.g=!1};function wa(p,T,I,j,se,me){p.info(function(){if(p.g)if(me)for(var Me="",Nt=me.split("&"),Sr=0;Sr<Nt.length;Sr++){var _t=Nt[Sr].split("=");if(1<_t.length){var Or=_t[0];_t=_t[1];var pr=Or.split("_");Me=2<=pr.length&&pr[1]=="type"?Me+(Or+"="+_t+"&"):Me+(Or+"=redacted&")}}else Me=null;else Me=me;return"XMLHTTP REQ ("+j+") [attempt "+se+"]: "+T+`
`+I+`
`+Me})}function is(p,T,I,j,se,me,Me){p.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+se+"]: "+T+`
`+I+`
`+me+" "+Me})}function O(p,T,I,j){p.info(function(){return"XMLHTTP TEXT ("+T+"): "+H(p,I)+(j?" "+j:"")})}function K(p,T){p.info(function(){return"TIMEOUT: "+T})}Ea.prototype.info=function(){};function H(p,T){if(!p.g)return T;if(!T)return null;try{var I=JSON.parse(T);if(I){for(p=0;p<I.length;p++)if(Array.isArray(I[p])){var j=I[p];if(!(2>j.length)){var se=j[1];if(Array.isArray(se)&&!(1>se.length)){var me=se[0];if(me!="noop"&&me!="stop"&&me!="close")for(var Me=1;Me<se.length;Me++)se[Me]=""}}}}return rs(I)}catch{return T}}var W={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function le(){}E(le,Gi),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},X=new le;function ge(p,T,I,j){this.j=p,this.i=T,this.l=I,this.R=j||1,this.U=new dr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ue}function ue(){this.i=null,this.g="",this.h=!1}var he={},de={};function Pe(p,T,I){p.L=1,p.v=cs(Wn(T)),p.m=I,p.P=!0,Le(p,null)}function Le(p,T){p.F=Date.now(),Fe(p),p.A=Wn(p.v);var I=p.A,j=p.R;Array.isArray(j)||(j=[String(j)]),fs(I.i,"t",j),p.C=0,I=p.j.J,p.h=new ue,p.g=Of(p.j,I?T:null,!p.m),0<p.O&&(p.M=new Ot(v(p.Y,p,p.g),p.O)),T=p.U,I=p.g,j=p.ca;var se="readystatechange";Array.isArray(se)||(se&&(Ht[0]=se.toString()),se=Ht);for(var me=0;me<se.length;me++){var Me=ut(I,se[me],j||T.handleEvent,!1,T.h||T);if(!Me)break;T.g[Me.key]=Me}T=p.H?P(p.H):{},p.m?(p.u||(p.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,T)):(p.u="GET",p.g.ea(p.A,p.u,null,T)),Ei(),wa(p.i,p.u,p.A,p.l,p.R,p.m)}ge.prototype.ca=function(p){p=p.target;const T=this.M;T&&Fn(p)==3?T.j():this.Y(p)},ge.prototype.Y=function(p){try{if(p==this.g)e:{const pr=Fn(this.g);var T=this.g.Ba();const si=this.g.Z();if(!(3>pr)&&(pr!=3||this.g&&(this.h.h||this.g.oa()||Cc(this.g)))){this.J||pr!=4||T==7||(T==8||0>=si?Ei(3):Ei(2)),It(this);var I=this.g.Z();this.X=I;t:if(Be(this)){var j=Cc(this.g);p="";var se=j.length,me=Fn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Dt(this),At(this);var Me="";break t}this.h.i=new c.TextDecoder}for(T=0;T<se;T++)this.h.h=!0,p+=this.h.i.decode(j[T],{stream:!(me&&T==se-1)});j.length=0,this.h.g+=p,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=I==200,is(this.i,this.u,this.A,this.l,this.R,pr,I),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,Sr=this.g;if((Nt=Sr.g?Sr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(Nt)){var _t=Nt;break t}}_t=null}if(I=_t)O(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wi(this,I);else{this.o=!1,this.s=3,Jt(12),Dt(this),At(this);break e}}if(this.P){I=!0;let Kn;for(;!this.J&&this.C<Me.length;)if(Kn=De(this,Me),Kn==de){pr==4&&(this.s=4,Jt(14),I=!1),O(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==he){this.s=4,Jt(15),O(this.i,this.l,Me,"[Invalid Chunk]"),I=!1;break}else O(this.i,this.l,Kn,null),wi(this,Kn);if(Be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pr!=4||Me.length!=0||this.h.h||(this.s=1,Jt(16),I=!1),this.o=this.o&&I,!I)O(this.i,this.l,Me,"[Invalid Chunked Response]"),Dt(this),At(this);else if(0<Me.length&&!this.W){this.W=!0;var Or=this.j;Or.g==this&&Or.ba&&!Or.M&&(Or.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),Rc(Or),Or.M=!0,Jt(11))}}else O(this.i,this.l,Me,null),wi(this,Me);pr==4&&Dt(this),this.o&&!this.J&&(pr==4?fl(this.j,this):(this.o=!1,Fe(this)))}else sl(this.g),I==400&&0<Me.indexOf("Unknown SID")?(this.s=3,Jt(12)):(this.s=0,Jt(13)),Dt(this),At(this)}}}catch{}finally{}};function Be(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function De(p,T){var I=p.C,j=T.indexOf(`
`,I);return j==-1?de:(I=Number(T.substring(I,j)),isNaN(I)?he:(j+=1,j+I>T.length?de:(T=T.slice(j,j+I),p.C=j+I,T)))}ge.prototype.cancel=function(){this.J=!0,Dt(this)};function Fe(p){p.S=Date.now()+p.I,et(p,p.I)}function et(p,T){if(p.B!=null)throw Error("WatchDog timer not null");p.B=xn(v(p.ba,p),T)}function It(p){p.B&&(c.clearTimeout(p.B),p.B=null)}ge.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(K(this.i,this.A),this.L!=2&&(Ei(),Jt(17)),Dt(this),this.s=2,At(this)):et(this,this.S-p)};function At(p){p.j.G==0||p.J||fl(p.j,p)}function Dt(p){It(p);var T=p.M;T&&typeof T.ma=="function"&&T.ma(),p.M=null,Hn(p.U),p.g&&(T=p.g,p.g=null,T.abort(),T.ma())}function wi(p,T){try{var I=p.j;if(I.G!=0&&(I.g==p||zt(I.h,p))){if(!p.K&&zt(I.h,p)&&I.G==3){try{var j=I.Da.g.parse(T)}catch{j=null}if(Array.isArray(j)&&j.length==3){var se=j;if(se[0]==0){e:if(!I.u){if(I.g)if(I.g.F+3e3<p.F)ul(I),Ci(I);else break e;cl(I),Jt(18)}}else I.za=se[1],0<I.za-I.T&&37500>se[2]&&I.F&&I.v==0&&!I.C&&(I.C=xn(v(I.Za,I),6e3));if(1>=as(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else Ca(I,11)}else if((p.K||I.g==p)&&ul(I),!F(T))for(se=I.Da.g.parse(T),T=0;T<se.length;T++){let _t=se[T];if(I.T=_t[0],_t=_t[1],I.G==2)if(_t[0]=="c"){I.K=_t[1],I.ia=_t[2];const Or=_t[3];Or!=null&&(I.la=Or,I.j.info("VER="+I.la));const pr=_t[4];pr!=null&&(I.Aa=pr,I.j.info("SVER="+I.Aa));const si=_t[5];si!=null&&typeof si=="number"&&0<si&&(j=1.5*si,I.L=j,I.j.info("backChannelRequestTimeoutMs_="+j)),j=I;const Kn=p.g;if(Kn){const po=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(po){var me=j.h;me.g||po.indexOf("spdy")==-1&&po.indexOf("quic")==-1&&po.indexOf("h2")==-1||(me.j=me.l,me.g=new Set,me.h&&(Tc(me,me.h),me.h=null))}if(j.D){const dl=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;dl&&(j.ya=dl,Mt(j.I,j.D,dl))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-p.F,I.j.info("Handshake RTT: "+I.R+"ms")),j=I;var Me=p;if(j.qa=bf(j,j.J?j.ia:null,j.W),Me.K){yf(j.h,Me);var Nt=Me,Sr=j.L;Sr&&(Nt.I=Sr),Nt.B&&(It(Nt),Fe(Nt)),j.g=Me}else ho(j);0<I.i.length&&Qi(I)}else _t[0]!="stop"&&_t[0]!="close"||Ca(I,7);else I.G==3&&(_t[0]=="stop"||_t[0]=="close"?_t[0]=="stop"?Ca(I,7):$r(I):_t[0]!="noop"&&I.l&&I.l.ta(_t),I.v=0)}}Ei(4)}catch{}}var Ki=class{constructor(p,T){this.g=p,this.map=T}};function zn(p){this.l=p||10,c.PerformanceNavigationTiming?(p=c.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sr(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function as(p){return p.h?1:p.g?p.g.size:0}function zt(p,T){return p.h?p.h==T:p.g?p.g.has(T):!1}function Tc(p,T){p.g?p.g.add(T):p.h=T}function yf(p,T){p.h&&p.h==T?p.h=null:p.g&&p.g.has(T)&&p.g.delete(T)}zn.prototype.cancel=function(){if(this.i=Ef(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Ef(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let T=p.i;for(const I of p.g.values())T=T.concat(I.D);return T}return y(p.i)}function tl(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(u(p)){for(var T=[],I=p.length,j=0;j<I;j++)T.push(p[j]);return T}T=[],I=0;for(j in p)T[I++]=p[j];return T}function rl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(u(p)||typeof p=="string"){var T=[];p=p.length;for(var I=0;I<p;I++)T.push(I);return T}T=[],I=0;for(const j in p)T[I++]=j;return T}}}function ss(p,T){if(p.forEach&&typeof p.forEach=="function")p.forEach(T,void 0);else if(u(p)||typeof p=="string")Array.prototype.forEach.call(p,T,void 0);else for(var I=rl(p),j=tl(p),se=j.length,me=0;me<se;me++)T.call(void 0,j[me],I&&I[me],p)}var lo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fd(p,T){if(p){p=p.split("&");for(var I=0;I<p.length;I++){var j=p[I].indexOf("="),se=null;if(0<=j){var me=p[I].substring(0,j);se=p[I].substring(j+1)}else me=p[I];T(me,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function Ta(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Ta){this.h=p.h,co(this,p.j),this.o=p.o,this.g=p.g,os(this,p.s),this.l=p.l;var T=p.i,I=new qi;I.i=T.i,T.g&&(I.g=new Map(T.g),I.h=T.h),ls(this,I),this.m=p.m}else p&&(T=String(p).match(lo))?(this.h=!1,co(this,T[1]||"",!0),this.o=gt(T[2]||""),this.g=gt(T[3]||"",!0),os(this,T[4]),this.l=gt(T[5]||"",!0),ls(this,T[6]||"",!0),this.m=gt(T[7]||"")):(this.h=!1,this.i=new qi(null,this.h))}Ta.prototype.toString=function(){var p=[],T=this.j;T&&p.push(us(T,nl,!0),":");var I=this.g;return(I||T=="file")&&(p.push("//"),(T=this.o)&&p.push(us(T,nl,!0),"@"),p.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.s,I!=null&&p.push(":",String(I))),(I=this.l)&&(this.g&&I.charAt(0)!="/"&&p.push("/"),p.push(us(I,I.charAt(0)=="/"?Sf:Tf,!0))),(I=this.i.toString())&&p.push("?",I),(I=this.m)&&p.push("#",us(I,Sc)),p.join("")};function Wn(p){return new Ta(p)}function co(p,T,I){p.j=I?gt(T,!0):T,p.j&&(p.j=p.j.replace(/:$/,""))}function os(p,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);p.s=T}else p.s=null}function ls(p,T,I){T instanceof qi?(p.i=T,Xi(p.i,p.h)):(I||(T=us(T,kf)),p.i=new qi(T,p.h))}function Mt(p,T,I){p.i.set(T,I)}function cs(p){return Mt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function gt(p,T){return p?T?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function us(p,T,I){return typeof p=="string"?(p=encodeURI(p).replace(T,wf),I&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function wf(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var nl=/[#\/\?@]/g,Tf=/[#\?:]/g,Sf=/[#\?]/g,kf=/[#\?@]/g,Sc=/#/g;function qi(p,T){this.h=this.g=null,this.i=p||null,this.j=!!T}function jr(p){p.g||(p.g=new Map,p.h=0,p.i&&Fd(p.i,function(T,I){p.add(decodeURIComponent(T.replace(/\+/g," ")),I)}))}t=qi.prototype,t.add=function(p,T){jr(this),this.i=null,p=ai(this,p);var I=this.g.get(p);return I||this.g.set(p,I=[]),I.push(T),this.h+=1,this};function Ti(p,T){jr(p),T=ai(p,T),p.g.has(T)&&(p.i=null,p.h-=p.g.get(T).length,p.g.delete(T))}function Si(p,T){return jr(p),T=ai(p,T),p.g.has(T)}t.forEach=function(p,T){jr(this),this.g.forEach(function(I,j){I.forEach(function(se){p.call(T,se,j,this)},this)},this)},t.na=function(){jr(this);const p=Array.from(this.g.values()),T=Array.from(this.g.keys()),I=[];for(let j=0;j<T.length;j++){const se=p[j];for(let me=0;me<se.length;me++)I.push(T[j])}return I},t.V=function(p){jr(this);let T=[];if(typeof p=="string")Si(this,p)&&(T=T.concat(this.g.get(ai(this,p))));else{p=Array.from(this.g.values());for(let I=0;I<p.length;I++)T=T.concat(p[I])}return T},t.set=function(p,T){return jr(this),this.i=null,p=ai(this,p),Si(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[T]),this.h+=1,this},t.get=function(p,T){return p?(p=this.V(p),0<p.length?String(p[0]):T):T};function fs(p,T,I){Ti(p,T),0<I.length&&(p.i=null,p.g.set(ai(p,T),y(I)),p.h+=I.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],T=Array.from(this.g.keys());for(var I=0;I<T.length;I++){var j=T[I];const me=encodeURIComponent(String(j)),Me=this.V(j);for(j=0;j<Me.length;j++){var se=me;Me[j]!==""&&(se+="="+encodeURIComponent(String(Me[j]))),p.push(se)}}return this.i=p.join("&")};function ai(p,T){return T=String(T),p.j&&(T=T.toLowerCase()),T}function Xi(p,T){T&&!p.j&&(jr(p),p.i=null,p.g.forEach(function(I,j){var se=j.toLowerCase();j!=se&&(Ti(this,j),fs(this,se,I))},p)),p.j=T}function bd(p,T){const I=new Ea;if(c.Image){const j=new Image;j.onload=_(Pn,I,"TestLoadImage: loaded",!0,T,j),j.onerror=_(Pn,I,"TestLoadImage: error",!1,T,j),j.onabort=_(Pn,I,"TestLoadImage: abort",!1,T,j),j.ontimeout=_(Pn,I,"TestLoadImage: timeout",!1,T,j),c.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=p}else T(!1)}function Af(p,T){const I=new Ea,j=new AbortController,se=setTimeout(()=>{j.abort(),Pn(I,"TestPingServer: timeout",!1,T)},1e4);fetch(p,{signal:j.signal}).then(me=>{clearTimeout(se),me.ok?Pn(I,"TestPingServer: ok",!0,T):Pn(I,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(se),Pn(I,"TestPingServer: error",!1,T)})}function Pn(p,T,I,j,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),j(I)}catch{}}function Od(){this.g=new io}function Cf(p,T,I){const j=I||"";try{ss(p,function(se,me){let Me=se;h(se)&&(Me=rs(se)),T.push(j+me+"="+encodeURIComponent(Me))})}catch(se){throw T.push(j+"type="+encodeURIComponent("_badmap")),se}}function Sa(p){this.l=p.Ub||null,this.j=p.eb||!1}E(Sa,Gi),Sa.prototype.g=function(){return new uo(this.l,this.j)},Sa.prototype.i=function(p){return function(){return p}}({});function uo(p,T){Lt.call(this),this.D=p,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(uo,Lt),t=uo.prototype,t.open=function(p,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=T,this.readyState=1,Ai(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(T.body=p),(this.D||c).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ki(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ai(this)),this.g&&(this.readyState=3,Ai(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;If(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function If(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var T=p.value?p.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!p.done}))&&(this.response=this.responseText+=T)}p.done?ki(this):Ai(this),this.readyState==3&&If(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,ki(this))},t.Qa=function(p){this.g&&(this.response=p,ki(this))},t.ga=function(){this.g&&ki(this)};function ki(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Ai(p)}t.setRequestHeader=function(p,T){this.u.append(p,T)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],T=this.h.entries();for(var I=T.next();!I.done;)I=I.value,p.push(I[0]+": "+I[1]),I=T.next();return p.join(`\r
`)};function Ai(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(uo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function ka(p){let T="";return z(p,function(I,j){T+=j,T+=":",T+=I,T+=`\r
`}),T}function hs(p,T,I){e:{for(j in I){var j=!1;break e}j=!0}j||(I=ka(I),typeof p=="string"?I!=null&&encodeURIComponent(String(I)):Mt(p,T,I))}function qt(p){Lt.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(qt,Lt);var Dd=/^https?$/i,kc=["POST","PUT"];t=qt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,T,I,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);T=T?T.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?xa(this.o):xa(X),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(T,String(p),!0),this.B=!1}catch(me){fo(this,me);return}if(p=I||"",I=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var se in j)I.set(se,j[se]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const me of j.keys())I.set(me,j.get(me));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(I.keys()).find(me=>me.toLowerCase()=="content-type"),se=c.FormData&&p instanceof c.FormData,!(0<=Array.prototype.indexOf.call(kc,T,void 0))||j||se||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[me,Me]of I)this.g.setRequestHeader(me,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{al(this),this.u=!0,this.g.send(p),this.u=!1}catch(me){fo(this,me)}};function fo(p,T){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=T,p.m=5,il(p),Gn(p)}function il(p){p.A||(p.A=!0,jt(p,"complete"),jt(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,jt(this,"complete"),jt(this,"abort"),Gn(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gn(this,!0)),qt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ac(this):this.bb())},t.bb=function(){Ac(this)};function Ac(p){if(p.h&&typeof o<"u"&&(!p.v[1]||Fn(p)!=4||p.Z()!=2)){if(p.u&&Fn(p)==4)Jr(p.Ea,0,p);else if(jt(p,"readystatechange"),Fn(p)==4){p.h=!1;try{const Me=p.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var I;if(!(I=T)){var j;if(j=Me===0){var se=String(p.D).match(lo)[1]||null;!se&&c.self&&c.self.location&&(se=c.self.location.protocol.slice(0,-1)),j=!Dd.test(se?se.toLowerCase():"")}I=j}if(I)jt(p,"complete"),jt(p,"success");else{p.m=6;try{var me=2<Fn(p)?p.g.statusText:""}catch{me=""}p.l=me+" ["+p.Z()+"]",il(p)}}finally{Gn(p)}}}}function Gn(p,T){if(p.g){al(p);const I=p.g,j=p.v[0]?()=>{}:null;p.g=null,p.v=null,T||jt(p,"ready");try{I.onreadystatechange=j}catch{}}}function al(p){p.I&&(c.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Fn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Fn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var T=this.g.responseText;return p&&T.indexOf(p)==0&&(T=T.substring(p.length)),no(T)}};function Cc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function sl(p){const T={};p=(p.g&&2<=Fn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<p.length;j++){if(F(p[j]))continue;var I=L(p[j]);const se=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const me=T[se]||[];T[se]=me,me.push(I)}A(T,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(p,T,I){return I&&I.internalChannelParams&&I.internalChannelParams[p]||T}function Ic(p){this.Aa=0,this.i=[],this.j=new Ea,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yi("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yi("baseRetryDelayMs",5e3,p),this.cb=Yi("retryDelaySeedMs",1e4,p),this.Wa=Yi("forwardChannelMaxRetries",2,p),this.wa=Yi("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new zn(p&&p.concurrentRequestLimit),this.Da=new Od,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ic.prototype,t.la=8,t.G=1,t.connect=function(p,T,I,j){Jt(0),this.W=p,this.H=T||{},I&&j!==void 0&&(this.H.OSID=I,this.H.OAID=j),this.F=this.X,this.I=bf(this,null,this.W),Qi(this)};function $r(p){if(ol(p),p.G==3){var T=p.U++,I=Wn(p.I);if(Mt(I,"SID",p.K),Mt(I,"RID",T),Mt(I,"TYPE","terminate"),Aa(p,I),T=new ge(p,p.j,T),T.L=2,T.v=cs(Wn(I)),I=!1,c.navigator&&c.navigator.sendBeacon)try{I=c.navigator.sendBeacon(T.v.toString(),"")}catch{}!I&&c.Image&&(new Image().src=T.v,I=!0),I||(T.g=Of(T.j,null),T.g.ea(T.v)),T.F=Date.now(),Fe(T)}Ff(p)}function Ci(p){p.g&&(Rc(p),p.g.cancel(),p.g=null)}function ol(p){Ci(p),p.u&&(c.clearTimeout(p.u),p.u=null),ul(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&c.clearTimeout(p.s),p.s=null)}function Qi(p){if(!sr(p.h)&&!p.s){p.s=!0;var T=p.Ga;Ae||xe(),Ee||(Ae(),Ee=!0),ie.add(T,p),p.B=0}}function Nd(p,T){return as(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=T.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=xn(v(p.Ga,p,T),Pf(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const se=new ge(this,this.j,p);let me=this.o;if(this.S&&(me?(me=P(me),M(me,this.S)):me=this.S),this.m!==null||this.O||(se.H=me,me=null),this.P)e:{for(var T=0,I=0;I<this.i.length;I++){t:{var j=this.i[I];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(T+=j,4096<T){T=I;break e}if(T===4096||I===this.i.length-1){T=I+1;break e}}T=1e3}else T=1e3;T=ds(this,se,T),I=Wn(this.I),Mt(I,"RID",p),Mt(I,"CVER",22),this.D&&Mt(I,"X-HTTP-Session-Id",this.D),Aa(this,I),me&&(this.O?T="headers="+encodeURIComponent(String(ka(me)))+"&"+T:this.m&&hs(I,this.m,me)),Tc(this.h,se),this.Ua&&Mt(I,"TYPE","init"),this.P?(Mt(I,"$req",T),Mt(I,"SID","null"),se.T=!0,Pe(se,I,null)):Pe(se,I,T),this.G=2}}else this.G==3&&(p?ll(this,p):this.i.length==0||sr(this.h)||ll(this))};function ll(p,T){var I;T?I=T.l:I=p.U++;const j=Wn(p.I);Mt(j,"SID",p.K),Mt(j,"RID",I),Mt(j,"AID",p.T),Aa(p,j),p.m&&p.o&&hs(j,p.m,p.o),I=new ge(p,p.j,I,p.B+1),p.m===null&&(I.H=p.o),T&&(p.i=T.D.concat(p.i)),T=ds(p,I,1e3),I.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Tc(p.h,I),Pe(I,j,T)}function Aa(p,T){p.H&&z(p.H,function(I,j){Mt(T,j,I)}),p.l&&ss({},function(I,j){Mt(T,j,I)})}function ds(p,T,I){I=Math.min(p.i.length,I);var j=p.l?v(p.l.Na,p.l,p):null;e:{var se=p.i;let me=-1;for(;;){const Me=["count="+I];me==-1?0<I?(me=se[0].g,Me.push("ofs="+me)):me=0:Me.push("ofs="+me);let Nt=!0;for(let Sr=0;Sr<I;Sr++){let _t=se[Sr].g;const Or=se[Sr].map;if(_t-=me,0>_t)me=Math.max(0,se[Sr].g-100),Nt=!1;else try{Cf(Or,Me,"req"+_t+"_")}catch{j&&j(Or)}}if(Nt){j=Me.join("&");break e}}}return p=p.i.splice(0,I),T.D=p,j}function ho(p){if(!p.g&&!p.u){p.Y=1;var T=p.Fa;Ae||xe(),Ee||(Ae(),Ee=!0),ie.add(T,p),p.v=0}}function cl(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=xn(v(p.Fa,p),Pf(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Rf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=xn(v(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Jt(10),Ci(this),Rf(this))};function Rc(p){p.A!=null&&(c.clearTimeout(p.A),p.A=null)}function Rf(p){p.g=new ge(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var T=Wn(p.qa);Mt(T,"RID","rpc"),Mt(T,"SID",p.K),Mt(T,"AID",p.T),Mt(T,"CI",p.F?"0":"1"),!p.F&&p.ja&&Mt(T,"TO",p.ja),Mt(T,"TYPE","xmlhttp"),Aa(p,T),p.m&&p.o&&hs(T,p.m,p.o),p.L&&(p.g.I=p.L);var I=p.g;p=p.ia,I.L=1,I.v=cs(Wn(T)),I.m=null,I.P=!0,Le(I,p)}t.Za=function(){this.C!=null&&(this.C=null,Ci(this),cl(this),Jt(19))};function ul(p){p.C!=null&&(c.clearTimeout(p.C),p.C=null)}function fl(p,T){var I=null;if(p.g==T){ul(p),Rc(p),p.g=null;var j=2}else if(zt(p.h,T))I=T.D,yf(p.h,T),j=1;else return;if(p.G!=0){if(T.o)if(j==1){I=T.m?T.m.length:0,T=Date.now()-T.F;var se=p.B;j=ya(),jt(j,new ns(j,I)),Qi(p)}else ho(p);else if(se=T.s,se==3||se==0&&0<T.X||!(j==1&&Nd(p,T)||j==2&&cl(p)))switch(I&&0<I.length&&(T=p.h,T.i=T.i.concat(I)),se){case 1:Ca(p,5);break;case 4:Ca(p,10);break;case 3:Ca(p,6);break;default:Ca(p,2)}}}function Pf(p,T){let I=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(I*=2),I*T}function Ca(p,T){if(p.j.info("Error code "+T),T==2){var I=v(p.fb,p),j=p.Xa;const se=!j;j=new Ta(j||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||co(j,"https"),cs(j),se?bd(j.toString(),I):Af(j.toString(),I)}else Jt(2);p.G=0,p.l&&p.l.sa(T),Ff(p),ol(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))};function Ff(p){if(p.G=0,p.ka=[],p.l){const T=Ef(p.h);(T.length!=0||p.i.length!=0)&&(w(p.ka,T),w(p.ka,p.i),p.h.i.length=0,y(p.i),p.i.length=0),p.l.ra()}}function bf(p,T,I){var j=I instanceof Ta?Wn(I):new Ta(I);if(j.g!="")T&&(j.g=T+"."+j.g),os(j,j.s);else{var se=c.location;j=se.protocol,T=T?T+"."+se.hostname:se.hostname,se=+se.port;var me=new Ta(null);j&&co(me,j),T&&(me.g=T),se&&os(me,se),I&&(me.l=I),j=me}return I=p.D,T=p.ya,I&&T&&Mt(j,I,T),Mt(j,"VER",p.la),Aa(p,j),j}function Of(p,T,I){if(T&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=p.Ca&&!p.pa?new qt(new Sa({eb:I})):new qt(p.pa),T.Ha(p.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pc(){}t=Pc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function hl(){}hl.prototype.g=function(p,T){return new _n(p,T)};function _n(p,T){Lt.call(this),this.g=new Ic(T),this.l=p,this.h=T&&T.messageUrlParams||null,p=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(p?p["X-WebChannel-Content-Type"]=T.messageContentType:p={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(p?p["X-WebChannel-Client-Profile"]=T.va:p={"X-WebChannel-Client-Profile":T.va}),this.g.S=p,(p=T&&T.Sb)&&!F(p)&&(this.g.m=p),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!F(T)&&(this.g.D=T,p=this.h,p!==null&&T in p&&(p=this.h,T in p&&delete p[T])),this.j=new Ji(this)}E(_n,Lt),_n.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){$r(this.g)},_n.prototype.o=function(p){var T=this.g;if(typeof p=="string"){var I={};I.__data__=p,p=I}else this.u&&(I={},I.__data__=rs(p),p=I);T.i.push(new Ki(T.Ya++,p)),T.G==3&&Qi(T)},_n.prototype.N=function(){this.g.l=null,delete this.j,$r(this.g),delete this.g,_n.aa.N.call(this)};function Df(p){ni.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var T=p.__sm__;if(T){e:{for(const I in T){p=I;break e}p=void 0}(this.i=p)&&(p=this.i,T=T!==null&&p in T?T[p]:void 0),this.data=T}else this.data=p}E(Df,ni);function Nf(){yi.call(this),this.status=1}E(Nf,yi);function Ji(p){this.g=p}E(Ji,Pc),Ji.prototype.ua=function(){jt(this.g,"a")},Ji.prototype.ta=function(p){jt(this.g,new Df(p))},Ji.prototype.sa=function(p){jt(this.g,new Nf)},Ji.prototype.ra=function(){jt(this.g,"b")},hl.prototype.createWebChannel=hl.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,n2=function(){return new hl},r2=function(){return ya()},t2=ii,Xm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},W.NO_ERROR=0,W.TIMEOUT=8,W.HTTP_ERROR=6,r0=W,q.COMPLETE="complete",e2=q,_a.EventType=Rn,Rn.OPEN="a",Rn.CLOSE="b",Rn.ERROR="c",Rn.MESSAGE="d",Lt.prototype.listen=Lt.prototype.K,au=_a,qt.prototype.listenOnce=qt.prototype.L,qt.prototype.getLastError=qt.prototype.Ka,qt.prototype.getLastErrorCode=qt.prototype.Ba,qt.prototype.getStatus=qt.prototype.Z,qt.prototype.getResponseJson=qt.prototype.Oa,qt.prototype.getResponseText=qt.prototype.oa,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Ha,ZT=qt}).apply(typeof Fh<"u"?Fh:typeof self<"u"?self:typeof window<"u"?window:{});const my="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}on.UNAUTHENTICATED=new on(null),on.GOOGLE_CREDENTIALS=new on("google-credentials-uid"),on.FIRST_PARTY=new on("first-party-uid"),on.MOCK_USER=new on("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pc="11.0.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo=new Bg("@firebase/firestore");function Ll(){return Vo.logLevel}function je(t,...e){if(Vo.logLevel<=pt.DEBUG){const r=e.map(Qg);Vo.debug(`Firestore (${pc}): ${t}`,...r)}}function qa(t,...e){if(Vo.logLevel<=pt.ERROR){const r=e.map(Qg);Vo.error(`Firestore (${pc}): ${t}`,...r)}}function Jl(t,...e){if(Vo.logLevel<=pt.WARN){const r=e.map(Qg);Vo.warn(`Firestore (${pc}): ${t}`,...r)}}function Qg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t="Unexpected state"){const e=`FIRESTORE (${pc}) INTERNAL ASSERTION FAILED: `+t;throw qa(e),new Error(e)}function bt(t,e){t||it()}function lt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Ja{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(on.UNAUTHENTICATED))}shutdown(){}}class Ob{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Db{constructor(e){this.t=e,this.currentUser=on.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){bt(this.o===void 0);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new $a;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new $a,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new $a)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(bt(typeof n.accessToken=="string"),new i2(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string"),new on(e)}}class Nb{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=on.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Lb{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new Nb(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(on.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Mb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Vb{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){bt(this.o===void 0);const n=a=>{a.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.R;return this.R=a.token,je("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(bt(typeof r.token=="string"),this.R=r.token,new Mb(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=Bb(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%e.length))}return n}}function vt(t,e){return t<e?-1:t>e?1:0}function Zl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{static now(){return Rr.fromMillis(Date.now())}static fromDate(e){return Rr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Rr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new $e(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new Rr(0,0))}static max(){return new st(new Rr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,r,n){r===void 0?r=0:r>e.length&&it(),n===void 0?n=e.length-r:n>e.length-r&&it(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=e.get(i),o=r.get(i);if(a<o)return-1;if(a>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Kt extends Fu{construct(e,r,n){return new Kt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Se.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Kt(r)}static emptyPath(){return new Kt([])}}const Ub=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qr extends Fu{construct(e,r,n){return new qr(e,r,n)}static isValidIdentifier(e){return Ub.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new qr(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new $e(Se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new $e(Se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new $e(Se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(n+=c,i++):(a(),i++)}if(a(),o)throw new $e(Se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qr(r)}static emptyPath(){return new qr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Kt.fromString(e))}static fromName(e){return new Xe(Kt.fromString(e).popFirst(5))}static empty(){return new Xe(Kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Kt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Kt(e.slice()))}}function jb(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=st.fromTimestamp(n===1e9?new Rr(r+1,0):new Rr(r,n));return new Ws(i,Xe.empty(),e)}function $b(t){return new Ws(t.readTime,t.key,-1)}class Ws{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ws(st.min(),Xe.empty(),-1)}static max(){return new Ws(st.max(),Xe.empty(),-1)}}function Hb(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Xe.comparator(t.documentKey,e.documentKey),r!==0?r:vt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Wb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(t){if(t.code!==Se.FAILED_PRECONDITION||t.message!==zb)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&it(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ke((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ke?r:ke.resolve(r)}catch(r){return ke.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.reject(r)}static resolve(e){return new ke((r,n)=>{r(e)})}static reject(e){return new ke((r,n)=>{n(e)})}static waitFor(e){return new ke((r,n)=>{let i=0,a=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++a,o&&a===i&&r()},u=>n(u))}),o=!0,a===i&&r()})}static or(e){let r=ke.resolve(!1);for(const n of e)r=r.next(i=>i?ke.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new ke((n,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;r(e[h]).next(d=>{o[h]=d,++c,c===a&&n(o)},d=>i(d))}})}static doWhile(e,r){return new ke((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function Gb(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function gc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}nd.oe=-1;function id(t){return t==null}function y0(t){return t===0&&1/t==-1/0}function Kb(t){return typeof t=="number"&&Number.isInteger(t)&&!y0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=gy(e)),e=Xb(t.get(r),e);return gy(e)}function Xb(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case"":r+="";break;default:r+=a}}return r}function gy(t){return t+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Js(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function s2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,r){this.comparator=e,this.root=r||Wr.EMPTY}insert(e,r){return new tr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Wr.BLACK,null,null))}remove(e){return new tr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bh(this.root,e,this.comparator,!1)}getReverseIterator(){return new bh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bh(this.root,e,this.comparator,!0)}}class bh{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wr{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Wr.RED,this.left=i??Wr.EMPTY,this.right=a??Wr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Wr(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Wr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Wr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw it();const e=this.left.check();if(e!==this.right.check())throw it();return e+(this.isRed()?0:1)}}Wr.EMPTY=null,Wr.RED=!0,Wr.BLACK=!1;Wr.EMPTY=new class{constructor(){this.size=0}get key(){throw it()}get value(){throw it()}get color(){throw it()}get left(){throw it()}get right(){throw it()}copy(e,r,n,i,a){return this}insert(e,r,n){return new Wr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new tr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new xy(this.data.getIterator())}getIteratorFrom(e){return new xy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class xy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.fields=e,e.sort(qr.comparator)}static empty(){return new Zn([])}unionWith(e){let r=new Pr(qr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Zn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Zl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new o2("Invalid base64 string: "+a):a}}(e);return new Qr(r)}static fromUint8Array(e){const r=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new Qr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qr.EMPTY_BYTE_STRING=new Qr("");const Yb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gs(t){if(bt(!!t),typeof t=="string"){let e=0;const r=Yb.exec(t);if(bt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:cr(t.seconds),nanos:cr(t.nanos)}}function cr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function ad(t){const e=t.mapValue.fields.__previous_value__;return Jg(e)?ad(e):e}function bu(t){const e=Gs(t.mapValue.fields.__local_write_time__.timestampValue);return new Rr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,r,n,i,a,o,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h}}class Ou{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ou("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ou&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function qs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Jg(t)?4:Zb(t)?9007199254740991:Jb(t)?10:11:it()}function da(t,e){if(t===e)return!0;const r=qs(t);if(r!==qs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return bu(t).isEqual(bu(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=Gs(i.timestampValue),c=Gs(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Ks(i.bytesValue).isEqual(Ks(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return cr(i.geoPointValue.latitude)===cr(a.geoPointValue.latitude)&&cr(i.geoPointValue.longitude)===cr(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return cr(i.integerValue)===cr(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=cr(i.doubleValue),c=cr(a.doubleValue);return o===c?y0(o)===y0(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Zl(t.arrayValue.values||[],e.arrayValue.values||[],da);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(vy(o)!==vy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!da(o[u],c[u])))return!1;return!0}(t,e);default:return it()}}function Du(t,e){return(t.values||[]).find(r=>da(r,e))!==void 0}function ec(t,e){if(t===e)return 0;const r=qs(t),n=qs(e);if(r!==n)return vt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return vt(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=cr(a.integerValue||a.doubleValue),u=cr(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return _y(t.timestampValue,e.timestampValue);case 4:return _y(bu(t),bu(e));case 5:return vt(t.stringValue,e.stringValue);case 6:return function(a,o){const c=Ks(a),u=Ks(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const d=vt(c[h],u[h]);if(d!==0)return d}return vt(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=vt(cr(a.latitude),cr(o.latitude));return c!==0?c:vt(cr(a.longitude),cr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return yy(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,h,d;const g=a.fields||{},v=o.fields||{},_=(c=g.value)===null||c===void 0?void 0:c.arrayValue,E=(u=v.value)===null||u===void 0?void 0:u.arrayValue,y=vt(((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return y!==0?y:yy(_,E)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===Oh.mapValue&&o===Oh.mapValue)return 0;if(a===Oh.mapValue)return 1;if(o===Oh.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const v=vt(u[g],d[g]);if(v!==0)return v;const _=ec(c[u[g]],h[d[g]]);if(_!==0)return _}return vt(u.length,d.length)}(t.mapValue,e.mapValue);default:throw it()}}function _y(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return vt(t,e);const r=Gs(t),n=Gs(e),i=vt(r.seconds,n.seconds);return i!==0?i:vt(r.nanos,n.nanos)}function yy(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=ec(r[i],n[i]);if(a)return a}return vt(r.length,n.length)}function tc(t){return Ym(t)}function Ym(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Gs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ks(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Xe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=Ym(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const o of n)a?a=!1:i+=",",i+=`${o}:${Ym(r.fields[o])}`;return i+"}"}(t.mapValue):it()}function n0(t){switch(qs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ad(t);return e?16+n0(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+n0(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Js(n.fields,(a,o)=>{i+=a.length+n0(o)}),i}(t.mapValue);default:throw it()}}function Ey(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Qm(t){return!!t&&"integerValue"in t}function Zg(t){return!!t&&"arrayValue"in t}function wy(t){return!!t&&"nullValue"in t}function Ty(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function i0(t){return!!t&&"mapValue"in t}function Jb(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function mu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Js(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=mu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=mu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Zb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.value=e}static empty(){return new jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!i0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(r)}setAll(e){let r=qr.emptyPath(),n={},i=[];e.forEach((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}o?n[c.lastSegment()]=mu(o):i.push(c.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());i0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return da(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];i0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Js(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new jn(mu(this.value))}}function l2(t){const e=[];return Js(t.fields,(r,n)=>{const i=new qr([r]);if(i0(n)){const a=l2(n.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new Zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,r,n,i,a,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new cn(e,0,st.min(),st.min(),st.min(),jn.empty(),0)}static newFoundDocument(e,r,n,i){return new cn(e,1,r,st.min(),n,i,0)}static newNoDocument(e,r){return new cn(e,2,r,st.min(),st.min(),jn.empty(),0)}static newUnknownDocument(e,r){return new cn(e,3,r,st.min(),st.min(),jn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,r){this.position=e,this.inclusive=r}}function Sy(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?n=Xe.comparator(Xe.fromName(o.referenceValue),r.key):n=ec(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function ky(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!da(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,r="asc"){this.field=e,this.dir=r}}function eO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{}class Er extends c2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new rO(e,r,n):r==="array-contains"?new aO(e,n):r==="in"?new sO(e,n):r==="not-in"?new oO(e,n):r==="array-contains-any"?new lO(e,n):new Er(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new nO(e,n):new iO(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ec(r,this.value)):r!==null&&qs(this.value)===qs(r)&&this.matchesComparison(ec(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $i extends c2{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new $i(e,r)}matches(e){return u2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function u2(t){return t.op==="and"}function f2(t){return tO(t)&&u2(t)}function tO(t){for(const e of t.filters)if(e instanceof $i)return!1;return!0}function Jm(t){if(t instanceof Er)return t.field.canonicalString()+t.op.toString()+tc(t.value);if(f2(t))return t.filters.map(e=>Jm(e)).join(",");{const e=t.filters.map(r=>Jm(r)).join(",");return`${t.op}(${e})`}}function h2(t,e){return t instanceof Er?function(n,i){return i instanceof Er&&n.op===i.op&&n.field.isEqual(i.field)&&da(n.value,i.value)}(t,e):t instanceof $i?function(n,i){return i instanceof $i&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,o,c)=>a&&h2(o,i.filters[c]),!0):!1}(t,e):void it()}function d2(t){return t instanceof Er?function(r){return`${r.field.canonicalString()} ${r.op} ${tc(r.value)}`}(t):t instanceof $i?function(r){return r.op.toString()+" {"+r.getFilters().map(d2).join(" ,")+"}"}(t):"Filter"}class rO extends Er{constructor(e,r,n){super(e,r,n),this.key=Xe.fromName(n.referenceValue)}matches(e){const r=Xe.comparator(e.key,this.key);return this.matchesComparison(r)}}class nO extends Er{constructor(e,r){super(e,"in",r),this.keys=p2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class iO extends Er{constructor(e,r){super(e,"not-in",r),this.keys=p2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function p2(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Xe.fromName(n.referenceValue))}class aO extends Er{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Zg(r)&&Du(r.arrayValue,this.value)}}class sO extends Er{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Du(this.value.arrayValue,r)}}class oO extends Er{constructor(e,r){super(e,"not-in",r)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Du(this.value.arrayValue,r)}}class lO extends Er{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Zg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Du(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,r=null,n=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.ue=null}}function Ay(t,e=null,r=[],n=[],i=null,a=null,o=null){return new cO(t,e,r,n,i,a,o)}function e1(t){const e=lt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Jm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),id(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>tc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>tc(n)).join(",")),e.ue=r}return e.ue}function t1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!eO(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!h2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ky(t.startAt,e.startAt)&&ky(t.endAt,e.endAt)}function Zm(t){return Xe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,r=null,n=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function uO(t,e,r,n,i,a,o,c){return new rf(t,e,r,n,i,a,o,c)}function r1(t){return new rf(t)}function Cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function m2(t){return t.collectionGroup!==null}function gu(t){const e=lt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Pr(qr.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new w0(a,n))}),r.has(qr.keyField().canonicalString())||e.ce.push(new w0(qr.keyField(),n))}return e.ce}function ca(t){const e=lt(t);return e.le||(e.le=fO(e,gu(t))),e.le}function fO(t,e){if(t.limitType==="F")return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new w0(i.field,a)});const r=t.endAt?new E0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new E0(t.startAt.position,t.startAt.inclusive):null;return Ay(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function eg(t,e){const r=t.filters.concat([e]);return new rf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function tg(t,e,r){return new rf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function sd(t,e){return t1(ca(t),ca(e))&&t.limitType===e.limitType}function g2(t){return`${e1(ca(t))}|lt:${t.limitType}`}function Ml(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>d2(i)).join(", ")}]`),id(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>tc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>tc(i)).join(",")),`Target(${n})`}(ca(t))}; limitType=${t.limitType})`}function od(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Xe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of gu(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(o,c,u){const h=Sy(o,c,u);return o.inclusive?h<=0:h<0}(n.startAt,gu(n),i)||n.endAt&&!function(o,c,u){const h=Sy(o,c,u);return o.inclusive?h>=0:h>0}(n.endAt,gu(n),i))}(t,e)}function hO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function v2(t){return(e,r)=>{let n=!1;for(const i of gu(t)){const a=dO(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function dO(t,e,r){const n=t.field.isKeyField()?Xe.comparator(e.key,r.key):function(a,o,c){const u=o.data.field(a),h=c.data.field(a);return u!==null&&h!==null?ec(u,h):it()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return it()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Js(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return s2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=new tr(Xe.comparator);function Xa(){return pO}const x2=new tr(Xe.comparator);function su(...t){let e=x2;for(const r of t)e=e.insert(r.key,r);return e}function _2(t){let e=x2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Po(){return vu()}function y2(){return vu()}function vu(){return new Go(t=>t.toString(),(t,e)=>t.isEqual(e))}const mO=new tr(Xe.comparator),gO=new Pr(Xe.comparator);function mt(...t){let e=gO;for(const r of t)e=e.add(r);return e}const vO=new Pr(vt);function xO(){return vO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:y0(e)?"-0":e}}function E2(t){return{integerValue:""+t}}function _O(t,e){return Kb(e)?E2(e):n1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(){this._=void 0}}function yO(t,e,r){return t instanceof T0?function(i,a){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Jg(a)&&(a=ad(a)),a&&(o.fields.__previous_value__=a),{mapValue:o}}(r,e):t instanceof rc?T2(t,e):t instanceof nc?S2(t,e):function(i,a){const o=w2(i,a),c=Iy(o)+Iy(i.Pe);return Qm(o)&&Qm(i.Pe)?E2(c):n1(i.serializer,c)}(t,e)}function EO(t,e,r){return t instanceof rc?T2(t,e):t instanceof nc?S2(t,e):r}function w2(t,e){return t instanceof S0?function(n){return Qm(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class T0 extends ld{}class rc extends ld{constructor(e){super(),this.elements=e}}function T2(t,e){const r=k2(e);for(const n of t.elements)r.some(i=>da(i,n))||r.push(n);return{arrayValue:{values:r}}}class nc extends ld{constructor(e){super(),this.elements=e}}function S2(t,e){let r=k2(e);for(const n of t.elements)r=r.filter(i=>!da(i,n));return{arrayValue:{values:r}}}class S0 extends ld{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function Iy(t){return cr(t.integerValue||t.doubleValue)}function k2(t){return Zg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A2{constructor(e,r){this.field=e,this.transform=r}}function wO(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof rc&&i instanceof rc||n instanceof nc&&i instanceof nc?Zl(n.elements,i.elements,da):n instanceof S0&&i instanceof S0?da(n.Pe,i.Pe):n instanceof T0&&i instanceof T0}(t.transform,e.transform)}class TO{constructor(e,r){this.version=e,this.transformResults=r}}class kn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new kn}static exists(e){return new kn(void 0,e)}static updateTime(e){return new kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function a0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cd{}function C2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ud(t.key,kn.none()):new nf(t.key,t.data,kn.none());{const r=t.data,n=jn.empty();let i=new Pr(qr.comparator);for(let a of e.fields)if(!i.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),i=i.add(a)}return new Zs(t.key,n,new Zn(i.toArray()),kn.none())}}function SO(t,e,r){t instanceof nf?function(i,a,o){const c=i.value.clone(),u=Py(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Zs?function(i,a,o){if(!a0(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=Py(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(I2(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function xu(t,e,r,n){return t instanceof nf?function(a,o,c,u){if(!a0(a.precondition,o))return c;const h=a.value.clone(),d=Fy(a.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Zs?function(a,o,c,u){if(!a0(a.precondition,o))return c;const h=Fy(a.fieldTransforms,u,o),d=o.data;return d.setAll(I2(a)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(a,o,c){return a0(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,r)}function kO(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=w2(n.transform,i||null);a!=null&&(r===null&&(r=jn.empty()),r.set(n.field,a))}return r||null}function Ry(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Zl(n,i,(a,o)=>wO(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nf extends cd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zs extends cd{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function I2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Py(t,e,r){const n=new Map;bt(t.length===r.length);for(let i=0;i<r.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);n.set(a.field,EO(o,c,r[i]))}return n}function Fy(t,e,r){const n=new Map;for(const i of t){const a=i.transform,o=r.data.field(i.field);n.set(i.field,yO(a,o,e))}return n}class ud extends cd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AO extends cd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&SO(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=xu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=xu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=y2();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=r.has(i.key)?null:c;const u=C2(o,c);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(st.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),mt())}isEqual(e){return this.batchId===e.batchId&&Zl(this.mutations,e.mutations,(r,n)=>Ry(r,n))&&Zl(this.baseMutations,e.baseMutations,(r,n)=>Ry(r,n))}}class i1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){bt(e.mutations.length===n.length);let i=function(){return mO}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,n[o].version);return new i1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vr,yt;function PO(t){switch(t){default:return it();case Se.CANCELLED:case Se.UNKNOWN:case Se.DEADLINE_EXCEEDED:case Se.RESOURCE_EXHAUSTED:case Se.INTERNAL:case Se.UNAVAILABLE:case Se.UNAUTHENTICATED:return!1;case Se.INVALID_ARGUMENT:case Se.NOT_FOUND:case Se.ALREADY_EXISTS:case Se.PERMISSION_DENIED:case Se.FAILED_PRECONDITION:case Se.ABORTED:case Se.OUT_OF_RANGE:case Se.UNIMPLEMENTED:case Se.DATA_LOSS:return!0}}function R2(t){if(t===void 0)return qa("GRPC error has no .code"),Se.UNKNOWN;switch(t){case vr.OK:return Se.OK;case vr.CANCELLED:return Se.CANCELLED;case vr.UNKNOWN:return Se.UNKNOWN;case vr.DEADLINE_EXCEEDED:return Se.DEADLINE_EXCEEDED;case vr.RESOURCE_EXHAUSTED:return Se.RESOURCE_EXHAUSTED;case vr.INTERNAL:return Se.INTERNAL;case vr.UNAVAILABLE:return Se.UNAVAILABLE;case vr.UNAUTHENTICATED:return Se.UNAUTHENTICATED;case vr.INVALID_ARGUMENT:return Se.INVALID_ARGUMENT;case vr.NOT_FOUND:return Se.NOT_FOUND;case vr.ALREADY_EXISTS:return Se.ALREADY_EXISTS;case vr.PERMISSION_DENIED:return Se.PERMISSION_DENIED;case vr.FAILED_PRECONDITION:return Se.FAILED_PRECONDITION;case vr.ABORTED:return Se.ABORTED;case vr.OUT_OF_RANGE:return Se.OUT_OF_RANGE;case vr.UNIMPLEMENTED:return Se.UNIMPLEMENTED;case vr.DATA_LOSS:return Se.DATA_LOSS;default:return it()}}(yt=vr||(vr={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=new bo([4294967295,4294967295],0);function by(t){const e=FO().encode(t),r=new JT;return r.update(e),new Uint8Array(r.digest())}function Oy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new bo([r,n],0),new bo([i,a],0)]}class a1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ou(`Invalid padding: ${r}`);if(n<0)throw new ou(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ou(`Invalid padding when bitmap length is 0: ${r}`);this.Te=8*e.length-r,this.Ie=bo.fromNumber(this.Te)}Ee(e,r,n){let i=e.add(r.multiply(bo.fromNumber(n)));return i.compare(bO)===1&&(i=new bo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;const r=by(e),[n,i]=Oy(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);if(!this.de(o))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new a1(a,i,r);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.Te===0)return;const r=by(e),[n,i]=Oy(r);for(let a=0;a<this.hashCount;a++){const o=this.Ee(n,i,a);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,af.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new fd(st.min(),i,new tr(vt),Xa(),mt())}}class af{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new af(n,r,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class P2{constructor(e,r){this.targetId=e,this.me=r}}class F2{constructor(e,r,n=Qr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Dy{constructor(){this.fe=0,this.ge=Ny(),this.pe=Qr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=mt(),r=mt(),n=mt();return this.ge.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:it()}}),new af(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Ny()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,bt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class OO{constructor(e){this.Le=e,this.Be=new Map,this.ke=Xa(),this.qe=Dh(),this.Qe=Dh(),this.Ke=new tr(vt)}$e(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(r,e.Ve):this.We(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.We(r,e.key,e.Ve)}Ge(e){this.forEachTarget(e,r=>{const n=this.ze(r);switch(e.state){case 0:this.je(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.je(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.je(r)&&(this.He(r),n.De(e.resumeToken));break;default:it()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.je(i)&&r(i)})}Je(e){const r=e.targetId,n=e.me.count,i=this.Ye(r);if(i){const a=i.target;if(Zm(a))if(n===0){const o=new Xe(a.path);this.We(r,o,cn.newNoDocument(o,st.min()))}else bt(n===1);else{const o=this.Ze(r);if(o!==n){const c=this.Xe(e),u=c?this.et(c,e,o):1;if(u!==0){this.He(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,h)}}}}}Xe(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let o,c;try{o=Ks(n).toUint8Array()}catch(u){if(u instanceof o2)return Jl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new a1(o,i,a)}catch(u){return Jl(u instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Te===0?null:c}et(e,r,n){return r.me.count===n-this.rt(e,r.targetId)?0:2}rt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const o=this.Le.nt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.We(r,a,null),i++)}),i}it(e){const r=new Map;this.Be.forEach((a,o)=>{const c=this.Ye(o);if(c){if(a.current&&Zm(c.target)){const u=new Xe(c.target.path);this.st(u).has(o)||this.ot(o,u)||this.We(o,u,cn.newNoDocument(u,e))}a.be&&(r.set(o,a.ve()),a.Ce())}});let n=mt();this.Qe.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Ye(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.ke.forEach((a,o)=>o.setReadTime(e));const i=new fd(e,r,this.Ke,this.ke,n);return this.ke=Xa(),this.qe=Dh(),this.Qe=Dh(),this.Ke=new tr(vt),i}Ue(e,r){if(!this.je(e))return;const n=this.ot(e,r.key)?2:0;this.ze(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e)),this.Qe=this.Qe.insert(r.key,this._t(r.key).add(e))}We(e,r,n){if(!this.je(e))return;const i=this.ze(e);this.ot(e,r)?i.Fe(r,1):i.Me(r),this.Qe=this.Qe.insert(r,this._t(r).delete(e)),this.Qe=this.Qe.insert(r,this._t(r).add(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ze(e){const r=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let r=this.Be.get(e);return r||(r=new Dy,this.Be.set(e,r)),r}_t(e){let r=this.Qe.get(e);return r||(r=new Pr(vt),this.Qe=this.Qe.insert(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Pr(vt),this.qe=this.qe.insert(e,r)),r}je(e){const r=this.Ye(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}Ye(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new Dy),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.We(e,r,null)})}ot(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Dh(){return new tr(Xe.comparator)}function Ny(){return new tr(Xe.comparator)}const DO={asc:"ASCENDING",desc:"DESCENDING"},NO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LO={and:"AND",or:"OR"};class MO{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function rg(t,e){return t.useProto3Json||id(e)?e:{value:e}}function k0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VO(t,e){return k0(t,e.toTimestamp())}function ua(t){return bt(!!t),st.fromTimestamp(function(r){const n=Gs(r);return new Rr(n.seconds,n.nanos)}(t))}function s1(t,e){return ng(t,e).canonicalString()}function ng(t,e){const r=function(i){return new Kt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function O2(t){const e=Kt.fromString(t);return bt(V2(e)),e}function ig(t,e){return s1(t.databaseId,e.path)}function mm(t,e){const r=O2(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(Se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(Se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Xe(N2(r))}function D2(t,e){return s1(t.databaseId,e)}function BO(t){const e=O2(t);return e.length===4?Kt.emptyPath():N2(e)}function ag(t){return new Kt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function N2(t){return bt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Ly(t,e,r){return{name:ig(t,e),fields:r.value.mapValue.fields}}function UO(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:it()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(h,d){return h.useProto3Json?(bt(d===void 0||typeof d=="string"),Qr.fromBase64String(d||"")):(bt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Qr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const d=h.code===void 0?Se.UNKNOWN:R2(h.code);return new $e(d,h.message||"")}(o);r=new F2(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=mm(t,n.document.name),a=ua(n.document.updateTime),o=n.document.createTime?ua(n.document.createTime):st.min(),c=new jn({mapValue:{fields:n.document.fields}}),u=cn.newFoundDocument(i,a,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new s0(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=mm(t,n.document),a=n.readTime?ua(n.readTime):st.min(),o=cn.newNoDocument(i,a),c=n.removedTargetIds||[];r=new s0([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=mm(t,n.document),a=n.removedTargetIds||[];r=new s0([],a,i,null)}else{if(!("filter"in e))return it();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,o=new RO(i,a),c=n.targetId;r=new P2(c,o)}}return r}function jO(t,e){let r;if(e instanceof nf)r={update:Ly(t,e.key,e.value)};else if(e instanceof ud)r={delete:ig(t,e.key)};else if(e instanceof Zs)r={update:Ly(t,e.key,e.data),updateMask:YO(e.fieldMask)};else{if(!(e instanceof AO))return it();r={verify:ig(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const c=o.transform;if(c instanceof T0)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof rc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof nc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof S0)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw it()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:VO(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:it()}(t,e.precondition)),r}function $O(t,e){return t&&t.length>0?(bt(e!==void 0),t.map(r=>function(i,a){let o=i.updateTime?ua(i.updateTime):ua(a);return o.isEqual(st.min())&&(o=ua(a)),new TO(o,i.transformResults||[])}(r,e))):[]}function HO(t,e){return{documents:[D2(t,e.path)]}}function zO(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=D2(t,i);const a=function(h){if(h.length!==0)return M2($i.create(h,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(h){if(h.length!==0)return h.map(d=>function(v){return{field:Vl(v.field),direction:KO(v.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=rg(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ct:r,parent:i}}function WO(t){let e=BO(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){bt(n===1);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(g){const v=L2(g);return v instanceof $i&&f2(v)?v.getFilters():[v]}(r.where));let o=[];r.orderBy&&(o=function(g){return g.map(v=>function(E){return new w0(Bl(E.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(v))}(r.orderBy));let c=null;r.limit&&(c=function(g){let v;return v=typeof g=="object"?g.value:g,id(v)?null:v}(r.limit));let u=null;r.startAt&&(u=function(g){const v=!!g.before,_=g.values||[];return new E0(_,v)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const v=!g.before,_=g.values||[];return new E0(_,v)}(r.endAt)),uO(e,i,o,a,c,"F",u,h)}function GO(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function L2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Bl(r.unaryFilter.field);return Er.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Bl(r.unaryFilter.field);return Er.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Bl(r.unaryFilter.field);return Er.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bl(r.unaryFilter.field);return Er.create(o,"!=",{nullValue:"NULL_VALUE"});default:return it()}}(t):t.fieldFilter!==void 0?function(r){return Er.create(Bl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return it()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return $i.create(r.compositeFilter.filters.map(n=>L2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return it()}}(r.compositeFilter.op))}(t):it()}function KO(t){return DO[t]}function qO(t){return NO[t]}function XO(t){return LO[t]}function Vl(t){return{fieldPath:t.canonicalString()}}function Bl(t){return qr.fromServerFormat(t.fieldPath)}function M2(t){return t instanceof Er?function(r){if(r.op==="=="){if(Ty(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NAN"}};if(wy(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Ty(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NOT_NAN"}};if(wy(r.value))return{unaryFilter:{field:Vl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vl(r.field),op:qO(r.op),value:r.value}}}(t):t instanceof $i?function(r){const n=r.getFilters().map(i=>M2(i));return n.length===1?n[0]:{compositeFilter:{op:XO(r.op),filters:n}}}(t):it()}function YO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function V2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,r,n,i,a=st.min(),o=st.min(),c=Qr.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(e){this.ht=e}}function JO(t){const e=WO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(){this.ln=new eD}addToCollectionParentIndex(e,r){return this.ln.add(r),ke.resolve()}getCollectionParents(e,r){return ke.resolve(this.ln.getEntries(r))}addFieldIndex(e,r){return ke.resolve()}deleteFieldIndex(e,r){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,r){return ke.resolve()}getDocumentsMatchingTarget(e,r){return ke.resolve(null)}getIndexType(e,r){return ke.resolve(0)}getFieldIndexes(e,r){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,r){return ke.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,r){return ke.resolve(Ws.min())}updateCollectionGroup(e,r,n){return ke.resolve()}updateIndexEntries(e,r){return ke.resolve()}}class eD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(Kt.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(Kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Un{static withCacheSize(e){return new Un(e,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Un.DEFAULT_COLLECTION_PERCENTILE=10,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Un.DEFAULT=new Un(41943040,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Un.DISABLED=new Un(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new ic(0)}static Qn(){return new ic(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vy([t,e],[r,n]){const i=vt(t,r);return i===0?vt(e,n):i}class tD{constructor(e){this.Gn=e,this.buffer=new Pr(Vy),this.zn=0}jn(){return++this.zn}Hn(e){const r=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Vy(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class rD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){je("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){gc(r)?je("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await mc(r)}await this.Yn(3e5)})}}class nD{constructor(e,r){this.Zn=e,this.params=r}calculateTargetCount(e,r){return this.Zn.Xn(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ke.resolve(nd.oe);const n=new tD(r);return this.Zn.forEachTarget(e,i=>n.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>n.Hn(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Zn.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Zn.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(My)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),My):this.tr(e,r))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,r){let n,i,a,o,c,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),Ll()<=pt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function iD(t,e){return new nD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(){this.changes=new Go(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,cn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ke.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&xu(n.mutation,i,Zn.empty(),Rr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,mt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=mt()){const i=Po();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let o=su();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Po();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,mt()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,c)=>{r.set(o,c)})})}computeViews(e,r,n,i){let a=Xa();const o=vu(),c=function(){return vu()}();return r.forEach((u,h)=>{const d=n.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof Zs)?a=a.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),xu(d.mutation,h,d.mutation.getFieldMask(),Rr.now())):o.set(h.key,Zn.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,d)=>o.set(h,d)),r.forEach((h,d)=>{var g;return c.set(h,new sD(d,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,r){const n=vu();let i=new tr((o,c)=>o-c),a=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let d=n.get(u)||Zn.empty();d=c.applyToLocalView(h,d),n.set(u,d);const g=(i.get(c.batchId)||mt()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,d=u.value,g=y2();d.forEach(v=>{if(!a.has(v)){const _=C2(r.get(v),n.get(v));_!==null&&g.set(v,_),a=a.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return ke.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(o){return Xe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):m2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):ke.resolve(Po());let c=-1,u=a;return o.next(h=>ke.forEach(h,(d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(d)?ke.resolve():this.remoteDocumentCache.getEntry(e,d).next(v=>{u=u.insert(d,v)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,mt())).next(d=>({batchId:c,changes:_2(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Xe(r)).next(n=>{let i=su();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let o=su();return this.indexManager.getCollectionParents(e,a).next(c=>ke.forEach(c,u=>{const h=function(g,v){return new rf(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(d=>{d.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(o=>{a.forEach((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,cn.newInvalidDocument(d)))});let c=su();return o.forEach((u,h)=>{const d=a.get(u);d!==void 0&&xu(d.mutation,h,Zn.empty(),Rr.now()),od(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,r){return ke.resolve(this.Tr.get(r))}saveBundleMetadata(e,r){return this.Tr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ua(i.createTime)}}(r)),ke.resolve()}getNamedQuery(e,r){return ke.resolve(this.Ir.get(r))}saveNamedQuery(e,r){return this.Ir.set(r.name,function(i){return{name:i.name,query:JO(i.bundledQuery),readTime:ua(i.readTime)}}(r)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(){this.overlays=new tr(Xe.comparator),this.Er=new Map}getOverlay(e,r){return ke.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Po();return ke.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.Tt(e,r,a)}),ke.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Er.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Er.delete(n)),ke.resolve()}getOverlaysForCollection(e,r,n){const i=Po(),a=r.length+1,o=new Xe(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>n&&i.set(u.getKey(),u)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new tr((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=a.get(h.largestBatchId);d===null&&(d=Po(),a=a.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Po(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,d)=>c.set(h,d)),!(c.size()>=i)););return ke.resolve(c)}Tt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Er.get(i.largestBatchId).delete(n.key);this.Er.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new IO(r,n));let a=this.Er.get(r);a===void 0&&(a=mt(),this.Er.set(r,a)),this.Er.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(){this.sessionToken=Qr.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(){this.dr=new Pr(Vr.Ar),this.Rr=new Pr(Vr.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,r){const n=new Vr(e,r);this.dr=this.dr.add(n),this.Rr=this.Rr.add(n)}mr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.gr(new Vr(e,r))}pr(e,r){e.forEach(n=>this.removeReference(n,r))}yr(e){const r=new Xe(new Kt([])),n=new Vr(r,e),i=new Vr(r,e+1),a=[];return this.Rr.forEachInRange([n,i],o=>{this.gr(o),a.push(o.key)}),a}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){const r=new Xe(new Kt([])),n=new Vr(r,e),i=new Vr(r,e+1);let a=mt();return this.Rr.forEachInRange([n,i],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new Vr(e,0),n=this.dr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Vr{constructor(e,r){this.key=e,this.br=r}static Ar(e,r){return Xe.comparator(e.key,r.key)||vt(e.br,r.br)}static Vr(e,r){return vt(e.br,r.br)||Xe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Dr=1,this.vr=new Pr(Vr.Ar)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new CO(a,r,n,i);this.mutationQueue.push(o);for(const c of i)this.vr=this.vr.add(new Vr(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ke.resolve(o)}lookupMutationBatch(e,r){return ke.resolve(this.Cr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Fr(n),a=i<0?0:i;return ke.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Vr(r,0),i=new Vr(r,Number.POSITIVE_INFINITY),a=[];return this.vr.forEachInRange([n,i],o=>{const c=this.Cr(o.br);a.push(c)}),ke.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(vt);return r.forEach(i=>{const a=new Vr(i,0),o=new Vr(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([a,o],c=>{n=n.add(c.br)})}),ke.resolve(this.Mr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;Xe.isDocumentKey(a)||(a=a.child(""));const o=new Vr(new Xe(a),0);let c=new Pr(vt);return this.vr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.br)),!0)},o),ke.resolve(this.Mr(c))}Mr(e){const r=[];return e.forEach(n=>{const i=this.Cr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){bt(this.Or(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.vr;return ke.forEach(r.mutations,i=>{const a=new Vr(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=n})}Ln(e){}containsKey(e,r){const n=new Vr(r,0),i=this.vr.firstAfterOrEqual(n);return ke.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}Or(e,r){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){const r=this.Fr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e){this.Nr=e,this.docs=function(){return new tr(Xe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,o=this.Nr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ke.resolve(n?n.document.mutableCopy():cn.newInvalidDocument(r))}getEntries(e,r){let n=Xa();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():cn.newInvalidDocument(i))}),ke.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Xa();const o=r.path,c=new Xe(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||Hb($b(d),n)<=0||(i.has(d.key)||od(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return ke.resolve(a)}getAllFromCollectionGroup(e,r,n,i){it()}Lr(e,r){return ke.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new dD(this)}getSize(e){return ke.resolve(this.size)}}class dD extends aD{constructor(e){super(),this.hr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.hr.addEntry(e,i)):this.hr.removeEntry(n)}),ke.waitFor(r)}getFromCache(e,r){return this.hr.getEntry(e,r)}getAllFromCache(e,r){return this.hr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.persistence=e,this.Br=new Go(r=>e1(r),t1),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.kr=0,this.qr=new o1,this.targetCount=0,this.Qr=ic.qn()}forEachTarget(e,r){return this.Br.forEach((n,i)=>r(i)),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.kr&&(this.kr=r),ke.resolve()}Un(e){this.Br.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.Qr=new ic(r),this.highestTargetId=r),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,r){return this.Un(r),this.targetCount+=1,ke.resolve()}updateTargetData(e,r){return this.Un(r),ke.resolve()}removeTargetData(e,r){return this.Br.delete(r.target),this.qr.yr(r.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.Br.forEach((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.Br.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),ke.waitFor(a).next(()=>i)}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,r){const n=this.Br.get(r)||null;return ke.resolve(n)}addMatchingKeys(e,r,n){return this.qr.mr(r,n),ke.resolve()}removeMatchingKeys(e,r,n){this.qr.pr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),ke.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.qr.yr(r),ke.resolve()}getMatchingKeysForTargetId(e,r){const n=this.qr.Sr(r);return ke.resolve(n)}containsKey(e,r){return ke.resolve(this.qr.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,r){this.Kr={},this.overlays={},this.$r=new nd(0),this.Ur=!1,this.Ur=!0,this.Wr=new uD,this.referenceDelegate=e(this),this.Gr=new pD(this),this.indexManager=new ZO,this.remoteDocumentCache=function(i){return new hD(i)}(n=>this.referenceDelegate.zr(n)),this.serializer=new QO(r),this.jr=new lD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new cD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.Kr[e.toKey()];return n||(n=new fD(r,this.referenceDelegate),this.Kr[e.toKey()]=n),n}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const i=new mD(this.$r.next());return this.referenceDelegate.Hr(),n(i).next(a=>this.referenceDelegate.Jr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Yr(e,r){return ke.or(Object.values(this.Kr).map(n=>()=>n.containsKey(e,r)))}}class mD extends Wb{constructor(e){super(),this.currentSequenceNumber=e}}class l1{constructor(e){this.persistence=e,this.Zr=new o1,this.Xr=null}static ei(e){return new l1(e)}get ti(){if(this.Xr)return this.Xr;throw it()}addReference(e,r,n){return this.Zr.addReference(n,r),this.ti.delete(n.toString()),ke.resolve()}removeReference(e,r,n){return this.Zr.removeReference(n,r),this.ti.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,r){return this.ti.add(r.toString()),ke.resolve()}removeTarget(e,r){this.Zr.yr(r.targetId).forEach(i=>this.ti.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.ti.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Hr(){this.Xr=new Set}Jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.ti,n=>{const i=Xe.fromPath(n);return this.ni(e,i).next(a=>{a||r.removeEntry(i,st.min())})}).next(()=>(this.Xr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ni(e,r).next(n=>{n?this.ti.delete(r.toString()):this.ti.add(r.toString())})}zr(e){return 0}ni(e,r){return ke.or([()=>ke.resolve(this.Zr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Yr(e,r)])}}class A0{constructor(e,r){this.persistence=e,this.ri=new Go(n=>qb(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=iD(this,r)}static ei(e,r){return new A0(e,r)}Hr(){}Jr(e){return ke.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}Xn(e){const r=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}nr(e){let r=0;return this.er(e,n=>{r++}).next(()=>r)}er(e,r){return ke.forEach(this.ri,(n,i)=>this.ir(e,n,i).next(a=>a?ke.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.Lr(e,o=>this.ir(e,o,r).next(c=>{c||(n++,a.removeEntry(o,st.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.ri.set(r,e.currentSequenceNumber),ke.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.ri.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,r,n){return this.ri.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,r){return this.ri.set(r,e.currentSequenceNumber),ke.resolve()}zr(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=n0(e.data.value)),r}ir(e,r,n){return ke.or([()=>this.persistence.Yr(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.ri.get(r);return ke.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Wi=n,this.Gi=i}static zi(e,r){let n=mt(),i=mt();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new c1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return s4()?8:Gb(dn())>0?6:4}()}initialize(e,r){this.Zi=e,this.indexManager=r,this.ji=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.Xi(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.es(e,r,i,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new gD;return this.ts(e,r,o).next(c=>{if(a.result=c,this.Hi)return this.ns(e,r,o,c.size)})}).next(()=>a.result)}ns(e,r,n,i){return n.documentReadCount<this.Ji?(Ll()<=pt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Ml(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),ke.resolve()):(Ll()<=pt.DEBUG&&je("QueryEngine","Query:",Ml(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Yi*i?(Ll()<=pt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Ml(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ca(r))):ke.resolve())}Xi(e,r){if(Cy(r))return ke.resolve(null);let n=ca(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=tg(r,null,"F"),n=ca(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=mt(...a);return this.Zi.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.rs(r,c);return this.ss(r,h,o,u.readTime)?this.Xi(e,tg(r,null,"F")):this.os(e,h,r,u)}))})))}es(e,r,n,i){return Cy(r)||i.isEqual(st.min())?ke.resolve(null):this.Zi.getDocuments(e,n).next(a=>{const o=this.rs(r,a);return this.ss(r,o,n,i)?ke.resolve(null):(Ll()<=pt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ml(r)),this.os(e,o,r,jb(i,-1)).next(c=>c))})}rs(e,r){let n=new Pr(v2(e));return r.forEach((i,a)=>{od(e,a)&&(n=n.add(a))}),n}ss(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}ts(e,r,n){return Ll()<=pt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Ml(r)),this.Zi.getDocumentsMatchingQuery(e,r,Ws.min(),n)}os(e,r,n,i){return this.Zi.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e,r,n,i){this.persistence=e,this._s=r,this.serializer=i,this.us=new tr(vt),this.cs=new Go(a=>e1(a),t1),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(n)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oD(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.us))}}function _D(t,e,r,n){return new xD(t,e,r,n)}async function U2(t,e){const r=lt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Ps(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],c=[];let u=mt();for(const h of i){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of a){c.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Ts:h,removedBatchIds:o,addedBatchIds:c}))})})}function yD(t,e){const r=lt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.hs.newChangeBuffer({trackRemovals:!0});return function(c,u,h,d){const g=h.batch,v=g.keys();let _=ke.resolve();return v.forEach(E=>{_=_.next(()=>d.getEntry(u,E)).next(y=>{const w=h.docVersions.get(E);bt(w!==null),y.version.compareTo(w)<0&&(g.applyToRemoteDocument(y,h),y.isValidDocument()&&(y.setReadTime(h.commitVersion),d.addEntry(y)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=mt();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function j2(t){const e=lt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Gr.getLastRemoteSnapshotVersion(r))}function ED(t,e){const r=lt(t),n=e.snapshotVersion;let i=r.us;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.hs.newChangeBuffer({trackRemovals:!0});i=r.us;const c=[];e.targetChanges.forEach((d,g)=>{const v=i.get(g);if(!v)return;c.push(r.Gr.removeMatchingKeys(a,d.removedDocuments,g).next(()=>r.Gr.addMatchingKeys(a,d.addedDocuments,g)));let _=v.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(Qr.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,n)),i=i.insert(g,_),function(y,w,k){return y.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(v,_,d)&&c.push(r.Gr.updateTargetData(a,_))});let u=Xa(),h=mt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),c.push(wD(a,o,e.documentUpdates).next(d=>{u=d.Is,h=d.Es})),!n.isEqual(st.min())){const d=r.Gr.getLastRemoteSnapshotVersion(a).next(g=>r.Gr.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(d)}return ke.waitFor(c).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(r.us=i,a))}function wD(t,e,r){let n=mt(),i=mt();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=Xa();return r.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(st.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):je("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Is:o,Es:i}})}function TD(t,e){const r=lt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function SD(t,e){const r=lt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Gr.getTargetData(n,e).next(a=>a?(i=a,ke.resolve(i)):r.Gr.allocateTargetId(n).next(o=>(i=new Ds(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Gr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.us.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.us=r.us.insert(n.targetId,n),r.cs.set(e,n.targetId)),n})}async function sg(t,e,r){const n=lt(t),i=n.us.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!gc(o))throw o;je("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.us=n.us.remove(e),n.cs.delete(i.target)}function By(t,e,r){const n=lt(t);let i=st.min(),a=mt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,d){const g=lt(u),v=g.cs.get(d);return v!==void 0?ke.resolve(g.us.get(v)):g.Gr.getTargetData(h,d)}(n,o,ca(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Gr.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>n._s.getDocumentsMatchingQuery(o,e,r?i:st.min(),r?a:mt())).next(c=>(kD(n,hO(e),c),{documents:c,ds:a})))}function kD(t,e,r){let n=t.ls.get(e)||st.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.ls.set(e,n)}class Uy{constructor(){this.activeTargetIds=xO()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AD{constructor(){this._o=new Uy,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,r,n){this.ao[e]=r}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new Uy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{uo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.To)e(0)}Po(){je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nh=null;function gm(){return Nh===null?Nh=function(){return 268435456+Math.round(2147483648*Math.random())}():Nh++,"0x"+Nh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class PD extends class{get Co(){return!1}constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Fo=n+"://"+r.host,this.Mo=`projects/${i}/databases/${a}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Oo(r,n,i,a,o){const c=gm(),u=this.No(r,n.toUriEncodedString());je("RestConnection",`Sending RPC '${r}' ${c}:`,u,i);const h={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(h,a,o),this.Bo(r,u,h,i).then(d=>(je("RestConnection",`Received RPC '${r}' ${c}: `,d),d),d=>{throw Jl("RestConnection",`RPC '${r}' ${c} failed with error: `,d,"url: ",u,"request:",i),d})}ko(r,n,i,a,o,c){return this.Oo(r,n,i,a,o)}Lo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>r[o]=a),i&&i.headers.forEach((a,o)=>r[o]=a)}No(r,n){const i=ID[r];return`${this.Fo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,r,n,i){const a=gm();return new Promise((o,c)=>{const u=new ZT;u.setWithCredentials(!0),u.listenOnce(e2.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case r0.NO_ERROR:const d=u.getResponseJson();je(nn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(d)),o(d);break;case r0.TIMEOUT:je(nn,`RPC '${e}' ${a} timed out`),c(new $e(Se.DEADLINE_EXCEEDED,"Request time out"));break;case r0.HTTP_ERROR:const g=u.getStatus();if(je(nn,`RPC '${e}' ${a} failed with status:`,g,"response text:",u.getResponseText()),g>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const _=v==null?void 0:v.error;if(_&&_.status&&_.message){const E=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(Se).indexOf(k)>=0?k:Se.UNKNOWN}(_.status);c(new $e(E,_.message))}else c(new $e(Se.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new $e(Se.UNAVAILABLE,"Connection failed."));break;default:it()}}finally{je(nn,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(i);je(nn,`RPC '${e}' ${a} sending request:`,i),u.send(r,"POST",h,n,15)})}qo(e,r,n){const i=gm(),a=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=n2(),c=r2(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Lo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=a.join("");je(nn,`Creating RPC '${e}' stream ${i}: ${d}`,u);const g=o.createWebChannel(d,u);let v=!1,_=!1;const E=new RD({Eo:w=>{_?je(nn,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(v||(je(nn,`Opening RPC '${e}' stream ${i} transport.`),g.open(),v=!0),je(nn,`RPC '${e}' stream ${i} sending:`,w),g.send(w))},Ao:()=>g.close()}),y=(w,k,F)=>{w.listen(k,C=>{try{F(C)}catch(U){setTimeout(()=>{throw U},0)}})};return y(g,au.EventType.OPEN,()=>{_||(je(nn,`RPC '${e}' stream ${i} transport opened.`),E.So())}),y(g,au.EventType.CLOSE,()=>{_||(_=!0,je(nn,`RPC '${e}' stream ${i} transport closed`),E.Do())}),y(g,au.EventType.ERROR,w=>{_||(_=!0,Jl(nn,`RPC '${e}' stream ${i} transport errored:`,w),E.Do(new $e(Se.UNAVAILABLE,"The operation could not be completed")))}),y(g,au.EventType.MESSAGE,w=>{var k;if(!_){const F=w.data[0];bt(!!F);const C=F,U=(C==null?void 0:C.error)||((k=C[0])===null||k===void 0?void 0:k.error);if(U){je(nn,`RPC '${e}' stream ${i} received error:`,U);const V=U.status;let z=function(R){const M=vr[R];if(M!==void 0)return R2(M)}(V),A=U.message;z===void 0&&(z=Se.INTERNAL,A="Unknown error status: "+V+" with message "+U.message),_=!0,E.Do(new $e(z,A)),g.close()}else je(nn,`RPC '${e}' stream ${i} received:`,F),E.vo(F)}}),y(c,t2.STAT_EVENT,w=>{w.stat===Xm.PROXY?je(nn,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===Xm.NOPROXY&&je(nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.bo()},0),E}}function vm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(t){return new MO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,r,n=1e3,i=1.5,a=6e4){this.li=e,this.timerId=r,this.Qo=n,this.Ko=i,this.$o=a,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();const r=Math.floor(this.Uo+this.Ho()),n=Math.max(0,Date.now()-this.Go),i=Math.max(0,r-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,r,n,i,a,o,c,u){this.li=e,this.Yo=n,this.Zo=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new $2(e,r)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}async stop(){this.i_()&&await this.close(0)}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}async u_(){if(this.s_())return this.close(0)}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}async close(e,r){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():r&&r.code===Se.RESOURCE_EXHAUSTED?(qa(r.toString()),qa("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):r&&r.code===Se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.po(r)}P_(){}auth(){this.state=1;const e=this.T_(this.Xo),r=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Xo===r&&this.I_(n,i)},n=>{e(()=>{const i=new $e(Se.UNKNOWN,"Fetching auth token failed: "+n.message);return this.E_(i)})})}I_(e,r){const n=this.T_(this.Xo);this.stream=this.d_(e,r),this.stream.Ro(()=>{n(()=>this.listener.Ro())}),this.stream.mo(()=>{n(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{n(()=>this.E_(i))}),this.stream.onMessage(i=>{n(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(async()=>{this.state=0,this.start()})}E_(e){return je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return r=>{this.li.enqueueAndForget(()=>this.Xo===e?r():(je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class FD extends H2{constructor(e,r,n,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}d_(e,r){return this.connection.qo("Listen",e,r)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();const r=UO(this.serializer,e),n=function(a){if(!("targetChange"in a))return st.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?st.min():o.readTime?ua(o.readTime):st.min()}(e);return this.listener.R_(r,n)}V_(e){const r={};r.database=ag(this.serializer),r.addTarget=function(a,o){let c;const u=o.target;if(c=Zm(u)?{documents:HO(a,u)}:{query:zO(a,u).ct},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=b2(a,o.resumeToken);const h=rg(a,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(st.min())>0){c.readTime=k0(a,o.snapshotVersion.toTimestamp());const h=rg(a,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=GO(this.serializer,e);n&&(r.labels=n),this.c_(r)}m_(e){const r={};r.database=ag(this.serializer),r.removeTarget=e,this.c_(r)}}class bD extends H2{constructor(e,r,n,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,r){return this.connection.qo("Write",e,r)}A_(e){return bt(!!e.streamToken),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){bt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();const r=$O(e.writeResults,e.commitTime),n=ua(e.commitTime);return this.listener.y_(n,r)}w_(){const e={};e.database=ag(this.serializer),this.c_(e)}g_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>jO(this.serializer,n))};this.c_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new $e(Se.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,r,n,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Oo(e,ng(r,n),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $e(Se.UNKNOWN,a.toString())})}ko(e,r,n,i,a){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.ko(e,ng(r,n),i,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(Se.UNKNOWN,o.toString())})}terminate(){this.S_=!0,this.connection.terminate()}}class DD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(qa(r),this.C_=!1):je("OnlineStateTracker",r)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=a,this.Q_.uo(o=>{n.enqueueAndForget(async()=>{Ko(this)&&(je("RemoteStore","Restarting streams for network reachability change."),await async function(u){const h=lt(u);h.k_.add(4),await sf(h),h.K_.set("Unknown"),h.k_.delete(4),await dd(h)}(this))})}),this.K_=new DD(n,i)}}async function dd(t){if(Ko(t))for(const e of t.q_)await e(!0)}async function sf(t){for(const e of t.q_)await e(!1)}function z2(t,e){const r=lt(t);r.B_.has(e.targetId)||(r.B_.set(e.targetId,e),d1(r)?h1(r):vc(r).s_()&&f1(r,e))}function u1(t,e){const r=lt(t),n=vc(r);r.B_.delete(e),n.s_()&&W2(r,e),r.B_.size===0&&(n.s_()?n.a_():Ko(r)&&r.K_.set("Unknown"))}function f1(t,e){if(t.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}vc(t).V_(e)}function W2(t,e){t.U_.xe(e),vc(t).m_(e)}function h1(t){t.U_=new OO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>t.B_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),vc(t).start(),t.K_.F_()}function d1(t){return Ko(t)&&!vc(t).i_()&&t.B_.size>0}function Ko(t){return lt(t).k_.size===0}function G2(t){t.U_=void 0}async function LD(t){t.K_.set("Online")}async function MD(t){t.B_.forEach((e,r)=>{f1(t,e)})}async function VD(t,e){G2(t),d1(t)?(t.K_.O_(e),h1(t)):t.K_.set("Unknown")}async function BD(t,e,r){if(t.K_.set("Online"),e instanceof F2&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const c of a.targetIds)i.B_.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.B_.delete(c),i.U_.removeTarget(c))}(t,e)}catch(n){je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await C0(t,n)}else if(e instanceof s0?t.U_.$e(e):e instanceof P2?t.U_.Je(e):t.U_.Ge(e),!r.isEqual(st.min()))try{const n=await j2(t.localStore);r.compareTo(n)>=0&&await function(a,o){const c=a.U_.it(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=a.B_.get(h);d&&a.B_.set(h,d.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const d=a.B_.get(u);if(!d)return;a.B_.set(u,d.withResumeToken(Qr.EMPTY_BYTE_STRING,d.snapshotVersion)),W2(a,u);const g=new Ds(d.target,u,h,d.sequenceNumber);f1(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){je("RemoteStore","Failed to raise snapshot:",n),await C0(t,n)}}async function C0(t,e,r){if(!gc(e))throw e;t.k_.add(1),await sf(t),t.K_.set("Offline"),r||(r=()=>j2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je("RemoteStore","Retrying IndexedDB access"),await r(),t.k_.delete(1),await dd(t)})}function K2(t,e){return e().catch(r=>C0(t,r,e))}async function pd(t){const e=lt(t),r=Xs(e);let n=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;UD(e);)try{const i=await TD(e.localStore,n);if(i===null){e.L_.length===0&&r.a_();break}n=i.batchId,jD(e,i)}catch(i){await C0(e,i)}q2(e)&&X2(e)}function UD(t){return Ko(t)&&t.L_.length<10}function jD(t,e){t.L_.push(e);const r=Xs(t);r.s_()&&r.f_&&r.g_(e.mutations)}function q2(t){return Ko(t)&&!Xs(t).i_()&&t.L_.length>0}function X2(t){Xs(t).start()}async function $D(t){Xs(t).w_()}async function HD(t){const e=Xs(t);for(const r of t.L_)e.g_(r.mutations)}async function zD(t,e,r){const n=t.L_.shift(),i=i1.from(n,e,r);await K2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await pd(t)}async function WD(t,e){e&&Xs(t).f_&&await async function(n,i){if(function(o){return PO(o)&&o!==Se.ABORTED}(i.code)){const a=n.L_.shift();Xs(n).__(),await K2(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await pd(n)}}(t,e),q2(t)&&X2(t)}async function $y(t,e){const r=lt(t);r.asyncQueue.verifyOperationInProgress(),je("RemoteStore","RemoteStore received new credentials");const n=Ko(r);r.k_.add(3),await sf(r),n&&r.K_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.k_.delete(3),await dd(r)}async function GD(t,e){const r=lt(t);e?(r.k_.delete(2),await dd(r)):e||(r.k_.add(2),await sf(r),r.K_.set("Unknown"))}function vc(t){return t.W_||(t.W_=function(r,n,i){const a=lt(r);return a.b_(),new FD(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Ro:LD.bind(null,t),mo:MD.bind(null,t),po:VD.bind(null,t),R_:BD.bind(null,t)}),t.q_.push(async e=>{e?(t.W_.__(),d1(t)?h1(t):t.K_.set("Unknown")):(await t.W_.stop(),G2(t))})),t.W_}function Xs(t){return t.G_||(t.G_=function(r,n,i){const a=lt(r);return a.b_(),new bD(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Ro:()=>Promise.resolve(),mo:$D.bind(null,t),po:WD.bind(null,t),p_:HD.bind(null,t),y_:zD.bind(null,t)}),t.q_.push(async e=>{e?(t.G_.__(),await pd(t)):(await t.G_.stop(),t.L_.length>0&&(je("RemoteStore",`Stopping write stream with ${t.L_.length} pending writes`),t.L_=[]))})),t.G_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new $a,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,c=new p1(e,r,o,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function m1(t,e){if(qa("AsyncQueue",`${e}: ${t}`),gc(t))return new $e(Se.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{static emptySet(e){return new Wl(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Xe.comparator(r.key,n.key):(r,n)=>Xe.comparator(r.key,n.key),this.keyedMap=su(),this.sortedSet=new tr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Wl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Wl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(){this.z_=new tr(Xe.comparator)}track(e){const r=e.doc.key,n=this.z_.get(r);n?e.type!==0&&n.type===3?this.z_=this.z_.insert(r,e):e.type===3&&n.type!==1?this.z_=this.z_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.z_=this.z_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.z_=this.z_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.z_=this.z_.remove(r):e.type===1&&n.type===2?this.z_=this.z_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.z_=this.z_.insert(r,{type:2,doc:e.doc}):it():this.z_=this.z_.insert(r,e)}j_(){const e=[];return this.z_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ac{constructor(e,r,n,i,a,o,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,a){const o=[];return r.forEach(c=>{o.push({type:0,doc:c})}),new ac(e,r,Wl.emptySet(r),o,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}}class qD{constructor(){this.queries=zy(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(r,n){const i=lt(r),a=i.queries;i.queries=zy(),a.forEach((o,c)=>{for(const u of c.J_)u.onError(n)})})(this,new $e(Se.ABORTED,"Firestore shutting down"))}}function zy(){return new Go(t=>g2(t),sd)}async function Y2(t,e){const r=lt(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.Y_()&&e.Z_()&&(n=2):(a=new KD,n=e.Z_()?0:1);try{switch(n){case 0:a.H_=await r.onListen(i,!0);break;case 1:a.H_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const c=m1(o,`Initialization of query '${Ml(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,a),a.J_.push(e),e.ea(r.onlineState),a.H_&&e.ta(a.H_)&&g1(r)}async function Q2(t,e){const r=lt(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const o=a.J_.indexOf(e);o>=0&&(a.J_.splice(o,1),a.J_.length===0?i=e.Z_()?0:1:!a.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function XD(t,e){const r=lt(t);let n=!1;for(const i of e){const a=i.query,o=r.queries.get(a);if(o){for(const c of o.J_)c.ta(i)&&(n=!0);o.H_=i}}n&&g1(r)}function YD(t,e,r){const n=lt(t),i=n.queries.get(e);if(i)for(const a of i.J_)a.onError(r);n.queries.delete(e)}function g1(t){t.X_.forEach(e=>{e.next()})}var og,Wy;(Wy=og||(og={})).na="default",Wy.Cache="cache";class J2{constructor(e,r,n){this.query=e,this.ra=r,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=n||{}}ta(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ac(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.ia?this.oa(e)&&(this.ra.next(e),r=!0):this._a(e,this.onlineState)&&(this.aa(e),r=!0),this.sa=e,r}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let r=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),r=!0),r}_a(e,r){if(!e.fromCache||!this.Z_())return!0;const n=r!=="Offline";return(!this.options.ua||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}oa(e){if(e.docChanges.length>0)return!0;const r=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}aa(e){e=ac.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==og.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e){this.key=e}}class eS{constructor(e){this.key=e}}class QD{constructor(e,r){this.query=e,this.da=r,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=mt(),this.mutatedKeys=mt(),this.Va=v2(e),this.ma=new Wl(this.Va)}get fa(){return this.da}ga(e,r){const n=r?r.pa:new Hy,i=r?r.ma:this.ma;let a=r?r.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,g)=>{const v=i.get(d),_=od(this.query,g)?g:null,E=!!v&&this.mutatedKeys.has(v.key),y=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let w=!1;v&&_?v.data.isEqual(_.data)?E!==y&&(n.track({type:3,doc:_}),w=!0):this.ya(v,_)||(n.track({type:2,doc:_}),w=!0,(u&&this.Va(_,u)>0||h&&this.Va(_,h)<0)&&(c=!0)):!v&&_?(n.track({type:0,doc:_}),w=!0):v&&!_&&(n.track({type:1,doc:v}),w=!0,(u||h)&&(c=!0)),w&&(_?(o=o.add(_),a=y?a.add(d):a.delete(d)):(o=o.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{ma:o,pa:n,ss:c,mutatedKeys:a}}ya(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;const o=e.pa.j_();o.sort((d,g)=>function(_,E){const y=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it()}};return y(_)-y(E)}(d.type,g.type)||this.Va(d.doc,g.doc)),this.wa(n),i=i!=null&&i;const c=r&&!i?this.Sa():[],u=this.Ra.size===0&&this.current&&!i?1:0,h=u!==this.Aa;return this.Aa=u,o.length!==0||h?{snapshot:new ac(this.query,e.ma,a,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),ba:c}:{ba:c}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new Hy,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(r=>this.da=this.da.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.da=this.da.delete(r)),this.current=e.current)}Sa(){if(!this.current)return[];const e=this.Ra;this.Ra=mt(),this.ma.forEach(n=>{this.Da(n.key)&&(this.Ra=this.Ra.add(n.key))});const r=[];return e.forEach(n=>{this.Ra.has(n)||r.push(new eS(n))}),this.Ra.forEach(n=>{e.has(n)||r.push(new Z2(n))}),r}va(e){this.da=e.ds,this.Ra=mt();const r=this.ga(e.documents);return this.applyChanges(r,!0)}Ca(){return ac.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}}class JD{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class ZD{constructor(e){this.key=e,this.Fa=!1}}class e3{constructor(e,r,n,i,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Ma={},this.xa=new Go(c=>g2(c),sd),this.Oa=new Map,this.Na=new Set,this.La=new tr(Xe.comparator),this.Ba=new Map,this.ka=new o1,this.qa={},this.Qa=new Map,this.Ka=ic.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}}async function t3(t,e,r=!0){const n=sS(t);let i;const a=n.xa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Ca()):i=await tS(n,e,r,!0),i}async function r3(t,e){const r=sS(t);await tS(r,e,!0,!1)}async function tS(t,e,r,n){const i=await SD(t.localStore,ca(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let c;return n&&(c=await n3(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&r&&z2(t.remoteStore,i),c}async function n3(t,e,r,n,i){t.Ua=(g,v,_)=>async function(y,w,k,F){let C=w.view.ga(k);C.ss&&(C=await By(y.localStore,w.query,!1).then(({documents:A})=>w.view.ga(A,C)));const U=F&&F.targetChanges.get(w.targetId),V=F&&F.targetMismatches.get(w.targetId)!=null,z=w.view.applyChanges(C,y.isPrimaryClient,U,V);return Ky(y,w.targetId,z.ba),z.snapshot}(t,g,v,_);const a=await By(t.localStore,e,!0),o=new QD(e,a.ds),c=o.ga(a.documents),u=af.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=o.applyChanges(c,t.isPrimaryClient,u);Ky(t,r,h.ba);const d=new JD(e,r,o);return t.xa.set(e,d),t.Oa.has(r)?t.Oa.get(r).push(e):t.Oa.set(r,[e]),h.snapshot}async function i3(t,e,r){const n=lt(t),i=n.xa.get(e),a=n.Oa.get(i.targetId);if(a.length>1)return n.Oa.set(i.targetId,a.filter(o=>!sd(o,e))),void n.xa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await sg(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&u1(n.remoteStore,i.targetId),lg(n,i.targetId)}).catch(mc)):(lg(n,i.targetId),await sg(n.localStore,i.targetId,!0))}async function a3(t,e){const r=lt(t),n=r.xa.get(e),i=r.Oa.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),u1(r.remoteStore,n.targetId))}async function s3(t,e,r){const n=d3(t);try{const i=await function(o,c){const u=lt(o),h=Rr.now(),d=c.reduce((_,E)=>_.add(E.key),mt());let g,v;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=Xa(),y=mt();return u.hs.getEntries(_,d).next(w=>{E=w,E.forEach((k,F)=>{F.isValidDocument()||(y=y.add(k))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,E)).next(w=>{g=w;const k=[];for(const F of c){const C=kO(F,g.get(F.key).overlayedDocument);C!=null&&k.push(new Zs(F.key,C,l2(C.value.mapValue),kn.exists(!0)))}return u.mutationQueue.addMutationBatch(_,h,k,c)}).next(w=>{v=w;const k=w.applyToLocalDocumentSet(g,y);return u.documentOverlayCache.saveOverlays(_,w.batchId,k)})}).then(()=>({batchId:v.batchId,changes:_2(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let h=o.qa[o.currentUser.toKey()];h||(h=new tr(vt)),h=h.insert(c,u),o.qa[o.currentUser.toKey()]=h}(n,i.batchId,r),await of(n,i.changes),await pd(n.remoteStore)}catch(i){const a=m1(i,"Failed to persist write");r.reject(a)}}async function rS(t,e){const r=lt(t);try{const n=await ED(r.localStore,e);e.targetChanges.forEach((i,a)=>{const o=r.Ba.get(a);o&&(bt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Fa=!0:i.modifiedDocuments.size>0?bt(o.Fa):i.removedDocuments.size>0&&(bt(o.Fa),o.Fa=!1))}),await of(r,n,e)}catch(n){await mc(n)}}function Gy(t,e,r){const n=lt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.xa.forEach((a,o)=>{const c=o.view.ea(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=lt(o);u.onlineState=c;let h=!1;u.queries.forEach((d,g)=>{for(const v of g.J_)v.ea(c)&&(h=!0)}),h&&g1(u)}(n.eventManager,e),i.length&&n.Ma.R_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function o3(t,e,r){const n=lt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Ba.get(e),a=i&&i.key;if(a){let o=new tr(Xe.comparator);o=o.insert(a,cn.newNoDocument(a,st.min()));const c=mt().add(a),u=new fd(st.min(),new Map,new tr(vt),o,c);await rS(n,u),n.La=n.La.remove(a),n.Ba.delete(e),v1(n)}else await sg(n.localStore,e,!1).then(()=>lg(n,e,r)).catch(mc)}async function l3(t,e){const r=lt(t),n=e.batch.batchId;try{const i=await yD(r.localStore,e);iS(r,n,null),nS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await of(r,i)}catch(i){await mc(i)}}async function c3(t,e,r){const n=lt(t);try{const i=await function(o,c){const u=lt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(bt(g!==null),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>u.localDocuments.getDocuments(h,d))})}(n.localStore,e);iS(n,e,r),nS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await of(n,i)}catch(i){await mc(i)}}function nS(t,e){(t.Qa.get(e)||[]).forEach(r=>{r.resolve()}),t.Qa.delete(e)}function iS(t,e,r){const n=lt(t);let i=n.qa[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.qa[n.currentUser.toKey()]=i}}function lg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Oa.get(e))t.xa.delete(n),r&&t.Ma.Wa(n,r);t.Oa.delete(e),t.isPrimaryClient&&t.ka.yr(e).forEach(n=>{t.ka.containsKey(n)||aS(t,n)})}function aS(t,e){t.Na.delete(e.path.canonicalString());const r=t.La.get(e);r!==null&&(u1(t.remoteStore,r),t.La=t.La.remove(e),t.Ba.delete(r),v1(t))}function Ky(t,e,r){for(const n of r)n instanceof Z2?(t.ka.addReference(n.key,e),u3(t,n)):n instanceof eS?(je("SyncEngine","Document no longer in limbo: "+n.key),t.ka.removeReference(n.key,e),t.ka.containsKey(n.key)||aS(t,n.key)):it()}function u3(t,e){const r=e.key,n=r.path.canonicalString();t.La.get(r)||t.Na.has(n)||(je("SyncEngine","New document in limbo: "+r),t.Na.add(n),v1(t))}function v1(t){for(;t.Na.size>0&&t.La.size<t.maxConcurrentLimboResolutions;){const e=t.Na.values().next().value;t.Na.delete(e);const r=new Xe(Kt.fromString(e)),n=t.Ka.next();t.Ba.set(n,new ZD(r)),t.La=t.La.insert(r,n),z2(t.remoteStore,new Ds(ca(r1(r.path)),n,"TargetPurposeLimboResolution",nd.oe))}}async function of(t,e,r){const n=lt(t),i=[],a=[],o=[];n.xa.isEmpty()||(n.xa.forEach((c,u)=>{o.push(n.Ua(u,e,r).then(h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r==null?void 0:r.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);const g=c1.zi(u.targetId,h);a.push(g)}}))}),await Promise.all(o),n.Ma.R_(i),await async function(u,h){const d=lt(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>ke.forEach(h,v=>ke.forEach(v.Wi,_=>d.persistence.referenceDelegate.addReference(g,v.targetId,_)).next(()=>ke.forEach(v.Gi,_=>d.persistence.referenceDelegate.removeReference(g,v.targetId,_)))))}catch(g){if(!gc(g))throw g;je("LocalStore","Failed to update sequence numbers: "+g)}for(const g of h){const v=g.targetId;if(!g.fromCache){const _=d.us.get(v),E=_.snapshotVersion,y=_.withLastLimboFreeSnapshotVersion(E);d.us=d.us.insert(v,y)}}}(n.localStore,a))}async function f3(t,e){const r=lt(t);if(!r.currentUser.isEqual(e)){je("SyncEngine","User change. New user:",e.toKey());const n=await U2(r.localStore,e);r.currentUser=e,function(a,o){a.Qa.forEach(c=>{c.forEach(u=>{u.reject(new $e(Se.CANCELLED,o))})}),a.Qa.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await of(r,n.Ts)}}function h3(t,e){const r=lt(t),n=r.Ba.get(e);if(n&&n.Fa)return mt().add(n.key);{let i=mt();const a=r.Oa.get(e);if(!a)return i;for(const o of a){const c=r.xa.get(o);i=i.unionWith(c.view.fa)}return i}}function sS(t){const e=lt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=o3.bind(null,e),e.Ma.R_=XD.bind(null,e.eventManager),e.Ma.Wa=YD.bind(null,e.eventManager),e}function d3(t){const e=lt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=c3.bind(null,e),e}class I0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hd(e.databaseInfo.databaseId),this.sharedClientState=this.za(e),this.persistence=this.ja(e),await this.persistence.start(),this.localStore=this.Ha(e),this.gcScheduler=this.Ja(e,this.localStore),this.indexBackfillerScheduler=this.Ya(e,this.localStore)}Ja(e,r){return null}Ya(e,r){return null}Ha(e){return _D(this.persistence,new vD,e.initialUser,this.serializer)}ja(e){return new B2(l1.ei,this.serializer)}za(e){return new AD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}I0.provider={build:()=>new I0};class p3 extends I0{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,r){bt(this.persistence.referenceDelegate instanceof A0);const n=this.persistence.referenceDelegate.garbageCollector;return new rD(n,e.asyncQueue,r)}ja(e){const r=this.cacheSizeBytes!==void 0?Un.withCacheSize(this.cacheSizeBytes):Un.DEFAULT;return new B2(n=>A0.ei(n,r),this.serializer)}}class cg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Gy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=f3.bind(null,this.syncEngine),await GD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qD}()}createDatastore(e){const r=hd(e.databaseInfo.databaseId),n=function(a){return new PD(a)}(e.databaseInfo);return function(a,o,c,u){return new OD(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,o,c){return new ND(n,i,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Gy(this.syncEngine,r,0),function(){return jy.p()?new jy:new CD}())}createSyncEngine(e,r){return function(i,a,o,c,u,h,d){const g=new e3(i,a,o,c,u,h);return d&&(g.$a=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=lt(i);je("RemoteStore","RemoteStore shutting down."),a.k_.add(5),await sf(a),a.Q_.shutdown(),a.K_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}cg.provider={build:()=>new cg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):qa("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=on.UNAUTHENTICATED,this.clientId=a2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{je("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(je("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $a;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=m1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function xm(t,e){t.asyncQueue.verifyOperationInProgress(),je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await U2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await g3(t);je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>$y(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>$y(e.remoteStore,i)),t._onlineComponents=e}async function g3(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je("FirestoreClient","Using user provided OfflineComponentProvider");try{await xm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Se.FAILED_PRECONDITION||i.code===Se.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Jl("Error using user provided cache. Falling back to memory cache: "+r),await xm(t,new I0)}}else je("FirestoreClient","Using default OfflineComponentProvider"),await xm(t,new p3(void 0));return t._offlineComponents}async function lS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je("FirestoreClient","Using user provided OnlineComponentProvider"),await qy(t,t._uninitializedComponentsProvider._online)):(je("FirestoreClient","Using default OnlineComponentProvider"),await qy(t,new cg))),t._onlineComponents}function v3(t){return lS(t).then(e=>e.syncEngine)}async function cS(t){const e=await lS(t),r=e.eventManager;return r.onListen=t3.bind(null,e.syncEngine),r.onUnlisten=i3.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=r3.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=a3.bind(null,e.syncEngine),r}function x3(t,e,r={}){const n=new $a;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new oS({next:v=>{d.eu(),o.enqueueAndForget(()=>Q2(a,g));const _=v.docs.has(c);!_&&v.fromCache?h.reject(new $e(Se.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&v.fromCache&&u&&u.source==="server"?h.reject(new $e(Se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new J2(r1(c.path),d,{includeMetadataChanges:!0,ua:!0});return Y2(a,g)}(await cS(t),t.asyncQueue,e,r,n)),n.promise}function _3(t,e,r={}){const n=new $a;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new oS({next:v=>{d.eu(),o.enqueueAndForget(()=>Q2(a,g)),v.fromCache&&u.source==="server"?h.reject(new $e(Se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(v)},error:v=>h.reject(v)}),g=new J2(c,d,{includeMetadataChanges:!0,ua:!0});return Y2(a,g)}(await cS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t,e,r){if(!r)throw new $e(Se.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function y3(t,e,r,n){if(e===!0&&n===!0)throw new $e(Se.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Yy(t){if(!Xe.isDocumentKey(t))throw new $e(Se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qy(t){if(Xe.isDocumentKey(t))throw new $e(Se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function md(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":it()}function gi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=md(t);throw new $e(Se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $e(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}y3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new $e(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new $e(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new $e(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gd{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new bb;switch(n.type){case"firstParty":return new Lb(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Xy.get(r);n&&(je("ComponentProvider","Removing Datastore"),Xy.delete(r),n.terminate())}(this),Promise.resolve()}}function E3(t,e,r,n={}){var i;const a=(t=gi(t,gd))._getSettings(),o=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==o&&Jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:o,ssl:!1})),n.mockUserToken){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=on.MOCK_USER;else{c=ZR(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new $e(Se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new on(h)}t._authCredentials=new Ob(new i2(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new xc(this.firestore,e,this._query)}}class An{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $s(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}}class $s extends xc{constructor(e,r,n){super(e,r,r1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new Xe(e))}withConverter(e){return new $s(this.firestore,e,this._path)}}function Za(t,e,...r){if(t=br(t),fS("collection","path",e),t instanceof gd){const n=Kt.fromString(e,...r);return Qy(n),new $s(t,null,n)}{if(!(t instanceof An||t instanceof $s))throw new $e(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Qy(n),new $s(t.firestore,null,n)}}function ti(t,e,...r){if(t=br(t),arguments.length===1&&(e=a2.newId()),fS("doc","path",e),t instanceof gd){const n=Kt.fromString(e,...r);return Yy(n),new An(t,null,new Xe(n))}{if(!(t instanceof An||t instanceof $s))throw new $e(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Kt.fromString(e,...r));return Yy(n),new An(t.firestore,t instanceof $s?t.converter:null,new Xe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new $2(this,"async_queue_retry"),this.fu=()=>{const n=vm();n&&je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.r_.Jo()},this.gu=e;const r=vm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;const r=vm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});const r=new $a;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}async wu(){if(this.Iu.length!==0){try{await this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!gc(e))throw e;je("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}}yu(e){const r=this.gu.then(()=>(this.Ru=!0,e().catch(n=>{this.Au=n,this.Ru=!1;const i=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(n);throw qa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.Ru=!1,n))));return this.gu=r,r}enqueueAfterDelay(e,r,n){this.pu(),this.mu.indexOf(e)>-1&&(r=0);const i=p1.createAndSchedule(this,e,r,n,a=>this.Su(a));return this.du.push(i),i}pu(){this.Au&&it()}verifyOperationInProgress(){}async bu(){let e;do e=this.gu,await e;while(e!==this.gu)}Du(e){for(const r of this.du)if(r.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.du)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){const r=this.du.indexOf(e);this.du.splice(r,1)}}class eo extends gd{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Zy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zy(e),this._firestoreClient=void 0,await e}}}function w3(t,e){const r=typeof t=="object"?t:mT(),n=typeof t=="string"?t:"(default)",i=jg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=QR("firestore");a&&E3(i,...a)}return i}function vd(t){if(t._terminated)throw new $e(Se.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||T3(t),t._firestoreClient}function T3(t){var e,r,n;const i=t._freezeSettings(),a=function(c,u,h,d){return new Qb(c,u,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,uS(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new m3(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sc(Qr.fromBase64String(e))}catch(r){throw new $e(Se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new sc(Qr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(Se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(Se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(Se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=/^__.*__$/;class k3{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms):new nf(e,this.data,r,this.fieldTransforms)}}class hS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function dS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it()}}class xd{constructor(e,r,n,i,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Fu(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new xd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.xu({path:n,Nu:!1});return i.Lu(e),i}Bu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.xu({path:n,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return R0(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(dS(this.Mu)&&S3.test(e))throw this.qu('Document fields cannot begin and end with "__"')}}class A3{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||hd(e)}$u(e,r,n,i=!1){return new xd({Mu:e,methodName:r,Ku:n,path:qr.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uf(t){const e=t._freezeSettings(),r=hd(t._databaseId);return new A3(t._databaseId,!!e.ignoreUndefinedProperties,r)}function y1(t,e,r,n,i,a={}){const o=t.$u(a.merge||a.mergeFields?2:0,e,r,i);T1("Data must be an object, but it was:",o,n);const c=vS(n,o);let u,h;if(a.merge)u=new Zn(o.fieldMask),h=o.fieldTransforms;else if(a.mergeFields){const d=[];for(const g of a.mergeFields){const v=ug(e,g,r);if(!o.contains(v))throw new $e(Se.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);_S(d,v)||d.push(v)}u=new Zn(d),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new k3(new jn(c),u,h)}class _d extends cf{_toFieldTransform(e){if(e.Mu!==2)throw e.Mu===1?e.qu(`${this._methodName}() can only appear at the top level of your update data`):e.qu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _d}}function pS(t,e,r){return new xd({Mu:3,Ku:e.settings.Ku,methodName:t._methodName,Nu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class E1 extends cf{constructor(e,r){super(e),this.Uu=r}_toFieldTransform(e){const r=pS(this,e,!0),n=this.Uu.map(a=>qo(a,r)),i=new rc(n);return new A2(e.path,i)}isEqual(e){return e instanceof E1&&Yl(this.Uu,e.Uu)}}class w1 extends cf{constructor(e,r){super(e),this.Uu=r}_toFieldTransform(e){const r=pS(this,e,!0),n=this.Uu.map(a=>qo(a,r)),i=new nc(n);return new A2(e.path,i)}isEqual(e){return e instanceof w1&&Yl(this.Uu,e.Uu)}}function mS(t,e,r,n){const i=t.$u(1,e,r);T1("Data must be an object, but it was:",i,n);const a=[],o=jn.empty();Js(n,(u,h)=>{const d=S1(e,u,r);h=br(h);const g=i.Bu(d);if(h instanceof _d)a.push(d);else{const v=qo(h,g);v!=null&&(a.push(d),o.set(d,v))}});const c=new Zn(a);return new hS(o,c,i.fieldTransforms)}function gS(t,e,r,n,i,a){const o=t.$u(1,e,r),c=[ug(e,n,r)],u=[i];if(a.length%2!=0)throw new $e(Se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<a.length;v+=2)c.push(ug(e,a[v])),u.push(a[v+1]);const h=[],d=jn.empty();for(let v=c.length-1;v>=0;--v)if(!_S(h,c[v])){const _=c[v];let E=u[v];E=br(E);const y=o.Bu(_);if(E instanceof _d)h.push(_);else{const w=qo(E,y);w!=null&&(h.push(_),d.set(_,w))}}const g=new Zn(h);return new hS(d,g,o.fieldTransforms)}function C3(t,e,r,n=!1){return qo(r,t.$u(n?4:3,e))}function qo(t,e){if(xS(t=br(t)))return T1("Unsupported field value:",e,t),vS(t,e);if(t instanceof cf)return function(n,i){if(!dS(i.Mu))throw i.qu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(n,i){const a=[];let o=0;for(const c of n){let u=qo(c,i.ku(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=br(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return _O(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Rr.fromDate(n);return{timestampValue:k0(i.serializer,a)}}if(n instanceof Rr){const a=new Rr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:k0(i.serializer,a)}}if(n instanceof x1)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof sc)return{bytesValue:b2(i.serializer,n._byteString)};if(n instanceof An){const a=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw i.qu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:s1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof _1)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.qu("VectorValues must only contain numeric values.");return n1(c.serializer,u)})}}}}}}(n,i);throw i.qu(`Unsupported field value: ${md(n)}`)}(t,e)}function vS(t,e){const r={};return s2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Js(t,(n,i)=>{const a=qo(i,e.Ou(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function xS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Rr||t instanceof x1||t instanceof sc||t instanceof An||t instanceof cf||t instanceof _1)}function T1(t,e,r){if(!xS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=md(r);throw n==="an object"?e.qu(t+" a custom object"):e.qu(t+" "+n)}}function ug(t,e,r){if((e=br(e))instanceof lf)return e._internalPath;if(typeof e=="string")return S1(t,e);throw R0("Field path arguments must be of type string or ",t,!1,void 0,r)}const I3=new RegExp("[~\\*/\\[\\]]");function S1(t,e,r){if(e.search(I3)>=0)throw R0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new lf(...e.split("."))._internalPath}catch{throw R0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function R0(t,e,r,n,i){const a=n&&!n.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new $e(Se.INVALID_ARGUMENT,c+t+u)}function _S(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(k1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class R3 extends yS{data(){return super.data()}}function k1(t,e){return typeof e=="string"?S1(t,e):e instanceof lf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P3(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class A1{}class F3 extends A1{}function XH(t,e,...r){let n=[];e instanceof A1&&n.push(e),n=n.concat(r),function(a){const o=a.filter(u=>u instanceof C1).length,c=a.filter(u=>u instanceof yd).length;if(o>1||o>0&&c>0)throw new $e(Se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class yd extends F3{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new yd(e,r,n)}_apply(e){const r=this._parse(e);return ES(e._query,r),new xc(e.firestore,e.converter,eg(e._query,r))}_parse(e){const r=uf(e.firestore);return function(a,o,c,u,h,d,g){let v;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new $e(Se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){tE(g,d);const _=[];for(const E of g)_.push(eE(u,a,E));v={arrayValue:{values:_}}}else v=eE(u,a,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||tE(g,d),v=C3(c,o,g,d==="in"||d==="not-in");return Er.create(h,d,v)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function YH(t,e,r){const n=e,i=k1("where",t);return yd._create(i,n,r)}class C1 extends A1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new C1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:$i.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)ES(o,u),o=eg(o,u)}(e._query,r),new xc(e.firestore,e.converter,eg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function eE(t,e,r){if(typeof(r=br(r))=="string"){if(r==="")throw new $e(Se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!m2(e)&&r.indexOf("/")!==-1)throw new $e(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Kt.fromString(r));if(!Xe.isDocumentKey(n))throw new $e(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Ey(t,new Xe(n))}if(r instanceof An)return Ey(t,r._key);throw new $e(Se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${md(r)}.`)}function tE(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(Se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ES(t,e){const r=function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new $e(Se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class b3{convertValue(e,r="none"){switch(qs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw it()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Js(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,i;const a=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>cr(o.doubleValue));return new _1(a)}convertGeoPoint(e){return new x1(cr(e.latitude),cr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ad(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(bu(e));default:return null}}convertTimestamp(e){const r=Gs(e);return new Rr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Kt.fromString(e);bt(V2(n));const i=new Ou(n.get(1),n.get(3)),a=new Xe(n.popFirst(5));return i.isEqual(r)||qa(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wS extends yS{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new o0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(k1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class o0 extends wS{data(e={}){return super.data(e)}}class O3{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new lu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new o0(this._firestore,this._userDataWriter,n.key,n,new lu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(Se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const u=new o0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new o0(i._firestore,i._userDataWriter,c.doc.key,c.doc,new lu(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:D3(c.type),doc:u,oldIndex:h,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function D3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QH(t){t=gi(t,An);const e=gi(t.firestore,eo);return x3(vd(e),t._key).then(r=>N3(e,t,r))}class TS extends b3{constructor(e){super(),this.firestore=e}convertBytes(e){return new sc(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,r)}}function ff(t){t=gi(t,xc);const e=gi(t.firestore,eo),r=vd(e),n=new TS(e);return P3(t._query),_3(r,t._query).then(i=>new O3(e,n,t,i))}function JH(t,e,r){t=gi(t,An);const n=gi(t.firestore,eo),i=I1(t.converter,e,r);return hf(n,[y1(uf(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,kn.none())])}function to(t,e,r,...n){t=gi(t,An);const i=gi(t.firestore,eo),a=uf(i);let o;return o=typeof(e=br(e))=="string"||e instanceof lf?gS(a,"updateDoc",t._key,e,r,n):mS(a,"updateDoc",t._key,e),hf(i,[o.toMutation(t._key,kn.exists(!0))])}function R1(t){return hf(gi(t.firestore,eo),[new ud(t._key,kn.none())])}function P1(t,e){const r=gi(t.firestore,eo),n=ti(t),i=I1(t.converter,e);return hf(r,[y1(uf(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,kn.exists(!1))]).then(()=>n)}function hf(t,e){return function(n,i){const a=new $a;return n.asyncQueue.enqueueAndForget(async()=>s3(await v3(n),i,a)),a.promise}(vd(t),e)}function N3(t,e,r){const n=r.docs.get(e._key),i=new TS(t);return new wS(t,i,e._key,n,new lu(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=uf(e)}set(e,r,n){this._verifyNotCommitted();const i=_m(e,this._firestore),a=I1(i.converter,r,n),o=y1(this._dataReader,"WriteBatch.set",i._key,a,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,kn.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const a=_m(e,this._firestore);let o;return o=typeof(r=br(r))=="string"||r instanceof lf?gS(this._dataReader,"WriteBatch.update",a._key,r,n,i):mS(this._dataReader,"WriteBatch.update",a._key,r),this._mutations.push(o.toMutation(a._key,kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=_m(e,this._firestore);return this._mutations=this._mutations.concat(new ud(r._key,kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(Se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _m(t,e){if((t=br(t)).firestore!==e)throw new $e(Se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function SS(...t){return new E1("arrayUnion",t)}function kS(...t){return new w1("arrayRemove",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(t){return vd(t=gi(t,eo)),new L3(t,e=>hf(t,e))}(function(e,r=!0){(function(i){pc=i})(dc),Ql(new No("firestore",(n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),c=new eo(new Db(n.getProvider("auth-internal")),new Vb(n.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new $e(Se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ou(h.options.projectId,d)}(o,i),o);return a=Object.assign({useFetchStreams:r},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),Us(my,"4.7.5",e),Us(my,"4.7.5","esm2017")})();const V3={apiKey:"AIzaSyAxlL6dXgQ2JOjkwUNeWTdpretOWzf55tk",authDomain:"learn-track-center.firebaseapp.com",projectId:"learn-track-center",storageBucket:"learn-track-center.firebasestorage.app",messagingSenderId:'"651698569013",',appId:"1:651698569013:web:d8a9a0d97fef19f23bd67c",measurementId:"G-SHQ8L381Z5"},AS=pT(V3),ur=w3(AS),B3=Ib(AS),ZH=new La,CS=()=>{const[t,e]=G.useState(null),[r,n]=G.useState(!0);return G.useEffect(()=>{const i=xF(B3,a=>{e(a),n(!1)});return()=>i()},[]),{user:t,loading:r}},Ed=({type:t="loader",children:e,text:r,className:n})=>Y.jsx("div",{className:`loading-container ${n}`,children:t==="spinner"||e?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"spinner"}),r&&Y.jsx("p",{children:r}),Y.jsx("p",{children:e})]}):Y.jsxs(Y.Fragment,{children:[r&&Y.jsx("div",{className:"loading-text",children:Y.jsx("p",{children:r})}),Y.jsx("div",{className:"loader",children:e})]})}),Vn=({element:t})=>{const{user:e,loading:r}=CS();return r?Y.jsx(Ed,{}):e?Y.jsx(Y.Fragment,{children:t}):Y.jsx(tT,{to:"/",replace:!0})};function Nu(t,e){const[r,n]=G.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):e}catch(i){return console.error(i),e}});return G.useEffect(()=>{try{window.localStorage.setItem(t,JSON.stringify(r))}catch(i){console.error(i)}},[t,r]),[r,n]}const U3=({message:t,type:e,timeout:r=5e3,onClose:n})=>(G.useEffect(()=>{if(r===0)return;const i=setTimeout(()=>{n()},r);return()=>clearTimeout(i)},[n,r]),Y.jsxs("div",{className:`notification ${e}`,children:[Y.jsx("span",{children:t}),Y.jsx("button",{className:"close-button",onClick:n,children:""})]})),IS=G.createContext(void 0),F1=()=>{const t=G.useContext(IS);if(!t)throw new Error("useNotification must be used within a NotificationProvider");return t},j3=({children:t})=>{const[e,r]=G.useState([]),n=(a,o,c)=>{const u=Date.now();r(h=>{const d=[...h,{id:u,message:a,type:o,timeout:c}];return d.length>5?d.slice(-5):d}),c&&c>0&&setTimeout(()=>{i(u)},c)},i=a=>{r(o=>o.filter(c=>c.id!==a))};return Y.jsxs(IS.Provider,{value:{showNotification:n},children:[Y.jsx("div",{className:"notification-container",children:e.map(a=>Y.jsx(U3,{message:a.message,type:a.type,onClose:()=>i(a.id),timeout:a.timeout},a.id))}),t]})},$3=async()=>{const t=Za(ur,"courses");return(await ff(t)).docs.map(r=>({id:r.id,...r.data()}))},H3=async t=>{const e=Za(ur,`periods/${t}/courses`);return(await ff(e)).docs.map(n=>({id:n.id,...n.data()}))},z3=async(t,e)=>{const r=Za(ur,`periods/${t}/courses`),n=await P1(r,{...e});console.log("Course added with ID: ",n.id);const i=ti(ur,`periods/${t}`);await to(i,{coursesIds:SS(n.id)})},W3=async(t,e)=>{const r=ti(ur,`periods/${t}/courses`,e);await R1(r);const n=ti(ur,`periods/${t}`);await to(n,{coursesIds:kS(e)})},G3=async(t,e,r)=>{const n=ti(ur,`periods/${t}/courses`,e),{id:i,...a}=r;await to(n,a),console.log("Course updated with ID: ",e)},RS=G.createContext(void 0),K3=({children:t})=>{const[e,r]=G.useState(!1),[n,i]=G.useState("");return Y.jsxs(RS.Provider,{value:{isLoading:e,loadingText:n,setIsLoading:r,setLoadingText:i},children:[e&&Y.jsx(Ed,{text:n}),t]})},PS=()=>{const t=G.useContext(RS);if(t===void 0)throw new Error("useLoading must be used within a LoadingProvider");return t},FS=async()=>{const t=Za(ur,"teachers");return(await ff(t)).docs.map(n=>({id:n.id,...n.data()}))},q3=async t=>{const e=Za(ur,"teachers");await P1(e,t)},X3=async(t,e)=>{const r=ti(ur,`teachers/${t}`),{id:n,...i}=e;await to(r,i)},Y3=async t=>{const e=ti(ur,"teachers",t);await R1(e)},Q3=t=>{const[e,r]=G.useState([]),[n,i]=G.useState(!0),[a,o]=G.useState(null),[c,u]=Nu("availableTeachers",[]),[h,d]=Nu("availableCourses",[]),{showNotification:g}=F1(),{setIsLoading:v}=PS();G.useEffect(()=>{v(n)},[n,v]);const _=async()=>{try{i(!0);const U=(await H3(t)).map(V=>{const z=c.find(A=>A.id===V.teacherId);return{...V,teacherName:z?z.name:"Unknown Teacher"}});r(U)}catch{g("Error fetching courses","error")}finally{i(!1)}},E=async()=>{try{i(!0);const C=await $3();d(C)}catch{g("Error fetching courses","error")}finally{i(!1)}},y=async()=>{try{i(!0);const C=await FS();u(C)}catch{g("Error fetching courses","error")}finally{i(!1)}};return G.useEffect(()=>{_(),E(),y()},[]),{courses:e,availableCourses:h,availableTeachers:c,loading:n,error:a,handleAddCourse:async C=>{try{if(e.filter(U=>U.courseId===C.courseId).length>0){g("Course already added","error");return}i(!0),await z3(t,C),_()}catch{g("Error adding course","error")}finally{i(!1)}},handleDeleteCourse:async C=>{try{if(!C)return;i(!0),await W3(t,C),_()}catch{o("Error deleting course"),g("Error deleting course","error")}finally{i(!1)}},handleUpdateCourse:async(C,U)=>{try{if(!t)return;i(!0),await G3(t,C,U),_()}catch{o("Error update course"),g("Error update course","error")}finally{i(!1)}}}};function Bo(t){"@babel/helpers - typeof";return Bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bo(t)}function J3(t,e){if(Bo(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bS(t){var e=J3(t,"string");return Bo(e)=="symbol"?e:e+""}function cu(t,e,r){return(e=bS(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rE(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Je(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rE(Object(r),!0).forEach(function(n){cu(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Z3(t){if(Array.isArray(t))return t}function eN(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,o,c=[],u=!0,h=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(d){h=!0,i=d}finally{try{if(!u&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw i}}return c}}function fg(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function OS(t,e){if(t){if(typeof t=="string")return fg(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fg(t,e):void 0}}function tN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ha(t,e){return Z3(t)||eN(t,e)||OS(t,e)||tN()}function rN(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}function es(t,e){if(t==null)return{};var r,n,i=rN(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var nN=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function iN(t){var e=t.defaultInputValue,r=e===void 0?"":e,n=t.defaultMenuIsOpen,i=n===void 0?!1:n,a=t.defaultValue,o=a===void 0?null:a,c=t.inputValue,u=t.menuIsOpen,h=t.onChange,d=t.onInputChange,g=t.onMenuClose,v=t.onMenuOpen,_=t.value,E=es(t,nN),y=G.useState(c!==void 0?c:r),w=Ha(y,2),k=w[0],F=w[1],C=G.useState(u!==void 0?u:i),U=Ha(C,2),V=U[0],z=U[1],A=G.useState(_!==void 0?_:o),P=Ha(A,2),R=P[0],M=P[1],L=G.useCallback(function(Ee,ie){typeof h=="function"&&h(Ee,ie),M(Ee)},[h]),N=G.useCallback(function(Ee,ie){var xe;typeof d=="function"&&(xe=d(Ee,ie)),F(xe!==void 0?xe:Ee)},[d]),B=G.useCallback(function(){typeof v=="function"&&v(),z(!0)},[v]),Oe=G.useCallback(function(){typeof g=="function"&&g(),z(!1)},[g]),we=c!==void 0?c:k,Ce=u!==void 0?u:V,Ae=_!==void 0?_:R;return Je(Je({},E),{},{inputValue:we,menuIsOpen:Ce,onChange:L,onInputChange:N,onMenuClose:Oe,onMenuOpen:B,value:Ae})}function Ze(){return Ze=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ze.apply(null,arguments)}function aN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nE(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bS(n.key),n)}}function sN(t,e,r){return nE(t.prototype,e),nE(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hg(t,e){return hg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},hg(t,e)}function oN(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hg(t,e)}function P0(t){return P0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P0(t)}function DS(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DS=function(){return!!t})()}function lN(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cN(t,e){if(e&&(Bo(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lN(t)}function uN(t){var e=DS();return function(){var r,n=P0(t);if(e){var i=P0(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return cN(this,r)}}function fN(t){if(Array.isArray(t))return fg(t)}function hN(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b1(t){return fN(t)||hN(t)||OS(t)||dN()}var pN=!1;function mN(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function gN(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var vN=function(){function t(r){var n=this;this._insertTag=function(i){var a;n.tags.length===0?n.insertionPoint?a=n.insertionPoint.nextSibling:n.prepend?a=n.container.firstChild:a=n.before:a=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,a),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!pN:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(gN(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=mN(i);try{a.insertRule(n,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t}(),sn="-ms-",F0="-moz-",Rt="-webkit-",NS="comm",O1="rule",D1="decl",xN="@import",LS="@keyframes",_N="@layer",yN=Math.abs,wd=String.fromCharCode,EN=Object.assign;function wN(t,e){return Gr(t,0)^45?(((e<<2^Gr(t,0))<<2^Gr(t,1))<<2^Gr(t,2))<<2^Gr(t,3):0}function MS(t){return t.trim()}function TN(t,e){return(t=e.exec(t))?t[0]:t}function Pt(t,e,r){return t.replace(e,r)}function dg(t,e){return t.indexOf(e)}function Gr(t,e){return t.charCodeAt(e)|0}function Lu(t,e,r){return t.slice(e,r)}function aa(t){return t.length}function N1(t){return t.length}function Lh(t,e){return e.push(t),t}function SN(t,e){return t.map(e).join("")}var Td=1,oc=1,VS=0,$n=0,yr=0,_c="";function Sd(t,e,r,n,i,a,o){return{value:t,root:e,parent:r,type:n,props:i,children:a,line:Td,column:oc,length:o,return:""}}function nu(t,e){return EN(Sd("",null,null,"",null,null,0),t,{length:-t.length},e)}function kN(){return yr}function AN(){return yr=$n>0?Gr(_c,--$n):0,oc--,yr===10&&(oc=1,Td--),yr}function ei(){return yr=$n<VS?Gr(_c,$n++):0,oc++,yr===10&&(oc=1,Td++),yr}function fa(){return Gr(_c,$n)}function l0(){return $n}function df(t,e){return Lu(_c,t,e)}function Mu(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function BS(t){return Td=oc=1,VS=aa(_c=t),$n=0,[]}function US(t){return _c="",t}function c0(t){return MS(df($n-1,pg(t===91?t+2:t===40?t+1:t)))}function CN(t){for(;(yr=fa())&&yr<33;)ei();return Mu(t)>2||Mu(yr)>3?"":" "}function IN(t,e){for(;--e&&ei()&&!(yr<48||yr>102||yr>57&&yr<65||yr>70&&yr<97););return df(t,l0()+(e<6&&fa()==32&&ei()==32))}function pg(t){for(;ei();)switch(yr){case t:return $n;case 34:case 39:t!==34&&t!==39&&pg(yr);break;case 40:t===41&&pg(t);break;case 92:ei();break}return $n}function RN(t,e){for(;ei()&&t+yr!==57;)if(t+yr===84&&fa()===47)break;return"/*"+df(e,$n-1)+"*"+wd(t===47?t:ei())}function PN(t){for(;!Mu(fa());)ei();return df(t,$n)}function FN(t){return US(u0("",null,null,null,[""],t=BS(t),0,[0],t))}function u0(t,e,r,n,i,a,o,c,u){for(var h=0,d=0,g=o,v=0,_=0,E=0,y=1,w=1,k=1,F=0,C="",U=i,V=a,z=n,A=C;w;)switch(E=F,F=ei()){case 40:if(E!=108&&Gr(A,g-1)==58){dg(A+=Pt(c0(F),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:A+=c0(F);break;case 9:case 10:case 13:case 32:A+=CN(E);break;case 92:A+=IN(l0()-1,7);continue;case 47:switch(fa()){case 42:case 47:Lh(bN(RN(ei(),l0()),e,r),u);break;default:A+="/"}break;case 123*y:c[h++]=aa(A)*k;case 125*y:case 59:case 0:switch(F){case 0:case 125:w=0;case 59+d:k==-1&&(A=Pt(A,/\f/g,"")),_>0&&aa(A)-g&&Lh(_>32?aE(A+";",n,r,g-1):aE(Pt(A," ","")+";",n,r,g-2),u);break;case 59:A+=";";default:if(Lh(z=iE(A,e,r,h,d,i,c,C,U=[],V=[],g),a),F===123)if(d===0)u0(A,e,z,z,U,a,g,c,V);else switch(v===99&&Gr(A,3)===110?100:v){case 100:case 108:case 109:case 115:u0(t,z,z,n&&Lh(iE(t,z,z,0,0,i,c,C,i,U=[],g),V),i,V,g,c,n?U:V);break;default:u0(A,z,z,z,[""],V,0,c,V)}}h=d=_=0,y=k=1,C=A="",g=o;break;case 58:g=1+aa(A),_=E;default:if(y<1){if(F==123)--y;else if(F==125&&y++==0&&AN()==125)continue}switch(A+=wd(F),F*y){case 38:k=d>0?1:(A+="\f",-1);break;case 44:c[h++]=(aa(A)-1)*k,k=1;break;case 64:fa()===45&&(A+=c0(ei())),v=fa(),d=g=aa(C=A+=PN(l0())),F++;break;case 45:E===45&&aa(A)==2&&(y=0)}}return a}function iE(t,e,r,n,i,a,o,c,u,h,d){for(var g=i-1,v=i===0?a:[""],_=N1(v),E=0,y=0,w=0;E<n;++E)for(var k=0,F=Lu(t,g+1,g=yN(y=o[E])),C=t;k<_;++k)(C=MS(y>0?v[k]+" "+F:Pt(F,/&\f/g,v[k])))&&(u[w++]=C);return Sd(t,e,r,i===0?O1:c,u,h,d)}function bN(t,e,r){return Sd(t,e,r,NS,wd(kN()),Lu(t,2,-2),0)}function aE(t,e,r,n){return Sd(t,e,r,D1,Lu(t,0,n),Lu(t,n+1,-1),n)}function Gl(t,e){for(var r="",n=N1(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function ON(t,e,r,n){switch(t.type){case _N:if(t.children.length)break;case xN:case D1:return t.return=t.return||t.value;case NS:return"";case LS:return t.return=t.value+"{"+Gl(t.children,n)+"}";case O1:t.value=t.props.join(",")}return aa(r=Gl(t.children,n))?t.return=t.value+"{"+r+"}":""}function DN(t){var e=N1(t);return function(r,n,i,a){for(var o="",c=0;c<e;c++)o+=t[c](r,n,i,a)||"";return o}}function NN(t){return function(e){e.root||(e=e.return)&&t(e)}}function LN(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var MN=function(e,r,n){for(var i=0,a=0;i=a,a=fa(),i===38&&a===12&&(r[n]=1),!Mu(a);)ei();return df(e,$n)},VN=function(e,r){var n=-1,i=44;do switch(Mu(i)){case 0:i===38&&fa()===12&&(r[n]=1),e[n]+=MN($n-1,r,n);break;case 2:e[n]+=c0(i);break;case 4:if(i===44){e[++n]=fa()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=wd(i)}while(i=ei());return e},BN=function(e,r){return US(VN(BS(e),r))},sE=new WeakMap,UN=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!sE.get(n))&&!i){sE.set(e,!0);for(var a=[],o=BN(r,a),c=n.props,u=0,h=0;u<o.length;u++)for(var d=0;d<c.length;d++,h++)e.props[h]=a[u]?o[u].replace(/&\f/g,c[d]):c[d]+" "+o[u]}}},jN=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function jS(t,e){switch(wN(t,e)){case 5103:return Rt+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Rt+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Rt+t+F0+t+sn+t+t;case 6828:case 4268:return Rt+t+sn+t+t;case 6165:return Rt+t+sn+"flex-"+t+t;case 5187:return Rt+t+Pt(t,/(\w+).+(:[^]+)/,Rt+"box-$1$2"+sn+"flex-$1$2")+t;case 5443:return Rt+t+sn+"flex-item-"+Pt(t,/flex-|-self/,"")+t;case 4675:return Rt+t+sn+"flex-line-pack"+Pt(t,/align-content|flex-|-self/,"")+t;case 5548:return Rt+t+sn+Pt(t,"shrink","negative")+t;case 5292:return Rt+t+sn+Pt(t,"basis","preferred-size")+t;case 6060:return Rt+"box-"+Pt(t,"-grow","")+Rt+t+sn+Pt(t,"grow","positive")+t;case 4554:return Rt+Pt(t,/([^-])(transform)/g,"$1"+Rt+"$2")+t;case 6187:return Pt(Pt(Pt(t,/(zoom-|grab)/,Rt+"$1"),/(image-set)/,Rt+"$1"),t,"")+t;case 5495:case 3959:return Pt(t,/(image-set\([^]*)/,Rt+"$1$`$1");case 4968:return Pt(Pt(t,/(.+:)(flex-)?(.*)/,Rt+"box-pack:$3"+sn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Rt+t+t;case 4095:case 3583:case 4068:case 2532:return Pt(t,/(.+)-inline(.+)/,Rt+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(aa(t)-1-e>6)switch(Gr(t,e+1)){case 109:if(Gr(t,e+4)!==45)break;case 102:return Pt(t,/(.+:)(.+)-([^]+)/,"$1"+Rt+"$2-$3$1"+F0+(Gr(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~dg(t,"stretch")?jS(Pt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Gr(t,e+1)!==115)break;case 6444:switch(Gr(t,aa(t)-3-(~dg(t,"!important")&&10))){case 107:return Pt(t,":",":"+Rt)+t;case 101:return Pt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Rt+(Gr(t,14)===45?"inline-":"")+"box$3$1"+Rt+"$2$3$1"+sn+"$2box$3")+t}break;case 5936:switch(Gr(t,e+11)){case 114:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Rt+t+sn+Pt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Rt+t+sn+t+t}return t}var $N=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case D1:e.return=jS(e.value,e.length);break;case LS:return Gl([nu(e,{value:Pt(e.value,"@","@"+Rt)})],i);case O1:if(e.length)return SN(e.props,function(a){switch(TN(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Gl([nu(e,{props:[Pt(a,/:(read-\w+)/,":"+F0+"$1")]})],i);case"::placeholder":return Gl([nu(e,{props:[Pt(a,/:(plac\w+)/,":"+Rt+"input-$1")]}),nu(e,{props:[Pt(a,/:(plac\w+)/,":"+F0+"$1")]}),nu(e,{props:[Pt(a,/:(plac\w+)/,sn+"input-$1")]})],i)}return""})}},HN=[$N],zN=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(y){var w=y.getAttribute("data-emotion");w.indexOf(" ")!==-1&&(document.head.appendChild(y),y.setAttribute("data-s",""))})}var i=e.stylisPlugins||HN,a={},o,c=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(y){for(var w=y.getAttribute("data-emotion").split(" "),k=1;k<w.length;k++)a[w[k]]=!0;c.push(y)});var u,h=[UN,jN];{var d,g=[ON,NN(function(y){d.insert(y)})],v=DN(h.concat(i,g)),_=function(w){return Gl(FN(w),v)};u=function(w,k,F,C){d=F,_(w?w+"{"+k.styles+"}":k.styles),C&&(E.inserted[k.name]=!0)}}var E={key:r,sheet:new vN({key:r,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:a,registered:{},insert:u};return E.sheet.hydrate(c),E},ym={exports:{}},Ft={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function WN(){if(oE)return Ft;oE=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,n=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,a=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,c=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,h=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,g=t?Symbol.for("react.suspense"):60113,v=t?Symbol.for("react.suspense_list"):60120,_=t?Symbol.for("react.memo"):60115,E=t?Symbol.for("react.lazy"):60116,y=t?Symbol.for("react.block"):60121,w=t?Symbol.for("react.fundamental"):60117,k=t?Symbol.for("react.responder"):60118,F=t?Symbol.for("react.scope"):60119;function C(V){if(typeof V=="object"&&V!==null){var z=V.$$typeof;switch(z){case e:switch(V=V.type,V){case u:case h:case n:case a:case i:case g:return V;default:switch(V=V&&V.$$typeof,V){case c:case d:case E:case _:case o:return V;default:return z}}case r:return z}}}function U(V){return C(V)===h}return Ft.AsyncMode=u,Ft.ConcurrentMode=h,Ft.ContextConsumer=c,Ft.ContextProvider=o,Ft.Element=e,Ft.ForwardRef=d,Ft.Fragment=n,Ft.Lazy=E,Ft.Memo=_,Ft.Portal=r,Ft.Profiler=a,Ft.StrictMode=i,Ft.Suspense=g,Ft.isAsyncMode=function(V){return U(V)||C(V)===u},Ft.isConcurrentMode=U,Ft.isContextConsumer=function(V){return C(V)===c},Ft.isContextProvider=function(V){return C(V)===o},Ft.isElement=function(V){return typeof V=="object"&&V!==null&&V.$$typeof===e},Ft.isForwardRef=function(V){return C(V)===d},Ft.isFragment=function(V){return C(V)===n},Ft.isLazy=function(V){return C(V)===E},Ft.isMemo=function(V){return C(V)===_},Ft.isPortal=function(V){return C(V)===r},Ft.isProfiler=function(V){return C(V)===a},Ft.isStrictMode=function(V){return C(V)===i},Ft.isSuspense=function(V){return C(V)===g},Ft.isValidElementType=function(V){return typeof V=="string"||typeof V=="function"||V===n||V===h||V===a||V===i||V===g||V===v||typeof V=="object"&&V!==null&&(V.$$typeof===E||V.$$typeof===_||V.$$typeof===o||V.$$typeof===c||V.$$typeof===d||V.$$typeof===w||V.$$typeof===k||V.$$typeof===F||V.$$typeof===y)},Ft.typeOf=C,Ft}var lE;function GN(){return lE||(lE=1,ym.exports=WN()),ym.exports}var Em,cE;function KN(){if(cE)return Em;cE=1;var t=GN(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};a[t.ForwardRef]=n,a[t.Memo]=i;function o(E){return t.isMemo(E)?i:a[E.$$typeof]||e}var c=Object.defineProperty,u=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,v=Object.prototype;function _(E,y,w){if(typeof y!="string"){if(v){var k=g(y);k&&k!==v&&_(E,k,w)}var F=u(y);h&&(F=F.concat(h(y)));for(var C=o(E),U=o(y),V=0;V<F.length;++V){var z=F[V];if(!r[z]&&!(w&&w[z])&&!(U&&U[z])&&!(C&&C[z])){var A=d(y,z);try{c(E,z,A)}catch{}}}}return E}return Em=_,Em}KN();var qN=!0;function XN(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var $S=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||qN===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},YN=function(e,r,n){$S(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var a=r;do e.insert(r===a?"."+i:"",a,e.sheet,!0),a=a.next;while(a!==void 0)}};function QN(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var JN={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ZN=/[A-Z]|^ms/g,eL=/_EMO_([^_]+?)_([^]*?)_EMO_/g,HS=function(e){return e.charCodeAt(1)===45},uE=function(e){return e!=null&&typeof e!="boolean"},wm=LN(function(t){return HS(t)?t:t.replace(ZN,"-$&").toLowerCase()}),fE=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(eL,function(n,i,a){return sa={name:i,styles:a,next:sa},i})}return JN[e]!==1&&!HS(e)&&typeof r=="number"&&r!==0?r+"px":r};function Vu(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return sa={name:i.name,styles:i.styles,next:sa},i.name;var a=r;if(a.styles!==void 0){var o=a.next;if(o!==void 0)for(;o!==void 0;)sa={name:o.name,styles:o.styles,next:sa},o=o.next;var c=a.styles+";";return c}return tL(t,e,r)}case"function":{if(t!==void 0){var u=sa,h=r(t);return sa=u,Vu(t,e,h)}break}}var d=r;return d}function tL(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Vu(t,e,r[i])+";";else for(var a in r){var o=r[a];if(typeof o!="object"){var c=o;uE(c)&&(n+=wm(a)+":"+fE(a,c)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&e==null)for(var u=0;u<o.length;u++)uE(o[u])&&(n+=wm(a)+":"+fE(a,o[u])+";");else{var h=Vu(t,e,o);switch(a){case"animation":case"animationName":{n+=wm(a)+":"+h+";";break}default:n+=a+"{"+h+"}"}}}return n}var hE=/label:\s*([^\s;{]+)\s*(;|$)/g,sa;function zS(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";sa=void 0;var a=t[0];if(a==null||a.raw===void 0)n=!1,i+=Vu(r,e,a);else{var o=a;i+=o[0]}for(var c=1;c<t.length;c++)if(i+=Vu(r,e,t[c]),n){var u=a;i+=u[c]}hE.lastIndex=0;for(var h="",d;(d=hE.exec(i))!==null;)h+="-"+d[1];var g=QN(i)+h;return{name:g,styles:i,next:sa}}var rL=function(e){return e()},nL=A_.useInsertionEffect?A_.useInsertionEffect:!1,iL=nL||rL,aL=!1,WS=G.createContext(typeof HTMLElement<"u"?zN({key:"css"}):null);WS.Provider;var sL=function(e){return G.forwardRef(function(r,n){var i=G.useContext(WS);return e(r,i,n)})},oL=G.createContext({}),L1={}.hasOwnProperty,mg="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",lL=function(e,r){var n={};for(var i in r)L1.call(r,i)&&(n[i]=r[i]);return n[mg]=e,n},cL=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return $S(r,n,i),iL(function(){return YN(r,n,i)}),null},uL=sL(function(t,e,r){var n=t.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var i=t[mg],a=[n],o="";typeof t.className=="string"?o=XN(e.registered,a,t.className):t.className!=null&&(o=t.className+" ");var c=zS(a,void 0,G.useContext(oL));o+=e.key+"-"+c.name;var u={};for(var h in t)L1.call(t,h)&&h!=="css"&&h!==mg&&!aL&&(u[h]=t[h]);return u.className=o,r&&(u.ref=r),G.createElement(G.Fragment,null,G.createElement(cL,{cache:e,serialized:c,isStringTag:typeof i=="string"}),G.createElement(i,u))}),fL=uL,qe=function(e,r){var n=arguments;if(r==null||!L1.call(r,"css"))return G.createElement.apply(void 0,n);var i=n.length,a=new Array(i);a[0]=fL,a[1]=lL(e,r);for(var o=2;o<i;o++)a[o]=n[o];return G.createElement.apply(null,a)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(qe);function M1(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return zS(e)}function hL(){var t=M1.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function dL(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const pL=Math.min,mL=Math.max,b0=Math.round,Mh=Math.floor,O0=t=>({x:t,y:t});function gL(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}function kd(){return typeof window<"u"}function GS(t){return qS(t)?(t.nodeName||"").toLowerCase():"#document"}function Ya(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function KS(t){var e;return(e=(qS(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function qS(t){return kd()?t instanceof Node||t instanceof Ya(t).Node:!1}function vL(t){return kd()?t instanceof Element||t instanceof Ya(t).Element:!1}function V1(t){return kd()?t instanceof HTMLElement||t instanceof Ya(t).HTMLElement:!1}function dE(t){return!kd()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ya(t).ShadowRoot}function XS(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=B1(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function xL(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function _L(t){return["html","body","#document"].includes(GS(t))}function B1(t){return Ya(t).getComputedStyle(t)}function yL(t){if(GS(t)==="html")return t;const e=t.assignedSlot||t.parentNode||dE(t)&&t.host||KS(t);return dE(e)?e.host:e}function YS(t){const e=yL(t);return _L(e)?t.ownerDocument?t.ownerDocument.body:t.body:V1(e)&&XS(e)?e:YS(e)}function D0(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=YS(t),a=i===((n=t.ownerDocument)==null?void 0:n.body),o=Ya(i);if(a){const c=gg(o);return e.concat(o,o.visualViewport||[],XS(i)?i:[],c&&r?D0(c):[])}return e.concat(i,D0(i,[],r))}function gg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function EL(t){const e=B1(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=V1(t),a=i?t.offsetWidth:r,o=i?t.offsetHeight:n,c=b0(r)!==a||b0(n)!==o;return c&&(r=a,n=o),{width:r,height:n,$:c}}function U1(t){return vL(t)?t:t.contextElement}function pE(t){const e=U1(t);if(!V1(e))return O0(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:a}=EL(e);let o=(a?b0(r.width):r.width)/n,c=(a?b0(r.height):r.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const wL=O0(0);function TL(t){const e=Ya(t);return!xL()||!e.visualViewport?wL:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function SL(t,e,r){return!1}function mE(t,e,r,n){e===void 0&&(e=!1);const i=t.getBoundingClientRect(),a=U1(t);let o=O0(1);e&&(o=pE(t));const c=SL()?TL(a):O0(0);let u=(i.left+c.x)/o.x,h=(i.top+c.y)/o.y,d=i.width/o.x,g=i.height/o.y;if(a){const v=Ya(a),_=n;let E=v,y=gg(E);for(;y&&n&&_!==E;){const w=pE(y),k=y.getBoundingClientRect(),F=B1(y),C=k.left+(y.clientLeft+parseFloat(F.paddingLeft))*w.x,U=k.top+(y.clientTop+parseFloat(F.paddingTop))*w.y;u*=w.x,h*=w.y,d*=w.x,g*=w.y,u+=C,h+=U,E=Ya(y),y=gg(E)}}return gL({width:d,height:g,x:u,y:h})}function kL(t,e){let r=null,n;const i=KS(t);function a(){var c;clearTimeout(n),(c=r)==null||c.disconnect(),r=null}function o(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),a();const{left:h,top:d,width:g,height:v}=t.getBoundingClientRect();if(c||e(),!g||!v)return;const _=Mh(d),E=Mh(i.clientWidth-(h+g)),y=Mh(i.clientHeight-(d+v)),w=Mh(h),F={rootMargin:-_+"px "+-E+"px "+-y+"px "+-w+"px",threshold:mL(0,pL(1,u))||1};let C=!0;function U(V){const z=V[0].intersectionRatio;if(z!==u){if(!C)return o();z?o(!1,z):n=setTimeout(()=>{o(!1,1e-7)},1e3)}C=!1}try{r=new IntersectionObserver(U,{...F,root:i.ownerDocument})}catch{r=new IntersectionObserver(U,F)}r.observe(t)}return o(!0),a}function AL(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,h=U1(t),d=i||a?[...h?D0(h):[],...D0(e)]:[];d.forEach(k=>{i&&k.addEventListener("scroll",r,{passive:!0}),a&&k.addEventListener("resize",r)});const g=h&&c?kL(h,r):null;let v=-1,_=null;o&&(_=new ResizeObserver(k=>{let[F]=k;F&&F.target===h&&_&&(_.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var C;(C=_)==null||C.observe(e)})),r()}),h&&!u&&_.observe(h),_.observe(e));let E,y=u?mE(t):null;u&&w();function w(){const k=mE(t);y&&(k.x!==y.x||k.y!==y.y||k.width!==y.width||k.height!==y.height)&&r(),y=k,E=requestAnimationFrame(w)}return r(),()=>{var k;d.forEach(F=>{i&&F.removeEventListener("scroll",r),a&&F.removeEventListener("resize",r)}),g==null||g(),(k=_)==null||k.disconnect(),_=null,u&&cancelAnimationFrame(E)}}var vg=G.useLayoutEffect,CL=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],N0=function(){};function IL(t,e){return e?e[0]==="-"?t+e:t+"__"+e:t}function RL(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var a=[].concat(n);if(e&&t)for(var o in e)e.hasOwnProperty(o)&&e[o]&&a.push("".concat(IL(t,o)));return a.filter(function(c){return c}).map(function(c){return String(c).trim()}).join(" ")}var gE=function(e){return VL(e)?e.filter(Boolean):Bo(e)==="object"&&e!==null?[e]:[]},QS=function(e){e.className,e.clearValue,e.cx,e.getStyles,e.getClassNames,e.getValue,e.hasValue,e.isMulti,e.isRtl,e.options,e.selectOption,e.selectProps,e.setValue,e.theme;var r=es(e,CL);return Je({},r)},ir=function(e,r,n){var i=e.cx,a=e.getStyles,o=e.getClassNames,c=e.className;return{css:a(r,e),className:i(n??{},o(r,e),c)}};function Ad(t){return[document.documentElement,document.body,window].indexOf(t)>-1}function PL(t){return Ad(t)?window.innerHeight:t.clientHeight}function JS(t){return Ad(t)?window.pageYOffset:t.scrollTop}function L0(t,e){if(Ad(t)){window.scrollTo(0,e);return}t.scrollTop=e}function FL(t){var e=getComputedStyle(t),r=e.position==="absolute",n=/(auto|scroll)/;if(e.position==="fixed")return document.documentElement;for(var i=t;i=i.parentElement;)if(e=getComputedStyle(i),!(r&&e.position==="static")&&n.test(e.overflow+e.overflowY+e.overflowX))return i;return document.documentElement}function bL(t,e,r,n){return r*((t=t/n-1)*t*t+1)+e}function Vh(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:N0,i=JS(t),a=e-i,o=10,c=0;function u(){c+=o;var h=bL(c,i,a,r);L0(t,h),c<r?window.requestAnimationFrame(u):n(t)}u()}function vE(t,e){var r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=e.offsetHeight/3;n.bottom+i>r.bottom?L0(t,Math.min(e.offsetTop+e.clientHeight-t.offsetHeight+i,t.scrollHeight)):n.top-i<r.top&&L0(t,Math.max(e.offsetTop-i,0))}function OL(t){var e=t.getBoundingClientRect();return{bottom:e.bottom,height:e.height,left:e.left,right:e.right,top:e.top,width:e.width}}function xE(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function DL(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var ZS=!1,NL={get passive(){return ZS=!0}},Bh=typeof window<"u"?window:{};Bh.addEventListener&&Bh.removeEventListener&&(Bh.addEventListener("p",N0,NL),Bh.removeEventListener("p",N0,!1));var LL=ZS;function ML(t){return t!=null}function VL(t){return Array.isArray(t)}function Uh(t,e,r){return t?e:r}var BL=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=Object.entries(e).filter(function(o){var c=Ha(o,1),u=c[0];return!n.includes(u)});return a.reduce(function(o,c){var u=Ha(c,2),h=u[0],d=u[1];return o[h]=d,o},{})},UL=["children","innerProps"],jL=["children","innerProps"];function $L(t){var e=t.maxHeight,r=t.menuEl,n=t.minHeight,i=t.placement,a=t.shouldScroll,o=t.isFixedPosition,c=t.controlHeight,u=FL(r),h={placement:"bottom",maxHeight:e};if(!r||!r.offsetParent)return h;var d=u.getBoundingClientRect(),g=d.height,v=r.getBoundingClientRect(),_=v.bottom,E=v.height,y=v.top,w=r.offsetParent.getBoundingClientRect(),k=w.top,F=o?window.innerHeight:PL(u),C=JS(u),U=parseInt(getComputedStyle(r).marginBottom,10),V=parseInt(getComputedStyle(r).marginTop,10),z=k-V,A=F-y,P=z+C,R=g-C-y,M=_-F+C+U,L=C+y-V,N=160;switch(i){case"auto":case"bottom":if(A>=E)return{placement:"bottom",maxHeight:e};if(R>=E&&!o)return a&&Vh(u,M,N),{placement:"bottom",maxHeight:e};if(!o&&R>=n||o&&A>=n){a&&Vh(u,M,N);var B=o?A-U:R-U;return{placement:"bottom",maxHeight:B}}if(i==="auto"||o){var Oe=e,we=o?z:P;return we>=n&&(Oe=Math.min(we-U-c,e)),{placement:"top",maxHeight:Oe}}if(i==="bottom")return a&&L0(u,M),{placement:"bottom",maxHeight:e};break;case"top":if(z>=E)return{placement:"top",maxHeight:e};if(P>=E&&!o)return a&&Vh(u,L,N),{placement:"top",maxHeight:e};if(!o&&P>=n||o&&z>=n){var Ce=e;return(!o&&P>=n||o&&z>=n)&&(Ce=o?z-V:P-V),a&&Vh(u,L,N),{placement:"top",maxHeight:Ce}}return{placement:"bottom",maxHeight:e};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return h}function HL(t){var e={bottom:"top",top:"bottom"};return t?e[t]:"bottom"}var ek=function(e){return e==="auto"?"bottom":e},zL=function(e,r){var n,i=e.placement,a=e.theme,o=a.borderRadius,c=a.spacing,u=a.colors;return Je((n={label:"menu"},cu(n,HL(i),"100%"),cu(n,"position","absolute"),cu(n,"width","100%"),cu(n,"zIndex",1),n),r?{}:{backgroundColor:u.neutral0,borderRadius:o,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:c.menuGutter,marginTop:c.menuGutter})},tk=G.createContext(null),WL=function(e){var r=e.children,n=e.minMenuHeight,i=e.maxMenuHeight,a=e.menuPlacement,o=e.menuPosition,c=e.menuShouldScrollIntoView,u=e.theme,h=G.useContext(tk)||{},d=h.setPortalPlacement,g=G.useRef(null),v=G.useState(i),_=Ha(v,2),E=_[0],y=_[1],w=G.useState(null),k=Ha(w,2),F=k[0],C=k[1],U=u.spacing.controlHeight;return vg(function(){var V=g.current;if(V){var z=o==="fixed",A=c&&!z,P=$L({maxHeight:i,menuEl:V,minHeight:n,placement:a,shouldScroll:A,isFixedPosition:z,controlHeight:U});y(P.maxHeight),C(P.placement),d==null||d(P.placement)}},[i,a,o,c,n,d,U]),r({ref:g,placerProps:Je(Je({},e),{},{placement:F||ek(a),maxHeight:E})})},GL=function(e){var r=e.children,n=e.innerRef,i=e.innerProps;return qe("div",Ze({},ir(e,"menu",{menu:!0}),{ref:n},i),r)},KL=GL,qL=function(e,r){var n=e.maxHeight,i=e.theme.spacing.baseUnit;return Je({maxHeight:n,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},r?{}:{paddingBottom:i,paddingTop:i})},XL=function(e){var r=e.children,n=e.innerProps,i=e.innerRef,a=e.isMulti;return qe("div",Ze({},ir(e,"menuList",{"menu-list":!0,"menu-list--is-multi":a}),{ref:i},n),r)},rk=function(e,r){var n=e.theme,i=n.spacing.baseUnit,a=n.colors;return Je({textAlign:"center"},r?{}:{color:a.neutral40,padding:"".concat(i*2,"px ").concat(i*3,"px")})},YL=rk,QL=rk,JL=function(e){var r=e.children,n=r===void 0?"No options":r,i=e.innerProps,a=es(e,UL);return qe("div",Ze({},ir(Je(Je({},a),{},{children:n,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),n)},ZL=function(e){var r=e.children,n=r===void 0?"Loading...":r,i=e.innerProps,a=es(e,jL);return qe("div",Ze({},ir(Je(Je({},a),{},{children:n,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),n)},e6=function(e){var r=e.rect,n=e.offset,i=e.position;return{left:r.left,position:i,top:n,width:r.width,zIndex:1}},t6=function(e){var r=e.appendTo,n=e.children,i=e.controlElement,a=e.innerProps,o=e.menuPlacement,c=e.menuPosition,u=G.useRef(null),h=G.useRef(null),d=G.useState(ek(o)),g=Ha(d,2),v=g[0],_=g[1],E=G.useMemo(function(){return{setPortalPlacement:_}},[]),y=G.useState(null),w=Ha(y,2),k=w[0],F=w[1],C=G.useCallback(function(){if(i){var A=OL(i),P=c==="fixed"?0:window.pageYOffset,R=A[v]+P;(R!==(k==null?void 0:k.offset)||A.left!==(k==null?void 0:k.rect.left)||A.width!==(k==null?void 0:k.rect.width))&&F({offset:R,rect:A})}},[i,c,v,k==null?void 0:k.offset,k==null?void 0:k.rect.left,k==null?void 0:k.rect.width]);vg(function(){C()},[C]);var U=G.useCallback(function(){typeof h.current=="function"&&(h.current(),h.current=null),i&&u.current&&(h.current=AL(i,u.current,C,{elementResize:"ResizeObserver"in window}))},[i,C]);vg(function(){U()},[U]);var V=G.useCallback(function(A){u.current=A,U()},[U]);if(!r&&c!=="fixed"||!k)return null;var z=qe("div",Ze({ref:V},ir(Je(Je({},e),{},{offset:k.offset,position:c,rect:k.rect}),"menuPortal",{"menu-portal":!0}),a),n);return qe(tk.Provider,{value:E},r?jR.createPortal(z,r):z)},r6=function(e){var r=e.isDisabled,n=e.isRtl;return{label:"container",direction:n?"rtl":void 0,pointerEvents:r?"none":void 0,position:"relative"}},n6=function(e){var r=e.children,n=e.innerProps,i=e.isDisabled,a=e.isRtl;return qe("div",Ze({},ir(e,"container",{"--is-disabled":i,"--is-rtl":a}),n),r)},i6=function(e,r){var n=e.theme.spacing,i=e.isMulti,a=e.hasValue,o=e.selectProps.controlShouldRenderValue;return Je({alignItems:"center",display:i&&a&&o?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},r?{}:{padding:"".concat(n.baseUnit/2,"px ").concat(n.baseUnit*2,"px")})},a6=function(e){var r=e.children,n=e.innerProps,i=e.isMulti,a=e.hasValue;return qe("div",Ze({},ir(e,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":a}),n),r)},s6=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},o6=function(e){var r=e.children,n=e.innerProps;return qe("div",Ze({},ir(e,"indicatorsContainer",{indicators:!0}),n),r)},_E,l6=["size"],c6=["innerProps","isRtl","size"],u6={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},nk=function(e){var r=e.size,n=es(e,l6);return qe("svg",Ze({height:r,width:r,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:u6},n))},j1=function(e){return qe(nk,Ze({size:20},e),qe("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},ik=function(e){return qe(nk,Ze({size:20},e),qe("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ak=function(e,r){var n=e.isFocused,i=e.theme,a=i.spacing.baseUnit,o=i.colors;return Je({label:"indicatorContainer",display:"flex",transition:"color 150ms"},r?{}:{color:n?o.neutral60:o.neutral20,padding:a*2,":hover":{color:n?o.neutral80:o.neutral40}})},f6=ak,h6=function(e){var r=e.children,n=e.innerProps;return qe("div",Ze({},ir(e,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),n),r||qe(ik,null))},d6=ak,p6=function(e){var r=e.children,n=e.innerProps;return qe("div",Ze({},ir(e,"clearIndicator",{indicator:!0,"clear-indicator":!0}),n),r||qe(j1,null))},m6=function(e,r){var n=e.isDisabled,i=e.theme,a=i.spacing.baseUnit,o=i.colors;return Je({label:"indicatorSeparator",alignSelf:"stretch",width:1},r?{}:{backgroundColor:n?o.neutral10:o.neutral20,marginBottom:a*2,marginTop:a*2})},g6=function(e){var r=e.innerProps;return qe("span",Ze({},r,ir(e,"indicatorSeparator",{"indicator-separator":!0})))},v6=hL(_E||(_E=dL([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),x6=function(e,r){var n=e.isFocused,i=e.size,a=e.theme,o=a.colors,c=a.spacing.baseUnit;return Je({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},r?{}:{color:n?o.neutral60:o.neutral20,padding:c*2})},Tm=function(e){var r=e.delay,n=e.offset;return qe("span",{css:M1({animation:"".concat(v6," 1s ease-in-out ").concat(r,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},_6=function(e){var r=e.innerProps,n=e.isRtl,i=e.size,a=i===void 0?4:i,o=es(e,c6);return qe("div",Ze({},ir(Je(Je({},o),{},{innerProps:r,isRtl:n,size:a}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),r),qe(Tm,{delay:0,offset:n}),qe(Tm,{delay:160,offset:!0}),qe(Tm,{delay:320,offset:!n}))},y6=function(e,r){var n=e.isDisabled,i=e.isFocused,a=e.theme,o=a.colors,c=a.borderRadius,u=a.spacing;return Je({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:u.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},r?{}:{backgroundColor:n?o.neutral5:o.neutral0,borderColor:n?o.neutral10:i?o.primary:o.neutral20,borderRadius:c,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(o.primary):void 0,"&:hover":{borderColor:i?o.primary:o.neutral30}})},E6=function(e){var r=e.children,n=e.isDisabled,i=e.isFocused,a=e.innerRef,o=e.innerProps,c=e.menuIsOpen;return qe("div",Ze({ref:a},ir(e,"control",{control:!0,"control--is-disabled":n,"control--is-focused":i,"control--menu-is-open":c}),o,{"aria-disabled":n||void 0}),r)},w6=E6,T6=["data"],S6=function(e,r){var n=e.theme.spacing;return r?{}:{paddingBottom:n.baseUnit*2,paddingTop:n.baseUnit*2}},k6=function(e){var r=e.children,n=e.cx,i=e.getStyles,a=e.getClassNames,o=e.Heading,c=e.headingProps,u=e.innerProps,h=e.label,d=e.theme,g=e.selectProps;return qe("div",Ze({},ir(e,"group",{group:!0}),u),qe(o,Ze({},c,{selectProps:g,theme:d,getStyles:i,getClassNames:a,cx:n}),h),qe("div",null,r))},A6=function(e,r){var n=e.theme,i=n.colors,a=n.spacing;return Je({label:"group",cursor:"default",display:"block"},r?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:a.baseUnit*3,paddingRight:a.baseUnit*3,textTransform:"uppercase"})},C6=function(e){var r=QS(e);r.data;var n=es(r,T6);return qe("div",Ze({},ir(e,"groupHeading",{"group-heading":!0}),n))},I6=k6,R6=["innerRef","isDisabled","isHidden","inputClassName"],P6=function(e,r){var n=e.isDisabled,i=e.value,a=e.theme,o=a.spacing,c=a.colors;return Je(Je({visibility:n?"hidden":"visible",transform:i?"translateZ(0)":""},F6),r?{}:{margin:o.baseUnit/2,paddingBottom:o.baseUnit/2,paddingTop:o.baseUnit/2,color:c.neutral80})},sk={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},F6={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Je({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},sk)},b6=function(e){return Je({label:"input",color:"inherit",background:0,opacity:e?0:1,width:"100%"},sk)},O6=function(e){var r=e.cx,n=e.value,i=QS(e),a=i.innerRef,o=i.isDisabled,c=i.isHidden,u=i.inputClassName,h=es(i,R6);return qe("div",Ze({},ir(e,"input",{"input-container":!0}),{"data-value":n||""}),qe("input",Ze({className:r({input:!0},u),ref:a,style:b6(c),disabled:o},h)))},D6=O6,N6=function(e,r){var n=e.theme,i=n.spacing,a=n.borderRadius,o=n.colors;return Je({label:"multiValue",display:"flex",minWidth:0},r?{}:{backgroundColor:o.neutral10,borderRadius:a/2,margin:i.baseUnit/2})},L6=function(e,r){var n=e.theme,i=n.borderRadius,a=n.colors,o=e.cropWithEllipsis;return Je({overflow:"hidden",textOverflow:o||o===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},r?{}:{borderRadius:i/2,color:a.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},M6=function(e,r){var n=e.theme,i=n.spacing,a=n.borderRadius,o=n.colors,c=e.isFocused;return Je({alignItems:"center",display:"flex"},r?{}:{borderRadius:a/2,backgroundColor:c?o.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:o.dangerLight,color:o.danger}})},ok=function(e){var r=e.children,n=e.innerProps;return qe("div",n,r)},V6=ok,B6=ok;function U6(t){var e=t.children,r=t.innerProps;return qe("div",Ze({role:"button"},r),e||qe(j1,{size:14}))}var j6=function(e){var r=e.children,n=e.components,i=e.data,a=e.innerProps,o=e.isDisabled,c=e.removeProps,u=e.selectProps,h=n.Container,d=n.Label,g=n.Remove;return qe(h,{data:i,innerProps:Je(Je({},ir(e,"multiValue",{"multi-value":!0,"multi-value--is-disabled":o})),a),selectProps:u},qe(d,{data:i,innerProps:Je({},ir(e,"multiValueLabel",{"multi-value__label":!0})),selectProps:u},r),qe(g,{data:i,innerProps:Je(Je({},ir(e,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(r||"option")},c),selectProps:u}))},$6=j6,H6=function(e,r){var n=e.isDisabled,i=e.isFocused,a=e.isSelected,o=e.theme,c=o.spacing,u=o.colors;return Je({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},r?{}:{backgroundColor:a?u.primary:i?u.primary25:"transparent",color:n?u.neutral20:a?u.neutral0:"inherit",padding:"".concat(c.baseUnit*2,"px ").concat(c.baseUnit*3,"px"),":active":{backgroundColor:n?void 0:a?u.primary:u.primary50}})},z6=function(e){var r=e.children,n=e.isDisabled,i=e.isFocused,a=e.isSelected,o=e.innerRef,c=e.innerProps;return qe("div",Ze({},ir(e,"option",{option:!0,"option--is-disabled":n,"option--is-focused":i,"option--is-selected":a}),{ref:o,"aria-disabled":n},c),r)},W6=z6,G6=function(e,r){var n=e.theme,i=n.spacing,a=n.colors;return Je({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},r?{}:{color:a.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},K6=function(e){var r=e.children,n=e.innerProps;return qe("div",Ze({},ir(e,"placeholder",{placeholder:!0}),n),r)},q6=K6,X6=function(e,r){var n=e.isDisabled,i=e.theme,a=i.spacing,o=i.colors;return Je({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r?{}:{color:n?o.neutral40:o.neutral80,marginLeft:a.baseUnit/2,marginRight:a.baseUnit/2})},Y6=function(e){var r=e.children,n=e.isDisabled,i=e.innerProps;return qe("div",Ze({},ir(e,"singleValue",{"single-value":!0,"single-value--is-disabled":n}),i),r)},Q6=Y6,J6={ClearIndicator:p6,Control:w6,DropdownIndicator:h6,DownChevron:ik,CrossIcon:j1,Group:I6,GroupHeading:C6,IndicatorsContainer:o6,IndicatorSeparator:g6,Input:D6,LoadingIndicator:_6,Menu:KL,MenuList:XL,MenuPortal:t6,LoadingMessage:ZL,NoOptionsMessage:JL,MultiValue:$6,MultiValueContainer:V6,MultiValueLabel:B6,MultiValueRemove:U6,Option:W6,Placeholder:q6,SelectContainer:n6,SingleValue:Q6,ValueContainer:a6},Z6=function(e){return Je(Je({},J6),e.components)},yE=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function eM(t,e){return!!(t===e||yE(t)&&yE(e))}function tM(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!eM(t[r],e[r]))return!1;return!0}function rM(t,e){e===void 0&&(e=tM);var r=null;function n(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(r&&r.lastThis===this&&e(i,r.lastArgs))return r.lastResult;var o=t.apply(this,i);return r={lastResult:o,lastArgs:i,lastThis:this},o}return n.clear=function(){r=null},n}var nM={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},iM=function(e){return qe("span",Ze({css:nM},e))},EE=iM,aM={guidance:function(e){var r=e.isSearchable,n=e.isMulti,i=e.tabSelectsValue,a=e.context,o=e.isInitialFocus;switch(a){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return o?"".concat(e["aria-label"]||"Select"," is focused ").concat(r?",type to refine list":"",", press Down to open the menu, ").concat(n?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(e){var r=e.action,n=e.label,i=n===void 0?"":n,a=e.labels,o=e.isDisabled;switch(r){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(a.length>1?"s":""," ").concat(a.join(","),", selected.");case"select-option":return o?"option ".concat(i," is disabled. Select another option."):"option ".concat(i,", selected.");default:return""}},onFocus:function(e){var r=e.context,n=e.focused,i=e.options,a=e.label,o=a===void 0?"":a,c=e.selectValue,u=e.isDisabled,h=e.isSelected,d=e.isAppleDevice,g=function(y,w){return y&&y.length?"".concat(y.indexOf(w)+1," of ").concat(y.length):""};if(r==="value"&&c)return"value ".concat(o," focused, ").concat(g(c,n),".");if(r==="menu"&&d){var v=u?" disabled":"",_="".concat(h?" selected":"").concat(v);return"".concat(o).concat(_,", ").concat(g(i,n),".")}return""},onFilter:function(e){var r=e.inputValue,n=e.resultsMessage;return"".concat(n).concat(r?" for search term "+r:"",".")}},sM=function(e){var r=e.ariaSelection,n=e.focusedOption,i=e.focusedValue,a=e.focusableOptions,o=e.isFocused,c=e.selectValue,u=e.selectProps,h=e.id,d=e.isAppleDevice,g=u.ariaLiveMessages,v=u.getOptionLabel,_=u.inputValue,E=u.isMulti,y=u.isOptionDisabled,w=u.isSearchable,k=u.menuIsOpen,F=u.options,C=u.screenReaderStatus,U=u.tabSelectsValue,V=u.isLoading,z=u["aria-label"],A=u["aria-live"],P=G.useMemo(function(){return Je(Je({},aM),g||{})},[g]),R=G.useMemo(function(){var we="";if(r&&P.onChange){var Ce=r.option,Ae=r.options,Ee=r.removedValue,ie=r.removedValues,xe=r.value,te=function(ve){return Array.isArray(ve)?null:ve},D=Ee||Ce||te(xe),re=D?v(D):"",ee=Ae||ie||void 0,Z=ee?ee.map(v):[],ce=Je({isDisabled:D&&y(D,c),label:re,labels:Z},r);we=P.onChange(ce)}return we},[r,P,y,c,v]),M=G.useMemo(function(){var we="",Ce=n||i,Ae=!!(n&&c&&c.includes(n));if(Ce&&P.onFocus){var Ee={focused:Ce,label:v(Ce),isDisabled:y(Ce,c),isSelected:Ae,options:a,context:Ce===n?"menu":"value",selectValue:c,isAppleDevice:d};we=P.onFocus(Ee)}return we},[n,i,v,y,P,a,c,d]),L=G.useMemo(function(){var we="";if(k&&F.length&&!V&&P.onFilter){var Ce=C({count:a.length});we=P.onFilter({inputValue:_,resultsMessage:Ce})}return we},[a,_,k,P,F,C,V]),N=(r==null?void 0:r.action)==="initial-input-focus",B=G.useMemo(function(){var we="";if(P.guidance){var Ce=i?"value":k?"menu":"input";we=P.guidance({"aria-label":z,context:Ce,isDisabled:n&&y(n,c),isMulti:E,isSearchable:w,tabSelectsValue:U,isInitialFocus:N})}return we},[z,n,i,E,y,w,k,P,c,U,N]),Oe=qe(G.Fragment,null,qe("span",{id:"aria-selection"},R),qe("span",{id:"aria-focused"},M),qe("span",{id:"aria-results"},L),qe("span",{id:"aria-guidance"},B));return qe(G.Fragment,null,qe(EE,{id:h},N&&Oe),qe(EE,{"aria-live":A,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},o&&!N&&Oe))},oM=sM,xg=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],lM=new RegExp("["+xg.map(function(t){return t.letters}).join("")+"]","g"),lk={};for(var Sm=0;Sm<xg.length;Sm++)for(var km=xg[Sm],Am=0;Am<km.letters.length;Am++)lk[km.letters[Am]]=km.base;var ck=function(e){return e.replace(lM,function(r){return lk[r]})},cM=rM(ck),wE=function(e){return e.replace(/^\s+|\s+$/g,"")},uM=function(e){return"".concat(e.label," ").concat(e.value)},fM=function(e){return function(r,n){if(r.data.__isNew__)return!0;var i=Je({ignoreCase:!0,ignoreAccents:!0,stringify:uM,trim:!0,matchFrom:"any"},e),a=i.ignoreCase,o=i.ignoreAccents,c=i.stringify,u=i.trim,h=i.matchFrom,d=u?wE(n):n,g=u?wE(c(r)):c(r);return a&&(d=d.toLowerCase(),g=g.toLowerCase()),o&&(d=cM(d),g=ck(g)),h==="start"?g.substr(0,d.length)===d:g.indexOf(d)>-1}},hM=["innerRef"];function dM(t){var e=t.innerRef,r=es(t,hM),n=BL(r,"onExited","in","enter","exit","appear");return qe("input",Ze({ref:e},n,{css:M1({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var pM=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};function mM(t){var e=t.isEnabled,r=t.onBottomArrive,n=t.onBottomLeave,i=t.onTopArrive,a=t.onTopLeave,o=G.useRef(!1),c=G.useRef(!1),u=G.useRef(0),h=G.useRef(null),d=G.useCallback(function(w,k){if(h.current!==null){var F=h.current,C=F.scrollTop,U=F.scrollHeight,V=F.clientHeight,z=h.current,A=k>0,P=U-V-C,R=!1;P>k&&o.current&&(n&&n(w),o.current=!1),A&&c.current&&(a&&a(w),c.current=!1),A&&k>P?(r&&!o.current&&r(w),z.scrollTop=U,R=!0,o.current=!0):!A&&-k>C&&(i&&!c.current&&i(w),z.scrollTop=0,R=!0,c.current=!0),R&&pM(w)}},[r,n,i,a]),g=G.useCallback(function(w){d(w,w.deltaY)},[d]),v=G.useCallback(function(w){u.current=w.changedTouches[0].clientY},[]),_=G.useCallback(function(w){var k=u.current-w.changedTouches[0].clientY;d(w,k)},[d]),E=G.useCallback(function(w){if(w){var k=LL?{passive:!1}:!1;w.addEventListener("wheel",g,k),w.addEventListener("touchstart",v,k),w.addEventListener("touchmove",_,k)}},[_,v,g]),y=G.useCallback(function(w){w&&(w.removeEventListener("wheel",g,!1),w.removeEventListener("touchstart",v,!1),w.removeEventListener("touchmove",_,!1))},[_,v,g]);return G.useEffect(function(){if(e){var w=h.current;return E(w),function(){y(w)}}},[e,E,y]),function(w){h.current=w}}var TE=["boxSizing","height","overflow","paddingRight","position"],SE={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function kE(t){t.cancelable&&t.preventDefault()}function AE(t){t.stopPropagation()}function CE(){var t=this.scrollTop,e=this.scrollHeight,r=t+this.offsetHeight;t===0?this.scrollTop=1:r===e&&(this.scrollTop=t-1)}function IE(){return"ontouchstart"in window||navigator.maxTouchPoints}var RE=!!(typeof window<"u"&&window.document&&window.document.createElement),iu=0,Dl={capture:!1,passive:!1};function gM(t){var e=t.isEnabled,r=t.accountForScrollbars,n=r===void 0?!0:r,i=G.useRef({}),a=G.useRef(null),o=G.useCallback(function(u){if(RE){var h=document.body,d=h&&h.style;if(n&&TE.forEach(function(E){var y=d&&d[E];i.current[E]=y}),n&&iu<1){var g=parseInt(i.current.paddingRight,10)||0,v=document.body?document.body.clientWidth:0,_=window.innerWidth-v+g||0;Object.keys(SE).forEach(function(E){var y=SE[E];d&&(d[E]=y)}),d&&(d.paddingRight="".concat(_,"px"))}h&&IE()&&(h.addEventListener("touchmove",kE,Dl),u&&(u.addEventListener("touchstart",CE,Dl),u.addEventListener("touchmove",AE,Dl))),iu+=1}},[n]),c=G.useCallback(function(u){if(RE){var h=document.body,d=h&&h.style;iu=Math.max(iu-1,0),n&&iu<1&&TE.forEach(function(g){var v=i.current[g];d&&(d[g]=v)}),h&&IE()&&(h.removeEventListener("touchmove",kE,Dl),u&&(u.removeEventListener("touchstart",CE,Dl),u.removeEventListener("touchmove",AE,Dl)))}},[n]);return G.useEffect(function(){if(e){var u=a.current;return o(u),function(){c(u)}}},[e,o,c]),function(u){a.current=u}}var vM=function(e){var r=e.target;return r.ownerDocument.activeElement&&r.ownerDocument.activeElement.blur()},xM={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function _M(t){var e=t.children,r=t.lockEnabled,n=t.captureEnabled,i=n===void 0?!0:n,a=t.onBottomArrive,o=t.onBottomLeave,c=t.onTopArrive,u=t.onTopLeave,h=mM({isEnabled:i,onBottomArrive:a,onBottomLeave:o,onTopArrive:c,onTopLeave:u}),d=gM({isEnabled:r}),g=function(_){h(_),d(_)};return qe(G.Fragment,null,r&&qe("div",{onClick:vM,css:xM}),e(g))}var yM={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},EM=function(e){var r=e.name,n=e.onFocus;return qe("input",{required:!0,name:r,tabIndex:-1,"aria-hidden":"true",onFocus:n,css:yM,value:"",onChange:function(){}})},wM=EM;function $1(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function TM(){return $1(/^iPhone/i)}function uk(){return $1(/^Mac/i)}function SM(){return $1(/^iPad/i)||uk()&&navigator.maxTouchPoints>1}function kM(){return TM()||SM()}function AM(){return uk()||kM()}var CM=function(e){return e.label},IM=function(e){return e.label},RM=function(e){return e.value},PM=function(e){return!!e.isDisabled},FM={clearIndicator:d6,container:r6,control:y6,dropdownIndicator:f6,group:S6,groupHeading:A6,indicatorsContainer:s6,indicatorSeparator:m6,input:P6,loadingIndicator:x6,loadingMessage:QL,menu:zL,menuList:qL,menuPortal:e6,multiValue:N6,multiValueLabel:L6,multiValueRemove:M6,noOptionsMessage:YL,option:H6,placeholder:G6,singleValue:X6,valueContainer:i6},bM={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},OM=4,fk=4,DM=38,NM=fk*2,LM={baseUnit:fk,controlHeight:DM,menuGutter:NM},Cm={borderRadius:OM,colors:bM,spacing:LM},MM={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:xE(),captureMenuScroll:!xE(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:fM(),formatGroupLabel:CM,getOptionLabel:IM,getOptionValue:RM,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:PM,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!DL(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var r=e.count;return"".concat(r," result").concat(r!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function PE(t,e,r,n){var i=pk(t,e,r),a=mk(t,e,r),o=dk(t,e),c=M0(t,e);return{type:"option",data:e,isDisabled:i,isSelected:a,label:o,value:c,index:n}}function f0(t,e){return t.options.map(function(r,n){if("options"in r){var i=r.options.map(function(o,c){return PE(t,o,e,c)}).filter(function(o){return bE(t,o)});return i.length>0?{type:"group",data:r,options:i,index:n}:void 0}var a=PE(t,r,e,n);return bE(t,a)?a:void 0}).filter(ML)}function hk(t){return t.reduce(function(e,r){return r.type==="group"?e.push.apply(e,b1(r.options.map(function(n){return n.data}))):e.push(r.data),e},[])}function FE(t,e){return t.reduce(function(r,n){return n.type==="group"?r.push.apply(r,b1(n.options.map(function(i){return{data:i.data,id:"".concat(e,"-").concat(n.index,"-").concat(i.index)}}))):r.push({data:n.data,id:"".concat(e,"-").concat(n.index)}),r},[])}function VM(t,e){return hk(f0(t,e))}function bE(t,e){var r=t.inputValue,n=r===void 0?"":r,i=e.data,a=e.isSelected,o=e.label,c=e.value;return(!vk(t)||!a)&&gk(t,{label:o,value:c,data:i},n)}function BM(t,e){var r=t.focusedValue,n=t.selectValue,i=n.indexOf(r);if(i>-1){var a=e.indexOf(r);if(a>-1)return r;if(i<e.length)return e[i]}return null}function UM(t,e){var r=t.focusedOption;return r&&e.indexOf(r)>-1?r:e[0]}var Im=function(e,r){var n,i=(n=e.find(function(a){return a.data===r}))===null||n===void 0?void 0:n.id;return i||null},dk=function(e,r){return e.getOptionLabel(r)},M0=function(e,r){return e.getOptionValue(r)};function pk(t,e,r){return typeof t.isOptionDisabled=="function"?t.isOptionDisabled(e,r):!1}function mk(t,e,r){if(r.indexOf(e)>-1)return!0;if(typeof t.isOptionSelected=="function")return t.isOptionSelected(e,r);var n=M0(t,e);return r.some(function(i){return M0(t,i)===n})}function gk(t,e,r){return t.filterOption?t.filterOption(e,r):!0}var vk=function(e){var r=e.hideSelectedOptions,n=e.isMulti;return r===void 0?n:r},jM=1,xk=function(t){oN(r,t);var e=uN(r);function r(n){var i;if(aN(this,r),i=e.call(this,n),i.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.isAppleDevice=AM(),i.controlRef=null,i.getControlRef=function(u){i.controlRef=u},i.focusedOptionRef=null,i.getFocusedOptionRef=function(u){i.focusedOptionRef=u},i.menuListRef=null,i.getMenuListRef=function(u){i.menuListRef=u},i.inputRef=null,i.getInputRef=function(u){i.inputRef=u},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(u,h){var d=i.props,g=d.onChange,v=d.name;h.name=v,i.ariaOnChange(u,h),g(u,h)},i.setValue=function(u,h,d){var g=i.props,v=g.closeMenuOnSelect,_=g.isMulti,E=g.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:E}),v&&(i.setState({inputIsHiddenAfterUpdate:!_}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(u,{action:h,option:d})},i.selectOption=function(u){var h=i.props,d=h.blurInputOnSelect,g=h.isMulti,v=h.name,_=i.state.selectValue,E=g&&i.isOptionSelected(u,_),y=i.isOptionDisabled(u,_);if(E){var w=i.getOptionValue(u);i.setValue(_.filter(function(k){return i.getOptionValue(k)!==w}),"deselect-option",u)}else if(!y)g?i.setValue([].concat(b1(_),[u]),"select-option",u):i.setValue(u,"select-option");else{i.ariaOnChange(u,{action:"select-option",option:u,name:v});return}d&&i.blurInput()},i.removeValue=function(u){var h=i.props.isMulti,d=i.state.selectValue,g=i.getOptionValue(u),v=d.filter(function(E){return i.getOptionValue(E)!==g}),_=Uh(h,v,v[0]||null);i.onChange(_,{action:"remove-value",removedValue:u}),i.focusInput()},i.clearValue=function(){var u=i.state.selectValue;i.onChange(Uh(i.props.isMulti,[],null),{action:"clear",removedValues:u})},i.popValue=function(){var u=i.props.isMulti,h=i.state.selectValue,d=h[h.length-1],g=h.slice(0,h.length-1),v=Uh(u,g,g[0]||null);d&&i.onChange(v,{action:"pop-value",removedValue:d})},i.getFocusedOptionId=function(u){return Im(i.state.focusableOptionsWithIds,u)},i.getFocusableOptionsWithIds=function(){return FE(f0(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return RL.apply(void 0,[i.props.classNamePrefix].concat(h))},i.getOptionLabel=function(u){return dk(i.props,u)},i.getOptionValue=function(u){return M0(i.props,u)},i.getStyles=function(u,h){var d=i.props.unstyled,g=FM[u](h,d);g.boxSizing="border-box";var v=i.props.styles[u];return v?v(g,h):g},i.getClassNames=function(u,h){var d,g;return(d=(g=i.props.classNames)[u])===null||d===void 0?void 0:d.call(g,h)},i.getElementId=function(u){return"".concat(i.state.instancePrefix,"-").concat(u)},i.getComponents=function(){return Z6(i.props)},i.buildCategorizedOptions=function(){return f0(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return hk(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(u,h){i.setState({ariaSelection:Je({value:u},h)})},i.onMenuMouseDown=function(u){u.button===0&&(u.stopPropagation(),u.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(u){i.blockOptionHover=!1},i.onControlMouseDown=function(u){if(!u.defaultPrevented){var h=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&i.onMenuClose():h&&i.openMenu("first"):(h&&(i.openAfterFocus=!0),i.focusInput()),u.target.tagName!=="INPUT"&&u.target.tagName!=="TEXTAREA"&&u.preventDefault()}},i.onDropdownIndicatorMouseDown=function(u){if(!(u&&u.type==="mousedown"&&u.button!==0)&&!i.props.isDisabled){var h=i.props,d=h.isMulti,g=h.menuIsOpen;i.focusInput(),g?(i.setState({inputIsHiddenAfterUpdate:!d}),i.onMenuClose()):i.openMenu("first"),u.preventDefault()}},i.onClearIndicatorMouseDown=function(u){u&&u.type==="mousedown"&&u.button!==0||(i.clearValue(),u.preventDefault(),i.openAfterFocus=!1,u.type==="touchend"?i.focusInput():setTimeout(function(){return i.focusInput()}))},i.onScroll=function(u){typeof i.props.closeMenuOnScroll=="boolean"?u.target instanceof HTMLElement&&Ad(u.target)&&i.props.onMenuClose():typeof i.props.closeMenuOnScroll=="function"&&i.props.closeMenuOnScroll(u)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(u){var h=u.touches,d=h&&h.item(0);d&&(i.initialTouchX=d.clientX,i.initialTouchY=d.clientY,i.userIsDragging=!1)},i.onTouchMove=function(u){var h=u.touches,d=h&&h.item(0);if(d){var g=Math.abs(d.clientX-i.initialTouchX),v=Math.abs(d.clientY-i.initialTouchY),_=5;i.userIsDragging=g>_||v>_}},i.onTouchEnd=function(u){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(u.target)&&i.menuListRef&&!i.menuListRef.contains(u.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(u){i.userIsDragging||i.onControlMouseDown(u)},i.onClearIndicatorTouchEnd=function(u){i.userIsDragging||i.onClearIndicatorMouseDown(u)},i.onDropdownIndicatorTouchEnd=function(u){i.userIsDragging||i.onDropdownIndicatorMouseDown(u)},i.handleInputChange=function(u){var h=i.props.inputValue,d=u.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(d,{action:"input-change",prevInputValue:h}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(u){i.props.onFocus&&i.props.onFocus(u),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(u){var h=i.props.inputValue;if(i.menuListRef&&i.menuListRef.contains(document.activeElement)){i.inputRef.focus();return}i.props.onBlur&&i.props.onBlur(u),i.onInputChange("",{action:"input-blur",prevInputValue:h}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1})},i.onOptionHover=function(u){if(!(i.blockOptionHover||i.state.focusedOption===u)){var h=i.getFocusableOptions(),d=h.indexOf(u);i.setState({focusedOption:u,focusedOptionId:d>-1?i.getFocusedOptionId(u):null})}},i.shouldHideSelectedOptions=function(){return vk(i.props)},i.onValueInputFocus=function(u){u.preventDefault(),u.stopPropagation(),i.focus()},i.onKeyDown=function(u){var h=i.props,d=h.isMulti,g=h.backspaceRemovesValue,v=h.escapeClearsValue,_=h.inputValue,E=h.isClearable,y=h.isDisabled,w=h.menuIsOpen,k=h.onKeyDown,F=h.tabSelectsValue,C=h.openMenuOnFocus,U=i.state,V=U.focusedOption,z=U.focusedValue,A=U.selectValue;if(!y&&!(typeof k=="function"&&(k(u),u.defaultPrevented))){switch(i.blockOptionHover=!0,u.key){case"ArrowLeft":if(!d||_)return;i.focusValue("previous");break;case"ArrowRight":if(!d||_)return;i.focusValue("next");break;case"Delete":case"Backspace":if(_)return;if(z)i.removeValue(z);else{if(!g)return;d?i.popValue():E&&i.clearValue()}break;case"Tab":if(i.isComposing||u.shiftKey||!w||!F||!V||C&&i.isOptionSelected(V,A))return;i.selectOption(V);break;case"Enter":if(u.keyCode===229)break;if(w){if(!V||i.isComposing)return;i.selectOption(V);break}return;case"Escape":w?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:_}),i.onMenuClose()):E&&v&&i.clearValue();break;case" ":if(_)return;if(!w){i.openMenu("first");break}if(!V)return;i.selectOption(V);break;case"ArrowUp":w?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":w?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!w)return;i.focusOption("pageup");break;case"PageDown":if(!w)return;i.focusOption("pagedown");break;case"Home":if(!w)return;i.focusOption("first");break;case"End":if(!w)return;i.focusOption("last");break;default:return}u.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++jM),i.state.selectValue=gE(n.value),n.menuIsOpen&&i.state.selectValue.length){var a=i.getFocusableOptionsWithIds(),o=i.buildFocusableOptions(),c=o.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=a,i.state.focusedOption=o[c],i.state.focusedOptionId=Im(a,o[c])}return i}return sN(r,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&vE(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(i){var a=this.props,o=a.isDisabled,c=a.menuIsOpen,u=this.state.isFocused;(u&&!o&&i.isDisabled||u&&c&&!i.menuIsOpen)&&this.focusInput(),u&&o&&!i.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!u&&!o&&i.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(vE(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(i,a){this.props.onInputChange(i,a)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(i){var a=this,o=this.state,c=o.selectValue,u=o.isFocused,h=this.buildFocusableOptions(),d=i==="first"?0:h.length-1;if(!this.props.isMulti){var g=h.indexOf(c[0]);g>-1&&(d=g)}this.scrollToFocusedOptionOnUpdate=!(u&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:h[d],focusedOptionId:this.getFocusedOptionId(h[d])},function(){return a.onMenuOpen()})}},{key:"focusValue",value:function(i){var a=this.state,o=a.selectValue,c=a.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var u=o.indexOf(c);c||(u=-1);var h=o.length-1,d=-1;if(o.length){switch(i){case"previous":u===0?d=0:u===-1?d=h:d=u-1;break;case"next":u>-1&&u<h&&(d=u+1);break}this.setState({inputIsHidden:d!==-1,focusedValue:o[d]})}}}},{key:"focusOption",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",a=this.props.pageSize,o=this.state.focusedOption,c=this.getFocusableOptions();if(c.length){var u=0,h=c.indexOf(o);o||(h=-1),i==="up"?u=h>0?h-1:c.length-1:i==="down"?u=(h+1)%c.length:i==="pageup"?(u=h-a,u<0&&(u=0)):i==="pagedown"?(u=h+a,u>c.length-1&&(u=c.length-1)):i==="last"&&(u=c.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:c[u],focusedValue:null,focusedOptionId:this.getFocusedOptionId(c[u])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Cm):Je(Je({},Cm),this.props.theme):Cm}},{key:"getCommonProps",value:function(){var i=this.clearValue,a=this.cx,o=this.getStyles,c=this.getClassNames,u=this.getValue,h=this.selectOption,d=this.setValue,g=this.props,v=g.isMulti,_=g.isRtl,E=g.options,y=this.hasValue();return{clearValue:i,cx:a,getStyles:o,getClassNames:c,getValue:u,hasValue:y,isMulti:v,isRtl:_,options:E,selectOption:h,selectProps:g,setValue:d,theme:this.getTheme()}}},{key:"hasValue",value:function(){var i=this.state.selectValue;return i.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var i=this.props,a=i.isClearable,o=i.isMulti;return a===void 0?o:a}},{key:"isOptionDisabled",value:function(i,a){return pk(this.props,i,a)}},{key:"isOptionSelected",value:function(i,a){return mk(this.props,i,a)}},{key:"filterOption",value:function(i,a){return gk(this.props,i,a)}},{key:"formatOptionLabel",value:function(i,a){if(typeof this.props.formatOptionLabel=="function"){var o=this.props.inputValue,c=this.state.selectValue;return this.props.formatOptionLabel(i,{context:a,inputValue:o,selectValue:c})}else return this.getOptionLabel(i)}},{key:"formatGroupLabel",value:function(i){return this.props.formatGroupLabel(i)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var i=this.props,a=i.isDisabled,o=i.isSearchable,c=i.inputId,u=i.inputValue,h=i.tabIndex,d=i.form,g=i.menuIsOpen,v=i.required,_=this.getComponents(),E=_.Input,y=this.state,w=y.inputIsHidden,k=y.ariaSelection,F=this.commonProps,C=c||this.getElementId("input"),U=Je(Je(Je({"aria-autocomplete":"list","aria-expanded":g,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":v,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},g&&{"aria-controls":this.getElementId("listbox")}),!o&&{"aria-readonly":!0}),this.hasValue()?(k==null?void 0:k.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return o?G.createElement(E,Ze({},F,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:C,innerRef:this.getInputRef,isDisabled:a,isHidden:w,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:h,form:d,type:"text",value:u},U)):G.createElement(dM,Ze({id:C,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:N0,onFocus:this.onInputFocus,disabled:a,tabIndex:h,inputMode:"none",form:d,value:""},U))}},{key:"renderPlaceholderOrValue",value:function(){var i=this,a=this.getComponents(),o=a.MultiValue,c=a.MultiValueContainer,u=a.MultiValueLabel,h=a.MultiValueRemove,d=a.SingleValue,g=a.Placeholder,v=this.commonProps,_=this.props,E=_.controlShouldRenderValue,y=_.isDisabled,w=_.isMulti,k=_.inputValue,F=_.placeholder,C=this.state,U=C.selectValue,V=C.focusedValue,z=C.isFocused;if(!this.hasValue()||!E)return k?null:G.createElement(g,Ze({},v,{key:"placeholder",isDisabled:y,isFocused:z,innerProps:{id:this.getElementId("placeholder")}}),F);if(w)return U.map(function(P,R){var M=P===V,L="".concat(i.getOptionLabel(P),"-").concat(i.getOptionValue(P));return G.createElement(o,Ze({},v,{components:{Container:c,Label:u,Remove:h},isFocused:M,isDisabled:y,key:L,index:R,removeProps:{onClick:function(){return i.removeValue(P)},onTouchEnd:function(){return i.removeValue(P)},onMouseDown:function(B){B.preventDefault()}},data:P}),i.formatOptionLabel(P,"value"))});if(k)return null;var A=U[0];return G.createElement(d,Ze({},v,{data:A,isDisabled:y}),this.formatOptionLabel(A,"value"))}},{key:"renderClearIndicator",value:function(){var i=this.getComponents(),a=i.ClearIndicator,o=this.commonProps,c=this.props,u=c.isDisabled,h=c.isLoading,d=this.state.isFocused;if(!this.isClearable()||!a||u||!this.hasValue()||h)return null;var g={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:g,isFocused:d}))}},{key:"renderLoadingIndicator",value:function(){var i=this.getComponents(),a=i.LoadingIndicator,o=this.commonProps,c=this.props,u=c.isDisabled,h=c.isLoading,d=this.state.isFocused;if(!a||!h)return null;var g={"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:g,isDisabled:u,isFocused:d}))}},{key:"renderIndicatorSeparator",value:function(){var i=this.getComponents(),a=i.DropdownIndicator,o=i.IndicatorSeparator;if(!a||!o)return null;var c=this.commonProps,u=this.props.isDisabled,h=this.state.isFocused;return G.createElement(o,Ze({},c,{isDisabled:u,isFocused:h}))}},{key:"renderDropdownIndicator",value:function(){var i=this.getComponents(),a=i.DropdownIndicator;if(!a)return null;var o=this.commonProps,c=this.props.isDisabled,u=this.state.isFocused,h={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return G.createElement(a,Ze({},o,{innerProps:h,isDisabled:c,isFocused:u}))}},{key:"renderMenu",value:function(){var i=this,a=this.getComponents(),o=a.Group,c=a.GroupHeading,u=a.Menu,h=a.MenuList,d=a.MenuPortal,g=a.LoadingMessage,v=a.NoOptionsMessage,_=a.Option,E=this.commonProps,y=this.state.focusedOption,w=this.props,k=w.captureMenuScroll,F=w.inputValue,C=w.isLoading,U=w.loadingMessage,V=w.minMenuHeight,z=w.maxMenuHeight,A=w.menuIsOpen,P=w.menuPlacement,R=w.menuPosition,M=w.menuPortalTarget,L=w.menuShouldBlockScroll,N=w.menuShouldScrollIntoView,B=w.noOptionsMessage,Oe=w.onMenuScrollToTop,we=w.onMenuScrollToBottom;if(!A)return null;var Ce=function(re,ee){var Z=re.type,ce=re.data,_e=re.isDisabled,ve=re.isSelected,ye=re.label,Te=re.value,Ke=y===ce,J=_e?void 0:function(){return i.onOptionHover(ce)},kt=_e?void 0:function(){return i.selectOption(ce)},ct="".concat(i.getElementId("option"),"-").concat(ee),dt={id:ct,onClick:kt,onMouseMove:J,onMouseOver:J,tabIndex:-1,role:"option","aria-selected":i.isAppleDevice?void 0:ve};return G.createElement(_,Ze({},E,{innerProps:dt,data:ce,isDisabled:_e,isSelected:ve,key:ct,label:ye,type:Z,value:Te,isFocused:Ke,innerRef:Ke?i.getFocusedOptionRef:void 0}),i.formatOptionLabel(re.data,"menu"))},Ae;if(this.hasOptions())Ae=this.getCategorizedOptions().map(function(D){if(D.type==="group"){var re=D.data,ee=D.options,Z=D.index,ce="".concat(i.getElementId("group"),"-").concat(Z),_e="".concat(ce,"-heading");return G.createElement(o,Ze({},E,{key:ce,data:re,options:ee,Heading:c,headingProps:{id:_e,data:D.data},label:i.formatGroupLabel(D.data)}),D.options.map(function(ve){return Ce(ve,"".concat(Z,"-").concat(ve.index))}))}else if(D.type==="option")return Ce(D,"".concat(D.index))});else if(C){var Ee=U({inputValue:F});if(Ee===null)return null;Ae=G.createElement(g,E,Ee)}else{var ie=B({inputValue:F});if(ie===null)return null;Ae=G.createElement(v,E,ie)}var xe={minMenuHeight:V,maxMenuHeight:z,menuPlacement:P,menuPosition:R,menuShouldScrollIntoView:N},te=G.createElement(WL,Ze({},E,xe),function(D){var re=D.ref,ee=D.placerProps,Z=ee.placement,ce=ee.maxHeight;return G.createElement(u,Ze({},E,xe,{innerRef:re,innerProps:{onMouseDown:i.onMenuMouseDown,onMouseMove:i.onMenuMouseMove},isLoading:C,placement:Z}),G.createElement(_M,{captureEnabled:k,onTopArrive:Oe,onBottomArrive:we,lockEnabled:L},function(_e){return G.createElement(h,Ze({},E,{innerRef:function(ye){i.getMenuListRef(ye),_e(ye)},innerProps:{role:"listbox","aria-multiselectable":E.isMulti,id:i.getElementId("listbox")},isLoading:C,maxHeight:ce,focusedOption:y}),Ae)}))});return M||R==="fixed"?G.createElement(d,Ze({},E,{appendTo:M,controlElement:this.controlRef,menuPlacement:P,menuPosition:R}),te):te}},{key:"renderFormField",value:function(){var i=this,a=this.props,o=a.delimiter,c=a.isDisabled,u=a.isMulti,h=a.name,d=a.required,g=this.state.selectValue;if(d&&!this.hasValue()&&!c)return G.createElement(wM,{name:h,onFocus:this.onValueInputFocus});if(!(!h||c))if(u)if(o){var v=g.map(function(y){return i.getOptionValue(y)}).join(o);return G.createElement("input",{name:h,type:"hidden",value:v})}else{var _=g.length>0?g.map(function(y,w){return G.createElement("input",{key:"i-".concat(w),name:h,type:"hidden",value:i.getOptionValue(y)})}):G.createElement("input",{name:h,type:"hidden",value:""});return G.createElement("div",null,_)}else{var E=g[0]?this.getOptionValue(g[0]):"";return G.createElement("input",{name:h,type:"hidden",value:E})}}},{key:"renderLiveRegion",value:function(){var i=this.commonProps,a=this.state,o=a.ariaSelection,c=a.focusedOption,u=a.focusedValue,h=a.isFocused,d=a.selectValue,g=this.getFocusableOptions();return G.createElement(oM,Ze({},i,{id:this.getElementId("live-region"),ariaSelection:o,focusedOption:c,focusedValue:u,isFocused:h,selectValue:d,focusableOptions:g,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var i=this.getComponents(),a=i.Control,o=i.IndicatorsContainer,c=i.SelectContainer,u=i.ValueContainer,h=this.props,d=h.className,g=h.id,v=h.isDisabled,_=h.menuIsOpen,E=this.state.isFocused,y=this.commonProps=this.getCommonProps();return G.createElement(c,Ze({},y,{className:d,innerProps:{id:g,onKeyDown:this.onKeyDown},isDisabled:v,isFocused:E}),this.renderLiveRegion(),G.createElement(a,Ze({},y,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:v,isFocused:E,menuIsOpen:_}),G.createElement(u,Ze({},y,{isDisabled:v}),this.renderPlaceholderOrValue(),this.renderInput()),G.createElement(o,Ze({},y,{isDisabled:v}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(i,a){var o=a.prevProps,c=a.clearFocusValueOnUpdate,u=a.inputIsHiddenAfterUpdate,h=a.ariaSelection,d=a.isFocused,g=a.prevWasFocused,v=a.instancePrefix,_=i.options,E=i.value,y=i.menuIsOpen,w=i.inputValue,k=i.isMulti,F=gE(E),C={};if(o&&(E!==o.value||_!==o.options||y!==o.menuIsOpen||w!==o.inputValue)){var U=y?VM(i,F):[],V=y?FE(f0(i,F),"".concat(v,"-option")):[],z=c?BM(a,F):null,A=UM(a,U),P=Im(V,A);C={selectValue:F,focusedOption:A,focusedOptionId:P,focusableOptionsWithIds:V,focusedValue:z,clearFocusValueOnUpdate:!1}}var R=u!=null&&i!==o?{inputIsHidden:u,inputIsHiddenAfterUpdate:void 0}:{},M=h,L=d&&g;return d&&!L&&(M={value:Uh(k,F,F[0]||null),options:F,action:"initial-input-focus"},L=!g),(h==null?void 0:h.action)==="initial-input-focus"&&(M=null),Je(Je(Je({},C),R),{},{prevProps:i,ariaSelection:M,prevWasFocused:L})}}]),r}(G.Component);xk.defaultProps=MM;var $M=G.forwardRef(function(t,e){var r=iN(t);return G.createElement(xk,Ze({ref:e},r))}),HM=$M;const _k=({options:t,onChange:e,placeholder:r,isMulti:n=!1,defaultValue:i,label:a,value:o})=>Y.jsxs("div",{className:"select-input",children:[a&&Y.jsx("label",{children:a}),Y.jsx(HM,{value:t.find(c=>c.value===o),options:t,onChange:e,placeholder:r,isMulti:n,defaultValue:i,className:"select-input",classNamePrefix:"react-select"})]}),zM=()=>{const[t,e]=G.useState([]),[r,n]=G.useState(!0),[i,a]=G.useState(null),o=async()=>{try{n(!0);const d=await FS();return e(d),d}catch{return a("Error fetching teachers"),[]}finally{n(!1)}};return G.useEffect(()=>{o()},[]),{teachers:t,loadTeachers:o,loading:r,error:i,handleAddTeacher:async d=>{try{await q3(d),o()}catch{a("Error adding teacher")}},handleDeleteTeacher:async d=>{try{await Y3(d),o()}catch{a("Error deleting teacher")}},handleUpdateTeacher:async(d,g)=>{try{await X3(d,g),o()}catch{a("Error adding teacher")}}}},WM=({isEditing:t,fields:e,initialData:r,onItemAdded:n,onItemUpdated:i,onCancelEdit:a,clearFormAfterAdd:o=!1})=>{const[c,u]=G.useState({});G.useEffect(()=>{r&&u(r)},[r]);const h=y=>{const{name:w,value:k}=y.target;u({...c,[w]:k})},d=({name:y,value:w})=>{u({...c,[y]:w})},g=()=>u({}),v=async y=>{y.preventDefault(),r&&t?await(i==null?void 0:i(c)):await n(c),o&&g()},_=()=>{g(),a&&a()},E=y=>{const w={key:y.name,name:y.name,placeholder:y.placeholder,value:c[y.name]||"",required:!0,onChange:k=>{const F=k.target.value;h(k),y.onChange&&y.onChange(F)}};switch(y.type){case"select":return y.options&&Y.jsx(_k,{options:y.options,label:y.label,...w,onChange:k=>{const F=k.value;y.onChange?y.onChange(F):d({name:y.name,value:F})}});case"number":case"number-view":return G.createElement("input",{type:"number",min:"0",max:c[`${y.name}Max`]||100,...w,key:w.key});case"date":return G.createElement("input",{type:"date",...w,key:w.key});case"input":default:return G.createElement("input",{type:"text",...w,key:w.key})}};return Y.jsxs("form",{onSubmit:v,className:t?"editing":"",children:[e.map(E),Y.jsxs("div",{className:"buttons-container",children:[Y.jsx("button",{className:"save-button",type:"submit",children:t?"Save":"Add"}),t&&Y.jsx("button",{className:"cancel-button",type:"button",onClick:_,children:"Cancel"})]})]})},GM=({fields:t,sortConfig:e,handleSort:r,useFlexTable:n,showActions:i})=>!n&&Y.jsx("table",{className:`list-base-table header-table ${i?"with-actions":""}`,"aria-label":"List header",children:Y.jsx("thead",{children:Y.jsx("tr",{children:t.map(a=>a.view&&Y.jsxs("th",{onClick:()=>r(a.name),children:[a.label||a.placeholder||a.name,(e==null?void 0:e.key)===a.name&&Y.jsx("span",{children:e.direction==="ascending"?" ":" "})]},a.name))})})}),KM=({fields:t,items:e,selectedItem:r,tempChanges:n,handlers:i})=>{const{handleRowClick:a,setTempChanges:o}=i||{},c=(d,g,v)=>{const _=parseFloat(v);isNaN(_)||o(E=>({...E,[d]:{...E[d],[g]:_}}))},u=(d,g)=>{var _;const v=(_=n[d])==null?void 0:_[g];v!==void 0&&!isNaN(v)&&console.log(`Validated value for ${d}.${g}: ${v}`)},h=(d,g)=>{var _,E;if(!g.view)return null;const v=d[g.name];switch(g.type){case"link":return v&&Y.jsx("a",{href:v,target:"_blank",children:"Link"});case"select":const y=(_=g.options)==null?void 0:_.find(w=>w.value===v);return y?y.label:"Unknown";case"number":return Y.jsx("input",{type:"number",name:g.name,min:0,step:.5,max:d[`${g.name}Max`],value:((E=n[d.id])==null?void 0:E[g.name])??v,onChange:w=>c(d.id,g.name,w.target.value),onBlur:()=>u(d.id,g.name),onClick:w=>w.stopPropagation()});default:return v!==void 0?v:"N/A"}};return Y.jsx("div",{className:"table-body-container",children:Y.jsx("table",{className:"list-base-table body-table","aria-label":"List of items",children:Y.jsx("tbody",{children:e.map(d=>Y.jsx("tr",{onClick:()=>a==null?void 0:a(d),className:(r==null?void 0:r.id)===d.id?"selected-row":"","aria-selected":(r==null?void 0:r.id)===d.id,children:t.map(g=>Y.jsx("td",{children:h(d,g)},g.name))},d.id))})})})},qM=({hasPendingChanges:t,config:e,handlers:r})=>{const{ableForm:n,ableImport:i,seeable:a,removeable:o,showForm:c,showImportForm:u,selectedItem:h,viewLinks:d,tempChanges:g}=e,{handleShowForm:v,handleShowImportForm:_,onItemDeleted:E,onSaveAllChanges:y}=r,w=(k,F)=>{y&&y(k,F)};return Y.jsxs("div",{className:"actions buttons-container compact",children:[n&&Y.jsx("button",{className:c?"add-button":"edit-button",onClick:()=>v(c),"aria-expanded":c,"aria-label":c?"Hide the form":"Show the form",children:c?"Hide Form":"Add"}),n&&i&&!u&&Y.jsx("button",{onClick:()=>_(u),"aria-expanded":u,"aria-label":u?"Add a new item":"Hide the form",children:"Import"}),a&&d&&d.map((k,F)=>Y.jsx(Ho,{to:h?k.format.replace(":id",h.id):"#",className:`button view-button ${k.class||""} ${h?"":"disabled-link"}`,"aria-label":`View ${k.label}`,onClick:C=>!h&&C.preventDefault(),children:k.label},F)),o&&E&&Y.jsx("button",{disabled:!h,className:"delete-button",onClick:()=>(h==null?void 0:h.id)&&E(h.id),"aria-label":"Delete selected item",children:"Delete"}),t&&Y.jsx("button",{onClick:k=>w(k,g),className:"add-button","aria-label":"Save all changes",children:"Save All Changes"})]})},XM=({currentPage:t,totalPages:e,onPageChange:r})=>e<=1?null:Y.jsx("div",{className:"pagination",children:Array.from({length:e},(n,i)=>i+1).map(n=>Y.jsx("button",{onClick:()=>r(n),className:t===n?"active":"",children:n},n))}),OE=t=>{const[e,r]=G.useState(t);return G.useEffect(()=>{r(t)},[t]),[e,r]},YM=(t,e)=>{const[r,n]=e?Nu(`${e}-sortConfig`,null):G.useState(null),i=o=>{let c="ascending";r&&r.key===o&&r.direction==="ascending"&&(c="descending"),n({key:o,direction:c})},a=G.useMemo(()=>r===null?t:[...t].sort((o,c)=>o[r.key]<c[r.key]?r.direction==="ascending"?-1:1:o[r.key]>c[r.key]?r.direction==="ascending"?1:-1:0),[t,r]);return{sortConfig:r,handleSort:i,sortedItems:a}},QM=(t,e)=>{const[r,n]=e?Nu(`${e}-filterText`,""):G.useState(""),i=G.useMemo(()=>r?t.filter(a=>Object.values(a).some(o=>o.toString().toLowerCase().includes(r.toLowerCase()))):t,[t,r]);return{filterText:r,setFilterText:n,filteredItems:i}},JM=(t,e)=>{const[r,n]=G.useState(1),i=G.useMemo(()=>{const c=(r-1)*e;return t.slice(c,c+e)},[t,r,e]),a=Math.ceil(t.length/e);return{currentPage:r,paginatedItems:i,totalPages:a,handlePageChange:c=>{n(c)}}},ZM=({config:t,handlers:e})=>{const{useFlexTable:r=!1,alias:n,fields:i,items:a,ableFilter:o=!1,ableForm:c,ableImport:u,removeable:h,seeable:d,viewLinks:g,tempChanges:v,setTempChanges:_,selectedItem:E,showForm:y=!1,showImportForm:w=!1,loading:k=!1}=t,{onAdd:F,onImport:C,onSelect:U,onItemDeleted:V,onItemsUpdated:z}=e,[A,P]=OE(y),[R,M]=OE(w),[L,N]=G.useState(E),{sortConfig:B,handleSort:Oe,sortedItems:we}=YM(a,n),{filterText:Ce,setFilterText:Ae,filteredItems:Ee}=QM(we,n),{currentPage:ie,paginatedItems:xe,totalPages:te,handlePageChange:D}=JM(Ee,20),re=Ke=>{const J=(L==null?void 0:L.id)===Ke.id?null:Ke;N(J),U==null||U(J)},ee=Ke=>{P(!Ke),F&&F(!Ke)},Z=Ke=>{F&&F(!0),M(!Ke),C&&C(!Ke)},ce=async()=>{z&&await z(v)};G.useEffect(()=>{P(y)},[y]),G.useEffect(()=>{M(w)},[w]);const _e=h||d,ve=a?a.length:0,ye=we.length,Te={setTempChanges:_,handleRowClick:re};return!k&&Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{className:"container list-base",children:[Y.jsxs("div",{className:"item-count",children:["Total items: ",ve,Ce&&` (showing ${ye} filtered)`]}),o&&Y.jsx("div",{className:"filter-container",children:Y.jsx("input",{type:"text",placeholder:"Filter items...",value:Ce,onChange:Ke=>Ae(Ke.target.value)})})]}),_e&&Y.jsx(qM,{config:{ableForm:c,ableImport:u,seeable:d,removeable:h,showForm:A,showImportForm:R,selectedItem:L,viewLinks:g,tempChanges:v,setTempChanges:_},handlers:{handleShowForm:ee,handleShowImportForm:Z,onItemDeleted:V,onSaveAllChanges:ce},hasPendingChanges:Object.keys(v).length>0}),Y.jsxs("div",{className:`table-container ${_e?"with-actions":""}`,children:[Y.jsx(GM,{fields:i,sortConfig:B,handleSort:Oe,showActions:_e,useFlexTable:r}),Y.jsx(KM,{fields:i,items:xe,selectedItem:L,tempChanges:v,handlers:Te,useFlexTable:r})]}),Y.jsx(XM,{currentPage:ie,totalPages:te,onPageChange:D})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yk=1252,e8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],H1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},z1=function(t){e8.indexOf(t)!=-1&&(yk=H1[0]=t)};function t8(){z1(1252)}var Mi=function(t){z1(t)};function Ek(){Mi(1200),t8()}function DE(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function r8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function wk(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var uu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?r8(t.slice(2)):e==254&&r==255?wk(t.slice(2)):e==65279?t.slice(1):t},jh=function(e){return String.fromCharCode(e)},NE=function(e){return String.fromCharCode(e)},Bu,Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function LE(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),a=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,i=t.charCodeAt(h++),c=(n&15)<<2|i>>6,u=i&63,isNaN(n)?c=u=64:isNaN(i)&&(u=64),e+=Ns.charAt(a)+Ns.charAt(o)+Ns.charAt(c)+Ns.charAt(u);return e}function ri(t){var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)a=Ns.indexOf(t.charAt(h++)),o=Ns.indexOf(t.charAt(h++)),r=a<<2|o>>4,e+=String.fromCharCode(r),c=Ns.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=Ns.indexOf(t.charAt(h++)),i=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(i));return e}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ys(t){return xt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ME(t){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Li=function(e){return xt?Xo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Yo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function W1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return W1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Os=xt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Xo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function n8(t){for(var e=[],r=0,n=t.length+250,i=Ys(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|c>>6&15|(o&3)<<4,i[r++]=128|c&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Ys(65535),n=65530)}return e.push(i.slice(0,r)),Os(e)}var Cn=/\u0000/g,fu=/[\u0001-\u0006]/g;function Kl(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Vi(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}function G1(t,e){var r=""+t;return r.length>=e?r:nr(" ",e-r.length)+r}function V0(t,e){var r=""+t;return r.length>=e?r:r+nr(" ",e-r.length)}function i8(t,e){var r=""+Math.round(t);return r.length>=e?r:nr("0",e-r.length)+r}function a8(t,e){var r=""+t;return r.length>=e?r:nr("0",e-r.length)+r}var VE=Math.pow(2,32);function Nl(t,e){if(t>VE||t<-VE)return i8(t,e);var r=Math.round(t);return a8(r,e)}function B0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var BE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function s8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},UE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function U0(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,o=1,c=0,u=1,h=0,d=0,g=Math.floor(i);h<e&&(g=Math.floor(i),c=g*o+a,d=g*h+u,!(i-g<5e-8));)i=1/(i-g),a=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=a):(d=h,c=o)),!r)return[0,n*c,d];var v=Math.floor(n*c/d);return[v,n*c-v*d,d]}function Fo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,o=[],c={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=d8(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}var Tk=new Date(1899,11,31,0,0,0),l8=Tk.getTime(),c8=new Date(1900,2,1,0,0,0);function Sk(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=c8&&(r+=24*60*60*1e3),(r-(l8+(t.getTimezoneOffset()-Tk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function K1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f8(t){var e=t<0?12:11,r=K1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function h8(t){var e=K1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Uu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=f8(t):e===10?r=t.toFixed(10).substr(0,12):r=h8(t),K1(u8(r.toUpperCase()))}function Uo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Uu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return vi(14,Sk(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function d8(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function p8(t,e,r,n){var i="",a=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return Rm[r.m-1][1];case 5:return Rm[r.m-1][0];default:return Rm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return BE[r.q][0];default:return BE[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Vi(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(i=Vi(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?Vi(u,h):"";return d}function Ls(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var kk=/%/g;function m8(t,e,r){var n=e.replace(kk,""),i=e.length-n.length;return za(t,n,r*Math.pow(10,2*i))+nr("%",i)}function g8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Ak(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ak(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ck=/# (\?+)( ?)\/( ?)(\d+)/;function v8(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),o=i-a*n,c=n;return r+(a===0?"":""+a)+" "+(o===0?nr(" ",t[1].length+1+t[4].length):G1(o,t[1].length)+t[2]+"/"+t[3]+Vi(c,t[4].length))}function x8(t,e,r){return r+(e===0?"":""+e)+nr(" ",t[1].length+2+t[4].length)}var Ik=/^#*0*\.([0#]+)/,Rk=/\).*[0#]/,Pk=/\(###\) ###\\?-####/;function wn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function jE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function $E(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _8(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function y8(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function pi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Rk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pi("n",n,r):"("+pi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return g8(t,e,r);if(e.indexOf("%")!==-1)return m8(t,e,r);if(e.indexOf("E")!==-1)return Ak(e,r);if(e.charCodeAt(0)===36)return"$"+pi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Nl(u,e.length);if(e.match(/^[#?]+$/))return i=Nl(r,0),i==="0"&&(i=""),i.length>e.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(Ck))return v8(a,u,h);if(e.match(/^#+0+$/))return h+Nl(u,e.length-e.indexOf("0"));if(a=e.match(Ik))return i=jE(r,a[1].length).replace(/^([^\.]+)$/,"$1."+wn(a[1])).replace(/\.$/,"."+wn(a[1])).replace(/\.(\d*)$/,function(E,y){return"."+y+nr("0",wn(a[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+jE(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+Ls(Nl(u,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pi(t,e,-r):Ls(""+(Math.floor(r)+_8(r,a[1].length)))+"."+Vi($E(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return pi(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(pi(t,e.replace(/[\\-]/g,""),r)),o=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(Pk))return i=pi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=U0(u,Math.pow(10,o)-1,!1),i=""+h,d=za("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=V0(c[2],o),d.length<a[4].length&&(d=wn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=U0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?G1(c[1],o)+a[2]+"/"+a[3]+V0(c[2],o):nr(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Nl(r,0),e.length<=i.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return wn(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=$E(r,a[1].length),r<0?"-"+pi(t,e,-r):Ls(y8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Vi(0,3-E.length):"")+E})+"."+Vi(o,a[1].length);switch(e){case"###,##0.00":return pi(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=Ls(Nl(u,0));return _!=="0"?h+_:"";case"###,###.00":return pi(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return pi(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function E8(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return za(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function w8(t,e,r){var n=e.replace(kk,""),i=e.length-n.length;return za(t,n,r*Math.pow(10,2*i))+nr("%",i)}function Fk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Fk(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ia(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Rk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ia("n",n,r):"("+ia("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return E8(t,e,r);if(e.indexOf("%")!==-1)return w8(t,e,r);if(e.indexOf("E")!==-1)return Fk(e,r);if(e.charCodeAt(0)===36)return"$"+ia(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Vi(u,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(Ck))return x8(a,u,h);if(e.match(/^#+0+$/))return h+Vi(u,e.length-e.indexOf("0"));if(a=e.match(Ik))return i=(""+r).replace(/^([^\.]+)$/,"$1."+wn(a[1])).replace(/\.$/,"."+wn(a[1])),i=i.replace(/\.(\d*)$/,function(E,y){return"."+y+nr("0",wn(a[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+Ls(""+u);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ia(t,e,-r):Ls(""+r)+"."+nr("0",a[1].length);if(a=e.match(/^#,#*,#0/))return ia(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Kl(ia(t,e.replace(/[\\-]/g,""),r)),o=0,Kl(Kl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<i.length?i.charAt(o++):E==="0"?"0":""}));if(e.match(Pk))return i=ia(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=U0(u,Math.pow(10,o)-1,!1),i=""+h,d=za("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=V0(c[2],o),d.length<a[4].length&&(d=wn(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=U0(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?G1(c[1],o)+a[2]+"/"+a[3]+V0(c[2],o):nr(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:wn(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,v=e.length-i.length-g;return wn(e.substr(0,g)+i+e.substr(e.length-v))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ia(t,e,-r):Ls(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Vi(0,3-E.length):"")+E})+"."+Vi(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=Ls(""+u);return _!=="0"?h+_:"";default:if(e.match(/\.[0#?]*$/))return ia(t,e.slice(0,e.lastIndexOf(".")),r)+wn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function za(t,e,r){return(r|0)===r?ia(t,e,r):pi(t,e,r)}function T8(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var bk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":B0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(bk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function S8(t,e,r,n){for(var i=[],a="",o=0,c="",u="t",h,d,g,v="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!B0(t,o))throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(g);i[i.length]={t:"t",v:a},++o;break;case"\\":var _=t.charAt(++o),E=_==="("||_===")"?_:"t";i[i.length]={t:E,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Fo(e,r,t.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Fo(e,r),h==null))return"";for(a=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),i[i.length]={t:c,v:a},u=c;break;case"A":case"a":case"":var y={t:c,v:c};if(h==null&&(h=Fo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(y.v=h.H>=12?"P":"A"),y.t="T",v="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(y.v=h.H>=12?"PM":"AM"),y.t="T",o+=5,v="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(y.v=h.H>=12?"":""),y.t="T",o+=5,v="h"):(y.t="t",++o),h==null&&y.t==="T")return"";i[i.length]=y,u=c;break;case"[":for(a=c;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(bk)){if(h==null&&(h=Fo(e,r),h==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",yc(t)||(i[i.length]={t:"t",v:a}));break;case".":if(h!=null){for(a=c;++o<t.length&&(c=t.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;t.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"t",v:c},++o;break}var w=0,k=0,F;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,u="h",w<1&&(w=1);break;case"s":(F=i[o].v.match(/\.0+$/))&&(k=Math.max(k,F[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",U;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=p8(i[o].t.charCodeAt(0),i[o].v,h,k),i[o].t="t";break;case"n":case"?":for(U=o+1;i[U]!=null&&((c=i[U].t)==="?"||c==="D"||(c===" "||c==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[o].v+=i[U].v,i[U]={v:"",t:";"},++U;C+=i[o].v,o=U-1;break;case"G":i[o].t="t",i[o].v=Uo(e,r);break}var V="",z,A;if(C.length>0){C.charCodeAt(0)==40?(z=e<0&&C.charCodeAt(0)===45?-e:e,A=za("n",C,z)):(z=e<0&&n>1?-e:e,A=za("n",C,z),z<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),U=A.length-1;var P=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){P=o;break}var R=i.length;if(P===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(U>=i[o].v.length-1?(U-=i[o].v.length,i[o].v=A.substr(U+1,i[o].v.length)):U<0?i[o].v="":(i[o].v=A.substr(0,U+1),U=-1),i[o].t="t",R=o);U>=0&&R<i.length&&(i[R].v=A.substr(0,U+1)+i[R].v)}else if(P!==i.length&&A.indexOf("E")===-1){for(U=A.indexOf(".")-1,o=P;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")-1:i[o].v.length-1,V=i[o].v.substr(d+1);d>=0;--d)U>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(V=A.charAt(U--)+V);i[o].v=V,i[o].t="t",R=o}for(U>=0&&R<i.length&&(i[R].v=A.substr(0,U+1)+i[R].v),U=A.indexOf(".")+1,o=P;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==P)){for(d=i[o].v.indexOf(".")>-1&&o===P?i[o].v.indexOf(".")+1:0,V=i[o].v.substr(0,d);d<i[o].v.length;++d)U<A.length&&(V+=A.charAt(U++));i[o].v=V,i[o].t="t",R=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(z=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=za(i[o].t,i[o].v,z),i[o].t="t");var M="";for(o=0;o!==i.length;++o)i[o]!=null&&(M+=i[o].v);return M}var HE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function k8(t,e){var r=T8(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(HE),c=r[1].match(HE);return zE(e,o)?[n,r[0]]:zE(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,a]}function vi(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ft)[t],n==null&&(n=r.table&&r.table[UE[t]]||ft[UE[t]]),n==null&&(n=o8[t]||"General");break}if(B0(n,0))return Uo(e,r);e instanceof Date&&(e=Sk(e,r.date1904));var i=k8(n,e);if(B0(i[1]))return Uo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return S8(i[1],e,r,i[0])}function Oo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ft[r]==null){e<0&&(e=r);continue}if(ft[r]==t){e=r;break}}e<0&&(e=391)}return ft[e]=t,e}function Ok(){ft=s8()}var A8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Dk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function C8(t){var e=typeof t=="number"?ft[t]:t;return e=e.replace(Dk,"(\\d+)"),new RegExp("^"+e+"$")}function I8(t,e,r){var n=-1,i=-1,a=-1,o=-1,c=-1,u=-1;(e.match(Dk)||[]).forEach(function(g,v){var _=parseInt(r[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=_;break;case"d":a=_;break;case"h":o=_;break;case"s":u=_;break;case"m":o>=0?c=_:i=_;break}}),u>=0&&c==-1&&i>=0&&(c=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:n==-1&&i==-1&&a==-1?d:h+"T"+d}var R8=function(){var t={};t.version="1.2.0";function e(){for(var A=0,P=new Array(256),R=0;R!=256;++R)A=R,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[R]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=e();function n(A){var P=0,R=0,M=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)L[M]=A[M];for(M=0;M!=256;++M)for(R=A[M],P=256+M;P<4096;P+=256)R=L[P]=R>>>8^A[R&255];var N=[];for(M=1;M!=16;++M)N[M-1]=typeof Int32Array<"u"?L.subarray(M*256,M*256+256):L.slice(M*256,M*256+256);return N}var i=n(r),a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],g=i[6],v=i[7],_=i[8],E=i[9],y=i[10],w=i[11],k=i[12],F=i[13],C=i[14];function U(A,P){for(var R=P^-1,M=0,L=A.length;M<L;)R=R>>>8^r[(R^A.charCodeAt(M++))&255];return~R}function V(A,P){for(var R=P^-1,M=A.length-15,L=0;L<M;)R=C[A[L++]^R&255]^F[A[L++]^R>>8&255]^k[A[L++]^R>>16&255]^w[A[L++]^R>>>24]^y[A[L++]]^E[A[L++]]^_[A[L++]]^v[A[L++]]^g[A[L++]]^d[A[L++]]^h[A[L++]]^u[A[L++]]^c[A[L++]]^o[A[L++]]^a[A[L++]]^r[A[L++]];for(M+=15;L<M;)R=R>>>8^r[(R^A[L++])&255];return~R}function z(A,P){for(var R=P^-1,M=0,L=A.length,N=0,B=0;M<L;)N=A.charCodeAt(M++),N<128?R=R>>>8^r[(R^N)&255]:N<2048?(R=R>>>8^r[(R^(192|N>>6&31))&255],R=R>>>8^r[(R^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,B=A.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|N>>8&7))&255],R=R>>>8^r[(R^(128|N>>2&63))&255],R=R>>>8^r[(R^(128|B>>6&15|(N&3)<<4))&255],R=R>>>8^r[(R^(128|B&63))&255]):(R=R>>>8^r[(R^(224|N>>12&15))&255],R=R>>>8^r[(R^(128|N>>6&63))&255],R=R>>>8^r[(R^(128|N&63))&255]);return~R}return t.table=r,t.bstr=U,t.buf=V,t.str=z,t}(),Et=function(){var e={};e.version="1.2.1";function r(O,K){for(var H=O.split("/"),W=K.split("/"),q=0,X=0,le=Math.min(H.length,W.length);q<le;++q){if(X=H[q].length-W[q].length)return X;if(H[q]!=W[q])return H[q]<W[q]?-1:1}return H.length-W.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var K=O.lastIndexOf("/");return K===-1?O:O.slice(0,K+1)}function i(O){if(O.charAt(O.length-1)=="/")return i(O.slice(0,-1));var K=O.lastIndexOf("/");return K===-1?O:O.slice(K+1)}function a(O,K){typeof K=="string"&&(K=new Date(K));var H=K.getHours();H=H<<6|K.getMinutes(),H=H<<5|K.getSeconds()>>>1,O.write_shift(2,H);var W=K.getFullYear()-1980;W=W<<4|K.getMonth()+1,W=W<<5|K.getDate(),O.write_shift(2,W)}function o(O){var K=O.read_shift(2)&65535,H=O.read_shift(2)&65535,W=new Date,q=H&31;H>>>=5;var X=H&15;H>>>=4,W.setMilliseconds(0),W.setFullYear(H+1980),W.setMonth(X-1),W.setDate(q);var le=K&31;K>>>=5;var ge=K&63;return K>>>=6,W.setHours(K),W.setMinutes(ge),W.setSeconds(le<<1),W}function c(O){Kr(O,0);for(var K={},H=0;O.l<=O.length-4;){var W=O.read_shift(2),q=O.read_shift(2),X=O.l+q,le={};switch(W){case 21589:H=O.read_shift(1),H&1&&(le.mtime=O.read_shift(4)),q>5&&(H&2&&(le.atime=O.read_shift(4)),H&4&&(le.ctime=O.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}O.l=X,K[W]=le}return K}var u;function h(){return u||(u={})}function d(O,K){if(O[0]==80&&O[1]==75)return _a(O,K);if((O[0]|32)==109&&(O[1]|32)==105)return oo(O,K);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var H=3,W=512,q=0,X=0,le=0,ge=0,ue=0,he=[],de=O.slice(0,512);Kr(de,0);var Pe=g(de);switch(H=Pe[0],H){case 3:W=512;break;case 4:W=4096;break;case 0:if(Pe[1]==0)return _a(O,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}W!==512&&(de=O.slice(0,W),Kr(de,28));var Le=O.slice(0,W);v(de,H);var Be=de.read_shift(4,"i");if(H===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ge=de.read_shift(4,"i"),q=de.read_shift(4,"i"),ue=de.read_shift(4,"i"),X=de.read_shift(4,"i");for(var De=-1,Fe=0;Fe<109&&(De=de.read_shift(4,"i"),!(De<0));++Fe)he[Fe]=De;var et=_(O,W);w(ue,X,et,W,he);var It=F(et,le,he,W);It[le].name="!Directory",q>0&&ge!==B&&(It[ge].name="!MiniFAT"),It[he[0]].name="!FAT",It.fat_addrs=he,It.ssz=W;var At={},Dt=[],wi=[],Ki=[];C(le,It,et,Dt,q,At,wi,ge),E(wi,Ki,Dt),Dt.shift();var zn={FileIndex:wi,FullPaths:Ki};return K&&K.raw&&(zn.raw={header:Le,sectors:et}),zn}function g(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Oe,"Header Signature: "),O.l+=16;var K=O.read_shift(2,"u");return[O.read_shift(2,"u"),K]}function v(O,K){var H=9;switch(O.l+=2,H=O.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function _(O,K){for(var H=Math.ceil(O.length/K)-1,W=[],q=1;q<H;++q)W[q-1]=O.slice(q*K,(q+1)*K);return W[H-1]=O.slice(H*K),W}function E(O,K,H){for(var W=0,q=0,X=0,le=0,ge=0,ue=H.length,he=[],de=[];W<ue;++W)he[W]=de[W]=W,K[W]=H[W];for(;ge<de.length;++ge)W=de[ge],q=O[W].L,X=O[W].R,le=O[W].C,he[W]===W&&(q!==-1&&he[q]!==q&&(he[W]=he[q]),X!==-1&&he[X]!==X&&(he[W]=he[X])),le!==-1&&(he[le]=W),q!==-1&&W!=he[W]&&(he[q]=he[W],de.lastIndexOf(q)<ge&&de.push(q)),X!==-1&&W!=he[W]&&(he[X]=he[W],de.lastIndexOf(X)<ge&&de.push(X));for(W=1;W<ue;++W)he[W]===W&&(X!==-1&&he[X]!==X?he[W]=he[X]:q!==-1&&he[q]!==q&&(he[W]=he[q]));for(W=1;W<ue;++W)if(O[W].type!==0){if(ge=W,ge!=he[ge])do ge=he[ge],K[W]=K[ge]+"/"+K[W];while(ge!==0&&he[ge]!==-1&&ge!=he[ge]);he[W]=-1}for(K[0]+="/",W=1;W<ue;++W)O[W].type!==2&&(K[W]+="/")}function y(O,K,H){for(var W=O.start,q=O.size,X=[],le=W;H&&q>0&&le>=0;)X.push(K.slice(le*N,le*N+N)),q-=N,le=Io(H,le*4);return X.length===0?Cr(0):Os(X).slice(0,O.size)}function w(O,K,H,W,q){var X=B;if(O===B){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var le=H[O],ge=(W>>>2)-1;if(!le)return;for(var ue=0;ue<ge&&(X=Io(le,ue*4))!==B;++ue)q.push(X);w(Io(le,W-4),K-1,H,W,q)}}function k(O,K,H,W,q){var X=[],le=[];q||(q=[]);var ge=W-1,ue=0,he=0;for(ue=K;ue>=0;){q[ue]=!0,X[X.length]=ue,le.push(O[ue]);var de=H[Math.floor(ue*4/W)];if(he=ue*4&ge,W<4+he)throw new Error("FAT boundary crossed: "+ue+" 4 "+W);if(!O[de])break;ue=Io(O[de],he)}return{nodes:X,data:ew([le])}}function F(O,K,H,W){var q=O.length,X=[],le=[],ge=[],ue=[],he=W-1,de=0,Pe=0,Le=0,Be=0;for(de=0;de<q;++de)if(ge=[],Le=de+K,Le>=q&&(Le-=q),!le[Le]){ue=[];var De=[];for(Pe=Le;Pe>=0;){De[Pe]=!0,le[Pe]=!0,ge[ge.length]=Pe,ue.push(O[Pe]);var Fe=H[Math.floor(Pe*4/W)];if(Be=Pe*4&he,W<4+Be)throw new Error("FAT boundary crossed: "+Pe+" 4 "+W);if(!O[Fe]||(Pe=Io(O[Fe],Be),De[Pe]))break}X[Le]={nodes:ge,data:ew([ue])}}return X}function C(O,K,H,W,q,X,le,ge){for(var ue=0,he=W.length?2:0,de=K[O].data,Pe=0,Le=0,Be;Pe<de.length;Pe+=128){var De=de.slice(Pe,Pe+128);Kr(De,64),Le=De.read_shift(2),Be=J1(De,0,Le-he),W.push(Be);var Fe={name:Be,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},et=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);et!==0&&(Fe.ct=U(De,De.l-8));var It=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);It!==0&&(Fe.mt=U(De,De.l-8)),Fe.start=De.read_shift(4,"i"),Fe.size=De.read_shift(4,"i"),Fe.size<0&&Fe.start<0&&(Fe.size=Fe.type=0,Fe.start=B,Fe.name=""),Fe.type===5?(ue=Fe.start,q>0&&ue!==B&&(K[ue].name="!StreamData")):Fe.size>=4096?(Fe.storage="fat",K[Fe.start]===void 0&&(K[Fe.start]=k(H,Fe.start,K.fat_addrs,K.ssz)),K[Fe.start].name=Fe.name,Fe.content=K[Fe.start].data.slice(0,Fe.size)):(Fe.storage="minifat",Fe.size<0?Fe.size=0:ue!==B&&Fe.start!==B&&K[ue]&&(Fe.content=y(Fe,K[ue].data,(K[ge]||{}).data))),Fe.content&&Kr(Fe.content,0),X[Be]=Fe,le.push(Fe)}}function U(O,K){return new Date((Qn(O,K+4)/1e7*Math.pow(2,32)+Qn(O,K)/1e7-11644473600)*1e3)}function V(O,K){return h(),d(u.readFileSync(O),K)}function z(O,K){var H=K&&K.type;switch(H||xt&&Buffer.isBuffer(O)&&(H="buffer"),H||"base64"){case"file":return V(O,K);case"base64":return d(Li(ri(O)),K);case"binary":return d(Li(O),K)}return d(O,K)}function A(O,K){var H=K||{},W=H.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=W+"/",O.FileIndex[0]={name:W,type:5}),H.CLSID&&(O.FileIndex[0].clsid=H.CLSID),P(O)}function P(O){var K="Sh33tJ5";if(!Et.find(O,"/"+K)){var H=Cr(4);H[0]=55,H[1]=H[3]=50,H[2]=54,O.FileIndex.push({name:K,type:2,content:H,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+K),R(O)}}function R(O,K){A(O);for(var H=!1,W=!1,q=O.FullPaths.length-1;q>=0;--q){var X=O.FileIndex[q];switch(X.type){case 0:W?H=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(X.R*X.L*X.C)&&(H=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!K)){var le=new Date(1987,1,19),ge=0,ue=Object.create?Object.create(null):{},he=[];for(q=0;q<O.FullPaths.length;++q)ue[O.FullPaths[q]]=!0,O.FileIndex[q].type!==0&&he.push([O.FullPaths[q],O.FileIndex[q]]);for(q=0;q<he.length;++q){var de=n(he[q][0]);W=ue[de],W||(he.push([de,{name:i(de).replace("/",""),type:1,clsid:Ce,ct:le,mt:le,content:null}]),ue[de]=!0)}for(he.sort(function(Be,De){return r(Be[0],De[0])}),O.FullPaths=[],O.FileIndex=[],q=0;q<he.length;++q)O.FullPaths[q]=he[q][0],O.FileIndex[q]=he[q][1];for(q=0;q<he.length;++q){var Pe=O.FileIndex[q],Le=O.FullPaths[q];if(Pe.name=i(Le).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||Ce,q===0)Pe.C=he.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Le.slice(-1)=="/"){for(ge=q+1;ge<he.length&&n(O.FullPaths[ge])!=Le;++ge);for(Pe.C=ge>=he.length?-1:ge,ge=q+1;ge<he.length&&n(O.FullPaths[ge])!=n(Le);++ge);Pe.R=ge>=he.length?-1:ge,Pe.type=1}else n(O.FullPaths[q+1]||"")==n(Le)&&(Pe.R=q+1),Pe.type=2}}}function M(O,K){var H=K||{};if(H.fileType=="mad")return Jt(O,H);switch(R(O),H.fileType){case"zip":return ni(O,H)}var W=function(Be){for(var De=0,Fe=0,et=0;et<Be.FileIndex.length;++et){var It=Be.FileIndex[et];if(It.content){var At=It.content.length;At>0&&(At<4096?De+=At+63>>6:Fe+=At+511>>9)}}for(var Dt=Be.FullPaths.length+3>>2,wi=De+7>>3,Ki=De+127>>7,zn=wi+Fe+Dt+Ki,sr=zn+127>>7,as=sr<=109?0:Math.ceil((sr-109)/127);zn+sr+as+127>>7>sr;)as=++sr<=109?0:Math.ceil((sr-109)/127);var zt=[1,as,sr,Ki,Dt,Fe,De,0];return Be.FileIndex[0].size=De<<6,zt[7]=(Be.FileIndex[0].start=zt[0]+zt[1]+zt[2]+zt[3]+zt[4]+zt[5])+(zt[6]+7>>3),zt}(O),q=Cr(W[7]<<9),X=0,le=0;{for(X=0;X<8;++X)q.write_shift(1,we[X]);for(X=0;X<8;++X)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),X=0;X<3;++X)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,W[2]),q.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:B),q.write_shift(4,W[3]),q.write_shift(-4,W[1]?W[0]-1:B),q.write_shift(4,W[1]),X=0;X<109;++X)q.write_shift(-4,X<W[2]?W[1]+X:-1)}if(W[1])for(le=0;le<W[1];++le){for(;X<236+le*127;++X)q.write_shift(-4,X<W[2]?W[1]+X:-1);q.write_shift(-4,le===W[1]-1?B:le+1)}var ge=function(Be){for(le+=Be;X<le-1;++X)q.write_shift(-4,X+1);Be&&(++X,q.write_shift(-4,B))};for(le=X=0,le+=W[1];X<le;++X)q.write_shift(-4,Ae.DIFSECT);for(le+=W[2];X<le;++X)q.write_shift(-4,Ae.FATSECT);ge(W[3]),ge(W[4]);for(var ue=0,he=0,de=O.FileIndex[0];ue<O.FileIndex.length;++ue)de=O.FileIndex[ue],de.content&&(he=de.content.length,!(he<4096)&&(de.start=le,ge(he+511>>9)));for(ge(W[6]+7>>3);q.l&511;)q.write_shift(-4,Ae.ENDOFCHAIN);for(le=X=0,ue=0;ue<O.FileIndex.length;++ue)de=O.FileIndex[ue],de.content&&(he=de.content.length,!(!he||he>=4096)&&(de.start=le,ge(he+63>>6)));for(;q.l&511;)q.write_shift(-4,Ae.ENDOFCHAIN);for(X=0;X<W[4]<<2;++X){var Pe=O.FullPaths[X];if(!Pe||Pe.length===0){for(ue=0;ue<17;++ue)q.write_shift(4,0);for(ue=0;ue<3;++ue)q.write_shift(4,-1);for(ue=0;ue<12;++ue)q.write_shift(4,0);continue}de=O.FileIndex[X],X===0&&(de.start=de.size?de.start-1:B);var Le=X===0&&H.root||de.name;if(he=2*(Le.length+1),q.write_shift(64,Le,"utf16le"),q.write_shift(2,he),q.write_shift(1,de.type),q.write_shift(1,de.color),q.write_shift(-4,de.L),q.write_shift(-4,de.R),q.write_shift(-4,de.C),de.clsid)q.write_shift(16,de.clsid,"hex");else for(ue=0;ue<4;++ue)q.write_shift(4,0);q.write_shift(4,de.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,de.start),q.write_shift(4,de.size),q.write_shift(4,0)}for(X=1;X<O.FileIndex.length;++X)if(de=O.FileIndex[X],de.size>=4096)if(q.l=de.start+1<<9,xt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+511&-512;else{for(ue=0;ue<de.size;++ue)q.write_shift(1,de.content[ue]);for(;ue&511;++ue)q.write_shift(1,0)}for(X=1;X<O.FileIndex.length;++X)if(de=O.FileIndex[X],de.size>0&&de.size<4096)if(xt&&Buffer.isBuffer(de.content))de.content.copy(q,q.l,0,de.size),q.l+=de.size+63&-64;else{for(ue=0;ue<de.size;++ue)q.write_shift(1,de.content[ue]);for(;ue&63;++ue)q.write_shift(1,0)}if(xt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function L(O,K){var H=O.FullPaths.map(function(ue){return ue.toUpperCase()}),W=H.map(function(ue){var he=ue.split("/");return he[he.length-(ue.slice(-1)=="/"?2:1)]}),q=!1;K.charCodeAt(0)===47?(q=!0,K=H[0].slice(0,-1)+K):q=K.indexOf("/")!==-1;var X=K.toUpperCase(),le=q===!0?H.indexOf(X):W.indexOf(X);if(le!==-1)return O.FileIndex[le];var ge=!X.match(fu);for(X=X.replace(Cn,""),ge&&(X=X.replace(fu,"!")),le=0;le<H.length;++le)if((ge?H[le].replace(fu,"!"):H[le]).replace(Cn,"")==X||(ge?W[le].replace(fu,"!"):W[le]).replace(Cn,"")==X)return O.FileIndex[le];return null}var N=64,B=-2,Oe="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:Oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(O,K,H){h();var W=M(O,H);u.writeFileSync(K,W)}function ie(O){for(var K=new Array(O.length),H=0;H<O.length;++H)K[H]=String.fromCharCode(O[H]);return K.join("")}function xe(O,K){var H=M(O,K);switch(K&&K.type||"buffer"){case"file":return h(),u.writeFileSync(K.filename,H),H;case"binary":return typeof H=="string"?H:ie(H);case"base64":return LE(typeof H=="string"?H:ie(H));case"buffer":if(xt)return Buffer.isBuffer(H)?H:Xo(H);case"array":return typeof H=="string"?Li(H):H}return H}var te;function D(O){try{var K=O.InflateRaw,H=new K;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)te=O;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function re(O,K){if(!te)return Gi(O,K);var H=te.InflateRaw,W=new H,q=W._processChunk(O.slice(O.l),W._finishFlushFlag);return O.l+=W.bytesRead,q}function ee(O){return te?te.deflateRawSync(O):rt(O)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(O){var K=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(K>>16|K>>8|K)&255}for(var ye=typeof Uint8Array<"u",Te=ye?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)Te[Ke]=ve(Ke);function J(O,K){var H=Te[O&255];return K<=8?H>>>8-K:(H=H<<8|Te[O>>8&255],K<=16?H>>>16-K:(H=H<<8|Te[O>>16&255],H>>>24-K))}function kt(O,K){var H=K&7,W=K>>>3;return(O[W]|(H<=6?0:O[W+1]<<8))>>>H&3}function ct(O,K){var H=K&7,W=K>>>3;return(O[W]|(H<=5?0:O[W+1]<<8))>>>H&7}function dt(O,K){var H=K&7,W=K>>>3;return(O[W]|(H<=4?0:O[W+1]<<8))>>>H&15}function ut(O,K){var H=K&7,W=K>>>3;return(O[W]|(H<=3?0:O[W+1]<<8))>>>H&31}function Ve(O,K){var H=K&7,W=K>>>3;return(O[W]|(H<=1?0:O[W+1]<<8))>>>H&127}function Vt(O,K,H){var W=K&7,q=K>>>3,X=(1<<H)-1,le=O[q]>>>W;return H<8-W||(le|=O[q+1]<<8-W,H<16-W)||(le|=O[q+2]<<16-W,H<24-W)||(le|=O[q+3]<<24-W),le&X}function wr(O,K,H){var W=K&7,q=K>>>3;return W<=5?O[q]|=(H&7)<<W:(O[q]|=H<<W&255,O[q+1]=(H&7)>>8-W),K+3}function fr(O,K,H){var W=K&7,q=K>>>3;return H=(H&1)<<W,O[q]|=H,K+1}function Tr(O,K,H){var W=K&7,q=K>>>3;return H<<=W,O[q]|=H&255,H>>>=8,O[q+1]=H,K+8}function _i(O,K,H){var W=K&7,q=K>>>3;return H<<=W,O[q]|=H&255,H>>>=8,O[q+1]=H&255,O[q+2]=H>>>8,K+16}function gn(O,K){var H=O.length,W=2*H>K?2*H:K+5,q=0;if(H>=K)return O;if(xt){var X=ME(W);if(O.copy)O.copy(X);else for(;q<O.length;++q)X[q]=O[q];return X}else if(ye){var le=new Uint8Array(W);if(le.set)le.set(O);else for(;q<H;++q)le[q]=O[q];return le}return O.length=W,O}function hr(O){for(var K=new Array(O),H=0;H<O;++H)K[H]=0;return K}function vn(O,K,H){var W=1,q=0,X=0,le=0,ge=0,ue=O.length,he=ye?new Uint16Array(32):hr(32);for(X=0;X<32;++X)he[X]=0;for(X=ue;X<H;++X)O[X]=0;ue=O.length;var de=ye?new Uint16Array(ue):hr(ue);for(X=0;X<ue;++X)he[q=O[X]]++,W<q&&(W=q),de[X]=0;for(he[0]=0,X=1;X<=W;++X)he[X+16]=ge=ge+he[X-1]<<1;for(X=0;X<ue;++X)ge=O[X],ge!=0&&(de[X]=he[ge+16]++);var Pe=0;for(X=0;X<ue;++X)if(Pe=O[X],Pe!=0)for(ge=J(de[X],W)>>W-Pe,le=(1<<W+4-Pe)-1;le>=0;--le)K[ge|le<<Pe]=Pe&15|X<<4;return W}var Lt=ye?new Uint16Array(512):hr(512),jt=ye?new Uint16Array(32):hr(32);if(!ye){for(var $t=0;$t<512;++$t)Lt[$t]=0;for($t=0;$t<32;++$t)jt[$t]=0}(function(){for(var O=[],K=0;K<32;K++)O.push(5);vn(O,jt,32);var H=[];for(K=0;K<=143;K++)H.push(8);for(;K<=255;K++)H.push(9);for(;K<=279;K++)H.push(7);for(;K<=287;K++)H.push(8);vn(H,Lt,288)})();var Jr=function(){for(var K=ye?new Uint8Array(32768):[],H=0,W=0;H<_e.length-1;++H)for(;W<_e[H+1];++W)K[W]=H;for(;W<32768;++W)K[W]=29;var q=ye?new Uint8Array(259):[];for(H=0,W=0;H<ce.length-1;++H)for(;W<ce[H+1];++W)q[W]=H;function X(ge,ue){for(var he=0;he<ge.length;){var de=Math.min(65535,ge.length-he),Pe=he+de==ge.length;for(ue.write_shift(1,+Pe),ue.write_shift(2,de),ue.write_shift(2,~de&65535);de-- >0;)ue[ue.l++]=ge[he++]}return ue.l}function le(ge,ue){for(var he=0,de=0,Pe=ye?new Uint16Array(32768):[];de<ge.length;){var Le=Math.min(65535,ge.length-de);if(Le<10){for(he=wr(ue,he,+(de+Le==ge.length)),he&7&&(he+=8-(he&7)),ue.l=he/8|0,ue.write_shift(2,Le),ue.write_shift(2,~Le&65535);Le-- >0;)ue[ue.l++]=ge[de++];he=ue.l*8;continue}he=wr(ue,he,+(de+Le==ge.length)+2);for(var Be=0;Le-- >0;){var De=ge[de];Be=(Be<<5^De)&32767;var Fe=-1,et=0;if((Fe=Pe[Be])&&(Fe|=de&-32768,Fe>de&&(Fe-=32768),Fe<de))for(;ge[Fe+et]==ge[de+et]&&et<250;)++et;if(et>2){De=q[et],De<=22?he=Tr(ue,he,Te[De+1]>>1)-1:(Tr(ue,he,3),he+=5,Tr(ue,he,Te[De-23]>>5),he+=3);var It=De<8?0:De-4>>2;It>0&&(_i(ue,he,et-ce[De]),he+=It),De=K[de-Fe],he=Tr(ue,he,Te[De]>>3),he-=3;var At=De<4?0:De-2>>1;At>0&&(_i(ue,he,de-Fe-_e[De]),he+=At);for(var Dt=0;Dt<et;++Dt)Pe[Be]=de&32767,Be=(Be<<5^ge[de])&32767,++de;Le-=et-1}else De<=143?De=De+48:he=fr(ue,he,1),he=Tr(ue,he,Te[De]),Pe[Be]=de&32767,++de}he=Tr(ue,he,0)-1}return ue.l=(he+7)/8|0,ue.l}return function(ue,he){return ue.length<8?X(ue,he):le(ue,he)}}();function rt(O){var K=Cr(50+Math.floor(O.length*1.1)),H=Jr(O,K);return K.slice(0,H)}var Ot=ye?new Uint16Array(32768):hr(32768),dr=ye?new Uint16Array(32768):hr(32768),Ht=ye?new Uint16Array(128):hr(128),Hn=1,rs=1;function no(O,K){var H=ut(O,K)+257;K+=5;var W=ut(O,K)+1;K+=5;var q=dt(O,K)+4;K+=4;for(var X=0,le=ye?new Uint8Array(19):hr(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ue=1,he=ye?new Uint8Array(8):hr(8),de=ye?new Uint8Array(8):hr(8),Pe=le.length,Le=0;Le<q;++Le)le[Z[Le]]=X=ct(O,K),ue<X&&(ue=X),he[X]++,K+=3;var Be=0;for(he[0]=0,Le=1;Le<=ue;++Le)de[Le]=Be=Be+he[Le-1]<<1;for(Le=0;Le<Pe;++Le)(Be=le[Le])!=0&&(ge[Le]=de[Be]++);var De=0;for(Le=0;Le<Pe;++Le)if(De=le[Le],De!=0){Be=Te[ge[Le]]>>8-De;for(var Fe=(1<<7-De)-1;Fe>=0;--Fe)Ht[Be|Fe<<De]=De&7|Le<<3}var et=[];for(ue=1;et.length<H+W;)switch(Be=Ht[Ve(O,K)],K+=Be&7,Be>>>=3){case 16:for(X=3+kt(O,K),K+=2,Be=et[et.length-1];X-- >0;)et.push(Be);break;case 17:for(X=3+ct(O,K),K+=3;X-- >0;)et.push(0);break;case 18:for(X=11+Ve(O,K),K+=7;X-- >0;)et.push(0);break;default:et.push(Be),ue<Be&&(ue=Be);break}var It=et.slice(0,H),At=et.slice(H);for(Le=H;Le<286;++Le)It[Le]=0;for(Le=W;Le<30;++Le)At[Le]=0;return Hn=vn(It,Ot,286),rs=vn(At,dr,30),K}function io(O,K){if(O[0]==3&&!(O[1]&3))return[Ys(K),2];for(var H=0,W=0,q=ME(K||1<<18),X=0,le=q.length>>>0,ge=0,ue=0;!(W&1);){if(W=ct(O,H),H+=3,W>>>1)W>>1==1?(ge=9,ue=5):(H=no(O,H),ge=Hn,ue=rs);else{H&7&&(H+=8-(H&7));var he=O[H>>>3]|O[(H>>>3)+1]<<8;if(H+=32,he>0)for(!K&&le<X+he&&(q=gn(q,X+he),le=q.length);he-- >0;)q[X++]=O[H>>>3],H+=8;continue}for(;;){!K&&le<X+32767&&(q=gn(q,X+32767),le=q.length);var de=Vt(O,H,ge),Pe=W>>>1==1?Lt[de]:Ot[de];if(H+=Pe&15,Pe>>>=4,!(Pe>>>8&255))q[X++]=Pe;else{if(Pe==256)break;Pe-=257;var Le=Pe<8?0:Pe-4>>2;Le>5&&(Le=0);var Be=X+ce[Pe];Le>0&&(Be+=Vt(O,H,Le),H+=Le),de=Vt(O,H,ue),Pe=W>>>1==1?jt[de]:dr[de],H+=Pe&15,Pe>>>=4;var De=Pe<4?0:Pe-2>>1,Fe=_e[Pe];for(De>0&&(Fe+=Vt(O,H,De),H+=De),!K&&le<Be&&(q=gn(q,Be+100),le=q.length);X<Be;)q[X]=q[X-Fe],++X}}}return K?[q,H+7>>>3]:[q.slice(0,X),H+7>>>3]}function Gi(O,K){var H=O.slice(O.l||0),W=io(H,K);return O.l+=W[1],W[0]}function xa(O,K){if(O)typeof console<"u"&&console.error(K);else throw new Error(K)}function _a(O,K){var H=O;Kr(H,0);var W=[],q=[],X={FileIndex:W,FullPaths:q};A(X,{root:K.root});for(var le=H.length-4;(H[le]!=80||H[le+1]!=75||H[le+2]!=5||H[le+3]!=6)&&le>=0;)--le;H.l=le+4,H.l+=4;var ge=H.read_shift(2);H.l+=6;var ue=H.read_shift(4);for(H.l=ue,le=0;le<ge;++le){H.l+=20;var he=H.read_shift(4),de=H.read_shift(4),Pe=H.read_shift(2),Le=H.read_shift(2),Be=H.read_shift(2);H.l+=8;var De=H.read_shift(4),Fe=c(H.slice(H.l+Pe,H.l+Pe+Le));H.l+=Pe+Le+Be;var et=H.l;H.l=De+4,Rn(H,he,de,X,Fe),H.l=et}return X}function Rn(O,K,H,W,q){O.l+=2;var X=O.read_shift(2),le=O.read_shift(2),ge=o(O);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ue=O.read_shift(4),he=O.read_shift(4),de=O.read_shift(4),Pe=O.read_shift(2),Le=O.read_shift(2),Be="",De=0;De<Pe;++De)Be+=String.fromCharCode(O[O.l++]);if(Le){var Fe=c(O.slice(O.l,O.l+Le));(Fe[21589]||{}).mt&&(ge=Fe[21589].mt),((q||{})[21589]||{}).mt&&(ge=q[21589].mt)}O.l+=Le;var et=O.slice(O.l,O.l+he);switch(le){case 8:et=re(O,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var It=!1;X&8&&(ue=O.read_shift(4),ue==134695760&&(ue=O.read_shift(4),It=!0),he=O.read_shift(4),de=O.read_shift(4)),he!=K&&xa(It,"Bad compressed size: "+K+" != "+he),de!=H&&xa(It,"Bad uncompressed size: "+H+" != "+de),xn(W,Be,et,{unsafe:!0,mt:ge})}function ni(O,K){var H=K||{},W=[],q=[],X=Cr(1),le=H.compression?8:0,ge=0,ue=0,he=0,de=0,Pe=0,Le=O.FullPaths[0],Be=Le,De=O.FileIndex[0],Fe=[],et=0;for(ue=1;ue<O.FullPaths.length;++ue)if(Be=O.FullPaths[ue].slice(Le.length),De=O.FileIndex[ue],!(!De.size||!De.content||Be=="Sh33tJ5")){var It=de,At=Cr(Be.length);for(he=0;he<Be.length;++he)At.write_shift(1,Be.charCodeAt(he)&127);At=At.slice(0,At.l),Fe[Pe]=R8.buf(De.content,0);var Dt=De.content;le==8&&(Dt=ee(Dt)),X=Cr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),De.mt?a(X,De.mt):X.write_shift(4,0),X.write_shift(-4,Fe[Pe]),X.write_shift(4,Dt.length),X.write_shift(4,De.content.length),X.write_shift(2,At.length),X.write_shift(2,0),de+=X.length,W.push(X),de+=At.length,W.push(At),de+=Dt.length,W.push(Dt),X=Cr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,ge),X.write_shift(2,le),X.write_shift(4,0),X.write_shift(-4,Fe[Pe]),X.write_shift(4,Dt.length),X.write_shift(4,De.content.length),X.write_shift(2,At.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,It),et+=X.l,q.push(X),et+=At.length,q.push(At),++Pe}return X=Cr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Pe),X.write_shift(2,Pe),X.write_shift(4,et),X.write_shift(4,de),X.write_shift(2,0),Os([Os(W),Os(q),X])}var yi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ii(O,K){if(O.ctype)return O.ctype;var H=O.name||"",W=H.match(/\.([^\.]+)$/);return W&&yi[W[1]]||K&&(W=(H=K).match(/[\.\\]([^\.\\])+$/),W&&yi[W[1]])?yi[W[1]]:"application/octet-stream"}function ao(O){for(var K=LE(O),H=[],W=0;W<K.length;W+=76)H.push(K.slice(W,W+76));return H.join(`\r
`)+`\r
`}function ya(O){var K=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var de=he.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],W=K.split(`\r
`),q=0;q<W.length;++q){var X=W[q];if(X.length==0){H.push("");continue}for(var le=0;le<X.length;){var ge=76,ue=X.slice(le,le+ge);ue.charAt(ge-1)=="="?ge--:ue.charAt(ge-2)=="="?ge-=2:ue.charAt(ge-3)=="="&&(ge-=3),ue=X.slice(le,le+ge),le+=ge,le<X.length&&(ue+="="),H.push(ue)}}return H.join(`\r
`)}function so(O){for(var K=[],H=0;H<O.length;++H){for(var W=O[H];H<=O.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+O[++H];K.push(W)}for(var q=0;q<K.length;++q)K[q]=K[q].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Li(K.join(`\r
`))}function Ei(O,K,H){for(var W="",q="",X="",le,ge=0;ge<10;++ge){var ue=K[ge];if(!ue||ue.match(/^\s*$/))break;var he=ue.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":W=he[2].trim();break;case"content-type":X=he[2].trim();break;case"content-transfer-encoding":q=he[2].trim();break}}switch(++ge,q.toLowerCase()){case"base64":le=Li(ri(K.slice(ge).join("")));break;case"quoted-printable":le=so(K.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var de=xn(O,W.slice(H.length),le,{unsafe:!0});X&&(de.ctype=X)}function oo(O,K){if(ie(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=K&&K.root||"",W=(xt&&Buffer.isBuffer(O)?O.toString("binary"):ie(O)).split(`\r
`),q=0,X="";for(q=0;q<W.length;++q)if(X=W[q],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),H||(H=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),X.slice(0,H.length)!=H););var le=(W[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ge="--"+(le[1]||""),ue=[],he=[],de={FileIndex:ue,FullPaths:he};A(de);var Pe,Le=0;for(q=0;q<W.length;++q){var Be=W[q];Be!==ge&&Be!==ge+"--"||(Le++&&Ei(de,W.slice(Pe,q),H),Pe=q)}return de}function Jt(O,K){var H=K||{},W=H.boundary||"SheetJS";W="------="+W;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],X=O.FullPaths[0],le=X,ge=O.FileIndex[0],ue=1;ue<O.FullPaths.length;++ue)if(le=O.FullPaths[ue].slice(X.length),ge=O.FileIndex[ue],!(!ge.size||!ge.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var he=ge.content,de=xt&&Buffer.isBuffer(he)?he.toString("binary"):ie(he),Pe=0,Le=Math.min(1024,de.length),Be=0,De=0;De<=Le;++De)(Be=de.charCodeAt(De))>=32&&Be<128&&++Pe;var Fe=Pe>=Le*4/5;q.push(W),q.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+le),q.push("Content-Transfer-Encoding: "+(Fe?"quoted-printable":"base64")),q.push("Content-Type: "+ii(ge,le)),q.push(""),q.push(Fe?ya(de):ao(de))}return q.push(W+`--\r
`),q.join(`\r
`)}function ns(O){var K={};return A(K,O),K}function xn(O,K,H,W){var q=W&&W.unsafe;q||A(O);var X=!q&&Et.find(O,K);if(!X){var le=O.FullPaths[0];K.slice(0,le.length)==le?le=K:(le.slice(-1)!="/"&&(le+="/"),le=(le+K).replace("//","/")),X={name:i(K),type:2},O.FileIndex.push(X),O.FullPaths.push(le),q||Et.utils.cfb_gc(O)}return X.content=H,X.size=H?H.length:0,W&&(W.CLSID&&(X.clsid=W.CLSID),W.mt&&(X.mt=W.mt),W.ct&&(X.ct=W.ct)),X}function Ea(O,K){A(O);var H=Et.find(O,K);if(H){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==H)return O.FileIndex.splice(W,1),O.FullPaths.splice(W,1),!0}return!1}function wa(O,K,H){A(O);var W=Et.find(O,K);if(W){for(var q=0;q<O.FileIndex.length;++q)if(O.FileIndex[q]==W)return O.FileIndex[q].name=i(H),O.FullPaths[q]=H,!0}return!1}function is(O){R(O,!0)}return e.find=L,e.read=z,e.parse=d,e.write=xe,e.writeFile=Ee,e.utils={cfb_new:ns,cfb_add:xn,cfb_del:Ea,cfb_mov:wa,cfb_gc:is,ReadShift:_u,CheckField:rA,prep_blob:Kr,bconcat:Os,use_zlib:D,_deflateRaw:rt,_inflateRaw:Gi,consts:Ae},e}();function P8(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function pa(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function q1(t){for(var e=[],r=pa(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var j0=new Date(1899,11,30,0,0,0);function In(t,e){var r=t.getTime(),n=j0.getTime()+(t.getTimezoneOffset()-j0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Nk=new Date,F8=j0.getTime()+(Nk.getTimezoneOffset()-j0.getTimezoneOffset())*6e4,WE=Nk.getTimezoneOffset();function Cd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+F8),e.getTimezoneOffset()!==WE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-WE)*6e4),e}function b8(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[a],10)}return e}var GE=new Date("2017-02-19T19:06:09.000Z"),Lk=isNaN(GE.getFullYear())?new Date("2/19/17"):GE,O8=Lk.getFullYear()==2017;function Ur(t,e){var r=new Date(t);if(O8)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Lk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function jo(t,e){if(xt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return du(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return du(wk(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return du(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return du(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Xr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Xr(t[r]));return e}function nr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ui(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var D8=["january","february","march","april","may","june","july","august","september","october","november","december"];function lc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&D8.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var N8=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],c=1;c<a.length;++c)o.push(i),o.push(a[c]);return o}}();function Mk(t){return t?t.content&&t.type?jo(t.content,!0):t.data?uu(t.data):t.asNodeBuffer&&xt?uu(t.asNodeBuffer().toString("binary")):t.asBinary?uu(t.asBinary()):t._data&&t._data.getContent?uu(jo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Vk(t){if(!t)return null;if(t.data)return DE(t.data);if(t.asNodeBuffer&&xt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?DE(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function L8(t){return t&&t.name.slice(-4)===".bin"?Vk(t):Mk(t)}function mi(t,e){for(var r=t.FullPaths||pa(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function X1(t,e){var r=mi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function xr(t,e,r){if(!r)return L8(X1(t,e));if(!e)return null;try{return xr(t,e)}catch{return null}}function Jn(t,e,r){if(!r)return Mk(X1(t,e));if(!e)return null;try{return Jn(t,e)}catch{return null}}function M8(t,e,r){return Vk(X1(t,e))}function KE(t){for(var e=t.FullPaths||pa(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function V8(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return xt?n=Xo(r):n=n8(r),Et.utils.cfb_add(t,e,n)}Et.utils.cfb_add(t,e,r)}else t.file(e,r)}function Bk(t,e){switch(e.type){case"base64":return Et.read(t,{type:"base64"});case"binary":return Et.read(t,{type:"binary"});case"buffer":case"array":return Et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function hu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Uk=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,B8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,U8=/<[^>]*>/g,mn=Uk.match(qE)?qE:U8,j8=/<\w*:/,$8=/<(\/?)\w+:/;function tt(t,e,r){for(var n={},i=0,a=0;i!==t.length&&!((a=t.charCodeAt(i))===32||a===10||a===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(B8),c=0,u="",h=0,d="",g="",v=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],a=0;a!=g.length&&g.charCodeAt(a)!==61;++a);for(d=g.slice(0,a).trim();g.charCodeAt(a+1)==32;)++a;for(v=(i=g.charCodeAt(a+1))==34||i==39?1:0,u=g.slice(a+1+v,g.length-v),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var _=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[_]&&d.slice(c-3,c)=="ext")continue;n[_]=u,n[_.toLowerCase()]=u}}return n}function ga(t){return t.replace($8,"<$1")}var jk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},H8=q1(jk),St=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(t,function(c,u){return jk[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),z8=/[&<>'"]/g,W8=/[\u0000-\u001f]/g;function Y1(t){var e=t+"";return e.replace(z8,function(r){return H8[r]}).replace(/\n/g,"<br/>").replace(W8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var XE=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Yt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pm(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function YE(t){var e=Ys(2*t.length),r,n,i=1,a=0,o=0,c;for(n=0;n<t.length;n+=i)i=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),i=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function QE(t){return Xo(t,"binary").toString("utf8")}var $h="foo bar baz",Ut=xt&&(QE($h)==Pm($h)&&QE||YE($h)==Pm($h)&&YE)||Pm,du=xt?function(t){return Xo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},ju=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),$k=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),G8=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),K8=/<\/?(?:vt:)?variant>/g,q8=/<(?:vt:)([^>]*)>([\s\S]*)</;function JE(t,e){var r=tt(t),n=t.match(G8(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(K8,"").match(q8);o&&i.push({v:Ut(o[2]),t:o[1]})}),i}var X8=/(^\s|\s$|\n)/;function Y8(t){return pa(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Q8(t,e,r){return"<"+t+(r!=null?Y8(r):"")+(e!=null?(e.match(X8)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Q1(t){if(xt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ut(Yo(W1(t)));throw new Error("Bad input format: expected Buffer or string")}var $u=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,J8={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Z8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function e5(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function t5(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,o=n?-e:e;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)t[r+c]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var ZE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},ew=xt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Xo(e)})):ZE(t)}:ZE,tw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ua(t,i)));return n.join("").replace(Cn,"")},J1=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Cn,""):tw(t,e,r)}:tw,rw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Hk=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):rw(t,e,r)}:rw,nw=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Ul(t,i)));return n.join("")},pf=xt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):nw(e,r,n)}:nw,zk=function(t,e){var r=Qn(t,e);return r>0?pf(t,e+4,e+4+r-1):""},Wk=zk,Gk=function(t,e){var r=Qn(t,e);return r>0?pf(t,e+4,e+4+r-1):""},Kk=Gk,qk=function(t,e){var r=2*Qn(t,e);return r>0?pf(t,e+4,e+4+r-1):""},Xk=qk,Yk=function(e,r){var n=Qn(e,r);return n>0?J1(e,r+4,r+4+n):""},Qk=Yk,Jk=function(t,e){var r=Qn(t,e);return r>0?pf(t,e+4,e+4+r):""},Zk=Jk,eA=function(t,e){return e5(t,e)},$0=eA,tA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};xt&&(Wk=function(e,r){if(!Buffer.isBuffer(e))return zk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Kk=function(e,r){if(!Buffer.isBuffer(e))return Gk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Xk=function(e,r){if(!Buffer.isBuffer(e))return qk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Qk=function(e,r){if(!Buffer.isBuffer(e))return Yk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Zk=function(e,r){if(!Buffer.isBuffer(e))return Jk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},$0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):eA(e,r)},tA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ul=function(t,e){return t[e]},Ua=function(t,e){return t[e+1]*256+t[e]},r5=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Qn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Io=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},n5=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function _u(t,e){var r="",n,i,a=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(Ua(this,h)),h+=2;t*=2;break;case"utf8":r=pf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=J1(this,this.l,this.l+t);break;case"wstr":return _u.call(this,t,"dbcs");case"lpstr-ansi":r=Wk(this,this.l),t=4+Qn(this,this.l);break;case"lpstr-cp":r=Kk(this,this.l),t=4+Qn(this,this.l);break;case"lpwstr":r=Xk(this,this.l),t=4+2*Qn(this,this.l);break;case"lpp4":t=4+Qn(this,this.l),r=Qk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Qn(this,this.l),r=Zk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ul(this,this.l+t++))!==0;)a.push(jh(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=Ua(this,this.l+t))!==0;)a.push(jh(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Ul(this,h),this.l=h+1,c=_u.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(jh(Ua(this,h))),h+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Ul(this,h),this.l=h+1,c=_u.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(jh(Ul(this,h))),h+=1}r=a.join("");break;default:switch(t){case 1:return n=Ul(this,this.l),this.l++,n;case 2:return n=(e==="i"?r5:Ua)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Io:n5)(this,this.l),this.l+=4,n):(i=Qn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=$0(this,this.l):i=$0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Hk(this,this.l,t);break}}return this.l+=t,r}var i5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},a5=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},s5=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function o5(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)s5(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,i5(this,e,this.l);break;case 8:if(n=8,r==="f"){t5(this,e,this.l);break}case 16:break;case-4:n=4,a5(this,e,this.l);break}return this.l+=n,this}function rA(t,e){var r=Hk(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Kr(t,e){t.l=e,t.read_shift=_u,t.chk=rA,t.write_shift=o5}function pn(t,e){t.l+=e}function Cr(t){var e=Ys(t);return Kr(e,0),e}function ts(t,e,r){if(t){var n,i,a;Kr(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=q0[c]||q0[65535];for(n=t.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=t.read_shift(1))&127)<<7*i;u=t.l+a;var d=h.f&&h.f(t,a,r);if(t.l=u,e(d,h,c))return}}}function _g(){var t=[],e=xt?256:2048,r=function(h){var d=Cr(h);return Kr(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(h){return n&&h<n.length-n.l?n:(i(),n=r(Math.max(h+1,e)))},o=function(){return i(),Os(t)},c=function(h){i(),n=h,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:c,end:o,_bufs:t}}function yu(t,e,r){var n=Xr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iw(t,e,r){var n=Xr(t);return n.s=yu(n.s,e.s,r),n.e=yu(n.e,e.s,r),n}function Eu(t,e){if(t.cRel&&t.c<0)for(t=Xr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Xr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=u5(r)),!t.rRel&&t.rRel!=null&&(r=l5(r)),r}function Fm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ir(t.s.c)+":"+(t.e.cRel?"":"$")+Ir(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Yr(t.s.r)+":"+(t.e.rRel?"":"$")+Yr(t.e.r):Eu(t.s,e.biff)+":"+Eu(t.e,e.biff)}function Z1(t){return parseInt(c5(t),10)-1}function Yr(t){return""+(t+1)}function l5(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function c5(t){return t.replace(/\$(\d+)$/,"$1")}function ev(t){for(var e=f5(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ir(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function u5(t){return t.replace(/^([A-Z])/,"$$$1")}function f5(t){return t.replace(/^\$([A-Z])/,"$1")}function h5(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ec(t){var e=t.indexOf(":");return e==-1?{s:Sn(t),e:Sn(t)}:{s:Sn(t.slice(0,e)),e:Sn(t.slice(e+1))}}function wt(t,e){return typeof e>"u"||typeof e=="number"?wt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function ar(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function aw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=vi(t.z,r?In(e):e)}catch{}try{return t.w=vi((t.XF||{}).numFmtId||(r?14:0),r?In(e):e)}catch{return""+e}}function Qa(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Zo[t.v]||t.v:e==null?aw(t,t.v):aw(t,e))}function ro(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function nA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),o=0,c=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Sn(n.origin):n.origin;o=u.r,c=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=ar(a["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[g].length;++v)if(!(typeof e[g][v]>"u")){var _={v:e[g][v]},E=o+g,y=c+v;if(h.s.r>E&&(h.s.r=E),h.s.c>y&&(h.s.c=y),h.e.r<E&&(h.e.r=E),h.e.c<y&&(h.e.c=y),e[g][v]&&typeof e[g][v]=="object"&&!Array.isArray(e[g][v])&&!(e[g][v]instanceof Date))_=e[g][v];else if(Array.isArray(_.v)&&(_.f=e[g][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||ft[14],n.cellDates?(_.t="d",_.w=vi(_.z,In(_.v))):(_.t="n",_.v=In(_.v),_.w=vi(_.z,_.v))):_.t="s";if(i)a[E]||(a[E]=[]),a[E][y]&&a[E][y].z&&(_.z=a[E][y].z),a[E][y]=_;else{var w=ot({c:y,r:E});a[w]&&a[w].z&&(_.z=a[w].z),a[w]=_}}}return h.s.c<1e7&&(a["!ref"]=wt(h)),a}function wc(t,e){return nA(null,t,e)}function d5(t){return t.read_shift(4,"i")}function hn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function p5(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function tv(t,e){var r=t.l,n=t.read_shift(1),i=hn(t),a=[],o={t:i,h:i};if(n&1){for(var c=t.read_shift(4),u=0;u!=c;++u)a.push(p5(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}var m5=tv;function xi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var g5=hn;function rv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var v5=hn,yg=rv;function nv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?$0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Io(e,0)>>2;return r?i/100:i}function iA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Jo=iA;function un(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function x5(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var h=Do[i];h&&(e.rgb=zu(h));break;case 2:e.rgb=zu([o,c,u]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function _5(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function aA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function y5(t){return aA(t,1)}function E5(t){return aA(t,2)}var iv=2,Bn=3,Hh=11,sw=12,H0=19,zh=64,w5=65,T5=71,S5=4108,k5=4126,Br=80,sA=81,A5=[Br,sA],C5={1:{n:"CodePage",t:iv},2:{n:"Category",t:Br},3:{n:"PresentationFormat",t:Br},4:{n:"ByteCount",t:Bn},5:{n:"LineCount",t:Bn},6:{n:"ParagraphCount",t:Bn},7:{n:"SlideCount",t:Bn},8:{n:"NoteCount",t:Bn},9:{n:"HiddenCount",t:Bn},10:{n:"MultimediaClipCount",t:Bn},11:{n:"ScaleCrop",t:Hh},12:{n:"HeadingPairs",t:S5},13:{n:"TitlesOfParts",t:k5},14:{n:"Manager",t:Br},15:{n:"Company",t:Br},16:{n:"LinksUpToDate",t:Hh},17:{n:"CharacterCount",t:Bn},19:{n:"SharedDoc",t:Hh},22:{n:"HyperlinksChanged",t:Hh},23:{n:"AppVersion",t:Bn,p:"version"},24:{n:"DigSig",t:w5},26:{n:"ContentType",t:Br},27:{n:"ContentStatus",t:Br},28:{n:"Language",t:Br},29:{n:"Version",t:Br},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},I5={1:{n:"CodePage",t:iv},2:{n:"Title",t:Br},3:{n:"Subject",t:Br},4:{n:"Author",t:Br},5:{n:"Keywords",t:Br},6:{n:"Comments",t:Br},7:{n:"Template",t:Br},8:{n:"LastAuthor",t:Br},9:{n:"RevNumber",t:Br},10:{n:"EditTime",t:zh},11:{n:"LastPrinted",t:zh},12:{n:"CreatedDate",t:zh},13:{n:"ModifiedDate",t:zh},14:{n:"PageCount",t:Bn},15:{n:"WordCount",t:Bn},16:{n:"CharCount",t:Bn},17:{n:"Thumbnail",t:T5},18:{n:"Application",t:Br},19:{n:"DocSecurity",t:Bn},255:{},2147483648:{n:"Locale",t:H0},2147483651:{n:"Behavior",t:H0},1919054434:{}},ow={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},R5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function P5(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var F5=P5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Do=Xr(F5),Zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},oA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function b5(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function O5(t){var e=b5();if(!t||!t.match)return e;var r={};if((t.match(mn)||[]).forEach(function(n){var i=tt(n);switch(i[0].replace(j8,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[lw[i.ContentType]]!==void 0&&e[lw[i.ContentType]].push(i.PartName);break}}),e.xmlns!==J8.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var jl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Eg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function wu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(mn)||[]).forEach(function(i){var a=tt(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var c=a.TargetMode==="External"?a.Target:hu(a.Target,e);r[c]=o,n[a.Id]=o}}),r["!id"]=n,r}var D5="application/vnd.oasis.opendocument.spreadsheet";function N5(t,e){for(var r=Q1(t),n,i;n=$u.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=tt(n[0],!1),i.path=="/"&&i.type!==D5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Tu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],L5=function(){for(var t=new Array(Tu.length),e=0;e<Tu.length;++e){var r=Tu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function lA(t){var e={};t=Ut(t);for(var r=0;r<Tu.length;++r){var n=Tu[r],i=t.match(L5[r]);i!=null&&i.length>0&&(e[n[1]]=St(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Ur(e[n[1]]))}return e}var M5=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function cA(t,e,r,n){var i=[];if(typeof t=="string")i=JE(t,n);else for(var a=0;a<t.length;++a)i=i.concat(t[a].map(function(d){return{v:d}}));var o=typeof e=="string"?JE(e,n).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(u=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function V5(t,e,r){var n={};return e||(e={}),t=Ut(t),M5.forEach(function(i){var a=(t.match(ju(i[0]))||[])[1];switch(i[2]){case"string":a&&(e[i[1]]=St(a));break;case"bool":e[i[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&cA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var B5=/<[^>]+>[^<]*/g;function U5(t,e){var r={},n="",i=t.match(B5);if(i)for(var a=0;a!=i.length;++a){var o=i[a],c=tt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=St(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=St(d);break;case"bool":r[n]=Yt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Ur(d);break;case"cy":case"error":r[n]=St(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}var j5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},bm;function $5(t,e,r){bm||(bm=q1(j5)),e=bm[e]||e,t[e]=r}function av(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function uA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function fA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function hA(t,e,r){return e===31?fA(t):uA(t,e,r)}function wg(t,e,r){return hA(t,e,r===!1?0:4)}function H5(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return hA(t,e,0)}function z5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Cn,""),t.l-i&2&&(t.l+=2)}return r}function W5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Cn,"");return r}function G5(t){var e=t.l,r=z0(t,sA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=z0(t,Bn);return[r,n]}function K5(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(G5(t));return r}function cw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Cn,"").replace(fu,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function dA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function q5(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function z0(t,e,r){var n=t.read_shift(2),i,a=r||{};if(t.l+=2,e!==sw&&n!==e&&A5.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===sw?n:e){case 2:return i=t.read_shift(2,"i"),a.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return uA(t,n,4).replace(Cn,"");case 31:return fA(t);case 64:return av(t);case 65:return dA(t);case 71:return q5(t);case 80:return wg(t,n,!a.raw).replace(Cn,"");case 81:return H5(t,n).replace(Cn,"");case 4108:return K5(t);case 4126:case 4127:return n==4127?z5(t):W5(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function uw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0,c=0,u=-1,h={};for(o=0;o!=i;++o){var d=t.read_shift(4),g=t.read_shift(4);a[o]=[d,g+r]}a.sort(function(F,C){return F[1]-C[1]});var v={};for(o=0;o!=i;++o){if(t.l!==a[o][1]){var _=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,_=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],_=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],_=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(_=!1,t.l=a[o][1]),_)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[a[o][0]];if(v[E.n]=z0(t,E.t,{raw:!0}),E.p==="version"&&(v[E.n]=String(v[E.n]>>16)+"."+("0000"+String(v[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(v[E.n]){case 0:v[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Mi(c=v[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[E.n])}}else if(a[o][0]===1){if(c=v.CodePage=z0(t,iv),Mi(c),u!==-1){var y=t.l;t.l=a[u][1],h=cw(t,c),t.l=y}}else if(a[o][0]===0){if(c===0){u=o,t.l=a[o+1][1];continue}h=cw(t,c)}else{var w=h[a[o][0]],k;switch(t[t.l]){case 65:t.l+=4,k=dA(t);break;case 30:t.l+=4,k=wg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=wg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=lr(t,4);break;case 64:t.l+=4,k=Ur(av(t));break;default:throw new Error("unparsed value: "+t[t.l])}v[w]=k}}return t.l=r+n,v}function fw(t,e,r){var n=t.content;if(!n)return{};Kr(n,0);var i,a,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==Et.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=uw(n,e),v={SystemIdentifier:h};for(var _ in g)v[_]=g[_];if(v.FMTID=a,i===1)return v;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var E;try{E=uw(n,null)}catch{}for(_ in E)v[_]=E[_];return v.FMTID=[a,o],v}function Rs(t,e){return t.read_shift(e),null}function X5(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function lr(t,e){return t.read_shift(e)===1}function _r(t){return t.read_shift(2,"u")}function pA(t,e){return X5(t,e,_r)}function Y5(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function mf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function Q5(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,c,u={};i&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return i&&(t.l+=4*o),n&&(t.l+=c),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function $o(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function gf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):$o(t,n,r)}function el(t,e,r){if(r.biff>5)return gf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function J5(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Z5(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Cn,"");return n&&(t.l+=24),i}function eV(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(Cn,"");return r+o}function tV(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Z5(t);case"0303000000000000c000000000000046":return eV(t);default:throw new Error("Unsupported Moniker "+r)}}function Wh(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Cn,""):"";return r}function rV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var a,o,c,u,h="",d,g;i&16&&(a=Wh(t,r-t.l)),i&128&&(o=Wh(t,r-t.l)),(i&257)===257&&(c=Wh(t,r-t.l)),(i&257)===1&&(u=tV(t,r-t.l)),i&8&&(h=Wh(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(g=av(t)),t.l=r;var v=o||c||u||"";v&&h&&(v+="#"+h),v||(v="#"+h),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return d&&(_.guid=d),g&&(_.time=g),a&&(_.Tooltip=a),_}function mA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function gA(t,e){var r=mA(t);return r[3]=0,r}function va(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function nV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function iV(t,e,r){return e===0?"":el(t,e,r)}function aV(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,a,o]}function vA(t){var e=t.read_shift(2),r=nv(t);return[e,r]}function sV(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=mf(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,i}function Id(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function xA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var oV=xA;function _A(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function lV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function cV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function an(t){t.l+=2,t.l+=t.read_shift(2)}var uV={0:an,4:an,5:an,6:an,7:cV,8:an,9:an,10:an,11:an,12:an,13:lV,14:an,15:an,16:an,17:an,18:an,19:an,20:an,21:_A};function fV(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(uV[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Gh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function hV(t,e){return e===0||t.read_shift(2),1200}function dV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=el(t,0,r);return t.read_shift(e+n-t.l),i}function pV(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function mV(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=mf(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function gV(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0;o!=i&&t.l<r;++o)a.push(Q5(t));return a.Count=n,a.Unique=i,a}function vV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function xV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function _V(t){var e=nV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function yV(t){return t.read_shift(2),t.read_shift(4)}function hw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function EV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function wV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function TV(){}function SV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=mf(t,0,r),n}function kV(t){var e=va(t);return e.isst=t.read_shift(4),e}function AV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=va(t);r.biff==2&&t.l++;var a=gf(t,n-t.l,r);return i.val=a,i}function CV(t,e,r){var n=t.read_shift(2),i=el(t,0,r);return[n,i]}var IV=el;function dw(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,a=t.read_shift(i),o=t.read_shift(i),c=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:a,c},e:{r:o,c:u}}}function RV(t){var e=t.read_shift(2),r=t.read_shift(2),n=vA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function PV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(vA(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function FV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function bV(t,e,r,n){var i={},a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return i.patternType=R5[c>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function OV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=bV(t,e,n.fStyle,r),n}function DV(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function pw(t,e,r){var n=va(t);(r.biff==2||e==9)&&++t.l;var i=Y5(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function NV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=va(t),i=un(t);return n.val=i,n}var mw=iV;function LV(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=$o(t,a),c=[];n>t.l;)c.push(gf(t));return[a,i,o,c]}function gw(t,e,r){var n=t.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=sV(t,e-2,r)),a.body=i||t.read_shift(e-2),typeof i=="string"&&(a.Name=i),a}var MV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vw(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=$o(t,o,r);i&32&&(h=MV[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:x7(t,d,r,c);return{chKey:a,Name:h,itab:u,rgce:g}}function yA(t,e,r){if(r.biff<8)return VV(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(aV(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function VV(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=mf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function BV(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),a=$o(t,n,r),o=$o(t,i,r);return[a,o]}function UV(t,e,r){var n=xA(t);t.l++;var i=t.read_shift(1);return e-=8,[_7(t,e,r),i,n]}function xw(t,e,r){var n=oV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,g7(t,e,r)]}function jV(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function $V(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=el(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},c,o,a]}}function HV(t,e,r){return $V(t,e,r)}function zV(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Id(t));return r}function WV(t,e,r){if(r&&r.biff<8)return KV(t,e,r);var n=_A(t),i=fV(t,e-22,n[1]);return{cmo:n,ft:i}}var GV={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function KV(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((GV[n]||pn)(t,e,r)),{cmo:[i,n,a],ft:o}}function qV(t,e,r){var n=t.l,i="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=J5(t,6,r);var c=t.read_shift(2);t.read_shift(2),_r(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=$o(t,t.lens[h+1]-t.lens[h]-1);if(i+=g,i.length>=(d?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function XV(t,e){var r=Id(t);t.l+=16;var n=rV(t,e-24);return[r,n]}function YV(t,e){t.read_shift(2);var r=Id(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Cn,""),[r,n]}function QV(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ow[r]||r,r=t.read_shift(2),e[1]=ow[r]||r,e}function JV(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function ZV(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(gA(t));return r}function e9(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function EA(t,e,r){if(!r.cellStyles)return pn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var h={s:i,e:a,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function t9(t,e){var r={};return e<32||(t.l+=16,r.header=un(t),r.footer=un(t),t.l+=2),r}function r9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var n9=va,i9=pA,a9=gf;function s9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function o9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=va(t);++t.l;var i=el(t,e-7,r);return n.t="str",n.val=i,n}function l9(t){var e=va(t);++t.l;var r=un(t);return e.t="n",e.val=r,e}function c9(t){var e=va(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function u9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function f9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function h9(t,e,r){var n=t.l+e,i=va(t),a=t.read_shift(2),o=$o(t,a,r);return t.l=n,i.t="str",i.val=o,i}var d9=[2,3,48,49,131,139,140,245],_w=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=q1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=Ys(1);switch(u.type){case"base64":d=Li(ri(c));break;case"binary":d=Li(c);break;case"buffer":case"array":d=c;break}Kr(d,0);var g=d.read_shift(1),v=!!(g&136),_=!1,E=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,w=521;g==2&&(y=d.read_shift(2)),d.l+=3,g!=2&&(y=d.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(w=d.read_shift(2));var k=d.read_shift(2),F=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(F=t[d[d.l]]),d.l+=1,d.l+=2),E&&(d.l+=36);for(var C=[],U={},V=Math.min(d.length,g==2?521:w-10-(_?264:0)),z=E?32:11;d.l<V&&d[d.l]!=13;)switch(U={},U.name=Bu.utils.decode(F,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,U.type=String.fromCharCode(d.read_shift(1)),g!=2&&!E&&(U.offset=d.read_shift(4)),U.len=d.read_shift(1),g==2&&(U.offset=d.read_shift(2)),U.dec=d.read_shift(1),U.name.length&&C.push(U),g!=2&&(d.l+=E?13:14),U.type){case"B":(!_||U.len!=8)&&u.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,P=0;for(h[0]=[],P=0;P!=C.length;++P)h[0][P]=C[P].name;for(;y-- >0;){if(d[d.l]===42){d.l+=k;continue}for(++d.l,h[++A]=[],P=0,P=0;P!=C.length;++P){var R=d.slice(d.l,d.l+C[P].len);d.l+=C[P].len,Kr(R,0);var M=Bu.utils.decode(F,R);switch(C[P].type){case"C":M.trim().length&&(h[A][P]=M.replace(/\s+$/,""));break;case"D":M.length===8?h[A][P]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):h[A][P]=M;break;case"F":h[A][P]=parseFloat(M.trim());break;case"+":case"I":h[A][P]=E?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":h[A][P]=!0;break;case"N":case"F":h[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[A][P]="##MEMO##"+(E?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(h[A][P]=+M||0);break;case"@":h[A][P]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":h[A][P]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":h[A][P]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][P]=-R.read_shift(-8,"f");break;case"B":if(_&&C[P].len==8){h[A][P]=R.read_shift(8,"f");break}case"G":case"P":R.l+=C[P].len;break;case"0":if(C[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[P].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=C,h}function n(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=wc(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function i(c,u){try{return ro(n(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&Mi(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=_g(),g=Rg(c,{header:1,raw:!0,cellDates:!0}),v=g[0],_=g.slice(1),E=c["!cols"]||[],y=0,w=0,k=0,F=1;for(y=0;y<v.length;++y){if(((E[y]||{}).DBF||{}).name){v[y]=E[y].DBF.name,++k;continue}if(v[y]!=null){if(++k,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(w=0;w<1024;++w)if(v.indexOf(v[y]+"_"+w)==-1){v[y]+="_"+w;break}}}}var C=ar(c["!ref"]),U=[],V=[],z=[];for(y=0;y<=C.e.c-C.s.c;++y){var A="",P="",R=0,M=[];for(w=0;w<_.length;++w)_[w][y]!=null&&M.push(_[w][y]);if(M.length==0||v[y]==null){U[y]="?";continue}for(w=0;w<M.length;++w){switch(typeof M[w]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=M[w]instanceof Date?"D":"C";break;default:P="C"}R=Math.max(R,String(M[w]).length),A=A&&A!=P?"C":P}R>250&&(R=250),P=((E[y]||{}).DBF||{}).type,P=="C"&&E[y].DBF.len>R&&(R=E[y].DBF.len),A=="B"&&P=="N"&&(A="N",z[y]=E[y].DBF.dec,R=E[y].DBF.len),V[y]=A=="C"||P=="N"?R:a[A]||0,F+=V[y],U[y]=A}var L=d.next(32);for(L.write_shift(4,318902576),L.write_shift(4,_.length),L.write_shift(2,296+32*k),L.write_shift(2,F),y=0;y<4;++y)L.write_shift(4,0);for(L.write_shift(4,0|(+e[yk]||3)<<8),y=0,w=0;y<v.length;++y)if(v[y]!=null){var N=d.next(32),B=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,B,"sbcs"),N.write_shift(1,U[y]=="?"?"C":U[y],"sbcs"),N.write_shift(4,w),N.write_shift(1,V[y]||a[U[y]]||0),N.write_shift(1,z[y]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),w+=V[y]||a[U[y]]||0}var Oe=d.next(264);for(Oe.write_shift(4,13),y=0;y<65;++y)Oe.write_shift(4,0);for(y=0;y<_.length;++y){var we=d.next(F);for(we.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(U[w]){case"L":we.write_shift(1,_[y][w]==null?63:_[y][w]?84:70);break;case"B":we.write_shift(8,_[y][w]||0,"f");break;case"N":var Ce="0";for(typeof _[y][w]=="number"&&(Ce=_[y][w].toFixed(z[w]||0)),k=0;k<V[w]-Ce.length;++k)we.write_shift(1,32);we.write_shift(1,Ce,"sbcs");break;case"D":_[y][w]?(we.write_shift(4,("0000"+_[y][w].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(_[y][w].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+_[y][w].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(_[y][w]!=null?_[y][w]:"").slice(0,V[w]);for(we.write_shift(1,Ae,"sbcs"),k=0;k<V[w]-Ae.length;++k)we.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),p9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,_){var E=t[_];return typeof E=="number"?NE(E):E},n=function(v,_,E){var y=_.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return y==59?v:NE(y)};t["|"]=254;function i(v,_){switch(_.type){case"base64":return a(ri(v),_);case"binary":return a(v,_);case"buffer":return a(xt&&Buffer.isBuffer(v)?v.toString("binary"):Yo(v),_);case"array":return a(jo(v),_)}throw new Error("Unrecognized type "+_.type)}function a(v,_){var E=v.split(/[\n\r]+/),y=-1,w=-1,k=0,F=0,C=[],U=[],V=null,z={},A=[],P=[],R=[],M=0,L;for(+_.codepage>=0&&Mi(+_.codepage);k!==E.length;++k){M=0;var N=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),B=N.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Oe=B[0],we;if(N.length>0)switch(Oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&U.push(N.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,Ae=!1,Ee=!1,ie=!1,xe=-1,te=-1;for(F=1;F<B.length;++F)switch(B[F].charAt(0)){case"A":break;case"X":w=parseInt(B[F].slice(1))-1,Ae=!0;break;case"Y":for(y=parseInt(B[F].slice(1))-1,Ae||(w=0),L=C.length;L<=y;++L)C[L]=[];break;case"K":we=B[F].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(Ui(we))?isNaN(lc(we).getDate())||(we=Ur(we)):(we=Ui(we),V!==null&&yc(V)&&(we=Cd(we))),Ce=!0;break;case"E":ie=!0;var D=ql(B[F].slice(1),{r:y,c:w});C[y][w]=[C[y][w],D];break;case"S":Ee=!0,C[y][w]=[C[y][w],"S5S"];break;case"G":break;case"R":xe=parseInt(B[F].slice(1))-1;break;case"C":te=parseInt(B[F].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+N)}if(Ce&&(C[y][w]&&C[y][w].length==2?C[y][w][0]=we:C[y][w]=we,V=null),Ee){if(ie)throw new Error("SYLK shared formula cannot have own formula");var re=xe>-1&&C[xe][te];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");C[y][w][1]=FA(re[1],{r:y-xe,c:w-te})}break;case"F":var ee=0;for(F=1;F<B.length;++F)switch(B[F].charAt(0)){case"X":w=parseInt(B[F].slice(1))-1,++ee;break;case"Y":for(y=parseInt(B[F].slice(1))-1,L=C.length;L<=y;++L)C[L]=[];break;case"M":M=parseInt(B[F].slice(1))/20;break;case"F":break;case"G":break;case"P":V=U[parseInt(B[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=B[F].slice(1).split(" "),L=parseInt(R[0],10);L<=parseInt(R[1],10);++L)M=parseInt(R[2],10),P[L-1]=M===0?{hidden:!0}:{wch:M},cc(P[L-1]);break;case"C":w=parseInt(B[F].slice(1))-1,P[w]||(P[w]={});break;case"R":y=parseInt(B[F].slice(1))-1,A[y]||(A[y]={}),M>0?(A[y].hpt=M,A[y].hpx=Wu(M)):M===0&&(A[y].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+N)}ee<1&&(V=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+N)}}return A.length>0&&(z["!rows"]=A),P.length>0&&(z["!cols"]=P),_&&_.sheetRows&&(C=C.slice(0,_.sheetRows)),[C,z]}function o(v,_){var E=i(v,_),y=E[0],w=E[1],k=wc(y,_);return pa(w).forEach(function(F){k[F]=w[F]}),k}function c(v,_){return ro(o(v,_),_)}function u(v,_,E,y){var w="C;Y"+(E+1)+";X"+(y+1)+";K";switch(v.t){case"n":w+=v.v||0,v.f&&!v.F&&(w+=";E"+eU(v.f,{r:E,c:y}));break;case"b":w+=v.v?"TRUE":"FALSE";break;case"e":w+=v.w||v.v;break;case"d":w+='"'+(v.w||v.v)+'"';break;case"s":w+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function h(v,_){_.forEach(function(E,y){var w="F;W"+(y+1)+" "+(y+1)+" ";E.hidden?w+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=G0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=K0(E.wpx)),typeof E.wch=="number"&&(w+=Math.round(E.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function d(v,_){_.forEach(function(E,y){var w="F;";E.hidden?w+="M0;":E.hpt?w+="M"+20*E.hpt+";":E.hpx&&(w+="M"+20*IA(E.hpx)+";"),w.length>2&&v.push(w+"R"+(y+1))})}function g(v,_){var E=["ID;PWXL;N;E"],y=[],w=ar(v["!ref"]),k,F=Array.isArray(v),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&h(E,v["!cols"]),v["!rows"]&&d(E,v["!rows"]),E.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var U=w.s.r;U<=w.e.r;++U)for(var V=w.s.c;V<=w.e.c;++V){var z=ot({r:U,c:V});k=F?(v[U]||[])[V]:v[z],!(!k||k.v==null&&(!k.f||k.F))&&y.push(u(k,v,U,V))}return E.join(C)+C+y.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:o,from_sheet:g}}(),m9=function(){function t(a,o){switch(o.type){case"base64":return e(ri(a),o);case"binary":return e(a,o);case"buffer":return e(xt&&Buffer.isBuffer(a)?a.toString("binary"):Yo(a),o);case"array":return e(jo(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var c=a.split(`
`),u=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++u]=[],h=0;continue}if(!(u<0)){var v=c[d].trim().split(","),_=v[0],E=v[1];++d;for(var y=c[d]||"";(y.match(/["]/g)||[]).length&1&&d<c.length-1;)y+=`
`+c[++d];switch(y=y.trim(),+_){case-1:if(y==="BOT"){g[++u]=[],h=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[u][h]=!0:y==="FALSE"?g[u][h]=!1:isNaN(Ui(E))?isNaN(lc(E).getDate())?g[u][h]=E:g[u][h]=Ur(E):g[u][h]=Ui(E),++h;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[u][h++]=y!==""?y:null;break}if(y==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(a,o){return wc(t(a,o),o)}function n(a,o){return ro(r(a,o),o)}var i=function(){var a=function(u,h,d,g,v){u.push(h),u.push(d+","+g),u.push('"'+v.replace(/"/g,'""')+'"')},o=function(u,h,d,g){u.push(h+","+d),u.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var h=[],d=ar(u["!ref"]),g,v=Array.isArray(u);a(h,"TABLE",0,1,"sheetjs"),a(h,"VECTORS",0,d.e.r-d.s.r+1,""),a(h,"TUPLES",0,d.e.c-d.s.c+1,""),a(h,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){o(h,-1,0,"BOT");for(var E=d.s.c;E<=d.e.c;++E){var y=ot({r:_,c:E});if(g=v?(u[_]||[])[E]:u[y],!g){o(h,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,w,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=vi(g.z||ft[14],In(Ur(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var k=`\r
`,F=h.join(k);return F}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),g9=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,v){for(var _=g.split(`
`),E=-1,y=-1,w=0,k=[];w!==_.length;++w){var F=_[w].trim().split(":");if(F[0]==="cell"){var C=Sn(F[1]);if(k.length<=C.r)for(E=k.length;E<=C.r;++E)k[E]||(k[E]=[]);switch(E=C.r,y=C.c,F[2]){case"t":k[E][y]=t(F[3]);break;case"v":k[E][y]=+F[3];break;case"vtf":var U=F[F.length-1];case"vtc":switch(F[3]){case"nl":k[E][y]=!!+F[4];break;default:k[E][y]=+F[4];break}F[2]=="vtf"&&(k[E][y]=[k[E][y],U])}}}return v&&v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}function n(g,v){return wc(r(g,v),v)}function i(g,v){return ro(n(g,v),v)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var v=[],_=[],E,y="",w=Ec(g["!ref"]),k=Array.isArray(g),F=w.s.r;F<=w.e.r;++F)for(var C=w.s.c;C<=w.e.c;++C)if(y=ot({r:F,c:C}),E=k?(g[F]||[])[C]:g[y],!(!E||E.v==null||E.t==="z")){switch(_=["cell",y,"t"],E.t){case"s":case"str":_.push(e(E.v));break;case"n":E.f?(_[2]="vtf",_[3]="n",_[4]=E.v,_[5]=e(E.f)):(_[2]="v",_[3]=E.v);break;case"b":_[2]="vt"+(E.f?"f":"c"),_[3]="nl",_[4]=E.v?"1":"0",_[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var U=In(Ur(E.v));_[2]="vtc",_[3]="nd",_[4]=""+U,_[5]=E.w||vi(E.z||ft[14],U);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function d(g){return[a,o,c,o,h(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Hu=function(){function t(d,g,v,_,E){E.raw?g[v][_]=d:d===""||(d==="TRUE"?g[v][_]=!0:d==="FALSE"?g[v][_]=!1:isNaN(Ui(d))?isNaN(lc(d).getDate())?g[v][_]=d:g[v][_]=Ur(d):g[v][_]=Ui(d))}function e(d,g){var v=g||{},_=[];if(!d||d.length===0)return _;for(var E=d.split(/[\r\n]/),y=E.length-1;y>=0&&E[y].length===0;)--y;for(var w=10,k=0,F=0;F<=y;++F)k=E[F].indexOf(" "),k==-1?k=E[F].length:k++,w=Math.max(w,k);for(F=0;F<=y;++F){_[F]=[];var C=0;for(t(E[F].slice(0,w).trim(),_,F,C,v),C=1;C<=(E[F].length-w)/10+1;++C)t(E[F].slice(w+(C-1)*10,w+C*10).trim(),_,F,C,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var g={},v=!1,_=0,E=0;_<d.length;++_)(E=d.charCodeAt(_))==34?v=!v:!v&&E in r&&(g[E]=(g[E]||0)+1);E=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&E.push([g[_],_]);if(!E.length){g=n;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&E.push([g[_],_])}return E.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[E.pop()[1]]||44}function a(d,g){var v=g||{},_="",E=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=i(d.slice(0,1024)):v.FS?_=v.FS:_=i(d.slice(0,1024));var w=0,k=0,F=0,C=0,U=0,V=_.charCodeAt(0),z=!1,A=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var R=v.dateNF!=null?C8(v.dateNF):null;function M(){var L=d.slice(C,U),N={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)N.t="z";else if(v.raw)N.t="s",N.v=L;else if(L.trim().length===0)N.t="s",N.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(N.t="s",N.v=L.slice(2,-1).replace(/""/g,'"')):rU(L)?(N.t="n",N.f=L.slice(1)):(N.t="s",N.v=L);else if(L=="TRUE")N.t="b",N.v=!0;else if(L=="FALSE")N.t="b",N.v=!1;else if(!isNaN(F=Ui(L)))N.t="n",v.cellText!==!1&&(N.w=L),N.v=F;else if(!isNaN(lc(L).getDate())||R&&L.match(R)){N.z=v.dateNF||ft[14];var B=0;R&&L.match(R)&&(L=I8(L,v.dateNF,L.match(R)||[]),B=1),v.cellDates?(N.t="d",N.v=Ur(L,B)):(N.t="n",N.v=In(Ur(L,B))),v.cellText!==!1&&(N.w=vi(N.z,N.v instanceof Date?In(N.v):N.v)),v.cellNF||delete N.z}else N.t="s",N.v=L;if(N.t=="z"||(v.dense?(E[w]||(E[w]=[]),E[w][k]=N):E[ot({c:k,r:w})]=N),C=U+1,P=d.charCodeAt(C),y.e.c<k&&(y.e.c=k),y.e.r<w&&(y.e.r=w),A==V)++k;else if(k=0,++w,v.sheetRows&&v.sheetRows<=w)return!0}e:for(;U<d.length;++U)switch(A=d.charCodeAt(U)){case 34:P===34&&(z=!z);break;case V:case 10:case 13:if(!z&&M())break e;break}return U-C>0&&M(),E["!ref"]=wt(y),E}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):wc(e(d,g),g)}function c(d,g){var v="",_=g.type=="string"?[0,0,0,0]:dv(d,g);switch(g.type){case"base64":v=ri(d);break;case"binary":v=d;break;case"buffer":g.codepage==65001?v=d.toString("utf8"):g.codepage&&typeof Bu<"u"||(v=xt&&Buffer.isBuffer(d)?d.toString("binary"):Yo(d));break;case"array":v=jo(d);break;case"string":v=d;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Ut(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=Ut(v):g.type=="binary"&&typeof Bu<"u",v.slice(0,19)=="socialcalc:version:"?g9.to_sheet(g.type=="string"?v:Ut(v),g):o(v,g)}function u(d,g){return ro(c(d,g),g)}function h(d){for(var g=[],v=ar(d["!ref"]),_,E=Array.isArray(d),y=v.s.r;y<=v.e.r;++y){for(var w=[],k=v.s.c;k<=v.e.c;++k){var F=ot({r:y,c:k});if(_=E?(d[y]||[])[k]:d[F],!_||_.v==null){w.push("          ");continue}for(var C=(_.w||(Qa(_),_.w)||"").slice(0,10);C.length<10;)C+=" ";w.push(C+(k===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}}();function v9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=p9.to_workbook(t,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Hu.to_workbook(t,e)}}var Su=function(){function t(D,re,ee){if(D){Kr(D,D.l||0);for(var Z=ee.Enum||xe;D.l<D.length;){var ce=D.read_shift(2),_e=Z[ce]||Z[65535],ve=D.read_shift(2),ye=D.l+ve,Te=_e.f&&_e.f(D,ve,ee);if(D.l=ye,re(Te,_e,ce))return}}}function e(D,re){switch(re.type){case"base64":return r(Li(ri(D)),re);case"binary":return r(Li(D),re);case"buffer":case"array":return r(D,re)}throw"Unsupported type "+re.type}function r(D,re){if(!D)return D;var ee=re||{},Z=ee.dense?[]:{},ce="Sheet1",_e="",ve=0,ye={},Te=[],Ke=[],J={s:{r:0,c:0},e:{r:0,c:0}},kt=ee.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)ee.Enum=xe,t(D,function(Ve,Vt,wr){switch(wr){case 0:ee.vers=Ve,Ve>=4096&&(ee.qpro=!0);break;case 6:J=Ve;break;case 204:Ve&&(_e=Ve);break;case 222:_e=Ve;break;case 15:case 51:ee.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:wr==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=ee.dateNF||ft[14],ee.cellDates&&(Ve[1].t="d",Ve[1].v=Cd(Ve[1].v))),ee.qpro&&Ve[3]>ve&&(Z["!ref"]=wt(J),ye[ce]=Z,Te.push(ce),Z=ee.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ve=Ve[3],ce=_e||"Sheet"+(ve+1),_e="");var fr=ee.dense?(Z[Ve[0].r]||[])[Ve[0].c]:Z[ot(Ve[0])];if(fr){fr.t=Ve[1].t,fr.v=Ve[1].v,Ve[1].z!=null&&(fr.z=Ve[1].z),Ve[1].f!=null&&(fr.f=Ve[1].f);break}ee.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[ot(Ve[0])]=Ve[1];break}},ee);else if(D[2]==26||D[2]==14)ee.Enum=te,D[2]==14&&(ee.qpro=!0,D.l=0),t(D,function(Ve,Vt,wr){switch(wr){case 204:ce=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>ve&&(Z["!ref"]=wt(J),ye[ce]=Z,Te.push(ce),Z=ee.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ve=Ve[3],ce="Sheet"+(ve+1)),kt>0&&Ve[0].r>=kt)break;ee.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[ot(Ve[0])]=Ve[1],J.e.c<Ve[0].c&&(J.e.c=Ve[0].c),J.e.r<Ve[0].r&&(J.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(Ke[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:Ke[Ve[0]]=Ve[1],Ve[0]==ve&&(ce=Ve[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(Z["!ref"]=wt(J),ye[_e||ce]=Z,Te.push(_e||ce),!Ke.length)return{SheetNames:Te,Sheets:ye};for(var ct={},dt=[],ut=0;ut<Ke.length;++ut)ye[Te[ut]]?(dt.push(Ke[ut]||Te[ut]),ct[Ke[ut]]=ye[Ke[ut]]||ye[Te[ut]]):(dt.push(Ke[ut]),ct[Ke[ut]]={"!ref":"A1"});return{SheetNames:dt,Sheets:ct}}function n(D,re){var ee=re||{};if(+ee.codepage>=0&&Mi(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=_g(),ce=ar(D["!ref"]),_e=Array.isArray(D),ve=[];Ni(Z,0,a(1030)),Ni(Z,6,u(ce));for(var ye=Math.min(ce.e.r,8191),Te=ce.s.r;Te<=ye;++Te)for(var Ke=Yr(Te),J=ce.s.c;J<=ce.e.c;++J){Te===ce.s.r&&(ve[J]=Ir(J));var kt=ve[J]+Ke,ct=_e?(D[Te]||[])[J]:D[kt];if(!(!ct||ct.t=="z"))if(ct.t=="n")(ct.v|0)==ct.v&&ct.v>=-32768&&ct.v<=32767?Ni(Z,13,_(Te,J,ct.v)):Ni(Z,14,y(Te,J,ct.v));else{var dt=Qa(ct);Ni(Z,15,g(Te,J,dt.slice(0,239)))}}return Ni(Z,1),Z.end()}function i(D,re){var ee=re||{};if(+ee.codepage>=0&&Mi(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=_g();Ni(Z,0,o(D));for(var ce=0,_e=0;ce<D.SheetNames.length;++ce)(D.Sheets[D.SheetNames[ce]]||{})["!ref"]&&Ni(Z,27,ie(D.SheetNames[ce],_e++));var ve=0;for(ce=0;ce<D.SheetNames.length;++ce){var ye=D.Sheets[D.SheetNames[ce]];if(!(!ye||!ye["!ref"])){for(var Te=ar(ye["!ref"]),Ke=Array.isArray(ye),J=[],kt=Math.min(Te.e.r,8191),ct=Te.s.r;ct<=kt;++ct)for(var dt=Yr(ct),ut=Te.s.c;ut<=Te.e.c;++ut){ct===Te.s.r&&(J[ut]=Ir(ut));var Ve=J[ut]+dt,Vt=Ke?(ye[ct]||[])[ut]:ye[Ve];if(!(!Vt||Vt.t=="z"))if(Vt.t=="n")Ni(Z,23,M(ct,ut,ve,Vt.v));else{var wr=Qa(Vt);Ni(Z,22,A(ct,ut,ve,wr.slice(0,239)))}}++ve}}return Ni(Z,1),Z.end()}function a(D){var re=Cr(2);return re.write_shift(2,D),re}function o(D){var re=Cr(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var ee=0,Z=0,ce=0,_e=0;_e<D.SheetNames.length;++_e){var ve=D.SheetNames[_e],ye=D.Sheets[ve];if(!(!ye||!ye["!ref"])){++ce;var Te=Ec(ye["!ref"]);ee<Te.e.r&&(ee=Te.e.r),Z<Te.e.c&&(Z=Te.e.c)}}return ee>8191&&(ee=8191),re.write_shift(2,ee),re.write_shift(1,ce),re.write_shift(1,Z),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function c(D,re,ee){var Z={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&ee.qpro?(Z.s.c=D.read_shift(1),D.l++,Z.s.r=D.read_shift(2),Z.e.c=D.read_shift(1),D.l++,Z.e.r=D.read_shift(2),Z):(Z.s.c=D.read_shift(2),Z.s.r=D.read_shift(2),re==12&&ee.qpro&&(D.l+=2),Z.e.c=D.read_shift(2),Z.e.r=D.read_shift(2),re==12&&ee.qpro&&(D.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function u(D){var re=Cr(8);return re.write_shift(2,D.s.c),re.write_shift(2,D.s.r),re.write_shift(2,D.e.c),re.write_shift(2,D.e.r),re}function h(D,re,ee){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(Z[0].c=D.read_shift(1),Z[3]=D.read_shift(1),Z[0].r=D.read_shift(2),D.l+=2):(Z[2]=D.read_shift(1),Z[0].c=D.read_shift(2),Z[0].r=D.read_shift(2)),Z}function d(D,re,ee){var Z=D.l+re,ce=h(D,re,ee);if(ce[1].t="s",ee.vers==20768){D.l++;var _e=D.read_shift(1);return ce[1].v=D.read_shift(_e,"utf8"),ce}return ee.qpro&&D.l++,ce[1].v=D.read_shift(Z-D.l,"cstr"),ce}function g(D,re,ee){var Z=Cr(7+ee.length);Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,D),Z.write_shift(1,39);for(var ce=0;ce<Z.length;++ce){var _e=ee.charCodeAt(ce);Z.write_shift(1,_e>=128?95:_e)}return Z.write_shift(1,0),Z}function v(D,re,ee){var Z=h(D,re,ee);return Z[1].v=D.read_shift(2,"i"),Z}function _(D,re,ee){var Z=Cr(7);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,D),Z.write_shift(2,ee,"i"),Z}function E(D,re,ee){var Z=h(D,re,ee);return Z[1].v=D.read_shift(8,"f"),Z}function y(D,re,ee){var Z=Cr(13);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,D),Z.write_shift(8,ee,"f"),Z}function w(D,re,ee){var Z=D.l+re,ce=h(D,re,ee);if(ce[1].v=D.read_shift(8,"f"),ee.qpro)D.l=Z;else{var _e=D.read_shift(2);U(D.slice(D.l,D.l+_e),ce),D.l+=_e}return ce}function k(D,re,ee){var Z=re&32768;return re&=-32769,re=(Z?D:0)+(re>=8192?re-16384:re),(Z?"":"$")+(ee?Ir(re):Yr(re))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(D,re){Kr(D,0);for(var ee=[],Z=0,ce="",_e="",ve="",ye="";D.l<D.length;){var Te=D[D.l++];switch(Te){case 0:ee.push(D.read_shift(8,"f"));break;case 1:_e=k(re[0].c,D.read_shift(2),!0),ce=k(re[0].r,D.read_shift(2),!1),ee.push(_e+ce);break;case 2:{var Ke=k(re[0].c,D.read_shift(2),!0),J=k(re[0].r,D.read_shift(2),!1);_e=k(re[0].c,D.read_shift(2),!0),ce=k(re[0].r,D.read_shift(2),!1),ee.push(Ke+J+":"+_e+ce)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(D.read_shift(2));break;case 6:{for(var kt="";Te=D[D.l++];)kt+=String.fromCharCode(Te);ee.push('"'+kt.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:ye=ee.pop(),ve=ee.pop(),ee.push(["AND","OR"][Te-20]+"("+ve+","+ye+")");break;default:if(Te<32&&C[Te])ye=ee.pop(),ve=ee.pop(),ee.push(ve+C[Te]+ye);else if(F[Te]){if(Z=F[Te][1],Z==69&&(Z=D[D.l++]),Z>ee.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+ee.join("|")+"|");return}var ct=ee.slice(-Z);ee.length-=Z,ee.push(F[Te][0]+"("+ct.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}ee.length==1?re[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function V(D){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=D.read_shift(2),re[3]=D[D.l++],re[0].c=D[D.l++],re}function z(D,re){var ee=V(D);return ee[1].t="s",ee[1].v=D.read_shift(re-4,"cstr"),ee}function A(D,re,ee,Z){var ce=Cr(6+Z.length);ce.write_shift(2,D),ce.write_shift(1,ee),ce.write_shift(1,re),ce.write_shift(1,39);for(var _e=0;_e<Z.length;++_e){var ve=Z.charCodeAt(_e);ce.write_shift(1,ve>=128?95:ve)}return ce.write_shift(1,0),ce}function P(D,re){var ee=V(D);ee[1].v=D.read_shift(2);var Z=ee[1].v>>1;if(ee[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return ee[1].v=Z,ee}function R(D,re){var ee=V(D),Z=D.read_shift(4),ce=D.read_shift(4),_e=D.read_shift(2);if(_e==65535)return Z===0&&ce===3221225472?(ee[1].t="e",ee[1].v=15):Z===0&&ce===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var ve=_e&32768;return _e=(_e&32767)-16446,ee[1].v=(1-ve*2)*(ce*Math.pow(2,_e+32)+Z*Math.pow(2,_e)),ee}function M(D,re,ee,Z){var ce=Cr(14);if(ce.write_shift(2,D),ce.write_shift(1,ee),ce.write_shift(1,re),Z==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var _e=0,ve=0,ye=0,Te=0;return Z<0&&(_e=1,Z=-Z),ve=Math.log2(Z)|0,Z/=Math.pow(2,ve-31),Te=Z>>>0,Te&2147483648||(Z/=2,++ve,Te=Z>>>0),Z-=Te,Te|=2147483648,Te>>>=0,Z*=Math.pow(2,32),ye=Z>>>0,ce.write_shift(4,ye),ce.write_shift(4,Te),ve+=16383+(_e?32768:0),ce.write_shift(2,ve),ce}function L(D,re){var ee=R(D);return D.l+=re-14,ee}function N(D,re){var ee=V(D),Z=D.read_shift(4);return ee[1].v=Z>>6,ee}function B(D,re){var ee=V(D),Z=D.read_shift(8,"f");return ee[1].v=Z,ee}function Oe(D,re){var ee=B(D);return D.l+=re-10,ee}function we(D,re){return D[D.l+re-1]==0?D.read_shift(re,"cstr"):""}function Ce(D,re){var ee=D[D.l++];ee>re-1&&(ee=re-1);for(var Z="";Z.length<ee;)Z+=String.fromCharCode(D[D.l++]);return Z}function Ae(D,re,ee){if(!(!ee.qpro||re<21)){var Z=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ce=D.read_shift(re-21,"cstr");return[Z,ce]}}function Ee(D,re){for(var ee={},Z=D.l+re;D.l<Z;){var ce=D.read_shift(2);if(ce==14e3){for(ee[ce]=[0,""],ee[ce][0]=D.read_shift(2);D[D.l];)ee[ce][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return ee}function ie(D,re){var ee=Cr(5+D.length);ee.write_shift(2,14e3),ee.write_shift(2,re);for(var Z=0;Z<D.length;++Z){var ce=D.charCodeAt(Z);ee[ee.l++]=ce>127?95:ce}return ee[ee.l++]=0,ee}var xe={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:Oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function x9(t){var e={},r=t.match(mn),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=H1[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return e}var _9=function(){var t=ju("t"),e=ju("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:St(o[1])},u=a.match(e);return u&&(c.s=x9(u[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(c){return c.v})}}(),y9=function(){var e=/(\r\n|\n)/g;function r(i,a,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),a.push('<span style="'+c.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),E9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,w9=/<(?:\w+:)?r>/,T9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function sv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=St(Ut(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ut(t),r&&(n.h=Y1(n.t))):t.match(w9)&&(n.r=Ut(t),n.t=St(Ut((t.replace(T9,"").match(E9)||[]).join("").replace(mn,""))),r&&(n.h=y9(_9(n.r)))),n):{t:""}}var S9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,k9=/<(?:\w+:)?(?:si|sstItem)>/g,A9=/<\/(?:\w+:)?(?:si|sstItem)>/;function C9(t,e){var r=[],n="";if(!t)return r;var i=t.match(S9);if(i){n=i[2].replace(k9,"").split(A9);for(var a=0;a!=n.length;++a){var o=sv(n[a].trim(),e);o!=null&&(r[r.length]=o)}i=tt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function I9(t){return[t.read_shift(4),t.read_shift(4)]}function R9(t,e){var r=[],n=!1;return ts(t,function(a,o,c){switch(c){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function wA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Wa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function P9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function F9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),a=[];i-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function b9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(F9(t));return e}function O9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function D9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Wa(t,4),e.U=Wa(t,4),e.W=Wa(t,4),e}function N9(t){var e=D9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function TA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function SA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function L9(t){var e=Wa(t);switch(e.Minor){case 2:return[e.Minor,M9(t)];case 3:return[e.Minor,V9()];case 4:return[e.Minor,B9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function M9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=TA(t,r),i=SA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function V9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function B9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(mn,function(a){var o=tt(a);switch(ga(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function U9(t,e){var r={},n=r.EncryptionVersionInfo=Wa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=TA(t,i),e-=i,r.EncryptionVerifier=SA(t,e),r}function j9(t){var e={},r=e.EncryptionVersionInfo=Wa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function $9(t){var e=0,r,n=wA(t),i=n.length+1,a,o,c,u,h;for(r=Ys(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],c=e&16384?1:0,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var kA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,c){return n(o^c)},a=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=wA(o),u=a(c),h=c.length,d=Ys(16),g=0;g!=16;++g)d[g]=0;var v,_,E;for((h&1)===1&&(v=u>>8,d[h]=i(t[0],v),--h,v=u&255,_=c[c.length-1],d[h]=i(_,v));h>0;)--h,v=u>>8,d[h]=i(c[h],v),--h,v=u&255,d[h]=i(c[h],v);for(h=15,E=15-c.length;E>0;)v=u>>8,d[h]=i(t[E],v),--h,--E,v=u&255,d[h]=i(c[h],v),--h,--E;return d}}(),H9=function(t,e,r,n,i){i||(i=e),n||(n=kA(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},z9=function(t){var e=0,r=kA(t);return function(n){var i=H9("",n,e,r);return e=i[1],i[0]}};function W9(t,e,r,n){var i={key:_r(t),verificationBytes:_r(t)};return r.password&&(i.verifier=$9(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=z9(r.password)),i}function G9(t,e,r){var n=r;return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=j9(t):n.Data=U9(t,e),n}function K9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?G9(t,e-2,n):W9(t,r.biff>=8?e:e-2,r,n),n}var q9=function(){function t(i,a){switch(a.type){case"base64":return e(ri(i),a);case"binary":return e(i,a);case"buffer":return e(xt&&Buffer.isBuffer(i)?i.toString("binary"):Yo(i),a);case"array":return e(jo(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var o=a||{},c=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var v=/\\\w+\b/g,_=0,E,y=-1;E=v.exec(d);){switch(E[0]){case"\\cell":var w=d.slice(_,v.lastIndex-E[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var k={v:w,t:"s"};Array.isArray(c)?c[g][y]=k:c[ot({r:g,c:y})]=k}break}_=v.lastIndex}y>h.e.c&&(h.e.c=y)}),c["!ref"]=wt(h),c}function r(i,a){return ro(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=ar(i["!ref"]),c,u=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=ot({r:h,c:d});c=u?(i[h]||[])[d]:i[g],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(Qa(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function X9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function zu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Y9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),a=Math.min(e,r,n),o=i-a;if(o===0)return[0,0,e];var c=0,u=0,h=i+a;switch(u=o/(h>1?2-h:h),i){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,u,h/2]}function Q9(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=i*c,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-c),o[0]+=u,o[1]+=i;break;case 2:u=i*(c-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-c),o[1]+=u,o[2]+=i;break;case 4:u=i*(c-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-c),o[2]+=u,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function W0(t,e){if(e===0)return t;var r=Y9(X9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),zu(Q9(r))}var AA=6,J9=15,Z9=1,Tn=AA;function G0(t){return Math.floor((t+Math.round(128/Tn)/256)*Tn)}function K0(t){return Math.floor((t-5)/Tn*100+.5)/100}function Tg(t){return Math.round((t*Tn+5)/Tn*256)/256}function Om(t){return Tg(K0(G0(t)))}function ov(t){var e=Math.abs(t-Om(t)),r=Tn;if(e>.005)for(Tn=Z9;Tn<J9;++Tn)Math.abs(t-Om(t))<=e&&(e=Math.abs(t-Om(t)),r=Tn);Tn=r}function cc(t){t.width?(t.wpx=G0(t.width),t.wch=K0(t.wpx),t.MDW=Tn):t.wpx?(t.wch=K0(t.wpx),t.width=Tg(t.wch),t.MDW=Tn):typeof t.wch=="number"&&(t.width=Tg(t.wch),t.wpx=G0(t.width),t.MDW=Tn),t.customWidth&&delete t.customWidth}var eB=96,CA=eB;function IA(t){return t*96/CA}function Wu(t){return t*CA/96}var tB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rB(t,e,r,n){e.Borders=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=Yt(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=Yt(c.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in borders")}})}function nB(t,e,r,n){e.Fills=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fills")}})}function iB(t,e,r,n){e.Fonts=[];var i={},a=!1;(t[0].match(mn)||[]).forEach(function(o){var c=tt(o);switch(ga(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Ut(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?Yt(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?Yt(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?Yt(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?Yt(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?Yt(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?Yt(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?Yt(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=H1[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=Yt(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var u=Do[i.color.index];i.color.index==81&&(u=Do[1]),u||(u=Do[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=W0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fonts")}})}function aB(t,e,r){e.NumberFmt=[];for(var n=pa(ft),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ft[n[i]];var a=t[0].match(mn);if(a)for(i=0;i<a.length;++i){var o=tt(a[i]);switch(ga(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=St(Ut(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}Oo(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Kh=["numFmtId","fillId","fontId","borderId","xfId"],qh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function sB(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(mn)||[]).forEach(function(a){var o=tt(a),c=0;switch(ga(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<Kh.length;++c)n[Kh[c]]&&(n[Kh[c]]=parseInt(n[Kh[c]],10));for(c=0;c<qh.length;++c)n[qh[c]]&&(n[qh[c]]=Yt(n[qh[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Yt(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var oB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&aB(g,d,h),(g=c.match(i))&&iB(g,d,u,h),(g=c.match(n))&&nB(g,d,u,h),(g=c.match(a))&&rB(g,d,u,h),(g=c.match(r))&&sB(g,d,h),d}}();function lB(t,e){var r=t.read_shift(2),n=hn(t);return[r,n]}function cB(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=_5(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=x5(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=hn(t),n}var uB=pn;function fB(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var hB=pn;function dB(t,e,r){var n={};n.NumberFmt=[];for(var i in ft)n.NumberFmt[i]=ft[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return ts(t,function(u,h,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],Oo(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=W0(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(h.T>0)a.push(d);else if(h.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var pB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mB(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(mn)||[]).forEach(function(i){var a=tt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[pB.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function gB(){}function vB(){}var xB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_B=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function EB(t,e,r){e.themeElements={};var n;[["clrScheme",xB,mB],["fontScheme",_B,gB],["fmtScheme",yB,vB]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var wB=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function RA(t,e){(!t||t.length===0)&&(t=TB());var r,n={};if(!(r=t.match(wB)))throw new Error("themeElements not found in theme");return EB(r[0],n,e),n.raw=t,n}function TB(t,e){var r=[Uk];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SB(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=Bk(a,{type:"array"})}catch{return}var c=Jn(o,"theme/theme/theme1.xml",!0);if(c)return RA(c,r)}}function kB(t){return t.read_shift(4)}function AB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=CB(t,4);break;case 2:e.xclrValue=mA(t);break;case 3:e.xclrValue=kB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function CB(t,e){return pn(t,e)}function IB(t,e){return pn(t,e)}function RB(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=AB(t);break;case 6:n[1]=IB(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function PB(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),a=[];i-- >0;)a.push(RB(t,r-t.l));return{ixfe:n,ext:a}}function FB(t,e){e.forEach(function(r){switch(r[0]){}})}function bB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:hn(t)}}function OB(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function DB(t){return t.l+=4,t.read_shift(4)!=0}function NB(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,c=2;return ts(t,function(u,h,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function LB(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,a=2,o;return t.replace(mn,function(c){var u=tt(c);switch(ga(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function MB(t){var e=[];if(!t)return e;var r=1;return(t.match(mn)||[]).forEach(function(n){var i=tt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function VB(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function BB(t,e,r){var n=[];return ts(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function UB(t,e,r,n){if(!t)return t;var i=n||{},a=!1;ts(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function jB(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function yw(t,e,r,n){var i=Array.isArray(t),a;e.forEach(function(o){var c=Sn(o.ref);if(i?(t[c.r]||(t[c.r]=[]),a=t[c.r][c.c]):a=t[o.ref],!a){a={t:"z"},i?t[c.r][c.c]=a:t[o.ref]=a;var u=ar(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=wt(u);h!==t["!ref"]&&(t["!ref"]=h)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=a.c.length-1;g>=0;--g){if(!r&&a.c[g].T)return;r&&!a.c[g].T&&a.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}a.c.push(d)})}function $B(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=tt(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=Sn(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!g&&!!g[1]&&sv(g[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=v.h),n.push(h)}}}}),n}function HB(t,e){var r=[],n=!1,i={},a=0;return t.replace(mn,function(c,u){var h=tt(c);switch(ga(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+c.length;break;case"</text>":i.t=t.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function zB(t,e){var r=[],n=!1;return t.replace(mn,function(a){var o=tt(a);switch(ga(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function WB(t){var e={};e.iauthor=t.read_shift(4);var r=Jo(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}var GB=hn;function KB(t,e){var r=[],n=[],i={},a=!1;return ts(t,function(c,u,h){switch(h){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}var qB="application/vnd.ms-office.vbaProject";function XB(t){var e=Et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Et.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Et.write(e)}function YB(){return{"!type":"dialog"}}function QB(){return{"!type":"dialog"}}function JB(){return{"!type":"macro"}}function ZB(){return{"!type":"macro"}}var ql=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,o){var c=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,i+(c?"":"$")+Ir(d)+(u?"":"$")+Yr(h)}return function(i,a){return e=a,i.replace(t,r)}}(),PA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eU=function(){return function(e,r){return e.replace(PA,function(n,i,a,o,c,u){var h=ev(o)-(a?0:r.c),d=Z1(u)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",v=h==0?"":a?h+1:"["+h+"]";return i+"R"+g+"C"+v})}}();function FA(t,e){return t.replace(PA,function(r,n,i,a,o,c){return n+(i=="$"?i+a:Ir(ev(a)+e.c))+(o=="$"?o+c:Yr(Z1(c)+e.r))})}function tU(t,e,r){var n=Ec(e),i=n.s,a=Sn(r),o={r:a.r-i.r,c:a.c-i.c};return FA(t,o)}function rU(t){return t.length!=1}function Ew(t){return t.replace(/_xlfn\./g,"")}function gr(t){t.l+=1}function Qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return OA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),o=Qs(t),c=Qs(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function OA(t){var e=Qs(t),r=Qs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function nU(t,e,r){if(r.biff<8)return OA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=Qs(t),o=Qs(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function DA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return iU(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Qs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function iU(t){var e=Qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function aU(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function sU(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return oU(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function oU(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function lU(t,e,r){var n=(t[t.l++]&96)>>5,i=bA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function cU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=bA(t,a,r);return[n,i,o]}function uU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function hU(t,e,r){var n=(t[t.l++]&96)>>5,i=nU(t,e-1,r);return[n,i]}function dU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ww(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function pU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function mU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function gU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function xU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function NA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function _U(t){return t.read_shift(2),NA(t)}function yU(t){return t.read_shift(2),NA(t)}function EU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=DA(t,0,r);return[n,i]}function wU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=sU(t,0,r);return[n,i]}function TU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=DA(t,0,r);return[n,i,a]}function SU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[k7[i],VA[i],n]}function kU(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:AU(t);return[i,(a[0]===0?VA:S7)[a[1]]]}function AU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function CU(t,e,r){t.l+=r&&r.biff==2?3:4}function IU(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function RU(t){return t.l++,Zo[t.read_shift(1)]}function PU(t){return t.l++,t.read_shift(2)}function FU(t){return t.l++,t.read_shift(1)!==0}function bU(t){return t.l++,un(t)}function OU(t,e,r){return t.l++,mf(t,e-1,r)}function DU(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=lr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Zo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=un(t);break;case 2:r[1]=el(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function NU(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Jo:Id)(t));return i}function LU(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=DU(t,r.biff);return o}function MU(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function VU(t,e,r){if(r.biff==5)return BU(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function BU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function UU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function jU(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function $U(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function HU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var zU=pn,WU=pn,GU=pn;function vf(t,e,r){return t.l+=2,[aU(t)]}function lv(t){return t.l+=6,[]}var KU=vf,qU=lv,XU=lv,YU=vf;function LA(t){return t.l+=2,[_r(t),t.read_shift(2)&1]}var QU=vf,JU=LA,ZU=lv,e7=vf,t7=vf,r7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function n7(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),o=r7[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:a}}function i7(t){return t.l+=2,[t.read_shift(4)]}function a7(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function s7(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function o7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function l7(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function c7(t){return t.l+=4,[0,0]}var Tw={1:{n:"PtgExp",f:IU},2:{n:"PtgTbl",f:GU},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:OU},26:{n:"PtgSheet",f:a7},27:{n:"PtgEndSheet",f:s7},28:{n:"PtgErr",f:RU},29:{n:"PtgBool",f:FU},30:{n:"PtgInt",f:PU},31:{n:"PtgNum",f:bU},32:{n:"PtgArray",f:dU},33:{n:"PtgFunc",f:SU},34:{n:"PtgFuncVar",f:kU},35:{n:"PtgName",f:MU},36:{n:"PtgRef",f:EU},37:{n:"PtgArea",f:lU},38:{n:"PtgMemArea",f:UU},39:{n:"PtgMemErr",f:zU},40:{n:"PtgMemNoMem",f:WU},41:{n:"PtgMemFunc",f:jU},42:{n:"PtgRefErr",f:$U},43:{n:"PtgAreaErr",f:uU},44:{n:"PtgRefN",f:wU},45:{n:"PtgAreaN",f:hU},46:{n:"PtgMemAreaN",f:o7},47:{n:"PtgMemNoMemN",f:l7},57:{n:"PtgNameX",f:VU},58:{n:"PtgRef3d",f:TU},59:{n:"PtgArea3d",f:cU},60:{n:"PtgRefErr3d",f:HU},61:{n:"PtgAreaErr3d",f:fU},255:{}},u7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},f7={1:{n:"PtgElfLel",f:LA},2:{n:"PtgElfRw",f:e7},3:{n:"PtgElfCol",f:KU},6:{n:"PtgElfRwV",f:t7},7:{n:"PtgElfColV",f:YU},10:{n:"PtgElfRadical",f:QU},11:{n:"PtgElfRadicalS",f:ZU},13:{n:"PtgElfColS",f:qU},15:{n:"PtgElfColSV",f:XU},16:{n:"PtgElfRadicalLel",f:JU},25:{n:"PtgList",f:n7},29:{n:"PtgSxName",f:i7},255:{}},h7={0:{n:"PtgAttrNoop",f:c7},1:{n:"PtgAttrSemi",f:xU},2:{n:"PtgAttrIf",f:gU},4:{n:"PtgAttrChoose",f:pU},8:{n:"PtgAttrGoto",f:mU},16:{n:"PtgAttrSum",f:CU},32:{n:"PtgAttrBaxcel",f:ww},33:{n:"PtgAttrBaxcel",f:ww},64:{n:"PtgAttrSpace",f:_U},65:{n:"PtgAttrSpaceSemi",f:yU},128:{n:"PtgAttrIfError",f:vU},255:{}};function xf(t,e,r,n){if(n.biff<8)return pn(t,e);for(var i=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=LU(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=NU(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&a.push(pn(t,e)),a}function _f(t,e,r){for(var n=t.l+e,i,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],i=Tw[a]||Tw[u7[a]],(a===24||a===25)&&(i=(a===24?f7:h7)[t[t.l+1]]),!i||!i.f?pn(t,e):o.push([i.n,i.f(t,e,r)]);return o}function d7(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var p7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function m7(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function MA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sw(t,e,r){var n=MA(t,e,r);return n=="#REF"?n:m7(n,r)}function ln(t,e,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],u,h,d,g=0,v=0,_,E="";if(!t[0]||!t[0][0])return"";for(var y=-1,w="",k=0,F=t[0].length;k<F;++k){var C=t[0][k];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),y>=0){switch(t[0][y][1][0]){case 0:w=nr(" ",t[0][y][1][1]);break;case 1:w=nr("\r",t[0][y][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}h=h+w,y=-1}c.push(h+p7[C[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=yu(C[1][1],o,i),c.push(Eu(d,a));break;case"PtgRefN":d=r?yu(C[1][1],r,i):C[1][1],c.push(Eu(d,a));break;case"PtgRef3d":g=C[1][1],d=yu(C[1][2],o,i),E=Sw(n,g,i),c.push(E+"!"+Eu(d,a));break;case"PtgFunc":case"PtgFuncVar":var U=C[1][0],V=C[1][1];U||(U=0),U&=127;var z=U==0?[]:c.slice(-U);c.length-=U,V==="User"&&(V=z.shift()),c.push(V+"("+z.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":_=iw(C[1][1],r?{s:r}:o,i),c.push(Fm(_,i));break;case"PtgArea":_=iw(C[1][1],o,i),c.push(Fm(_,i));break;case"PtgArea3d":g=C[1][1],_=C[1][2],E=Sw(n,g,i),c.push(E+"!"+Fm(_,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var A=(n.names||[])[v-1]||(n[0]||[])[v],P=A?A.Name:"SH33TJSNAME"+String(v);P&&P.slice(0,6)=="_xlfn."&&!i.xlfn&&(P=P.slice(6)),c.push(P);break;case"PtgNameX":var R=C[1][1];v=C[1][2];var M;if(i.biff<=5)R<0&&(R=-R),n[R]&&(M=n[R][v]);else{var L="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][v]&&n[R][v].itab>0&&(L=n.SheetNames[n[R][v].itab-1]+"!"):L=n.SheetNames[v-1]+"!"),n[R]&&n[R][v])L+=n[R][v].Name;else if(n[0]&&n[0][v])L+=n[0][v].Name;else{var N=(MA(n,R,i)||"").split(";;");N[v-1]?L=N[v-1]:L+="SH33TJSERRX"}c.push(L);break}M||(M={Name:"SH33TJSERRY"}),c.push(M.Name);break;case"PtgParen":var B="(",Oe=")";if(y>=0){switch(w="",t[0][y][1][0]){case 2:B=nr(" ",t[0][y][1][1])+B;break;case 3:B=nr("\r",t[0][y][1][1])+B;break;case 4:Oe=nr(" ",t[0][y][1][1])+Oe;break;case 5:Oe=nr("\r",t[0][y][1][1])+Oe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}c.push(B+c.pop()+Oe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:C[1][1],r:C[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[ot(d)]){var Ce=n.sharedf[ot(d)];c.push(ln(Ce,o,we,n,i))}else{var Ae=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(ln(h[1],o,we,n,i)),Ae=!0;break}Ae||c.push(C[1])}break;case"PtgArray":c.push("{"+d7(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&Ee.indexOf(t[0][k][0])==-1){C=t[0][y];var ie=!0;switch(C[1][0]){case 4:ie=!1;case 0:w=nr(" ",C[1][1]);break;case 5:ie=!1;case 1:w=nr("\r",C[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((ie?w:"")+c.pop()+(ie?"":w)),y=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function g7(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],pn(t,e-2)];var c=_f(t,o,r);return e!==o+i&&(a=xf(t,e-o-i,c,r)),t.l=n,[c,a]}function v7(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],pn(t,e-2)];var c=_f(t,o,r);return e!==o+i&&(a=xf(t,e-o-i,c,r)),t.l=n,[c,a]}function x7(t,e,r,n){var i=t.l+e,a=_f(t,n,r),o;return i!==t.l&&(o=xf(t,i-t.l,a,r)),[a,o]}function _7(t,e,r){var n=t.l+e,i,a=t.read_shift(2),o=_f(t,a,r);return a==65535?[[],pn(t,e-2)]:(e!==a+2&&(i=xf(t,n-a-2,o,r)),[o,i])}function y7(t){var e;if(Ua(t,t.l+6)!==65535)return[un(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Dm(t,e,r){var n=t.l+e,i=va(t);r.biff==2&&++t.l;var a=y7(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=v7(t,n-t.l,r);return{cell:i,val:a[0],formula:c,shared:o>>3&1,tt:a[1]}}function Rd(t,e,r){var n=t.read_shift(4),i=_f(t,n,r),a=t.read_shift(4),o=a>0?xf(t,a,i,r):null;return[i,o]}var E7=Rd,Pd=Rd,w7=Rd,T7=Rd,S7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},k7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Nm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var ku={},Xl={};function Au(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function BA(t,e,r,n,i,a){try{n.cellNF&&(t.z=ft[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ur(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ft[e]==null&&Oo(A8[e]||"General",e),t.t==="e")t.w=t.w||Zo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uu(t.v);else if(t.t==="d"){var o=In(t.v);(o|0)===o?t.w=o.toString(10):t.w=Uu(o)}else{if(t.v===void 0)return"";t.w=Uo(t.v,Xl)}else t.t==="d"?t.w=vi(e,In(t.v),Xl):t.w=vi(e,t.v,Xl)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=W0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=W0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&a.Fills)throw c}}}function A7(t,e){var r=ar(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=wt(r))}var C7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,I7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,R7=/<(?:\w:)?hyperlink [^>]*>/mg,P7=/"(\w*:\w*)"/,F7=/<(?:\w:)?col\b[^>]*[\/]?>/g,b7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O7=/<(?:\w:)?pageMargins[^>]*\/>/g,UA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,D7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,N7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function L7(t,e,r,n,i,a,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(I7);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var v=h.match(UA);v?cv(v[0],c,i,r):(v=h.match(D7))&&M7(v[0],v[1]||"",c,i,r);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var E=h.slice(_,_+50).match(P7);E&&A7(c,E[1])}var y=h.match(N7);y&&y[1]&&H7(y[1],i);var w=[];if(e.cellStyles){var k=h.match(F7);k&&U7(w,k)}g&&z7(g[1],c,e,u,a,o);var F=d.match(b7);F&&(c["!autofilter"]=j7(F[0]));var C=[],U=d.match(C7);if(U)for(_=0;_!=U.length;++_)C[_]=ar(U[_].slice(U[_].indexOf('"')+1));var V=d.match(R7);V&&V7(c,V,n);var z=d.match(O7);if(z&&(c["!margins"]=B7(tt(z[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=wt(u)),e.sheetRows>0&&c["!ref"]){var A=ar(c["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=wt(A))}return w.length>0&&(c["!cols"]=w),C.length>0&&(c["!merges"]=C),c}function cv(t,e,r,n){var i=tt(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=St(Ut(i.codeName)))}function M7(t,e,r,n,i){cv(t.slice(0,t.indexOf(">")),r,n,i)}function V7(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var a=tt(Ut(e[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+St(a.location))):(a.Target="#"+St(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var c=ar(a.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=ot({c:h,r:u});n?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function B7(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function U7(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=tt(e[n],!0);i.hidden&&(i.hidden=Yt(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ov(i.width)),cc(i);a<=o;)t[a++]=Xr(i)}}function j7(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var $7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function H7(t,e){e.Views||(e.Views=[{}]),(t.match($7)||[]).forEach(function(r,n){var i=tt(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Yt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var z7=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=ju("v"),o=ju("f");return function(u,h,d,g,v,_){for(var E=0,y="",w=[],k=[],F=0,C=0,U=0,V="",z,A,P=0,R=0,M,L,N=0,B=0,Oe=Array.isArray(_.CellXf),we,Ce=[],Ae=[],Ee=Array.isArray(h),ie=[],xe={},te=!1,D=!!d.sheetStubs,re=u.split(e),ee=0,Z=re.length;ee!=Z;++ee){y=re[ee].trim();var ce=y.length;if(ce!==0){var _e=0;e:for(E=0;E<ce;++E)switch(y[E]){case">":if(y[E-1]!="/"){++E;break e}if(d&&d.cellStyles){if(A=tt(y.slice(_e,E),!0),P=A.r!=null?parseInt(A.r,10):P+1,R=-1,d.sheetRows&&d.sheetRows<P)continue;xe={},te=!1,A.ht&&(te=!0,xe.hpt=parseFloat(A.ht),xe.hpx=Wu(xe.hpt)),A.hidden=="1"&&(te=!0,xe.hidden=!0),A.outlineLevel!=null&&(te=!0,xe.level=+A.outlineLevel),te&&(ie[P-1]=xe)}break;case"<":_e=E;break}if(_e>=E)break;if(A=tt(y.slice(_e,E),!0),P=A.r!=null?parseInt(A.r,10):P+1,R=-1,!(d.sheetRows&&d.sheetRows<P)){g.s.r>P-1&&(g.s.r=P-1),g.e.r<P-1&&(g.e.r=P-1),d&&d.cellStyles&&(xe={},te=!1,A.ht&&(te=!0,xe.hpt=parseFloat(A.ht),xe.hpx=Wu(xe.hpt)),A.hidden=="1"&&(te=!0,xe.hidden=!0),A.outlineLevel!=null&&(te=!0,xe.level=+A.outlineLevel),te&&(ie[P-1]=xe)),w=y.slice(E).split(t);for(var ve=0;ve!=w.length&&w[ve].trim().charAt(0)=="<";++ve);for(w=w.slice(ve),E=0;E!=w.length;++E)if(y=w[E].trim(),y.length!==0){if(k=y.match(r),F=E,C=0,U=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,k!=null&&k.length===2){for(F=0,V=k[1],C=0;C!=V.length&&!((U=V.charCodeAt(C)-64)<1||U>26);++C)F=26*F+U;--F,R=F}else++R;for(C=0;C!=y.length&&y.charCodeAt(C)!==62;++C);if(++C,A=tt(y.slice(0,C),!0),A.r||(A.r=ot({r:P-1,c:R})),V=y.slice(C),z={t:""},(k=V.match(a))!=null&&k[1]!==""&&(z.v=St(k[1])),d.cellFormula){if((k=V.match(o))!=null&&k[1]!==""){if(z.f=St(Ut(k[1])).replace(/\r\n/g,`
`),d.xlfn||(z.f=Ew(z.f)),k[0].indexOf('t="array"')>-1)z.F=(V.match(i)||[])[1],z.F.indexOf(":")>-1&&Ce.push([ar(z.F),z.F]);else if(k[0].indexOf('t="shared"')>-1){L=tt(k[0]);var ye=St(Ut(k[1]));d.xlfn||(ye=Ew(ye)),Ae[parseInt(L.si,10)]=[L,ye,A.r]}}else(k=V.match(/<f[^>]*\/>/))&&(L=tt(k[0]),Ae[L.si]&&(z.f=tU(Ae[L.si][1],Ae[L.si][2],A.r)));var Te=Sn(A.r);for(C=0;C<Ce.length;++C)Te.r>=Ce[C][0].s.r&&Te.r<=Ce[C][0].e.r&&Te.c>=Ce[C][0].s.c&&Te.c<=Ce[C][0].e.c&&(z.F=Ce[C][1])}if(A.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(D)z.t="z";else continue;else z.t=A.t||"n";switch(g.s.c>R&&(g.s.c=R),g.e.c<R&&(g.e.c=R),z.t){case"n":if(z.v==""||z.v==null){if(!D)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!D)continue;z.t="z"}else M=ku[parseInt(z.v,10)],z.v=M.t,z.r=M.r,d.cellHTML&&(z.h=M.h);break;case"str":z.t="s",z.v=z.v!=null?Ut(z.v):"",d.cellHTML&&(z.h=Y1(z.v));break;case"inlineStr":k=V.match(n),z.t="s",k!=null&&(M=sv(k[1]))?(z.v=M.t,d.cellHTML&&(z.h=M.h)):z.v="";break;case"b":z.v=Yt(z.v);break;case"d":d.cellDates?z.v=Ur(z.v,1):(z.v=In(Ur(z.v,1)),z.t="n");break;case"e":(!d||d.cellText!==!1)&&(z.w=z.v),z.v=oA[z.v];break}if(N=B=0,we=null,Oe&&A.s!==void 0&&(we=_.CellXf[A.s],we!=null&&(we.numFmtId!=null&&(N=we.numFmtId),d.cellStyles&&we.fillId!=null&&(B=we.fillId))),BA(z,N,B,d,v,_),d.cellDates&&Oe&&z.t=="n"&&yc(ft[N])&&(z.t="d",z.v=Cd(z.v)),A.cm&&d.xlmeta){var Ke=(d.xlmeta.Cell||[])[+A.cm-1];Ke&&Ke.type=="XLDAPR"&&(z.D=!0)}if(Ee){var J=Sn(A.r);h[J.r]||(h[J.r]=[]),h[J.r][J.c]=z}else h[A.r]=z}}}}ie.length>0&&(h["!rows"]=ie)}}();function W7(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}var G7=Jo;function K7(){}function q7(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=g5(t),r}function X7(t){var e=xi(t);return[e]}function Y7(t){var e=Qo(t);return[e]}function Q7(t){var e=xi(t),r=t.read_shift(1);return[e,r,"b"]}function J7(t){var e=Qo(t),r=t.read_shift(1);return[e,r,"b"]}function Z7(t){var e=xi(t),r=t.read_shift(1);return[e,r,"e"]}function ej(t){var e=Qo(t),r=t.read_shift(1);return[e,r,"e"]}function tj(t){var e=xi(t),r=t.read_shift(4);return[e,r,"s"]}function rj(t){var e=Qo(t),r=t.read_shift(4);return[e,r,"s"]}function nj(t){var e=xi(t),r=un(t);return[e,r,"n"]}function jA(t){var e=Qo(t),r=un(t);return[e,r,"n"]}function ij(t){var e=xi(t),r=nv(t);return[e,r,"n"]}function aj(t){var e=Qo(t),r=nv(t);return[e,r,"n"]}function sj(t){var e=xi(t),r=tv(t);return[e,r,"is"]}function oj(t){var e=xi(t),r=hn(t);return[e,r,"str"]}function lj(t){var e=Qo(t),r=hn(t);return[e,r,"str"]}function cj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"b"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function uj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"e"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function fj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=un(t),o=[i,a,"n"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}function hj(t,e,r){var n=t.l+e,i=xi(t);i.r=r["!row"];var a=hn(t),o=[i,a,"str"];if(r.cellFormula){t.l+=2;var c=Pd(t,n-t.l,r);o[3]=ln(c,null,i,r.supbooks,r)}else t.l=n;return o}var dj=Jo;function pj(t,e){var r=t.l+e,n=Jo(t),i=rv(t),a=hn(t),o=hn(t),c=hn(t);t.l=r;var u={rfx:n,relId:i,loc:a,display:c};return o&&(u.Tooltip=o),u}function mj(){}function gj(t,e,r){var n=t.l+e,i=iA(t),a=t.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var c=E7(t,n-t.l,r);o[1]=c}else t.l=n;return o}function vj(t,e,r){var n=t.l+e,i=Jo(t),a=[i];if(r.cellFormula){var o=T7(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}var xj=["left","right","top","bottom","header","footer"];function _j(t){var e={};return xj.forEach(function(r){e[r]=un(t)}),e}function yj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Ej(){}function wj(){}function Tj(t,e,r,n,i,a,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,v=!1,_,E,y,w,k,F,C,U,V,z=[];c.biff=12,c["!row"]=0;var A=0,P=!1,R=[],M={},L=c.supbooks||i.supbooks||[[]];if(L.sharedf=M,L.arrayf=R,L.SheetNames=i.SheetNames||i.Sheets.map(function(Ee){return Ee.name}),!c.supbooks&&(c.supbooks=L,i.Names))for(var N=0;N<i.Names.length;++N)L[0][N+1]=i.Names[N];var B=[],Oe=[],we=!1;q0[16]={n:"BrtShortReal",f:jA};var Ce;if(ts(t,function(ie,xe,te){if(!v)switch(te){case 148:h=ie;break;case 0:_=ie,c.sheetRows&&c.sheetRows<=_.r&&(v=!0),U=Yr(w=_.r),c["!row"]=_.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Wu(ie.hpt)),Oe[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:ie[2]},ie[2]){case"n":E.v=ie[1];break;case"s":C=ku[ie[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!ie[1];break;case"e":E.v=ie[1],c.cellText!==!1&&(E.w=Zo[E.v]);break;case"str":E.t="s",E.v=ie[1];break;case"is":E.t="s",E.v=ie[1].t;break}if((y=o.CellXf[ie[0].iStyleRef])&&BA(E,y.numFmtId,null,c,a,o),k=ie[0].c==-1?k+1:ie[0].c,c.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Ir(k)+U]=E,c.cellFormula){for(P=!1,A=0;A<R.length;++A){var D=R[A];_.r>=D[0].s.r&&_.r<=D[0].e.r&&k>=D[0].s.c&&k<=D[0].e.c&&(E.F=wt(D[0]),P=!0)}!P&&ie.length>3&&(E.f=ie[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>k&&(d.s.c=k),d.e.r<_.r&&(d.e.r=_.r),d.e.c<k&&(d.e.c=k),c.cellDates&&y&&E.t=="n"&&yc(ft[y.numFmtId])){var re=Fo(E.v);re&&(E.t="d",E.v=new Date(re.y,re.m-1,re.d,re.H,re.M,re.S,re.u))}Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;E={t:"z",v:void 0},k=ie[0].c==-1?k+1:ie[0].c,c.dense?(u[w]||(u[w]=[]),u[w][k]=E):u[Ir(k)+U]=E,d.s.r>_.r&&(d.s.r=_.r),d.s.c>k&&(d.s.c=k),d.e.r<_.r&&(d.e.r=_.r),d.e.c<k&&(d.e.c=k),Ce&&(Ce.type=="XLDAPR"&&(E.D=!0),Ce=void 0);break;case 176:z.push(ie);break;case 49:Ce=((c.xlmeta||{}).Cell||[])[ie-1];break;case 494:var ee=n["!id"][ie.relId];for(ee?(ie.Target=ee.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=ee):ie.relId==""&&(ie.Target="#"+ie.loc),w=ie.rfx.s.r;w<=ie.rfx.e.r;++w)for(k=ie.rfx.s.c;k<=ie.rfx.e.c;++k)c.dense?(u[w]||(u[w]=[]),u[w][k]||(u[w][k]={t:"z",v:void 0}),u[w][k].l=ie):(F=ot({c:k,r:w}),u[F]||(u[F]={t:"z",v:void 0}),u[F].l=ie);break;case 426:if(!c.cellFormula)break;R.push(ie),V=c.dense?u[w][k]:u[Ir(k)+U],V.f=ln(ie[1],d,{r:_.r,c:k},L,c),V.F=wt(ie[0]);break;case 427:if(!c.cellFormula)break;M[ot(ie[0].s)]=ie[1],V=c.dense?u[w][k]:u[Ir(k)+U],V.f=ln(ie[1],d,{r:_.r,c:k},L,c);break;case 60:if(!c.cellStyles)break;for(;ie.e>=ie.s;)B[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},we||(we=!0,ov(ie.w/256)),cc(B[ie.e+1]);break;case 161:u["!autofilter"]={ref:wt(ie)};break;case 476:u["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(u["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!xe.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=wt(h||d)),c.sheetRows&&u["!ref"]){var Ae=ar(u["!ref"]);c.sheetRows<=+Ae.e.r&&(Ae.e.r=c.sheetRows-1,Ae.e.r>d.e.r&&(Ae.e.r=d.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>d.e.c&&(Ae.e.c=d.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),u["!fullref"]=u["!ref"],u["!ref"]=wt(Ae))}return z.length>0&&(u["!merges"]=z),B.length>0&&(u["!cols"]=B),Oe.length>0&&(u["!rows"]=Oe),u}function Sj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=St((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,i,n]}function kj(t,e,r,n,i,a){var o=a||{"!type":"chart"};if(!t)return a;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var v=Sj(g);d.s.r=d.s.c=0,d.e.c=c,h=Ir(c),v[0].forEach(function(_,E){o[h+Yr(E)]={t:"n",v:_,z:v[1]},u=E}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=wt(d)),o}function Aj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(UA);return c&&cv(c[0],a,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Cj(t,e){t.l+=10;var r=hn(t);return{name:r}}function Ij(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ts(t,function(u,h,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var $A=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Rj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Pj=[],Fj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Aw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var a=e[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Yt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Cw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Yt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function HA(t){Cw(t.WBProps,$A),Cw(t.CalcPr,Fj),Aw(t.WBView,Rj),Aw(t.Sheets,Pj),Xl.date1904=Yt(t.WBProps.date1904)}var bj="][*?/\\".split("");function Oj(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Dj=/<\w+:workbook/;function Nj(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(t.replace(mn,function(u,h){var d=tt(u);switch(ga(d[0])){case"<?xml":break;case"<workbook":u.match(Dj)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$A.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Yt(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Ut(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=St(Ut(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ut(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Yt(d.hidden||"0")&&(a.Hidden=!0),o=h+u.length;break;case"</definedName>":a.Ref=St(Ut(t.slice(o,h))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Z8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HA(r),r}function Lj(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=yg(t),r.name=hn(t),r}function Mj(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?hn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Vj(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Bj(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=v5(t),o=w7(t,0,r),c=rv(t);t.l=n;var u={Name:a,Ptg:o};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function Uj(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],q0[16]={n:"BrtFRTArchID$",f:Vj},ts(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=ln(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),HA(r),r.Names=a,r.supbooks=o,r}function jj(t,e,r){return e.slice(-4)===".bin"?Uj(t,r):Nj(t,r)}function $j(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Tj(t,n,r,i,a,o,c):L7(t,n,r,i,a,o,c)}function Hj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Ij(t,n,r,i,a):Aj(t,n,r,i,a)}function zj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?JB():ZB()}function Wj(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?YB():QB()}function Gj(t,e,r,n){return e.slice(-4)===".bin"?dB(t,r,n):oB(t,r,n)}function Kj(t,e,r){return RA(t,r)}function qj(t,e,r){return e.slice(-4)===".bin"?R9(t,r):C9(t,r)}function Xj(t,e,r){return e.slice(-4)===".bin"?KB(t,r):$B(t,r)}function Yj(t,e,r){return e.slice(-4)===".bin"?BB(t):MB(t)}function Qj(t,e,r,n){return r.slice(-4)===".bin"?UB(t,e,r,n):void 0}function Jj(t,e,r){return e.slice(-4)===".bin"?NB(t,e,r):LB(t,e,r)}var zA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,WA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Di(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(zA),a,o,c,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(WA),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),n[c]=a[2].slice(1,a[2].length-1));return n}function Zj(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(zA),i,a,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(WA),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Cu;function e$(t,e){var r=Cu[t]||St(t);return r==="General"?Uo(e):vi(r,e)}function t$(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Yt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Ur(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[St(e)]=i}function r$(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Zo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uu(t.v):t.w=Uo(t.v):t.w=e$(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Cu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&yc(n)){var i=Fo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function n$(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tB[n.Pattern]||n.Pattern)}t[e.ID]=e}function i$(t,e,r,n,i,a,o,c,u,h){var d="General",g=n.StyleID,v={};h=h||{};var _=[],E=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);a[g]!==void 0&&(a[g].nf&&(d=a[g].nf),a[g].Interior&&_.push(a[g].Interior),!!a[g].Parent);)g=a[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Yt(t);break;case"String":n.t="s",n.r=XE(St(t)),n.v=t.indexOf("<")>-1?St(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Ur(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=St(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=oA[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=XE(e||t));break}if(r$(n,d,h),h.cellFormula!==!1)if(n.Formula){var y=St(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=ql(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ql("RC:RC",i):n.ArrayRange&&(n.F=ql(n.ArrayRange,i),u.push([ar(n.F),n.F]))}else for(E=0;E<u.length;++E)i.r>=u[E][0].s.r&&i.r<=u[E][0].e.r&&i.c>=u[E][0].s.c&&i.c<=u[E][0].e.c&&(n.F=u[E][1]);h.cellStyles&&(_.forEach(function(w){!v.patternType&&w.patternType&&(v.patternType=w.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function a$(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Lm(t,e){var r=e||{};Ok();var n=uu(Q1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ut(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Xr(r);return o.type="string",Hu.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Vt){i.indexOf("<"+Vt)>=0&&(a=!0)}),a)return p$(n,r);Cu={"General Number":"General","General Date":ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ft[15],"Short Date":ft[14],"Long Time":ft[19],"Medium Time":ft[18],"Short Time":ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ft[2],Standard:ft[4],Percent:ft[10],Scientific:ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},g=[],v=r.dense?[]:{},_="",E={},y={},w=Di('<Data ss:Type="String">'),k=0,F=0,C=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},z={},A="",P=0,R=[],M={},L={},N=0,B=[],Oe=[],we={},Ce=[],Ae,Ee=!1,ie=[],xe=[],te={},D=0,re=0,ee={Sheets:[],WBProps:{date1904:!1}},Z={};$u.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";c=$u.exec(n);)switch(c[3]=(ce=c[3]).toLowerCase()){case"data":if(ce=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?i$(n.slice(k,c.index),A,w,u[u.length-1][0]=="comment"?we:E,{c:F,r:C},V,Ce[F],y,ie,r):(A="",w=Di(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Oe.length>0&&(E.c=Oe),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(v[C]||(v[C]=[]),v[C][F]=E):v[Ir(F)+Yr(C)]=E),E.HRef&&(E.l={Target:St(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(D=F+(parseInt(E.MergeAcross,10)|0),re=C+(parseInt(E.MergeDown,10)|0),R.push({s:{c:F,r:C},e:{c:D,r:re}})),!r.sheetStubs)E.MergeAcross?F=D+1:++F;else if(E.MergeAcross||E.MergeDown){for(var _e=F;_e<=D;++_e)for(var ve=C;ve<=re;++ve)(_e>F||ve>C)&&(r.dense?(v[ve]||(v[ve]=[]),v[ve][_e]={t:"z"}):v[Ir(_e)+Yr(ve)]={t:"z"});F=D+1}else++F;else E=Zj(c[0]),E.Index&&(F=+E.Index-1),F<U.s.c&&(U.s.c=F),F>U.e.c&&(U.e.c=F),c[0].slice(-2)==="/>"&&++F,Oe=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<U.s.r&&(U.s.r=C),C>U.e.r&&(U.e.r=C),c[0].slice(-2)==="/>"&&(y=Di(c[0]),y.Index&&(C=+y.Index-1)),F=0,++C):(y=Di(c[0]),y.Index&&(C=+y.Index-1),te={},(y.AutoFitHeight=="0"||y.Height)&&(te.hpx=parseInt(y.Height,10),te.hpt=IA(te.hpx),xe[C]=te),y.Hidden=="1"&&(te.hidden=!0,xe[C]=te));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(_),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(v["!ref"]=wt(U),r.sheetRows&&r.sheetRows<=U.e.r&&(v["!fullref"]=v["!ref"],U.e.r=r.sheetRows-1,v["!ref"]=wt(U))),R.length&&(v["!merges"]=R),Ce.length>0&&(v["!cols"]=Ce),xe.length>0&&(v["!rows"]=xe),d[_]=v}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=F=0,u.push([c[3],!1]),h=Di(c[0]),_=St(h.Name),v=r.dense?[]:{},R=[],ie=[],xe=[],Z={name:_,Hidden:0},ee.Sheets.push(Z);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Ce=[],Ee=!1}break;case"style":c[1]==="/"?n$(V,z,r):z=Di(c[0]);break;case"numberformat":z.nf=St(Di(c[0]).Format||"General"),Cu[z.nf]&&(z.nf=Cu[z.nf]);for(var ye=0;ye!=392&&ft[ye]!=z.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(ft[ye]==null){Oo(z.nf,ye);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(Ae=Di(c[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!Ee&&Ae.wpx>10){Ee=!0,Tn=AA;for(var Te=0;Te<Ce.length;++Te)Ce[Te]&&cc(Ce[Te])}Ee&&cc(Ae),Ce[Ae.Index-1||Ce.length]=Ae;for(var Ke=0;Ke<+Ae.Span;++Ke)Ce[Ce.length]=Xr(Ae);break;case"namedrange":if(c[1]==="/")break;ee.Names||(ee.Names=[]);var J=tt(c[0]),kt={Name:J.Name,Ref:ql(J.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(kt.Sheet=ee.Sheets.length-1),ee.Names.push(kt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(P,c.index):P=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;z.Interior=Di(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?$5(M,ce,n.slice(N,c.index)):N=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));a$(we),Oe.push(we)}else u.push([c[3],!1]),h=Di(c[0]),we={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ct=Di(c[0]);v["!autofilter"]={ref:ql(ct.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return Ow(n,r);var dt=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(N,c.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else N=c.index+c[0].length;break;case"header":v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+tt(c[0]).Margin)||(v["!margins"].header=+tt(c[0]).Margin);break;case"footer":v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+tt(c[0]).Margin)||(v["!margins"].footer=+tt(c[0]).Margin);break;case"pagemargins":var ut=tt(c[0]);v["!margins"]||Au(v["!margins"]={},"xlml"),isNaN(+ut.Top)||(v["!margins"].top=+ut.Top),isNaN(+ut.Left)||(v["!margins"].left=+ut.Left),isNaN(+ut.Right)||(v["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(v["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?t$(L,ce,B,n.slice(N,c.index)):(B=c,N=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Ve={};return!r.bookSheets&&!r.bookProps&&(Ve.Sheets=d),Ve.SheetNames=g,Ve.Workbook=ee,Ve.SSF=Xr(ft),Ve.Props=M,Ve.Custprops=L,Ve}function Sg(t,e){switch(hv(e=e||{}),e.type||"base64"){case"base64":return Lm(ri(t),e);case"binary":case"buffer":case"file":return Lm(t,e);case"array":return Lm(Yo(t),e)}}function s$(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=y5(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=E5(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var o$=[60,1084,2066,2165,2175];function l$(t,e,r,n,i){var a=n,o=[],c=r.slice(r.l,r.l+a);if(i.enc&&i.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),r.l+=a;for(var u=Ua(r,r.l),h=kg[u],d=0;h!=null&&o$.indexOf(u)>-1;)a=Ua(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+a),o.push(c),r.l+=4+a,h=kg[u=Ua(r,r.l)];var g=Os(o);Kr(g,0);var v=0;g.lens=[];for(var _=0;_<o.length;++_)g.lens.push(v),v+=o[_].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,i)}function na(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ft[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Zo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uu(t.v):t.w=Uo(t.v):t.w=vi(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&yc(ft[n]||String(n))){var i=Fo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Xh(t,e,r){return{v:t,ixfe:e,t:r}}function c$(t,e){var r={opts:{}},n={},i=e.dense?[]:{},a={},o={},c=null,u=[],h="",d={},g,v="",_,E,y,w,k={},F=[],C,U,V=[],z=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},R=function(rt){return rt<8?Do[rt]:rt<64&&z[rt-8]||Do[rt]},M=function(rt,Ot,dr){var Ht=Ot.XF.data;if(!(!Ht||!Ht.patternType||!dr||!dr.cellStyles)){Ot.s={},Ot.s.patternType=Ht.patternType;var Hn;(Hn=zu(R(Ht.icvFore)))&&(Ot.s.fgColor={rgb:Hn}),(Hn=zu(R(Ht.icvBack)))&&(Ot.s.bgColor={rgb:Hn})}},L=function(rt,Ot,dr){if(!(te>1)&&!(dr.sheetRows&&rt.r>=dr.sheetRows)){if(dr.cellStyles&&Ot.XF&&Ot.XF.data&&M(rt,Ot,dr),delete Ot.ixfe,delete Ot.XF,g=rt,v=ot(rt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<o.s.r&&(o.s.r=rt.r),rt.c<o.s.c&&(o.s.c=rt.c),rt.r+1>o.e.r&&(o.e.r=rt.r+1),rt.c+1>o.e.c&&(o.e.c=rt.c+1),dr.cellFormula&&Ot.f){for(var Ht=0;Ht<F.length;++Ht)if(!(F[Ht][0].s.c>rt.c||F[Ht][0].s.r>rt.r)&&!(F[Ht][0].e.c<rt.c||F[Ht][0].e.r<rt.r)){Ot.F=wt(F[Ht][0]),(F[Ht][0].s.c!=rt.c||F[Ht][0].s.r!=rt.r)&&delete Ot.f,Ot.f&&(Ot.f=""+ln(F[Ht][1],o,rt,ie,N));break}}dr.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=Ot):i[v]=Ot}},N={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var B,Oe=[],we=[],Ce=[],Ae=[],Ee=!1,ie=[];ie.SheetNames=N.snames,ie.sharedf=N.sharedf,ie.arrayf=N.arrayf,ie.names=[],ie.XTI=[];var xe=0,te=0,D=0,re=[],ee=[],Z;N.codepage=1200,Mi(1200);for(var ce=!1;t.l<t.length-1;){var _e=t.l,ve=t.read_shift(2);if(ve===0&&xe===10)break;var ye=t.l===t.length?0:t.read_shift(2),Te=kg[ve];if(Te&&Te.f){if(e.bookSheets&&xe===133&&ve!==133)break;if(xe=ve,Te.r===2||Te.r==12){var Ke=t.read_shift(2);if(ye-=2,!N.enc&&Ke!==ve&&((Ke&255)<<8|Ke>>8)!==ve)throw new Error("rt mismatch: "+Ke+"!="+ve);Te.r==12&&(t.l+=10,ye-=10)}var J={};if(ve===10?J=Te.f(t,ye,N):J=l$(ve,Te,t,ye,N),te==0&&[9,521,1033,2057].indexOf(xe)===-1)continue;switch(ve){case 34:r.opts.Date1904=A.WBProps.date1904=J;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=J,!e.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=J;break;case 66:var kt=Number(J);switch(kt){case 21010:kt=1200;break;case 32768:kt=1e4;break;case 32769:kt=1252;break}Mi(N.codepage=kt),ce=!0;break;case 317:N.rrtabid=J;break;case 25:N.winlocked=J;break;case 439:r.opts.RefreshAll=J;break;case 12:r.opts.CalcCount=J;break;case 16:r.opts.CalcDelta=J;break;case 17:r.opts.CalcIter=J;break;case 13:r.opts.CalcMode=J;break;case 14:r.opts.CalcPrecision=J;break;case 95:r.opts.CalcSaveRecalc=J;break;case 15:N.CalcRefMode=J;break;case 2211:r.opts.FullCalc=J;break;case 129:J.fDialog&&(i["!type"]="dialog"),J.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),J.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(J);break;case 430:ie.push([J]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(J);break;case 24:case 536:Z={Name:J.Name,Ref:ln(J.rgce,o,null,ie,N)},J.itab>0&&(Z.Sheet=J.itab-1),ie.names.push(Z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(ee[J.itab-1]={ref:wt(J.rgce[0][0][1][2])});break;case 22:N.ExternCount=J;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(J),ie.XTI=ie.XTI.concat(J);break;case 2196:if(N.biff<8)break;Z!=null&&(Z.Comment=J[1]);break;case 18:i["!protect"]=J;break;case 19:J!==0&&N.WTF&&console.error("Password verifier: "+J);break;case 133:a[J.pos]=J,N.snames.push(J.name);break;case 10:{if(--te)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=wt(o),e.sheetRows&&e.sheetRows<=o.e.r){var ct=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=wt(o),o.e.r=ct}o.e.r++,o.e.c++}Oe.length>0&&(i["!merges"]=Oe),we.length>0&&(i["!objects"]=we),Ce.length>0&&(i["!cols"]=Ce),Ae.length>0&&(i["!rows"]=Ae),A.Sheets.push(P)}h===""?d=i:n[h]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),N.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(N.biff=5,ce=!0,Mi(N.codepage=28591)),N.biff==8&&J.BIFFVer==0&&J.dt==16&&(N.biff=2),te++)break;if(i=e.dense?[]:{},N.biff<8&&!ce&&(ce=!0,Mi(N.codepage=e.codepage||1252)),N.biff<5||J.BIFFVer==0&&J.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:t.l-ye,name:h};a[dt.pos]=dt,N.snames.push(h)}else h=(a[_e]||{name:""}).name;J.dt==32&&(i["!type"]="chart"),J.dt==64&&(i["!type"]="macro"),Oe=[],we=[],N.arrayf=F=[],Ce=[],Ae=[],Ee=!1,P={Hidden:(a[_e]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[J.r]||[])[J.c]:i[ot({c:J.c,r:J.r})])&&++J.c,C={ixfe:J.ixfe,XF:V[J.ixfe]||{},v:J.val,t:"n"},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e);break;case 5:case 517:C={ixfe:J.ixfe,XF:V[J.ixfe],v:J.val,t:J.t},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e);break;case 638:C={ixfe:J.ixfe,XF:V[J.ixfe],v:J.rknum,t:"n"},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e);break;case 189:for(var ut=J.c;ut<=J.C;++ut){var Ve=J.rkrec[ut-J.c][0];C={ixfe:Ve,XF:V[Ve],v:J.rkrec[ut-J.c][1],t:"n"},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:ut,r:J.r},C,e)}break;case 6:case 518:case 1030:{if(J.val=="String"){c=J;break}if(C=Xh(J.val,J.cell.ixfe,J.tt),C.XF=V[C.ixfe],e.cellFormula){var Vt=J.formula;if(Vt&&Vt[0]&&Vt[0][0]&&Vt[0][0][0]=="PtgExp"){var wr=Vt[0][0][1][0],fr=Vt[0][0][1][1],Tr=ot({r:wr,c:fr});k[Tr]?C.f=""+ln(J.formula,o,J.cell,ie,N):C.F=((e.dense?(i[wr]||[])[fr]:i[Tr])||{}).F}else C.f=""+ln(J.formula,o,J.cell,ie,N)}D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L(J.cell,C,e),c=J}break;case 7:case 519:if(c)c.val=J,C=Xh(J,c.cell.ixfe,"s"),C.XF=V[C.ixfe],e.cellFormula&&(C.f=""+ln(c.formula,o,c.cell,ie,N)),D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(J);var _i=ot(J[0].s);if(_=e.dense?(i[J[0].s.r]||[])[J[0].s.c]:i[_i],e.cellFormula&&_){if(!c||!_i||!_)break;_.f=""+ln(J[1],o,J[0],ie,N),_.F=wt(J[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!c)break;k[ot(c.cell)]=J[0],_=e.dense?(i[c.cell.r]||[])[c.cell.c]:i[ot(c.cell)],(_||{}).f=""+ln(J[0],o,g,ie,N)}}break;case 253:C=Xh(u[J.isst].t,J.ixfe,"s"),u[J.isst].h&&(C.h=u[J.isst].h),C.XF=V[C.ixfe],D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:J.ixfe,XF:V[J.ixfe],t:"z"},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e));break;case 190:if(e.sheetStubs)for(var gn=J.c;gn<=J.C;++gn){var hr=J.ixfe[gn-J.c];C={ixfe:hr,XF:V[hr],t:"z"},D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:gn,r:J.r},C,e)}break;case 214:case 516:case 4:C=Xh(J.val,J.ixfe,"s"),C.XF=V[C.ixfe],D>0&&(C.z=re[C.ixfe>>8&63]),na(C,e,r.opts.Date1904),L({c:J.c,r:J.r},C,e);break;case 0:case 512:te===1&&(o=J);break;case 252:u=J;break;case 1054:if(N.biff==4){re[D++]=J[1];for(var vn=0;vn<D+163&&ft[vn]!=J[1];++vn);vn>=163&&Oo(J[1],D+163)}else Oo(J[1],J[0]);break;case 30:{re[D++]=J;for(var Lt=0;Lt<D+163&&ft[Lt]!=J;++Lt);Lt>=163&&Oo(J,D+163)}break;case 229:Oe=Oe.concat(J);break;case 93:we[J.cmo[0]]=N.lastobj=J;break;case 438:N.lastobj.TxO=J;break;case 127:N.lastobj.ImData=J;break;case 440:for(w=J[0].s.r;w<=J[0].e.r;++w)for(y=J[0].s.c;y<=J[0].e.c;++y)_=e.dense?(i[w]||[])[y]:i[ot({c:y,r:w})],_&&(_.l=J[1]);break;case 2048:for(w=J[0].s.r;w<=J[0].e.r;++w)for(y=J[0].s.c;y<=J[0].e.c;++y)_=e.dense?(i[w]||[])[y]:i[ot({c:y,r:w})],_&&_.l&&(_.l.Tooltip=J[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;_=e.dense?(i[J[0].r]||[])[J[0].c]:i[ot(J[0])];var jt=we[J[2]];_||(e.dense?(i[J[0].r]||(i[J[0].r]=[]),_=i[J[0].r][J[0].c]={t:"z"}):_=i[ot(J[0])]={t:"z"},o.e.r=Math.max(o.e.r,J[0].r),o.s.r=Math.min(o.s.r,J[0].r),o.e.c=Math.max(o.e.c,J[0].c),o.s.c=Math.min(o.s.c,J[0].c)),_.c||(_.c=[]),E={a:J[1],t:jt.TxO.t},_.c.push(E)}break;case 2173:FB(V[J.ixfe],J.ext);break;case 125:{if(!N.cellStyles)break;for(;J.e>=J.s;)Ce[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},Ee||(Ee=!0,ov(J.w/256)),cc(Ce[J.e+1])}break;case 520:{var $t={};J.level!=null&&(Ae[J.r]=$t,$t.level=J.level),J.hidden&&(Ae[J.r]=$t,$t.hidden=!0),J.hpt&&(Ae[J.r]=$t,$t.hpt=J.hpt,$t.hpx=Wu(J.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Au(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=J;break;case 161:i["!margins"]||Au(i["!margins"]={}),i["!margins"].header=J.header,i["!margins"].footer=J.footer;break;case 574:J.RTL&&(A.Views[0].RTL=!0);break;case 146:z=J;break;case 2198:B=J;break;case 140:U=J;break;case 442:h?P.CodeName=J||P.name:A.WBProps.CodeName=J||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),t.l+=ye}return r.SheetNames=pa(a).sort(function(Jr,rt){return Number(Jr)-Number(rt)}).map(function(Jr){return a[Jr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&ee.forEach(function(Jr,rt){r.Sheets[r.SheetNames[rt]]["!autofilter"]=Jr}),r.Strings=u,r.SSF=Xr(ft),N.enc&&(r.Encryption=N.enc),B&&(r.Themes=B),r.Metadata={},U!==void 0&&(r.Metadata.Country=U),ie.names.length>0&&(A.Names=ie.names),r.Workbook=A,r}var Iw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function u$(t,e,r){var n=Et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=fw(n,C5,Iw.DSI);for(var a in i)e[a]=i[a]}catch(h){if(r.WTF)throw h}var o=Et.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=fw(o,I5,Iw.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(cA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function GA(t,e){e||(e={}),hv(e),Ek(),e.codepage&&z1(e.codepage);var r,n;if(t.FullPaths){if(Et.find(t,"/encryption"))throw new Error("File is password-protected");r=Et.find(t,"!CompObj"),n=Et.find(t,"/Workbook")||Et.find(t,"/Book")}else{switch(e.type){case"base64":t=Li(ri(t));break;case"binary":t=Li(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Kr(t,0),n={content:t}}var i,a;if(r&&s$(r),e.bookProps&&!e.bookSheets)i={};else{var o=xt?"buffer":"array";if(n&&n.content)i=c$(n.content,e);else if((a=Et.find(t,"PerfectOffice_MAIN"))&&a.content)i=Su.to_workbook(a.content,(e.type=o,e));else if((a=Et.find(t,"NativeContent_MAIN"))&&a.content)i=Su.to_workbook(a.content,(e.type=o,e));else throw(a=Et.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=XB(t))}var c={};return t.FullPaths&&u$(t,c,e),i.Props=i.Custprops=c,e.bookFiles&&(i.cfb=t),i}var q0={0:{f:W7},1:{f:X7},2:{f:ij},3:{f:Z7},4:{f:Q7},5:{f:nj},6:{f:oj},7:{f:tj},8:{f:hj},9:{f:fj},10:{f:cj},11:{f:uj},12:{f:Y7},13:{f:aj},14:{f:ej},15:{f:J7},16:{f:jA},17:{f:lj},18:{f:rj},19:{f:tv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Bj},40:{},42:{},43:{f:cB},44:{f:lB},45:{f:uB},46:{f:hB},47:{f:fB},48:{},49:{f:d5},50:{},51:{f:OB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:EA},62:{f:sj},63:{f:VB},64:{f:Ej},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:pn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:q7},148:{f:G7,p:16},151:{f:mj},152:{},153:{f:Mj},154:{},155:{},156:{f:Lj},157:{},158:{},159:{T:1,f:I9},160:{T:-1},161:{T:1,f:Jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bB},336:{T:-1},337:{f:DB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:gj},427:{f:vj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_j},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:K7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:GB},633:{T:1},634:{T:-1},635:{T:1,f:WB},636:{T:-1},637:{f:m5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Cj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kg={6:{f:Dm},10:{f:Rs},12:{f:_r},13:{f:_r},14:{f:lr},15:{f:lr},16:{f:un},17:{f:lr},18:{f:lr},19:{f:_r},20:{f:mw},21:{f:mw},23:{f:yA},24:{f:vw},25:{f:lr},26:{},27:{},28:{f:HV},29:{},34:{f:lr},35:{f:gw},38:{f:un},39:{f:un},40:{f:un},41:{f:un},42:{f:lr},43:{f:lr},47:{f:K9},49:{f:SV},51:{f:_r},60:{},61:{f:EV},64:{f:lr},65:{f:TV},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:dV},93:{f:WV},94:{},95:{f:lr},96:{},97:{},99:{f:lr},125:{f:EA},128:{f:DV},129:{f:pV},130:{f:_r},131:{f:lr},132:{f:lr},133:{f:mV},134:{},140:{f:QV},141:{f:_r},144:{},146:{f:ZV},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:i9},161:{f:t9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:PV},190:{f:FV},193:{f:Rs},197:{},198:{},199:{},200:{},201:{},202:{f:lr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:lr},222:{},224:{f:OV},225:{f:hV},226:{f:Rs},227:{},229:{f:zV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:gV},253:{f:kV},255:{f:vV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:lr},353:{f:Rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:LV},431:{f:lr},432:{},433:{},434:{},437:{},438:{f:qV},439:{f:lr},440:{f:XV},441:{},442:{f:gf},443:{},444:{f:_r},445:{},446:{},448:{f:Rs},449:{f:yV,r:2},450:{f:Rs},512:{f:dw},513:{f:n9},515:{f:NV},516:{f:AV},517:{f:pw},519:{f:a9},520:{f:xV},523:{},545:{f:xw},549:{f:hw},566:{},574:{f:wV},638:{f:RV},659:{},1048:{},1054:{f:CV},1084:{},1212:{f:UV},2048:{f:YV},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Gh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:e9,r:12},2173:{f:PB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:lr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:BV,r:12},2197:{},2198:{f:SB,r:12},2199:{},2200:{},2201:{},2202:{f:jV,r:12},2203:{f:Rs},2204:{},2205:{},2206:{},2207:{},2211:{f:_V},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:r9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:JV},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:dw},1:{},2:{f:c9},3:{f:l9},4:{f:o9},5:{f:pw},7:{f:u9},8:{},9:{f:Gh},11:{},22:{f:_r},30:{f:IV},31:{},32:{},33:{f:xw},36:{},37:{f:hw},50:{f:f9},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:s9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:h9},223:{},234:{},354:{},421:{},518:{f:Dm},521:{f:Gh},536:{f:vw},547:{f:gw},561:{},579:{},1030:{f:Dm},1033:{f:Gh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ni(t,e,r,n){var i=e;if(!isNaN(i)){var a=(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&tA(r)&&t.push(r)}}function Rw(t,e){var r=e,n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=i.index,c=a&&a.index||t.length,u=N8(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<u.length;++o){var y=u[o].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var k=y.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var F=k[c].trim();if(F.match(/<t[dh]/i)){for(var C=F,U=0;C.charAt(0)=="<"&&(U=C.indexOf(">"))>-1;)C=C.slice(U+1);for(var V=0;V<E.length;++V){var z=E[V];z.s.c==d&&z.s.r<h&&h<=z.e.r&&(d=z.e.c+1,V=-1)}var A=tt(F.slice(0,F.indexOf(">")));v=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||v>1)&&E.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+v-1}});var P=A.t||A["data-t"]||"";if(!C.length){d+=v;continue}if(C=$k(C),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!C.length){d+=v;continue}var R={t:"s",v:C};r.raw||!C.trim().length||P=="s"||(C==="TRUE"?R={t:"b",v:!0}:C==="FALSE"?R={t:"b",v:!1}:isNaN(Ui(C))?isNaN(lc(C).getDate())||(R={t:"d",v:Ur(C)},r.cellDates||(R={t:"n",v:In(R.v)}),R.z=r.dateNF||ft[14]):R={t:"n",v:Ui(C)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=R):n[ot({r:h,c:d})]=R,d+=v}}}}return n["!ref"]=wt(_),E.length&&(n["!merges"]=E),n}function f$(t,e,r,n){for(var i=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o)&&!(i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){c=-1;break}c=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(c<0)){var d=ot({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],v=g&&g.v!=null&&(g.h||Y1(g.w||(Qa(g),g.w)||""))||"",_={};c>1&&(_.rowspan=c),u>1&&(_.colspan=u),n.editable?v='<span contenteditable="true">'+v+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),_.id=(n.id||"sjs")+"-"+d,a.push(Q8("td",v,_))}}var E="<tr>";return E+a.join("")+"</tr>"}var h$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',d$="</body></html>";function p$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ro(Rw(r[0],e),e);var n=pv();return r.forEach(function(i,a){mv(n,Rw(i,e),"Sheet"+(a+1))}),n}function m$(t,e,r){var n=[];return n.join("")+"<table"+(r.id?' id="'+r.id+'"':"")+">"}function g$(t,e){var r=e||{},n=r.header!=null?r.header:h$,i=r.footer!=null?r.footer:d$,a=[n],o=Ec(t["!ref"]);r.dense=Array.isArray(t),a.push(m$(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)a.push(f$(t,o,c,r));return a.push("</table>"+i),a.join("")}function KA(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Sn(n.origin):n.origin;i=o.r,a=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var d=Ec(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),i==-1&&(h.e.r=i=d.e.r+1)}var g=[],v=0,_=t["!rows"]||(t["!rows"]=[]),E=0,y=0,w=0,k=0,F=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&y<u;++E){var U=c[E];if(Pw(U)){if(n.display)continue;_[y]={hidden:!0}}var V=U.children;for(w=k=0;w<V.length;++w){var z=V[w];if(!(n.display&&Pw(z))){var A=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):$k(z.innerHTML),P=z.getAttribute("data-z")||z.getAttribute("z");for(v=0;v<g.length;++v){var R=g[v];R.s.c==k+a&&R.s.r<y+i&&y+i<=R.e.r&&(k=R.e.c+1-a,v=-1)}C=+z.getAttribute("colspan")||1,((F=+z.getAttribute("rowspan")||1)>1||C>1)&&g.push({s:{r:y+i,c:k+a},e:{r:y+i+(F||1)-1,c:k+a+(C||1)-1}});var M={t:"s",v:A},L=z.getAttribute("data-t")||z.getAttribute("t")||"";A!=null&&(A.length==0?M.t=L||"z":n.raw||A.trim().length==0||L=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(Ui(A))?isNaN(lc(A).getDate())||(M={t:"d",v:Ur(A)},n.cellDates||(M={t:"n",v:In(M.v)}),M.z=n.dateNF||ft[14]):M={t:"n",v:Ui(A)})),M.z===void 0&&P!=null&&(M.z=P);var N="",B=z.getElementsByTagName("A");if(B&&B.length)for(var Oe=0;Oe<B.length&&!(B[Oe].hasAttribute("href")&&(N=B[Oe].getAttribute("href"),N.charAt(0)!="#"));++Oe);N&&N.charAt(0)!="#"&&(M.l={Target:N}),n.dense?(t[y+i]||(t[y+i]=[]),t[y+i][k+a]=M):t[ot({c:k+a,r:y+i})]=M,h.e.c<k+a&&(h.e.c=k+a),k+=C}}++y}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,y-1+i),t["!ref"]=wt(h),y>=u&&(t["!fullref"]=wt((h.e.r=c.length-E+y-1+i,h))),t}function qA(t,e){var r=e||{},n=r.dense?[]:{};return KA(n,t,e)}function v$(t,e){return ro(qA(t,e),e)}function Pw(t){var e="",r=x$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function x$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=St(e.replace(/<[^>]*>/g,""));return[r]}var Fw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function XA(t,e){var r=e||{},n=Q1(t),i=[],a,o,c={name:""},u="",h=0,d,g,v={},_=[],E=r.dense?[]:{},y,w,k={value:""},F="",C=0,U=[],V=-1,z=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,R={},M=[],L={},N=0,B=0,Oe=[],we=1,Ce=1,Ae=[],Ee={Names:[]},ie={},xe=["",""],te=[],D={},re="",ee=0,Z=!1,ce=!1,_e=0;for($u.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=$u.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?E["!ref"]=wt(A):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(E["!fullref"]=E["!ref"],A.e.r=r.sheetRows-1,E["!ref"]=wt(A)),M.length&&(E["!merges"]=M),Oe.length&&(E["!rows"]=Oe),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),v[d.name]=E,ce=!1):y[0].charAt(y[0].length-2)!=="/"&&(d=tt(y[0],!1),V=z=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,E=r.dense?[]:{},M=[],Oe=[],ce=!0);break;case"table-row-group":y[1]==="/"?--P:++P;break;case"table-row":case"":if(y[1]==="/"){V+=we,we=1;break}if(g=tt(y[0],!1),g.?V=g.-1:V==-1&&(V=0),we=+g["number-rows-repeated"]||1,we<10)for(_e=0;_e<we;++_e)P>0&&(Oe[V+_e]={level:P});z=-1;break;case"covered-table-cell":y[1]!=="/"&&++z,r.sheetStubs&&(r.dense?(E[V]||(E[V]=[]),E[V][z]={t:"z"}):E[ot({r:V,c:z})]={t:"z"}),F="",U=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++z,k=tt(y[0],!1),Ce=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=kw(St(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=St(k["string-value"]||""),r.dense?(E[V]||(E[V]=[]),E[V][z]=w):E[ot({r:V,c:z})]=w),z+=Ce-1;else if(y[1]!=="/"){++z,F="",C=0,U=[],Ce=1;var ve=we?V+we-1:V;if(z>A.e.c&&(A.e.c=z),z<A.s.c&&(A.s.c=z),V<A.s.r&&(A.s.r=V),ve>A.e.r&&(A.e.r=ve),k=tt(y[0],!1),te=[],D={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=St(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(N=parseInt(k["number-matrix-rows-spanned"],10)||0,B=parseInt(k["number-matrix-columns-spanned"],10)||0,L={s:{r:V,c:z},e:{r:V+N-1,c:z+B-1}},w.F=wt(L),Ae.push([L,w.F])),k.formula)w.f=kw(k.formula);else for(_e=0;_e<Ae.length;++_e)V>=Ae[_e][0].s.r&&V<=Ae[_e][0].e.r&&z>=Ae[_e][0].s.c&&z<=Ae[_e][0].e.c&&(w.F=Ae[_e][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(N=parseInt(k["number-rows-spanned"],10)||0,B=parseInt(k["number-columns-spanned"],10)||0,L={s:{r:V,c:z},e:{r:V+N-1,c:z+B-1}},M.push(L)),k["number-columns-repeated"]&&(Ce=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Yt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=Ur(k["date-value"]),r.cellDates||(w.t="n",w.v=In(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=b8(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Cd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(F=St(k["string-value"]),U=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Z=!1,w.t==="s"&&(w.v=F||"",U.length&&(w.R=U),Z=C==0),ie.Target&&(w.l=ie),te.length>0&&(w.c=te,te=[]),F&&r.cellText!==!1&&(w.w=F),Z&&(w.t="z",delete w.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=V))for(var ye=0;ye<we;++ye){if(Ce=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(E[V+ye]||(E[V+ye]=[]),E[V+ye][z]=ye==0?w:Xr(w);--Ce>0;)E[V+ye][z+Ce]=Xr(w);else for(E[ot({r:V+ye,c:z})]=w;--Ce>0;)E[ot({r:V+ye,c:z+Ce})]=Xr(w);A.e.c<=z&&(A.e.c=z)}Ce=parseInt(k["number-columns-repeated"]||"1",10),z+=Ce-1,Ce=0,w={},F="",U=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a;D.t=F,U.length&&(D.R=U),D.a=re,te.push(D)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);re="",ee=0,F="",C=0,U=[];break;case"creator":y[1]==="/"?re=n.slice(ee,y.index):ee=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);F="",C=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(R[c.name]=u,(a=i.pop())[0]!==y[3])throw"Bad state: "+a}else y[0].charAt(y[0].length-2)!=="/"&&(u="",c=tt(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=tt(y[0],!1),u+=Fw[y[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=tt(y[0],!1),u+=Fw[y[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,y.index);break}else h=y.index+y[0].length;break;case"named-range":o=tt(y[0],!1),xe=Nm(o["cell-range-address"]);var Te={Name:o.name,Ref:xe[0]+"!"+xe[1]};ce&&(Te.Sheet=_.length),Ee.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!k||!k["string-value"])){var Ke=_$(n.slice(C,y.index));F=(F.length>0?F+`
`:"")+Ke[0]}else tt(y[0],!1),C=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{xe=Nm(tt(y[0])["target-range-address"]),v[xe[0]]["!autofilter"]={ref:xe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ie=tt(y[0],!1),!ie.href)break;ie.Target=St(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(xe=Nm(ie.Target.slice(1)),ie.Target="#"+xe[0]+"!"+xe[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var J={Sheets:v,SheetNames:_,Workbook:Ee};return r.bookSheets&&delete J.Sheets,J}function bw(t,e){e=e||{},mi(t,"META-INF/manifest.xml")&&N5(xr(t,"META-INF/manifest.xml"),e);var r=Jn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=XA(Ut(r),e);return mi(t,"meta.xml")&&(n.Props=lA(xr(t,"meta.xml"))),n}function Ow(t,e){return XA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ag(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ut(Yo(t))}function Cg(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Dw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function y$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Gu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function fn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Gu(t,r),a=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(a){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Gu(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var h={data:c,type:a};e[i]==null?e[i]=[h]:e[i].push(h)}return e}function fv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function E$(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Gu(t,n),a=fn(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:Fr(a[1][0].data),messages:[]};a[2].forEach(function(c){var u=fn(c.data),h=Fr(u[3][0].data);o.messages.push({meta:u,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=a[3])!=null&&e[0]&&(o.merge=Fr(a[3][0].data)>>>0>0),r.push(o)}return r}function w$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Gu(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(a==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,a==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Cg(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(i.push(i[0].slice(-u)),h-=u;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-u,-u+h))}}var d=Cg(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function T$(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(w$(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Cg(e)}function S$(t,e,r,n){var i=uv(t),a=i.getUint32(4,!0),o=(n>1?12:8)+Dw(a&(n>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);a&512&&(c=i.getUint32(o,!0),o+=4),o+=Dw(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(o,!0),o+=4),a&32&&(h=i.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function k$(t,e,r){var n=uv(t),i=n.getUint32(8,!0),a=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);i&1&&(u=y$(t,a),a+=16),i&2&&(h=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(c=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return g}function A$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return S$(t,e,r,t[0]);case 5:return k$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Hs(t){var e=fn(t);return Gu(e[1][0].data)}function Nw(t,e){var r=fn(e.data),n=Fr(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var c=fn(o.data),u=Fr(c[1][0].data)>>>0;switch(n){case 1:a[u]=Ag(c[3][0].data);break;case 8:{var h=t[Hs(c[9][0].data)][0],d=fn(h.data),g=t[Hs(d[1][0].data)][0],v=Fr(g.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=fn(g.data);a[u]=_[3].map(function(E){return Ag(E.data)}).join("")}break}}),a}function C$(t,e){var r,n,i,a,o,c,u,h,d,g,v,_,E,y,w=fn(t),k=Fr(w[1][0].data)>>>0,F=Fr(w[2][0].data)>>>0,C=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(w[8][0].data)>0||!1,U,V;if((a=(i=w[7])==null?void 0:i[0])!=null&&a.data&&e!=0)U=(c=(o=w[7])==null?void 0:o[0])==null?void 0:c.data,V=(h=(u=w[6])==null?void 0:u[0])==null?void 0:h.data;else if((g=(d=w[4])==null?void 0:d[0])!=null&&g.data&&e!=1)U=(_=(v=w[4])==null?void 0:v[0])==null?void 0:_.data,V=(y=(E=w[3])==null?void 0:E[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var z=C?4:1,A=uv(U),P=[],R=0;R<U.length/2;++R){var M=A.getUint16(R*2,!0);M<65535&&P.push([R,M])}if(P.length!=F)throw"Expected ".concat(F," cells, found ").concat(P.length);var L=[];for(R=0;R<P.length-1;++R)L[P[R][0]]=V.subarray(P[R][1]*z,P[R+1][1]*z);return P.length>=1&&(L[P[P.length-1][0]]=V.subarray(P[P.length-1][1]*z)),{R:k,cells:L}}function I$(t,e){var r,n=fn(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,a=fv(n[5],function(o){return C$(o,i)});return{nrows:Fr(n[4][0].data)>>>0,data:a.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function R$(t,e,r){var n,i=fn(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Fr(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(Fr(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=wt(a);var o=fn(i[4][0].data),c=Nw(t,t[Hs(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?Nw(t,t[Hs(o[17][0].data)][0]):[],h=fn(o[3][0].data),d=0;h[1].forEach(function(g){var v=fn(g.data),_=t[Hs(v[2][0].data)][0],E=Fr(_.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var y=I$(t,_);y.data.forEach(function(w,k){w.forEach(function(F,C){var U=ot({r:d+k,c:C}),V=A$(F,c,u);V&&(r[U]=V)})}),d+=y.nrows})}function P$(t,e){var r=fn(e.data),n={"!ref":"A1"},i=t[Hs(r[2][0].data)],a=Fr(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return R$(t,i[0],n),n}function F$(t,e){var r,n=fn(e.data),i={name:(r=n[1])!=null&&r[0]?Ag(n[1][0].data):"",sheets:[]},a=fv(n[2],Hs);return a.forEach(function(o){t[o].forEach(function(c){var u=Fr(c.meta[1][0].data);u==6e3&&i.sheets.push(P$(t,c))})}),i}function b$(t,e){var r=pv(),n=fn(e.data),i=fv(n[1],Hs);if(i.forEach(function(a){t[a].forEach(function(o){var c=Fr(o.meta[1][0].data);if(c==2){var u=F$(t,o);u.sheets.forEach(function(h,d){mv(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Mm(t){var e,r,n,i,a={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=T$(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=E$(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){a[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Fr(a[1][0].meta[1][0].data)==1&&a[1][0];if(c||o.forEach(function(u){a[u].forEach(function(h){var d=Fr(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return b$(a,c)}function O$(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function hv(t){O$([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function D$(t){return jl.WS.indexOf(t)>-1?"sheet":t==jl.CS?"chart":t==jl.DS?"dialog":t==jl.MS?"macro":t&&t.length?t:"sheet"}function N$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,D$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function L$(t,e,r,n,i,a,o,c,u,h,d,g){try{a[n]=wu(Jn(t,r,!0),e);var v=xr(t,e),_;switch(c){case"sheet":_=$j(v,e,i,u,a[n],h,d,g);break;case"chart":if(_=Hj(v,e,i,u,a[n],h,d,g),!_||!_["!drawel"])break;var E=hu(_["!drawel"].Target,e),y=Eg(E),w=jB(Jn(t,E,!0),wu(Jn(t,y,!0),E)),k=hu(w,E),F=Eg(k);_=kj(Jn(t,k,!0),k,u,wu(Jn(t,F,!0),k),h,_);break;case"macro":_=zj(v,e,i,u,a[n],h,d,g);break;case"dialog":_=Wj(v,e,i,u,a[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=_;var C=[];a&&a[n]&&pa(a[n]).forEach(function(U){var V="";if(a[n][U].Type==jl.CMNT){V=hu(a[n][U].Target,e);var z=Xj(xr(t,V,!0),V,u);if(!z||!z.length)return;yw(_,z,!1)}a[n][U].Type==jl.TCMNT&&(V=hu(a[n][U].Target,e),C=C.concat(HB(xr(t,V,!0),u)))}),C&&C.length&&yw(_,C,!0,u.people||[])}catch(U){if(u.WTF)throw U}}function di(t){return t.charAt(0)=="/"?t.slice(1):t}function M$(t,e){if(Ok(),e=e||{},hv(e),mi(t,"META-INF/manifest.xml")||mi(t,"objectdata.xml"))return bw(t,e);if(mi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Mm<"u"){if(t.FileIndex)return Mm(t);var r=Et.utils.cfb_new();return KE(t).forEach(function(Oe){V8(r,Oe,M8(t,Oe))}),Mm(r)}throw new Error("Unsupported NUMBERS file")}if(!mi(t,"[Content_Types].xml"))throw mi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=KE(t),i=O5(Jn(t,"[Content_Types].xml")),a=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",xr(t,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!xr(t,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(ku=[],i.sst)try{ku=qj(xr(t,di(i.sst)),i.sst,e)}catch(Oe){if(e.WTF)throw Oe}e.cellStyles&&i.themes.length&&(u=Kj(Jn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(h=Gj(xr(t,di(i.style)),i.style,u,e))}i.links.map(function(Oe){try{var we=wu(Jn(t,Eg(di(Oe))),Oe);return Qj(xr(t,di(Oe)),we,Oe,e)}catch{}});var d=jj(xr(t,di(i.workbooks[0])),i.workbooks[0],e),g={},v="";i.coreprops.length&&(v=xr(t,di(i.coreprops[0]),!0),v&&(g=lA(v)),i.extprops.length!==0&&(v=xr(t,di(i.extprops[0]),!0),v&&V5(v,g,e)));var _={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(v=Jn(t,di(i.custprops[0]),!0),v&&(_=U5(v,e)));var E={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(we){return we.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(E.Props=g,E.Custprops=_),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var y={};e.bookDeps&&i.calcchain&&(y=Yj(xr(t,di(i.calcchain)),i.calcchain));var w=0,k={},F,C;{var U=d.Sheets;g.Worksheets=U.length,g.SheetNames=[];for(var V=0;V!=U.length;++V)g.SheetNames[V]=U[V].name}var z=a?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),P=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");mi(t,P)||(P="xl/_rels/workbook."+z+".rels");var R=wu(Jn(t,P,!0),P.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=Jj(xr(t,di(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=zB(xr(t,di(i.people[0])),e)),R&&(R=N$(R,d.Sheets));var M=xr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var L="sheet";if(R&&R[w]?(F="xl/"+R[w][1].replace(/[\/]?xl\//,""),mi(t,F)||(F=R[w][1]),mi(t,F)||(F=P.replace(/_rels\/.*$/,"")+R[w][1]),L=R[w][2]):(F="xl/worksheets/sheet"+(w+1-M)+"."+z,F=F.replace(/sheet0\./,"sheet.")),C=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,B=0;B!=e.sheets.length;++B)typeof e.sheets[B]=="number"&&e.sheets[B]==w&&(N=1),typeof e.sheets[B]=="string"&&e.sheets[B].toLowerCase()==g.SheetNames[w].toLowerCase()&&(N=1);if(!N)continue e}}L$(t,F,C,g.SheetNames[w],w,k,o,L,e,d,u,h)}return E={Directory:i,Workbook:d,Props:g,Custprops:_,Deps:y,Sheets:o,SheetNames:g.SheetNames,Strings:ku,Styles:h,Themes:u,SSF:Xr(ft)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Oe,we){Oe=Oe.replace(/^Root Entry[\/]/,""),E.keys.push(Oe),E.files[Oe]=t.FileIndex[we]}))),e&&e.bookVBA&&(i.vba.length>0?E.vbaraw=xr(t,di(i.vba[0]),!0):i.defaults&&i.defaults.bin===qB&&(E.vbaraw=xr(t,"xl/vbaProject.bin",!0))),E}function V$(t,e){var r=e||{},n="Workbook",i=Et.find(t,n);try{if(n="/!DataSpaces/Version",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(P9(i.content),n="/!DataSpaces/DataSpaceMap",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=b9(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=O9(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);N9(i.content)}catch{}if(n="/EncryptionInfo",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=L9(i.content);if(n="/EncryptedPackage",i=Et.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function dv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ri(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function B$(t,e){return Et.find(t,"EncryptedPackage")?V$(t,e):GA(t,e)}function U$(t,e){var r,n=t,i=e||{};return i.type||(i.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r=Bk(n,i),M$(r,i)}function YA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sg(t.slice(r),e);default:break e}return Hu.to_workbook(t,e)}function j$(t,e){var r="",n=dv(t,e);switch(e.type){case"base64":r=ri(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=jo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ut(r)),e.type="binary",YA(r,e)}function $$(t,e){var r=t;return e.type=="base64"&&(r=ri(r)),r=Bu.utils.decode(1200,r.slice(2),"str"),e.type="binary",YA(r,e)}function H$(t){return t.match(/[^\x00-\x7F]/)?du(t):t}function Vm(t,e,r,n){return n?(r.type="string",Hu.to_workbook(t,r)):Hu.to_workbook(e,r)}function Ig(t,e){Ek();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ig(new Uint8Array(t),(r=Xr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xl={},r.dateNF&&(Xl.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=P8(t),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=H$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Xr(r),r.type="array",Ig(W1(n),r)}switch((i=dv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return B$(Et.read(n,r),r);break;case 9:if(i[1]<=8)return GA(n,r);break;case 60:return Sg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return v9(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return m9.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?U$(n,r):Vm(t,n,r,a);case 239:return i[3]===60?Sg(n,r):Vm(t,n,r,a);case 255:if(i[1]===254)return $$(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Su.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Su.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _w.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return q9.to_workbook(n,r);break;case 10:case 13:case 32:return j$(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return d9.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?_w.to_workbook(n,r):Vm(t,n,r,a)}function z$(t,e,r,n,i,a,o,c){var u=Yr(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||t[r])for(var _=e.s.c;_<=e.e.c;++_){var E=o?t[r][_]:t[n[_]+u];if(E===void 0||E.t===void 0){if(h===void 0)continue;a[_]!=null&&(v[a[_]]=h);continue}var y=E.v;switch(E.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(a[_]!=null){if(y==null)if(E.t=="e"&&y===null)v[a[_]]=null;else if(h!==void 0)v[a[_]]=h;else if(d&&y===null)v[a[_]]=null;else continue;else v[a[_]]=d&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?y:Qa(E,y,c);y!=null&&(g=!1)}}return{row:v,isempty:g}}function Rg(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":u=ar(d);break;case"number":u=ar(t["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var g=Yr(u.s.r),v=[],_=[],E=0,y=0,w=Array.isArray(t),k=u.s.r,F=0,C={};w&&!t[k]&&(t[k]=[]);var U=h.skipHidden&&t["!cols"]||[],V=h.skipHidden&&t["!rows"]||[];for(F=u.s.c;F<=u.e.c;++F)if(!(U[F]||{}).hidden)switch(v[F]=Ir(F),r=w?t[k][F]:t[v[F]+g],n){case 1:a[F]=F-u.s.c;break;case 2:a[F]=v[F];break;case 3:a[F]=h.header[F-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Qa(r,null,h),y=C[o]||0,!y)C[o]=1;else{do c=o+"_"+y++;while(C[c]);C[o]=y,C[c]=1}a[F]=c}for(k=u.s.r+i;k<=u.e.r;++k)if(!(V[k]||{}).hidden){var z=z$(t,u,k,v,n,a,w,h);(z.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(_[E++]=z.row)}return _.length=E,_}var Lw=/"/g;function W$(t,e,r,n,i,a,o,c){for(var u=!0,h=[],d="",g=Yr(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var _=c.dense?(t[r]||[])[v]:t[n[v]+g];if(_==null)d="";else if(_.v!=null){u=!1,d=""+(c.rawNumbers&&_.t=="n"?_.v:Qa(_,null,c));for(var E=0,y=0;E!==d.length;++E)if((y=d.charCodeAt(E))===i||y===a||y===34||c.forceQuotes){d='"'+d.replace(Lw,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(u=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(Lw,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function QA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ar(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),h=new RegExp((a=="|"?"\\|":a)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],E=i.s.c;E<=i.e.c;++E)(v[E]||{}).hidden||(g[E]=Ir(E));for(var y=0,w=i.s.r;w<=i.e.r;++w)(_[w]||{}).hidden||(d=W$(t,i,w,g,o,u,a,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((y++?c:"")+d)));return delete n.dense,r.join("")}function G$(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=QA(t,e);return r}function K$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ar(t["!ref"]),a="",o=[],c,u=[],h=Array.isArray(t);for(c=i.s.c;c<=i.e.c;++c)o[c]=Ir(c);for(var d=i.s.r;d<=i.e.r;++d)for(a=Yr(d),c=i.s.c;c<=i.e.c;++c)if(e=o[c]+a,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function JA(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},o=0,c=0;if(n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?Sn(n.origin):n.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+i}};if(a["!ref"]){var g=ar(a["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+i)}else o==-1&&(o=0,d.e.r=e.length-1+i);var v=n.header||[],_=0;e.forEach(function(y,w){pa(y).forEach(function(k){(_=v.indexOf(k))==-1&&(v[_=v.length]=k);var F=y[k],C="z",U="",V=ot({c:c+_,r:o+w+i});h=Ku(a,V),F&&typeof F=="object"&&!(F instanceof Date)?a[V]=F:(typeof F=="number"?C="n":typeof F=="boolean"?C="b":typeof F=="string"?C="s":F instanceof Date?(C="d",n.cellDates||(C="n",F=In(F)),U=n.dateNF||ft[14]):F===null&&n.nullError&&(C="e",F=0),h?(h.t=C,h.v=F,delete h.w,delete h.R,U&&(h.z=U)):a[V]=h={t:C,v:F},U&&(h.z=U))})}),d.e.c=Math.max(d.e.c,c+v.length-1);var E=Yr(o);if(i)for(_=0;_<v.length;++_)a[Ir(_+c)+E]={t:"s",v:v[_]};return a["!ref"]=wt(d),a}function q$(t,e){return JA(null,t,e)}function Ku(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Ku(t,ot(e)):Ku(t,ot({r:e,c:r||0}))}function X$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function pv(){return{SheetNames:[],Sheets:{}}}function mv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(Oj(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Y$(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=X$(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Q$(t,e){return t.z=e,t}function ZA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function J$(t,e,r){return ZA(t,"#"+e,r)}function Z$(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function eH(t,e,r,n){for(var i=typeof e!="string"?e:ar(e),a=typeof e=="string"?e:wt(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var u=Ku(t,o,c);u.t="n",u.F=a,delete u.v,o==i.s.r&&c==i.s.c&&(u.f=r,n&&(u.D=!0))}return t}var tH={encode_col:Ir,encode_row:Yr,encode_cell:ot,encode_range:wt,decode_col:ev,decode_row:Z1,split_cell:h5,decode_cell:Sn,decode_range:Ec,format_cell:Qa,sheet_add_aoa:nA,sheet_add_json:JA,sheet_add_dom:KA,aoa_to_sheet:wc,json_to_sheet:q$,table_to_sheet:qA,table_to_book:v$,sheet_to_csv:QA,sheet_to_txt:G$,sheet_to_json:Rg,sheet_to_html:g$,sheet_to_formulae:K$,sheet_to_row_object_array:Rg,sheet_get_cell:Ku,book_new:pv,book_append_sheet:mv,book_set_sheet_visibility:Y$,cell_set_number_format:Q$,cell_set_hyperlink:ZA,cell_set_internal_link:J$,cell_add_comment:Z$,sheet_set_array_formula:eH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rH=({onFileUpload:t,columnNames:e})=>{const[r,n]=G.useState(null),[i,a]=G.useState(null),o=u=>{var d;const h=(d=u.target.files)==null?void 0:d[0];if(h){if(h.type!=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"){a("Please upload a valid Excel file (.xlsx)");return}n(h),a(null)}},c=async u=>{if(u.preventDefault(),r){const h=new FileReader;h.onload=d=>{var v;const g=(v=d.target)==null?void 0:v.result;try{const _=Ig(g,{type:"binary"}),E=_.SheetNames[0],y=_.Sheets[E];let w=tH.sheet_to_json(y,{header:1});const k=w.shift();console.log("Headers:",k);const F=e.filter(U=>!k.includes(U));if(F.length>0){a(`Missing headers: ${F.join(", ")}`);return}const C=w.map(U=>k.reduce((V,z,A)=>(V[z]=U[A],V),{}));t(C)}catch(_){console.error("Error processing file:",_),a("Error processing file")}},h.readAsBinaryString(r)}};return Y.jsxs("form",{onSubmit:c,children:[Y.jsx("input",{type:"file",accept:".xlsx",onChange:o,required:!0,"aria-label":"Upload Excel file"}),i&&Y.jsx("div",{className:"error",children:i})," ",Y.jsx("button",{type:"submit",children:"Load Data"})," "]})},Mw=({label:t,checked:e=!1,onChange:r})=>{const[n,i]=G.useState(e);G.useEffect(()=>{i(e)},[e]);const a=o=>{const c=o.target.checked;i(c),r&&r(c)};return Y.jsxs("label",{className:"container",children:[Y.jsx("input",{type:"checkbox",checked:n,onChange:a}),Y.jsx("svg",{viewBox:"0 0 64 64",height:"1.25em",width:"1.25em",children:Y.jsx("path",{d:"M 0 16 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 16 L 32 48 L 64 16 V 8 A 8 8 90 0 0 56 0 H 8 A 8 8 90 0 0 0 8 V 56 A 8 8 90 0 0 8 64 H 56 A 8 8 90 0 0 64 56 V 16",pathLength:"575.0541381835938",className:"path"})}),t&&Y.jsx("span",{children:t})]})};var eC={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Vw=Ms.createContext&&Ms.createContext(eC),nH=["attr","size","title"];function iH(t,e){if(t==null)return{};var r=aH(t,e),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function aH(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function X0(){return X0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},X0.apply(this,arguments)}function Bw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Y0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bw(Object(r),!0).forEach(function(n){sH(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sH(t,e,r){return e=oH(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oH(t){var e=lH(t,"string");return typeof e=="symbol"?e:e+""}function lH(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tC(t){return t&&t.map((e,r)=>Ms.createElement(e.tag,Y0({key:r},e.attr),tC(e.child)))}function rC(t){return e=>Ms.createElement(cH,X0({attr:Y0({},t.attr)},e),tC(t.child))}function cH(t){var e=r=>{var{attr:n,size:i,title:a}=t,o=iH(t,nH),c=i||r.size||"1em",u;return r.className&&(u=r.className),t.className&&(u=(u?u+" ":"")+t.className),Ms.createElement("svg",X0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,o,{className:u,style:Y0(Y0({color:t.color||r.color},r.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&Ms.createElement("title",null,a),t.children)};return Vw!==void 0?Ms.createElement(Vw.Consumer,null,r=>e(r)):e(eC)}function uH(t){return rC({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(t)}function fH(t){return rC({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(t)}const hH=({title:t,message:e,onConfirm:r,onCancel:n})=>Y.jsx("div",{className:"modal-overlay",children:Y.jsxs("div",{className:"card",children:[Y.jsx("div",{className:"header",children:Y.jsx("div",{className:"image_v",children:Y.jsx("div",{className:"image",children:Y.jsx(fH,{})})})}),Y.jsxs("div",{className:"content",children:[Y.jsx("h2",{className:"title",children:t}),Y.jsx("p",{className:"message",children:e})]}),Y.jsxs("div",{className:"buttons-container flex",children:[Y.jsx("button",{className:"confirm-button",onClick:r,children:"S"}),Y.jsx("button",{className:"cancel-button",onClick:n,children:"No"})]})]})}),dH=({fields:t,data:e,onSelect:r,onImport:n,onImportMulti:i,titleModal:a,messageModal:o})=>{const[c,u]=G.useState(e||[]),[h,d]=G.useState(new Set),[g,v]=G.useState(!1);G.useEffect(()=>{u(e)},[e]);const _=U=>{const V=new Set(h);V.has(U)?V.delete(U):V.add(U),d(V)},E=()=>{h.size===c.length?d(new Set):d(new Set(c.map((U,V)=>V)))},y=U=>{d(new Set([U]));const V=c[U];r(V)},w=U=>{const V=c[U];n(V)},k=()=>{const U=c.filter((V,z)=>!h.has(z));u(U),d(new Set)},F=()=>{v(!1);const U=c.filter((V,z)=>h.has(z));if(console.log({dataToImport:U,selectedRows:h}),U.length===0){console.log("No changes to save!");return}i&&i(U)},C=()=>{console.log("Cancelled!"),v(!1)};return c&&c.length>0&&Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{className:"actions buttons-container",children:[Y.jsx("button",{className:"delete-button",onClick:k,"aria-label":"Delete selected rows",children:"Delete Selected Rows"}),i&&Y.jsx("button",{className:"edit-button",onClick:()=>v(!0),"aria-label":"Confirm and save changes",children:"Confirm and Save"})]}),Y.jsxs("div",{className:"table-container",children:[Y.jsx("table",{className:"list-base-table header-table","aria-label":"table data to import",children:Y.jsx("thead",{children:Y.jsxs("tr",{children:[Y.jsx("th",{children:Y.jsx(Mw,{checked:h.size===c.length,onChange:E,"aria-label":"Select all students"})}),t.map(({name:U,placeholder:V})=>Y.jsx("th",{children:V},`up-th-${U}`)),Y.jsx("th",{children:"Action"})]})})}),Y.jsx("div",{className:"table-body-container",children:Y.jsx("table",{className:"upload-table list-base-table body-table","aria-label":"List data to import",children:Y.jsx("tbody",{children:c.map((U,V)=>Y.jsxs("tr",{"aria-selected":h.has(V),onClick:()=>_(V),children:[Y.jsx("td",{children:Y.jsxs("div",{onClick:z=>z.stopPropagation(),"aria-hidden":"true",children:[" ",Y.jsx(Mw,{checked:h.has(V),onChange:()=>_(V),"aria-label":`Select ${U[0]}`})]})}),t.map(({name:z})=>Y.jsx("td",{children:U[z]},`${z}-${V}`)),Y.jsxs("td",{className:"actions",onClick:z=>z.stopPropagation(),"aria-hidden":"true",children:[Y.jsx("button",{className:"save-button",onClick:()=>y(V),"aria-label":`Select ${U.id}`,children:"Select"}),Y.jsx("button",{className:"view-button",onClick:()=>w(V),"aria-label":`Import ${U.id}`,children:"Import"})]})]},`up-row-${V}`))})})})]}),g&&Y.jsx(hH,{title:a||"Confirm Import",message:o||"Are you sure you want to proceed import?",onConfirm:F,onCancel:C})]})},pH=({handlers:t,fetchItems:e,...r})=>{const{showForm:n=!1,clearFormAfterAdd:i=!1,ableImport:a=!1,ableFilter:o=!1,ableForm:c=!0,alias:u,title:h,fields:d,items:g,initialFormData:v,loading:_,viewLinks:E,uploadFields:y}=r,{showNotification:w}=F1(),k=(g==null?void 0:g.length)===0,[F,C]=G.useState(v||null),[U,V]=G.useState(null),[z,A]=G.useState(n),[P,R]=G.useState(!1),[M,L]=G.useState(!1),[N,B]=G.useState(null),[Oe,we]=G.useState([]),[Ce,Ae]=G.useState(!1),[Ee,ie]=G.useState({}),xe=async()=>{e&&await e()},te=async ve=>{var ye;await((ye=t==null?void 0:t.onItemAdded)==null?void 0:ye.call(t,ve)),xe(),V(null),i&&Z()},D=async ve=>{var ye;N?(await((ye=t==null?void 0:t.onItemUpdated)==null?void 0:ye.call(t,N.id,ve)),w("Item updated","success"),i&&Z()):w("Error updating item","error")},re=async ve=>{var ye;L(!!ve),B(ve),(ye=t==null?void 0:t.onSelect)==null||ye.call(t,ve),ve||(B(null),C(null),Z())},ee=async ve=>{t!=null&&t.onItemDeleted&&(await(t==null?void 0:t.onItemDeleted(ve)),xe(),w("Item deleted","success"))},Z=()=>{L(!1),B(null),A(n)},ce=ve=>{we(ve),Ae(!0),w("File uploaded successfully!","success")},_e=async()=>{var ve;try{(ve=t==null?void 0:t.onItemsUpdated)==null||ve.call(t,Ee),ie({})}catch(ye){console.error("Error saving changes:",ye),w("Error saving changes","error")}};return G.useEffect(()=>{k&&!_?(A(!0),R(!0)):A(n)},[g]),G.useEffect(()=>{U&&te(U),xe()},[U]),G.useEffect(()=>{t!=null&&t.onItemAdded&&L(!0),(g==null?void 0:g.length)==0&&L(!1),xe()},[M]),d.filter(ve=>ve.view===!0).length===0&&d.forEach(ve=>ve.view=!0),Y.jsxs(Y.Fragment,{children:[h&&Y.jsx("h1",{className:"title",children:h}),Y.jsxs("div",{className:"module-container",children:[!_&&c&&z&&Y.jsx(Y.Fragment,{children:Y.jsxs("div",{className:"form-container",children:[Y.jsx(WM,{onItemAdded:te,onItemUpdated:D,fields:d,isEditing:M,onCancelEdit:Z,initialData:F||N,clearFormAfterAdd:i}),a&&Y.jsx(Y.Fragment,{children:P&&Y.jsx(rH,{onFileUpload:ce,columnNames:d.map(ve=>ve.name)})})]})}),Y.jsxs("div",{className:"list-container",children:[a&&Ce&&Y.jsx("div",{className:"upload-container",children:Y.jsx(dH,{fields:y||d,data:Oe,onSelect:B,onImport:V,onImportMulti:t==null?void 0:t.onItemsAdded})}),(g==null?void 0:g.length)>0&&Y.jsx(ZM,{config:{viewLinks:E,loading:_||!1,alias:u,items:g,selectedItem:v||N,fields:d,removeable:!!(t!=null&&t.onItemDeleted),editable:!!(t!=null&&t.onItemUpdated),seeable:!!(t!=null&&t.onView),ableFilter:o,ableForm:c,ableImport:a,showForm:z,showImportForm:P,useFlexTable:!1,tempChanges:Ee,setTempChanges:ie},handlers:{onAdd:A,onImport:R,onSelect:re,onItemDeleted:ee,onItemsUpdated:_e}})]})]})]})},mH=async(t,e)=>{const r=Za(ur,`periods/${t}/courses/${e}/assignments`);return(await ff(r)).docs.map(a=>({id:a.id,...a.data()}))},gH=async(t,e,r)=>{const n=Za(ur,`periods/${t}/courses/${e}/assignments`),i=await P1(n,{...r});console.log("Assignment added with ID: ",i.id);const a=ti(ur,`periods/${t}/courses/${e}`);await to(a,{assignmentsIds:SS(i.id)})},vH=async(t,e,r)=>{const n=M3(ur),i=Za(ur,`periods/${e}/courses/${r}/assignments`);t.forEach(a=>{const o=ti(i);n.set(o,{title:a.title,contributionPercentage:a.contributionPercentage})});try{await n.commit()}catch(a){throw console.error("Error committing batch:",a),new Error("Error adding assignments")}},xH=async(t,e,r,n,i)=>{const a=ti(ur,`periods/${t}/courses/${e}/assignments/${r}`),{id:o,...c}=n;await to(a,c)},_H=async(t,e,r)=>{const n=ti(ur,`periods/${t}/courses/${e}/assignments/${r}`);await R1(n);const i=ti(ur,`periods/${t}`);await to(i,{assignmentsIds:kS(e)})},yH=async(t,e)=>{const r=Za(ur,`periods/${t}/courses/${e}/assignments`),i=(await ff(r)).docs.map(o=>o.id);console.log({ids:i,periodId:t,courseId:e});const a=ti(ur,`periods/${t}/courses/${e}`);await to(a,{assignmentsIds:i})},EH=t=>{const{courseId:e,periodId:r}=t,[n,i]=G.useState([]),[a,o]=G.useState(!1),[c,u]=G.useState(null),{showNotification:h}=F1(),d=G.useCallback(async()=>{o(!0);try{const k=await mH(r,e);i(k)}catch(k){u(k instanceof Error?k.message:"Error al cargar las calificaciones")}finally{o(!1)}},[r,e,o]);G.useEffect(()=>{let k=!0;return(async()=>{k&&await d()})(),()=>{k=!1}},[e,d]);const g=G.useCallback(async k=>{o(!0);try{const{id:F,...C}=k;await gH(r,e,C),await d()}catch(F){u(F instanceof Error?F.message:"Error adding assignment")}finally{o(!1)}},[r,e,d,o]),v=async k=>{try{const F=k.filter(U=>!n.some(V=>V.title===U.title));if(F.length===0){h("All assignments already exist","error");return}if(F.filter(U=>!_(U)).length>0){h("Some assignments have invalid data","error");return}await vH(F,r,e),h(`${F.length} assignments added`,"success"),d()}catch(F){console.error("Error adding assignments:",F),u("Error adding assignments")}},_=k=>n.some(C=>C.title===k.title)?(h("The assignment already exists","error"),!1):!k.title||typeof k.contributionPercentage!="number"||k.contributionPercentage<0||k.contributionPercentage>100?(h("Invalid assignment data","error"),!1):!0,E=G.useCallback(async(k,F)=>{o(!0);try{await xH(r,e,k,F),await d()}catch(C){u(C instanceof Error?C.message:"Error updating assignment")}finally{o(!1)}},[r,e,d,o]),y=G.useCallback(async k=>{o(!0);try{await _H(r,e,k),await d()}catch(F){u(F instanceof Error?F.message:"Error deleting assignment")}finally{o(!1)}},[r,e,d,o]);return{assignments:n,loadAssignments:d,loading:a,setLoading:o,error:c,handleAddAssignment:g,handleAddAssignments:v,handleUpdateAssignment:E,handleDeleteAssignment:y,handleSyncAssignments:async()=>{try{if(console.log("Syncing assignments for period:",r,"course:",e),!r||!e){u("Invalid period or course ID");return}o(!0),await yH(r,e),await d()}catch{u("Error syncing assignments")}finally{o(!1)}}}},wH=({periodId:t,courseId:e})=>{const{assignments:r,loading:n,error:i,handleAddAssignment:a,handleAddAssignments:o,handleDeleteAssignment:c,handleUpdateAssignment:u,handleSyncAssignments:h}=EH({periodId:t,courseId:e}),d=G.useMemo(()=>r.reduce((v,_)=>v+(Number(_.contributionPercentage)||0),0),[r]),g=[{name:"title",placeholder:"Title of the assignment"},{name:"contributionPercentage",placeholder:"percentage",type:"number-view"},{name:"link",placeholder:"URL",type:"link"}];return n?Y.jsx(Ed,{text:"Loading assignments",className:"h30vh"}):i?Y.jsxs("div",{children:["Error: ",i]}):Y.jsxs("div",{className:"assignments-manager",children:[Y.jsx("div",{className:"button-container",children:Y.jsx("button",{className:"save-button",onClick:h,children:"Sync"})}),Y.jsxs("p",{children:[Y.jsx("b",{children:"Total Percentage: "}),"(",d,")%"]}),d<100&&Y.jsxs("p",{children:[Y.jsx("b",{children:"Pending Percentage: "}),"(",100-d,")%"]}),Y.jsx(pH,{alias:e,fields:g,items:r,handlers:{onItemAdded:a,onItemUpdated:u,onItemDeleted:c,onItemsAdded:o},loading:n,clearFormAfterAdd:!1,showForm:!1,ableForm:!0,ableImport:!0})]})},TH=({titleName:t,fields:e,data:r,handlers:n,ableDelete:i,viewLink:a})=>{const o=(u,h)=>{switch(u){case"date":return new Date(h).toLocaleDateString();case"array":return h.length;case"number":return Number(h).toLocaleString();default:return h}},c=!!(n!=null&&n.onItemUpdated)||i||a;return Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{className:"actions buttons-container compact",children:[(n==null?void 0:n.onItemUpdated)&&Y.jsx("button",{onClick:()=>n.onItemUpdated&&r&&n.onItemUpdated(r),className:"edit-button",children:"Edit"}),i&&r&&r.id&&Y.jsx("button",{onClick:()=>(n==null?void 0:n.onDelete)&&r&&n.onDelete(r.id),className:"delete-button",children:"Delete"}),a&&Y.jsx(Ho,{to:a,className:"button view-button","aria-label":"View selected item",children:"View"})]}),Y.jsxs("div",{className:`module-card ${c?"with-actions":""}`,children:[Y.jsx("h3",{children:r?r[t]:""}),e.map(({name:u,placeholder:h,type:d})=>r&&r[u]?Y.jsxs("p",{children:[Y.jsxs("strong",{className:"capitalize",children:[h,":"]})," ",o(d,r[u])]},u):null)]})]})},SH=[{name:"name",placeholder:"name"},{name:"description",placeholder:"description"},{name:"duration",placeholder:"duration"},{name:"hours",placeholder:"hours"},{name:"status",placeholder:"status"},{name:"assignmentsIds",placeholder:"assignments",type:"array"},{name:"enrolledStudents",placeholder:"Enrolled Students",type:"array"},{name:"teacherName",placeholder:"teacherName"}],kH=({data:t,viewLink:e,onDelete:r,onItemAdded:n,onItemUpdated:i})=>{var a;return Y.jsx(Y.Fragment,{children:Y.jsx(TH,{titleName:"name",fields:SH,data:t,viewLink:e,handlers:{onDelete:r,onItemAdded:n,onItemUpdated:i},ableDelete:t.assignmentsIds.length===0&&(((a=t.enrolledStudents)==null?void 0:a.length)??0)===0})})},AH=({periodId:t})=>{const e=Dg(),{courses:r,availableCourses:n,handleAddCourse:i,handleDeleteCourse:a,handleUpdateCourse:o}=Q3(t),{teachers:c}=zM(),[u,h]=G.useState(null),[d,g]=G.useState(null),[v]=Nu("selectPeriod",null),_=()=>{e(-1)},E=async k=>{if(d){const{id:F,...C}=k,U={...C,teacherId:d};await o(F,U),g(null)}},y=async()=>{const{id:k,...F}=n.filter(C=>C.id===u)[0];if(u){const C={...F,periodId:t,courseId:k,status:"Not Started",assignmentsIds:[],enrolledStudents:[]};await i(C),h(null)}},w=(k,F)=>k&&F&&String(k)===String(F);return Y.jsxs("div",{className:"periods-manager card",children:[Y.jsxs("div",{className:"container",children:[Y.jsx("h3",{children:v==null?void 0:v.name}),Y.jsx("button",{onClick:_,children:"Volver"})]}),Y.jsxs("div",{className:"container",children:[t&&Y.jsxs("div",{className:"item",children:[Y.jsx("h3",{children:"Available Courses"}),Y.jsx("div",{className:"buttons-container flex",children:n.map((k,F)=>Y.jsx("button",{className:`button ${w(u,k.id)?"active":""}`,onClick:()=>h(k.id),children:k.name},`ac-${F}`))}),n.length===0&&Y.jsx("div",{className:"empty",children:"No courses available for this period"})]}),t&&u&&Y.jsx("button",{className:"edit-button",onClick:y,children:"Assign course"})]}),Y.jsx("div",{className:"",children:r.map(k=>Y.jsxs("div",{className:"container periods-list",children:[Y.jsxs("div",{className:"item",children:[!k.teacherId&&Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"buttons-container actions",children:Y.jsx("button",{className:"save-button",onClick:()=>E(k),children:"Save"})}),Y.jsx(_k,{label:"Teacher",options:c.map(F=>({value:F.id,label:F.name})),value:"",onChange:F=>g(F.value),placeholder:"Select Teacher"},"teacherId")]}),Y.jsx(kH,{data:k,onDelete:a,viewLink:`/period/${t}/course/${k.id}`})]}),k.id&&t&&Y.jsx(wH,{courseId:k.id,periodId:t})]},k.id))})]})},CH=()=>{const{id:t}=GI();return Y.jsx("div",{children:t&&Y.jsx(AH,{periodId:t})})},IH=G.lazy(()=>Wi(()=>import("./Register-bowjnG0_.js"),__vite__mapDeps([0,1]))),RH=G.lazy(()=>Wi(()=>import("./Home-CMXl9aMT.js"),__vite__mapDeps([2,3,4]))),PH=G.lazy(()=>Wi(()=>import("./Courses-CBfsy0Rs.js"),__vite__mapDeps([5,6]))),Uw=G.lazy(()=>Wi(()=>import("./Grades-CFufRhY8.js"),__vite__mapDeps([7,8,9]))),jw=G.lazy(()=>Wi(()=>import("./Periods-ue_t-bD9.js"),__vite__mapDeps([10,11]))),FH=G.lazy(()=>Wi(()=>import("./Dashboard-Bzi2hLAY.js"),__vite__mapDeps([12,3,4]))),bH=G.lazy(()=>Wi(()=>import("./Students-BAHQ8X_3.js"),__vite__mapDeps([13,8,9,14,15,11,16,17]))),OH=G.lazy(()=>Wi(()=>import("./Teachers-CZg263qw.js"),[])),$w=G.lazy(()=>Wi(()=>import("./StudentsCourses-DsqqlxHv.js"),__vite__mapDeps([18,8,9,14,15,11,16]))),Hw=G.lazy(()=>Wi(()=>import("./CourseStudents-nBi6jYH6.js"),__vite__mapDeps([19,6,9,15,11,20]))),DH=G.lazy(()=>Wi(()=>import("./PeriodStudents-B4HCw0MC.js"),[])),NH=()=>{const{loading:t}=CS(),{setIsLoading:e}=PS(),[r,n]=G.useState(!1),[i,a]=G.useState(!1);if(G.useEffect(()=>{let c;return t?e(!0):c=setTimeout(()=>{e(!1),n(!0),a(!0)},2e3),()=>{c&&clearTimeout(c)}},[t,e]),!r)return null;const o=Y.jsxs(oR,{children:[Y.jsx(Mr,{path:"/",element:Y.jsx(RH,{})}),Y.jsx(Mr,{path:"/register",element:Y.jsx(IH,{})}),Y.jsx(Mr,{path:"/dashboard",element:Y.jsx(Vn,{element:Y.jsx(FH,{})})}),Y.jsx(Mr,{path:"/students",element:Y.jsx(Vn,{element:Y.jsx(bH,{})})}),Y.jsx(Mr,{path:"/students/:id/periods",element:Y.jsx(Vn,{element:Y.jsx($w,{})})}),Y.jsx(Mr,{path:"/students/:id/courses",element:Y.jsx(Vn,{element:Y.jsx($w,{})})}),Y.jsx(Mr,{path:"/teachers",element:Y.jsx(Vn,{element:Y.jsx(OH,{})})}),Y.jsx(Mr,{path:"/courses",element:Y.jsx(Vn,{element:Y.jsx(PH,{})})}),Y.jsx(Mr,{path:"/grades",element:Y.jsx(Vn,{element:Y.jsx(Uw,{})})}),Y.jsx(Mr,{path:"/periods",element:Y.jsx(Vn,{element:Y.jsx(jw,{})})}),Y.jsx(Mr,{path:"/periods/courses",element:Y.jsx(Vn,{element:Y.jsx(jw,{})})}),Y.jsx(Mr,{path:"/period/:id/courses",element:Y.jsx(Vn,{element:Y.jsx(CH,{})})}),Y.jsx(Mr,{path:"/period/:id/students",element:Y.jsx(Vn,{element:Y.jsx(DH,{})})}),Y.jsx(Mr,{path:"/period/:periodId/course/:courseId",element:Y.jsx(Vn,{element:Y.jsx(Hw,{})})}),Y.jsx(Mr,{path:"grades/period/:periodId/course/:courseId",element:Y.jsx(Vn,{element:Y.jsx(Uw,{})})}),Y.jsx(Mr,{path:"/course/:id/students",element:Y.jsx(Vn,{element:Y.jsx(Hw,{})})}),Y.jsx(Mr,{path:"*",element:Y.jsx(tT,{to:"/"})})," "]});return Y.jsx(G.Suspense,{fallback:Y.jsx(Ed,{text:"Cargando componente..."}),children:i?o:null})},nC=G.createContext(void 0),LH=({children:t})=>{const[e,r]=G.useState(null);return Y.jsx(nC.Provider,{value:{openDropdown:e,setOpenDropdown:r},children:t})},MH=()=>{const t=G.useContext(nC);if(t===void 0)throw new Error("useDropdown must be used within a DropdownProvider");return t},iC=({id:t,title:e,items:r})=>{const{openDropdown:n,setOpenDropdown:i}=MH(),a=ma(),o=()=>{i(n===t?null:t)},c=n===t,u=r.some(h=>a.pathname===h.to);return Y.jsxs("div",{className:"dropdown",children:[Y.jsxs("button",{onClick:o,className:`dropdown-button${u?" active":""} ${c?" open":""}`,children:[e," ",Y.jsx("span",{className:"dropdown-icon",children:""})]}),c&&Y.jsx("ul",{className:"dropdown-menu",children:r.map((h,d)=>Y.jsx("li",{className:a.pathname===h.to?"active":"",onClick:()=>i(null),children:Y.jsxs(Ho,{to:h.to,style:{display:"flex",alignItems:"center"},children:[h.icon&&Y.jsx("span",{className:"item-icon",children:h.icon}),h.label]})},d))})]})},VH=({items:t})=>{const e=ma();return Y.jsx("header",{className:"navbar",children:Y.jsx("ul",{children:t.map(r=>Y.jsx("li",{children:r.children?Y.jsx(iC,{id:`${r.label.toLowerCase()}-dropdown-desktop`,title:r.label,items:r.children}):Y.jsx("button",{className:`dropdown-button ${e.pathname===r.to?"active":""}`,children:Y.jsx(Ho,{to:r.to,children:r.label})})},r.label))})})},BH=({items:t,isOpen:e,onClose:r})=>Y.jsxs("div",{className:`sidebar ${e?"open":""}`,children:[Y.jsx("button",{className:"close-button",onClick:r,children:" "}),Y.jsx("ul",{children:t.map(n=>Y.jsx("li",{children:n.children?Y.jsx(iC,{id:`${n.label.toLowerCase()}-dropdown`,title:n.label,items:n.children}):Y.jsx("button",{className:`dropdown-button ${location.pathname===n.to?"active":""}`,children:Y.jsx(Ho,{to:n.to,onClick:r,children:n.label})})},n.label))})]}),zw=[{label:"Dashboard",to:"/dashboard"},{label:"Students",to:"",children:[{label:"Estudiantes",to:"/students"},{label:"Calificaciones",to:"/grades"}]},{label:"Params",to:"",children:[{label:"Periods",to:"/periods"},{label:"Courses",to:"/courses"},{label:"Profesores",to:"/teachers"}]},{label:"User",to:"",children:[{label:"Login",to:"/login"},{label:"Register",to:"/register"}]}],UH=()=>{const[t,e]=G.useState(!1),r=()=>{e(!t)};return Y.jsxs("div",{children:[Y.jsxs("button",{className:"toggle-button",onClick:r,children:[Y.jsx(uH,{})," "]}),Y.jsx(BH,{items:zw,isOpen:t,onClose:()=>e(!1)}),Y.jsx(VH,{items:zw})]})},jH=({children:t})=>Y.jsxs("div",{className:"grid",children:[Y.jsx("div",{className:"header",children:Y.jsx(UH,{})}),Y.jsx("div",{className:"main",children:t})]}),$H=()=>Y.jsx(FR,{basename:"/learntrackcenter",children:Y.jsx(j3,{children:Y.jsx(K3,{children:Y.jsx(LH,{children:Y.jsx(jH,{children:Y.jsx(NH,{})})})})})});gI.createRoot(document.getElementById("root")).render(Y.jsx(G.StrictMode,{children:Y.jsx($H,{})}));export{wH as A,kS as B,TH as C,pH as D,H3 as E,XH as F,YH as G,Ed as L,AH as P,F1 as a,B3 as b,HH as c,CS as d,PS as e,Za as f,ZH as g,ur as h,P1 as i,Y as j,ff as k,ti as l,R1 as m,GI as n,Nu as o,zH as p,zM as q,G as r,WH as s,mH as t,Dg as u,to as v,M3 as w,QH as x,JH as y,SS as z};
