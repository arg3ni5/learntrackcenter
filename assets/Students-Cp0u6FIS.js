import{j as d,b as A}from"./index-g1SReERP.js";import{r as t,h as F}from"./vendor-react-CrVlFZLu.js";import{M as $,u as P,P as D,a as N,b as k,L as U,m as O,D as T}from"./DataManagementModule-3FyRWLSI.js";import{u as V}from"./useStudents-Do7mkyRj.js";import{u as W}from"./Card-CSivsItZ.js";import{S as H,a as K}from"./StudentPeriodsManager-C15VPskD.js";import"./vendor-firebase-DPqF2cx7.js";import"./vendor-ui-Cz82L-V6.js";import"./vendor-utils-CMv371St.js";import"./studentService-BMfmTLA_.js";import"./useStudentCourses-BW1e4n1x.js";import"./periodCourseService-CGSWCgaZ.js";import"./periodService-CU21sGfe.js";class B extends t.Component{getSnapshotBeforeUpdate(l){const e=this.props.childRef.current;if(e&&l.isPresent&&!this.props.isPresent){const a=e.offsetParent,c=a instanceof HTMLElement&&a.offsetWidth||0,o=this.props.sizeRef.current;o.height=e.offsetHeight||0,o.width=e.offsetWidth||0,o.top=e.offsetTop,o.left=e.offsetLeft,o.right=c-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function G({children:r,isPresent:l,anchorX:e}){const a=t.useId(),c=t.useRef(null),o=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=t.useContext($);return t.useInsertionEffect(()=>{const{width:m,height:n,top:g,left:i,right:p}=o.current;if(l||!c.current||!m||!n)return;const f=e==="left"?`left: ${i}`:`right: ${p}`;c.current.dataset.motionPopId=a;const s=document.createElement("style");return h&&(s.nonce=h),document.head.appendChild(s),s.sheet&&s.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${n}px !important;
            ${f}px !important;
            top: ${g}px !important;
          }
        `),()=>{document.head.removeChild(s)}},[l]),d.jsx(B,{isPresent:l,childRef:c,sizeRef:o,children:t.cloneElement(r,{ref:c})})}const X=({children:r,initial:l,isPresent:e,onExitComplete:a,custom:c,presenceAffectsLayout:o,mode:h,anchorX:m})=>{const n=P(_),g=t.useId(),i=t.useCallback(f=>{n.set(f,!0);for(const s of n.values())if(!s)return;a&&a()},[n,a]),p=t.useMemo(()=>({id:g,initial:l,isPresent:e,custom:c,onExitComplete:i,register:f=>(n.set(f,!1),()=>n.delete(f))}),o?[Math.random(),i]:[e,i]);return t.useMemo(()=>{n.forEach((f,s)=>n.set(s,!1))},[e]),t.useEffect(()=>{!e&&!n.size&&a&&a()},[e]),h==="popLayout"&&(r=d.jsx(G,{isPresent:e,anchorX:m,children:r})),d.jsx(D.Provider,{value:p,children:r})};function _(){return new Map}const y=r=>r.key||"";function I(r){const l=[];return t.Children.forEach(r,e=>{t.isValidElement(e)&&l.push(e)}),l}const q=({children:r,custom:l,initial:e=!0,onExitComplete:a,presenceAffectsLayout:c=!0,mode:o="sync",propagate:h=!1,anchorX:m="left"})=>{const[n,g]=N(h),i=t.useMemo(()=>I(r),[r]),p=h&&!n?[]:i.map(y),f=t.useRef(!0),s=t.useRef(i),v=P(()=>new Map),[L,b]=t.useState(i),[C,R]=t.useState(i);k(()=>{f.current=!1,s.current=i;for(let x=0;x<C.length;x++){const u=y(C[x]);p.includes(u)?v.delete(u):v.get(u)!==!0&&v.set(u,!1)}},[C,p.length,p.join("-")]);const j=[];if(i!==L){let x=[...i];for(let u=0;u<C.length;u++){const S=C[u],M=y(S);p.includes(M)||(x.splice(u,0,S),j.push(S))}return o==="wait"&&j.length&&(x=j),R(I(x)),b(i),null}const{forceRender:E}=t.useContext(U);return d.jsx(d.Fragment,{children:C.map(x=>{const u=y(x),S=h&&!n?!1:i===C||p.includes(u),M=()=>{if(v.has(u))v.set(u,!0);else return;let w=!0;v.forEach(z=>{z||(w=!1)}),w&&(E==null||E(),R(s.current),h&&(g==null||g()),a&&a())};return d.jsx(X,{isPresent:S,initial:!f.current||e?void 0:!1,custom:S?void 0:l,presenceAffectsLayout:c,mode:o,onExitComplete:S?void 0:M,anchorX:m,children:x},u)})})},J=()=>{const{setIsLoading:r}=A(),{students:l,loading:e,handleAddStudent:a,handleAddStudents:c,handleRemoveStudent:o,handleUpdateStudent:h}=V("Loading Student"),[m,n]=W("selectedStudent",null),g=F(),i=[{name:"fullName",placeholder:"Full Name",view:!0,size:20},{name:"identificationNumber",placeholder:"Identification Number",size:15},{name:"email",placeholder:"Email Address",size:20}];t.useEffect(()=>{r(e)},[e,r]);const p=s=>{g(`/students/${s.id}/courses`),n(s)},f=async s=>{s&&(await o(s),n(null))};return d.jsxs(d.Fragment,{children:[d.jsx("h1",{className:"title",children:"Manage Student"}),d.jsx(q,{initial:!1,children:m&&d.jsxs(O.div,{initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},children:[d.jsx(H,{student:m}),d.jsx(K,{student:m})]})}),d.jsx(T,{fields:i,items:l,handlers:{onItemAdded:a,onItemsAdded:c,onItemDeleted:f,onItemUpdated:h,onView:p,onSelect:n},initialFormData:m,ableFilter:!0,showForm:!1,ableForm:!0,ableImport:!0,clearFormAfterAdd:!0,loading:e})]})},ue=()=>d.jsx(J,{});export{ue as default};
