import{d as I,j as p,D}from"./index-CkVjQk0q.js";import{r as d,f as S}from"./vendor-react-BWjxQFbR.js";import{c as y,d as w,b as j,e as b,f as E}from"./vendor-firebase-IMjs4EV5.js";import{u as x}from"./useStudents-DrMRFjY7.js";import"./vendor-ui-CZ9GI7ht.js";import"./vendor-utils-BDfVuDdi.js";import"./studentService-Cy0qVCwC.js";const F=async e=>{const t=y(I,"grades");await w(t,e)},v=async()=>{const e=y(I,"grades");return(await j(e)).docs.map(s=>({id:s.id,studentId:s.data().studentId,subjectId:s.data().subjectId,finalGrade:s.data().finalGrade}))},C=async e=>{const t=b(I,"grades",e);await E(t)},M=()=>{const[e,t]=d.useState(null),[s,l]=d.useState(null),[i,u]=d.useState([]),[m,n]=d.useState(!0),[f,r]=d.useState(null),o=async()=>{try{console.log({courseId:e,periodId:s}),n(!0);const a=await v();u(a)}catch{r("Error al cargar las calificaciones")}finally{n(!1)}};return d.useEffect(()=>{o()},[]),{grades:i,loading:m,error:f,addNewGrade:async a=>{try{await F(a),o()}catch{r("Error al agregar la calificación")}},removeGrade:async a=>{try{await C(a),o()}catch{r("Error al eliminar la calificación")}},setCourseId:t,setPeriodId:l}},A=({courseId:e,periodId:t})=>{const{grades:s,addNewGrade:l,removeGrade:i,setCourseId:u,setPeriodId:m}=M(),{students:n}=x(void 0);d.useEffect(()=>{u(e),m(t)},[]);const f=[{name:"studentId",placeholder:"ID of the Student"},{name:"subjectId",placeholder:"ID of the Subject"},{name:"finalGrade",placeholder:"Final Grade"}],r=[{name:"studentId",placeholder:"ID of the Student"},{name:"finalGrade",placeholder:"Final Grade"}],o=async G=>{const h=G.map(a=>{const c=n.find(g=>g.email===a.email||g.email===a.studentId);return c?{...a,studentId:c.id}:a});console.log(h)};return p.jsx(D,{title:"Grade Management",fields:f,uploadFields:r,items:s,showForm:!1,ableForm:!0,ableImport:!0,handlers:{onItemAdded:l,onItemsAdded:o,onItemDeleted:i}})},B=()=>{const{periodId:e,courseId:t}=S();return p.jsx("div",{children:p.jsx(A,{periodId:e,courseId:t})})};export{B as default};
