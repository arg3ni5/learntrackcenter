import{d as I,j as p}from"./index-g1SReERP.js";import{r,i as S}from"./vendor-react-CrVlFZLu.js";import{D as w}from"./DataManagementModule-3FyRWLSI.js";import{_ as y,p as j,h as D,d as E,y as b}from"./vendor-firebase-DPqF2cx7.js";import{u as x}from"./useStudents-Do7mkyRj.js";import"./vendor-ui-Cz82L-V6.js";import"./Card-CSivsItZ.js";import"./vendor-utils-CMv371St.js";import"./studentService-BMfmTLA_.js";const F=async e=>{const t=y(I,"grades");await j(t,e)},v=async()=>{const e=y(I,"grades");return(await D(e)).docs.map(s=>({id:s.id,studentId:s.data().studentId,subjectId:s.data().subjectId,finalGrade:s.data().finalGrade}))},C=async e=>{const t=E(I,"grades",e);await b(t)},M=()=>{const[e,t]=r.useState(null),[s,l]=r.useState(null),[i,u]=r.useState([]),[m,n]=r.useState(!0),[f,d]=r.useState(null),o=async()=>{try{console.log({courseId:e,periodId:s}),n(!0);const a=await v();u(a)}catch{d("Error al cargar las calificaciones")}finally{n(!1)}};return r.useEffect(()=>{o()},[]),{grades:i,loading:m,error:f,addNewGrade:async a=>{try{await F(a),o()}catch{d("Error al agregar la calificación")}},removeGrade:async a=>{try{await C(a),o()}catch{d("Error al eliminar la calificación")}},setCourseId:t,setPeriodId:l}},A=({courseId:e,periodId:t})=>{const{grades:s,addNewGrade:l,removeGrade:i,setCourseId:u,setPeriodId:m}=M(),{students:n}=x(void 0);r.useEffect(()=>{u(e),m(t)},[]);const f=[{name:"studentId",placeholder:"ID of the Student"},{name:"subjectId",placeholder:"ID of the Subject"},{name:"finalGrade",placeholder:"Final Grade"}],d=[{name:"studentId",placeholder:"ID of the Student"},{name:"finalGrade",placeholder:"Final Grade"}],o=async G=>{const h=G.map(a=>{const c=n.find(g=>g.email===a.email||g.email===a.studentId);return c?{...a,studentId:c.id}:a});console.log(h)};return p.jsx(w,{title:"Grade Management",fields:f,uploadFields:d,items:s,showForm:!1,ableForm:!0,ableImport:!0,handlers:{onItemAdded:l,onItemsAdded:o,onItemDeleted:i}})},H=()=>{const{periodId:e,courseId:t}=S();return p.jsx("div",{children:p.jsx(A,{periodId:e,courseId:t})})};export{H as default};
