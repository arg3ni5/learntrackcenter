import{a as h,g as N,d as E,j as a,F as C}from"./index-g1SReERP.js";import{r as l,L as k}from"./vendor-react-CrVlFZLu.js";import{c as P,s as A,a as G,f as L,E as ae,l as ce,b as I,d as x,e as W,m as D,o as T}from"./vendor-firebase-DPqF2cx7.js";import{U as M}from"./UserProfile-zpXe82QV.js";import"./vendor-ui-Cz82L-V6.js";const R="_form_1pcn0_1",F="_input_1pcn0_23",H="_button_1pcn0_51",O="_link_1pcn0_69",q="_buttons_1pcn0_99",V="_lineText_1pcn0_125",Y="_pass_1pcn0_135",z="_icon_1pcn0_143",B="_message_1pcn0_161",J="_success_1pcn0_171",K="_error_1pcn0_179",g={form:R,input:F,button:H,link:O,buttons:q,lineText:V,pass:Y,icon:z,message:B,success:J,error:K},Q=async(e,r)=>{try{return(await P(h,e,r)).user}catch(n){throw console.error("Error registering user"),n}},w=async(e,r)=>{try{return(await A(h,e,r)).user}catch(n){throw console.error("Error logging in user:",n),n}},_=async e=>{try{return await G(h,N)}catch(r){throw console.error("Error signing in with Google:",r),r}};const X=async()=>{try{await I(h)}catch(e){throw console.error("Error logging out"),e}},Z=async e=>{const r=x(E,"users",e),n=await W(r);if(n.exists())return n.data();throw new Error("User not found")},$=async(e,r)=>{try{const n=x(E,"users",e);await D(n,r,{merge:!0})}catch(n){throw console.error("Error updating user profile:",n),n}},ee=async e=>{try{return await L(h,e)}catch(r){throw console.error("Error fetching sign-in methods:",r),r}},j=()=>{const[e,r]=l.useState(null),[n,o]=l.useState(!1),[d,s]=l.useState(""),m=async(t,i)=>{o(!0),s("");try{const c=await ee(t);if(c.includes("password")){if(i)return await w(t,i);throw new Error("Se requiere una contraseña para iniciar sesión con Email/Password.")}else{if(c.includes("google.com"))return await _();throw new Error("No hay una cuenta registrada con este correo.")}}catch(c){throw s(c.message),c}finally{o(!1)}},f=async(t,i)=>{o(!0),s("");try{const c=await Q(t,i);r(c)}catch(c){c instanceof Error?s(c.message):s(String(c))}finally{o(!1)}},p=async(t,i)=>{o(!0),s("");try{const c=await w(t,i);console.log(c),r(c)}catch(c){c instanceof Error?s(c.message):s(String(c))}finally{o(!1)}},u=async()=>{o(!0),s("");try{const t=await _();r(t)}catch(t){t instanceof Error?s(t.message):s(String(t))}finally{o(!1)}},S=async()=>{o(!0),s("");try{await X(),r(null)}catch(t){t instanceof Error?s(t.message):s(String(t))}finally{o(!1)}},b=async t=>{o(!0),s("");try{const i=await Z(t);r({...e,...i})}catch(i){i instanceof Error?s(i.message):s(String(i))}finally{o(!1)}},U=async(t,i)=>{o(!0),s("");try{await $(t,i)}catch(c){c instanceof Error?s(c.message):s(String(c))}finally{o(!1)}},y=async()=>{o(!0),s("");try{const t=await y();r(t)}catch(t){t instanceof Error?s(t.message):s(String(t))}finally{o(!1)}};return{user:e,loading:n,error:d,register:f,login:p,handleLogin:m,loginWithGoogleHandler:u,logout:S,linkGoogleAccount:y,fetchUserData:b,updateProfileData:U}},se=()=>{const{login:e,loginWithGoogleHandler:r,loading:n,error:o}=j(),[d,s]=l.useState(""),[m,f]=l.useState(""),p=async u=>{u.preventDefault(),await e(d,m)};return a.jsx("div",{className:"container",children:a.jsxs("div",{className:"item",children:[a.jsx("h1",{className:"title",children:"Login"}),a.jsxs("form",{onSubmit:p,className:g.form,children:[a.jsx("div",{className:g.buttons,children:a.jsx(k,{to:"/register",className:g.link,children:"Register"})}),a.jsx("input",{className:g.input,type:"email",placeholder:"Email",value:d,onChange:u=>s(u.target.value)}),a.jsx("input",{type:"password",placeholder:"Contraseña",value:m,onChange:u=>f(u.target.value)}),a.jsx("div",{className:g.buttons,children:a.jsx("button",{className:g.button,type:"submit",disabled:n,children:"Sign In"})})]}),a.jsxs("div",{className:"container p-0",children:[a.jsx("span",{className:"title"}),a.jsx("span",{className:g.lineText,children:"Sign In with"}),a.jsx("span",{className:"title"})]}),a.jsx("button",{onClick:r,disabled:n,children:a.jsx(C,{})}),o&&a.jsx("p",{children:o})]})})},re=()=>{const[e,r]=l.useState(null),[n,o]=l.useState(!0);return l.useEffect(()=>{const d=T(h,s=>{r(s),o(!1)});return()=>d()},[]),{user:e,loading:n}},ue=()=>{const{user:e}=re(),{linkGoogleAccount:r}=j();l.useEffect(()=>{console.log(e)},[e]);const n=l.useMemo(()=>e==null?void 0:e.providerData.some(o=>o.providerId==="google.com"),[e]);return a.jsxs("div",{className:"home-container",children:[a.jsx("h1",{children:"Welcome to LearnTrackCenter"})," ",a.jsx("p",{children:"Your platform for managing grades and students."}),e?a.jsx(M,{}):a.jsx(se,{}),e&&!n&&a.jsx("button",{onClick:r,children:"Vincular con Google"})]})};export{ue as default};
